(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();function up(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function VC(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}),n}var zh={exports:{}},yc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F1;function HC(){if(F1)return yc;F1=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,a,i){var l=null;if(i!==void 0&&(l=""+i),a.key!==void 0&&(l=""+a.key),"key"in a){i={};for(var c in a)c!=="key"&&(i[c]=a[c])}else i=a;return a=i.ref,{$$typeof:t,type:r,key:l,ref:a!==void 0?a:null,props:i}}return yc.Fragment=e,yc.jsx=n,yc.jsxs=n,yc}var L1;function $C(){return L1||(L1=1,zh.exports=HC()),zh.exports}var x=$C(),qh={exports:{}},ft={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O1;function GC(){if(O1)return ft;O1=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.iterator;function _(D){return D===null||typeof D!="object"?null:(D=v&&D[v]||D["@@iterator"],typeof D=="function"?D:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,S={};function b(D,ee,M){this.props=D,this.context=ee,this.refs=S,this.updater=M||T}b.prototype.isReactComponent={},b.prototype.setState=function(D,ee){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,ee,"setState")},b.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function k(){}k.prototype=b.prototype;function A(D,ee,M){this.props=D,this.context=ee,this.refs=S,this.updater=M||T}var C=A.prototype=new k;C.constructor=A,E(C,b.prototype),C.isPureReactComponent=!0;var I=Array.isArray,B={H:null,A:null,T:null,S:null,V:null},j=Object.prototype.hasOwnProperty;function F(D,ee,M,Y,K,W){return M=W.ref,{$$typeof:t,type:D,key:ee,ref:M!==void 0?M:null,props:W}}function X(D,ee){return F(D.type,ee,void 0,void 0,void 0,D.props)}function P(D){return typeof D=="object"&&D!==null&&D.$$typeof===t}function re(D){var ee={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(M){return ee[M]})}var G=/\/+/g;function te(D,ee){return typeof D=="object"&&D!==null&&D.key!=null?re(""+D.key):ee.toString(36)}function _e(){}function Ne(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(_e,_e):(D.status="pending",D.then(function(ee){D.status==="pending"&&(D.status="fulfilled",D.value=ee)},function(ee){D.status==="pending"&&(D.status="rejected",D.reason=ee)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function Ee(D,ee,M,Y,K){var W=typeof D;(W==="undefined"||W==="boolean")&&(D=null);var oe=!1;if(D===null)oe=!0;else switch(W){case"bigint":case"string":case"number":oe=!0;break;case"object":switch(D.$$typeof){case t:case e:oe=!0;break;case g:return oe=D._init,Ee(oe(D._payload),ee,M,Y,K)}}if(oe)return K=K(D),oe=Y===""?"."+te(D,0):Y,I(K)?(M="",oe!=null&&(M=oe.replace(G,"$&/")+"/"),Ee(K,ee,M,"",function(De){return De})):K!=null&&(P(K)&&(K=X(K,M+(K.key==null||D&&D.key===K.key?"":(""+K.key).replace(G,"$&/")+"/")+oe)),ee.push(K)),1;oe=0;var ve=Y===""?".":Y+":";if(I(D))for(var Te=0;Te<D.length;Te++)Y=D[Te],W=ve+te(Y,Te),oe+=Ee(Y,ee,M,W,K);else if(Te=_(D),typeof Te=="function")for(D=Te.call(D),Te=0;!(Y=D.next()).done;)Y=Y.value,W=ve+te(Y,Te++),oe+=Ee(Y,ee,M,W,K);else if(W==="object"){if(typeof D.then=="function")return Ee(Ne(D),ee,M,Y,K);throw ee=String(D),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.")}return oe}function se(D,ee,M){if(D==null)return D;var Y=[],K=0;return Ee(D,Y,"","",function(W){return ee.call(M,W,K++)}),Y}function ue(D){if(D._status===-1){var ee=D._result;ee=ee(),ee.then(function(M){(D._status===0||D._status===-1)&&(D._status=1,D._result=M)},function(M){(D._status===0||D._status===-1)&&(D._status=2,D._result=M)}),D._status===-1&&(D._status=0,D._result=ee)}if(D._status===1)return D._result.default;throw D._result}var ae=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ee=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(ee))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)};function J(){}return ft.Children={map:se,forEach:function(D,ee,M){se(D,function(){ee.apply(this,arguments)},M)},count:function(D){var ee=0;return se(D,function(){ee++}),ee},toArray:function(D){return se(D,function(ee){return ee})||[]},only:function(D){if(!P(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},ft.Component=b,ft.Fragment=n,ft.Profiler=a,ft.PureComponent=A,ft.StrictMode=r,ft.Suspense=d,ft.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,ft.__COMPILER_RUNTIME={__proto__:null,c:function(D){return B.H.useMemoCache(D)}},ft.cache=function(D){return function(){return D.apply(null,arguments)}},ft.cloneElement=function(D,ee,M){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var Y=E({},D.props),K=D.key,W=void 0;if(ee!=null)for(oe in ee.ref!==void 0&&(W=void 0),ee.key!==void 0&&(K=""+ee.key),ee)!j.call(ee,oe)||oe==="key"||oe==="__self"||oe==="__source"||oe==="ref"&&ee.ref===void 0||(Y[oe]=ee[oe]);var oe=arguments.length-2;if(oe===1)Y.children=M;else if(1<oe){for(var ve=Array(oe),Te=0;Te<oe;Te++)ve[Te]=arguments[Te+2];Y.children=ve}return F(D.type,K,void 0,void 0,W,Y)},ft.createContext=function(D){return D={$$typeof:l,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:i,_context:D},D},ft.createElement=function(D,ee,M){var Y,K={},W=null;if(ee!=null)for(Y in ee.key!==void 0&&(W=""+ee.key),ee)j.call(ee,Y)&&Y!=="key"&&Y!=="__self"&&Y!=="__source"&&(K[Y]=ee[Y]);var oe=arguments.length-2;if(oe===1)K.children=M;else if(1<oe){for(var ve=Array(oe),Te=0;Te<oe;Te++)ve[Te]=arguments[Te+2];K.children=ve}if(D&&D.defaultProps)for(Y in oe=D.defaultProps,oe)K[Y]===void 0&&(K[Y]=oe[Y]);return F(D,W,void 0,void 0,null,K)},ft.createRef=function(){return{current:null}},ft.forwardRef=function(D){return{$$typeof:c,render:D}},ft.isValidElement=P,ft.lazy=function(D){return{$$typeof:g,_payload:{_status:-1,_result:D},_init:ue}},ft.memo=function(D,ee){return{$$typeof:f,type:D,compare:ee===void 0?null:ee}},ft.startTransition=function(D){var ee=B.T,M={};B.T=M;try{var Y=D(),K=B.S;K!==null&&K(M,Y),typeof Y=="object"&&Y!==null&&typeof Y.then=="function"&&Y.then(J,ae)}catch(W){ae(W)}finally{B.T=ee}},ft.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},ft.use=function(D){return B.H.use(D)},ft.useActionState=function(D,ee,M){return B.H.useActionState(D,ee,M)},ft.useCallback=function(D,ee){return B.H.useCallback(D,ee)},ft.useContext=function(D){return B.H.useContext(D)},ft.useDebugValue=function(){},ft.useDeferredValue=function(D,ee){return B.H.useDeferredValue(D,ee)},ft.useEffect=function(D,ee,M){var Y=B.H;if(typeof M=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Y.useEffect(D,ee)},ft.useId=function(){return B.H.useId()},ft.useImperativeHandle=function(D,ee,M){return B.H.useImperativeHandle(D,ee,M)},ft.useInsertionEffect=function(D,ee){return B.H.useInsertionEffect(D,ee)},ft.useLayoutEffect=function(D,ee){return B.H.useLayoutEffect(D,ee)},ft.useMemo=function(D,ee){return B.H.useMemo(D,ee)},ft.useOptimistic=function(D,ee){return B.H.useOptimistic(D,ee)},ft.useReducer=function(D,ee,M){return B.H.useReducer(D,ee,M)},ft.useRef=function(D){return B.H.useRef(D)},ft.useState=function(D){return B.H.useState(D)},ft.useSyncExternalStore=function(D,ee,M){return B.H.useSyncExternalStore(D,ee,M)},ft.useTransition=function(){return B.H.useTransition()},ft.version="19.1.0",ft}var P1;function fp(){return P1||(P1=1,qh.exports=GC()),qh.exports}var U=fp();const cs=up(U);var Yh={exports:{}},_c={},Wh={exports:{}},Jh={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U1;function zC(){return U1||(U1=1,function(t){function e(se,ue){var ae=se.length;se.push(ue);e:for(;0<ae;){var J=ae-1>>>1,D=se[J];if(0<a(D,ue))se[J]=ue,se[ae]=D,ae=J;else break e}}function n(se){return se.length===0?null:se[0]}function r(se){if(se.length===0)return null;var ue=se[0],ae=se.pop();if(ae!==ue){se[0]=ae;e:for(var J=0,D=se.length,ee=D>>>1;J<ee;){var M=2*(J+1)-1,Y=se[M],K=M+1,W=se[K];if(0>a(Y,ae))K<D&&0>a(W,Y)?(se[J]=W,se[K]=ae,J=K):(se[J]=Y,se[M]=ae,J=M);else if(K<D&&0>a(W,ae))se[J]=W,se[K]=ae,J=K;else break e}}return ue}function a(se,ue){var ae=se.sortIndex-ue.sortIndex;return ae!==0?ae:se.id-ue.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var d=[],f=[],g=1,v=null,_=3,T=!1,E=!1,S=!1,b=!1,k=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function I(se){for(var ue=n(f);ue!==null;){if(ue.callback===null)r(f);else if(ue.startTime<=se)r(f),ue.sortIndex=ue.expirationTime,e(d,ue);else break;ue=n(f)}}function B(se){if(S=!1,I(se),!E)if(n(d)!==null)E=!0,j||(j=!0,te());else{var ue=n(f);ue!==null&&Ee(B,ue.startTime-se)}}var j=!1,F=-1,X=5,P=-1;function re(){return b?!0:!(t.unstable_now()-P<X)}function G(){if(b=!1,j){var se=t.unstable_now();P=se;var ue=!0;try{e:{E=!1,S&&(S=!1,A(F),F=-1),T=!0;var ae=_;try{t:{for(I(se),v=n(d);v!==null&&!(v.expirationTime>se&&re());){var J=v.callback;if(typeof J=="function"){v.callback=null,_=v.priorityLevel;var D=J(v.expirationTime<=se);if(se=t.unstable_now(),typeof D=="function"){v.callback=D,I(se),ue=!0;break t}v===n(d)&&r(d),I(se)}else r(d);v=n(d)}if(v!==null)ue=!0;else{var ee=n(f);ee!==null&&Ee(B,ee.startTime-se),ue=!1}}break e}finally{v=null,_=ae,T=!1}ue=void 0}}finally{ue?te():j=!1}}}var te;if(typeof C=="function")te=function(){C(G)};else if(typeof MessageChannel<"u"){var _e=new MessageChannel,Ne=_e.port2;_e.port1.onmessage=G,te=function(){Ne.postMessage(null)}}else te=function(){k(G,0)};function Ee(se,ue){F=k(function(){se(t.unstable_now())},ue)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(se){se.callback=null},t.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<se?Math.floor(1e3/se):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_next=function(se){switch(_){case 1:case 2:case 3:var ue=3;break;default:ue=_}var ae=_;_=ue;try{return se()}finally{_=ae}},t.unstable_requestPaint=function(){b=!0},t.unstable_runWithPriority=function(se,ue){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var ae=_;_=se;try{return ue()}finally{_=ae}},t.unstable_scheduleCallback=function(se,ue,ae){var J=t.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?J+ae:J):ae=J,se){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=ae+D,se={id:g++,callback:ue,priorityLevel:se,startTime:ae,expirationTime:D,sortIndex:-1},ae>J?(se.sortIndex=ae,e(f,se),n(d)===null&&se===n(f)&&(S?(A(F),F=-1):S=!0,Ee(B,ae-J))):(se.sortIndex=D,e(d,se),E||T||(E=!0,j||(j=!0,te()))),se},t.unstable_shouldYield=re,t.unstable_wrapCallback=function(se){var ue=_;return function(){var ae=_;_=ue;try{return se.apply(this,arguments)}finally{_=ae}}}}(Jh)),Jh}var B1;function qC(){return B1||(B1=1,Wh.exports=zC()),Wh.exports}var Kh={exports:{}},er={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j1;function YC(){if(j1)return er;j1=1;var t=fp();function e(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(d,f,g){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:d,containerInfo:f,implementation:g}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return er.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,er.createPortal=function(d,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(e(299));return i(d,f,null,g)},er.flushSync=function(d){var f=l.T,g=r.p;try{if(l.T=null,r.p=2,d)return d()}finally{l.T=f,r.p=g,r.d.f()}},er.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(d,f))},er.prefetchDNS=function(d){typeof d=="string"&&r.d.D(d)},er.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var g=f.as,v=c(g,f.crossOrigin),_=typeof f.integrity=="string"?f.integrity:void 0,T=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;g==="style"?r.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:T}):g==="script"&&r.d.X(d,{crossOrigin:v,integrity:_,fetchPriority:T,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},er.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var g=c(f.as,f.crossOrigin);r.d.M(d,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(d)},er.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var g=f.as,v=c(g,f.crossOrigin);r.d.L(d,g,{crossOrigin:v,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},er.preloadModule=function(d,f){if(typeof d=="string")if(f){var g=c(f.as,f.crossOrigin);r.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(d)},er.requestFormReset=function(d){r.d.r(d)},er.unstable_batchedUpdates=function(d,f){return d(f)},er.useFormState=function(d,f,g){return l.H.useFormState(d,f,g)},er.useFormStatus=function(){return l.H.useHostTransitionStatus()},er.version="19.1.0",er}var V1;function WC(){if(V1)return Kh.exports;V1=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Kh.exports=YC(),Kh.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H1;function JC(){if(H1)return _c;H1=1;var t=qC(),e=fp(),n=WC();function r(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function i(s){var o=s,u=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(u=o.return),s=o.return;while(s)}return o.tag===3?u:null}function l(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function c(s){if(i(s)!==s)throw Error(r(188))}function d(s){var o=s.alternate;if(!o){if(o=i(s),o===null)throw Error(r(188));return o!==s?null:s}for(var u=s,p=o;;){var y=u.return;if(y===null)break;var w=y.alternate;if(w===null){if(p=y.return,p!==null){u=p;continue}break}if(y.child===w.child){for(w=y.child;w;){if(w===u)return c(y),s;if(w===p)return c(y),o;w=w.sibling}throw Error(r(188))}if(u.return!==p.return)u=y,p=w;else{for(var N=!1,L=y.child;L;){if(L===u){N=!0,u=y,p=w;break}if(L===p){N=!0,p=y,u=w;break}L=L.sibling}if(!N){for(L=w.child;L;){if(L===u){N=!0,u=w,p=y;break}if(L===p){N=!0,p=w,u=y;break}L=L.sibling}if(!N)throw Error(r(189))}}if(u.alternate!==p)throw Error(r(190))}if(u.tag!==3)throw Error(r(188));return u.stateNode.current===u?s:o}function f(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=f(s),o!==null)return o;s=s.sibling}return null}var g=Object.assign,v=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),A=Symbol.for("react.consumer"),C=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),re=Symbol.for("react.memo_cache_sentinel"),G=Symbol.iterator;function te(s){return s===null||typeof s!="object"?null:(s=G&&s[G]||s["@@iterator"],typeof s=="function"?s:null)}var _e=Symbol.for("react.client.reference");function Ne(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===_e?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case E:return"Fragment";case b:return"Profiler";case S:return"StrictMode";case B:return"Suspense";case j:return"SuspenseList";case P:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case T:return"Portal";case C:return(s.displayName||"Context")+".Provider";case A:return(s._context.displayName||"Context")+".Consumer";case I:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case F:return o=s.displayName||null,o!==null?o:Ne(s.type)||"Memo";case X:o=s._payload,s=s._init;try{return Ne(s(o))}catch{}}return null}var Ee=Array.isArray,se=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae={pending:!1,data:null,method:null,action:null},J=[],D=-1;function ee(s){return{current:s}}function M(s){0>D||(s.current=J[D],J[D]=null,D--)}function Y(s,o){D++,J[D]=s.current,s.current=o}var K=ee(null),W=ee(null),oe=ee(null),ve=ee(null);function Te(s,o){switch(Y(oe,o),Y(W,s),Y(K,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?l1(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=l1(o),s=c1(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}M(K),Y(K,s)}function De(){M(K),M(W),M(oe)}function Se(s){s.memoizedState!==null&&Y(ve,s);var o=K.current,u=c1(o,s.type);o!==u&&(Y(W,s),Y(K,u))}function Be(s){W.current===s&&(M(K),M(W)),ve.current===s&&(M(ve),mc._currentValue=ae)}var Z=Object.prototype.hasOwnProperty,dt=t.unstable_scheduleCallback,Ke=t.unstable_cancelCallback,xt=t.unstable_shouldYield,nt=t.unstable_requestPaint,Ie=t.unstable_now,Bt=t.unstable_getCurrentPriorityLevel,an=t.unstable_ImmediatePriority,sn=t.unstable_UserBlockingPriority,un=t.unstable_NormalPriority,On=t.unstable_LowPriority,vt=t.unstable_IdlePriority,tn=t.log,zn=t.unstable_setDisableYieldValue,yn=null,Qt=null;function Mt(s){if(typeof tn=="function"&&zn(s),Qt&&typeof Qt.setStrictMode=="function")try{Qt.setStrictMode(yn,s)}catch{}}var it=Math.clz32?Math.clz32:on,tt=Math.log,St=Math.LN2;function on(s){return s>>>=0,s===0?32:31-(tt(s)/St|0)|0}var jt=256,Pn=4194304;function Oe(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function We(s,o,u){var p=s.pendingLanes;if(p===0)return 0;var y=0,w=s.suspendedLanes,N=s.pingedLanes;s=s.warmLanes;var L=p&134217727;return L!==0?(p=L&~w,p!==0?y=Oe(p):(N&=L,N!==0?y=Oe(N):u||(u=L&~s,u!==0&&(y=Oe(u))))):(L=p&~w,L!==0?y=Oe(L):N!==0?y=Oe(N):u||(u=p&~s,u!==0&&(y=Oe(u)))),y===0?0:o!==0&&o!==y&&(o&w)===0&&(w=y&-y,u=o&-o,w>=u||w===32&&(u&4194048)!==0)?o:y}function Ge(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function Ze(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pt(){var s=jt;return jt<<=1,(jt&4194048)===0&&(jt=256),s}function Zn(){var s=Pn;return Pn<<=1,(Pn&62914560)===0&&(Pn=4194304),s}function jr(s){for(var o=[],u=0;31>u;u++)o.push(s);return o}function ra(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function _a(s,o,u,p,y,w){var N=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var L=s.entanglements,ne=s.expirationTimes,me=s.hiddenUpdates;for(u=N&~u;0<u;){var be=31-it(u),ke=1<<be;L[be]=0,ne[be]=-1;var ge=me[be];if(ge!==null)for(me[be]=null,be=0;be<ge.length;be++){var xe=ge[be];xe!==null&&(xe.lane&=-536870913)}u&=~ke}p!==0&&gs(s,p,0),w!==0&&y===0&&s.tag!==0&&(s.suspendedLanes|=w&~(N&~o))}function gs(s,o,u){s.pendingLanes|=o,s.suspendedLanes&=~o;var p=31-it(o);s.entangledLanes|=o,s.entanglements[p]=s.entanglements[p]|1073741824|u&4194090}function xs(s,o){var u=s.entangledLanes|=o;for(s=s.entanglements;u;){var p=31-it(u),y=1<<p;y&o|s[p]&o&&(s[p]|=o),u&=~y}}function Va(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Ha(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function vs(){var s=ue.p;return s!==0?s:(s=window.event,s===void 0?32:k1(s.type))}function ii(s,o){var u=ue.p;try{return ue.p=s,o()}finally{ue.p=u}}var yr=Math.random().toString(36).slice(2),fn="__reactFiber$"+yr,dn="__reactProps$"+yr,Vr="__reactContainer$"+yr,yt="__reactEvents$"+yr,ys="__reactListeners$"+yr,R="__reactHandles$"+yr,V="__reactResources$"+yr,O="__reactMarker$"+yr;function H(s){delete s[fn],delete s[dn],delete s[yt],delete s[ys],delete s[R]}function z(s){var o=s[fn];if(o)return o;for(var u=s.parentNode;u;){if(o=u[Vr]||u[fn]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(s=h1(s);s!==null;){if(u=s[fn])return u;s=h1(s)}return o}s=u,u=s.parentNode}return null}function q(s){if(s=s[fn]||s[Vr]){var o=s.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return s}return null}function fe(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(r(33))}function ye(s){var o=s[V];return o||(o=s[V]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function le(s){s[O]=!0}var he=new Set,pe={};function Re(s,o){Fe(s,o),Fe(s+"Capture",o)}function Fe(s,o){for(pe[s]=o,s=0;s<o.length;s++)he.add(o[s])}var Ue=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Me={},Q={};function we(s){return Z.call(Q,s)?!0:Z.call(Me,s)?!1:Ue.test(s)?Q[s]=!0:(Me[s]=!0,!1)}function Ae(s,o,u){if(we(o))if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var p=o.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+u)}}function Pe(s,o,u){if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+u)}}function Ve(s,o,u,p){if(p===null)s.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(o,u,""+p)}}var lt,It;function bt(s){if(lt===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);lt=o&&o[1]||"",It=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+lt+s+It}var Ft=!1;function hn(s,o){if(!s||Ft)return"";Ft=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(o){var ke=function(){throw Error()};if(Object.defineProperty(ke.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ke,[])}catch(xe){var ge=xe}Reflect.construct(s,[],ke)}else{try{ke.call()}catch(xe){ge=xe}s.call(ke.prototype)}}else{try{throw Error()}catch(xe){ge=xe}(ke=s())&&typeof ke.catch=="function"&&ke.catch(function(){})}}catch(xe){if(xe&&ge&&typeof xe.stack=="string")return[xe.stack,ge.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=p.DetermineComponentFrameRoot(),N=w[0],L=w[1];if(N&&L){var ne=N.split(`
`),me=L.split(`
`);for(y=p=0;p<ne.length&&!ne[p].includes("DetermineComponentFrameRoot");)p++;for(;y<me.length&&!me[y].includes("DetermineComponentFrameRoot");)y++;if(p===ne.length||y===me.length)for(p=ne.length-1,y=me.length-1;1<=p&&0<=y&&ne[p]!==me[y];)y--;for(;1<=p&&0<=y;p--,y--)if(ne[p]!==me[y]){if(p!==1||y!==1)do if(p--,y--,0>y||ne[p]!==me[y]){var be=`
`+ne[p].replace(" at new "," at ");return s.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",s.displayName)),be}while(1<=p&&0<=y);break}}}finally{Ft=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?bt(u):""}function Lt(s){switch(s.tag){case 26:case 27:case 5:return bt(s.type);case 16:return bt("Lazy");case 13:return bt("Suspense");case 19:return bt("SuspenseList");case 0:case 15:return hn(s.type,!1);case 11:return hn(s.type.render,!1);case 1:return hn(s.type,!0);case 31:return bt("Activity");default:return""}}function Hr(s){try{var o="";do o+=Lt(s),s=s.return;while(s);return o}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function mn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Cl(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function no(s){var o=Cl(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),p=""+s[o];if(!s.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var y=u.get,w=u.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return y.call(this)},set:function(N){p=""+N,w.call(this,N)}}),Object.defineProperty(s,o,{enumerable:u.enumerable}),{getValue:function(){return p},setValue:function(N){p=""+N},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function _s(s){s._valueTracker||(s._valueTracker=no(s))}function ro(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var u=o.getValue(),p="";return s&&(p=Cl(s)?s.checked?"true":"false":s.value),s=p,s!==u?(o.setValue(s),!0):!1}function oi(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Gt=/[\n"\\]/g;function _t(s){return s.replace(Gt,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Nn(s,o,u,p,y,w,N,L){s.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.type=N:s.removeAttribute("type"),o!=null?N==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+mn(o)):s.value!==""+mn(o)&&(s.value=""+mn(o)):N!=="submit"&&N!=="reset"||s.removeAttribute("value"),o!=null?aa(s,N,mn(o)):u!=null?aa(s,N,mn(u)):p!=null&&s.removeAttribute("value"),y==null&&w!=null&&(s.defaultChecked=!!w),y!=null&&(s.checked=y&&typeof y!="function"&&typeof y!="symbol"),L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?s.name=""+mn(L):s.removeAttribute("name")}function li(s,o,u,p,y,w,N,L){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.type=w),o!=null||u!=null){if(!(w!=="submit"&&w!=="reset"||o!=null))return;u=u!=null?""+mn(u):"",o=o!=null?""+mn(o):u,L||o===s.value||(s.value=o),s.defaultValue=o}p=p??y,p=typeof p!="function"&&typeof p!="symbol"&&!!p,s.checked=L?s.checked:!!p,s.defaultChecked=!!p,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(s.name=N)}function aa(s,o,u){o==="number"&&oi(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function Ar(s,o,u,p){if(s=s.options,o){o={};for(var y=0;y<u.length;y++)o["$"+u[y]]=!0;for(u=0;u<s.length;u++)y=o.hasOwnProperty("$"+s[u].value),s[u].selected!==y&&(s[u].selected=y),y&&p&&(s[u].defaultSelected=!0)}else{for(u=""+mn(u),o=null,y=0;y<s.length;y++){if(s[y].value===u){s[y].selected=!0,p&&(s[y].defaultSelected=!0);return}o!==null||s[y].disabled||(o=s[y])}o!==null&&(o.selected=!0)}}function bu(s,o,u){if(o!=null&&(o=""+mn(o),o!==s.value&&(s.value=o),u==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=u!=null?""+mn(u):""}function og(s,o,u,p){if(o==null){if(p!=null){if(u!=null)throw Error(r(92));if(Ee(p)){if(1<p.length)throw Error(r(93));p=p[0]}u=p}u==null&&(u=""),o=u}u=mn(o),s.defaultValue=u,p=s.textContent,p===u&&p!==""&&p!==null&&(s.value=p)}function ao(s,o){if(o){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=o;return}}s.textContent=o}var US=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function lg(s,o,u){var p=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?p?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":p?s.setProperty(o,u):typeof u!="number"||u===0||US.has(o)?o==="float"?s.cssFloat=u:s[o]=(""+u).trim():s[o]=u+"px"}function cg(s,o,u){if(o!=null&&typeof o!="object")throw Error(r(62));if(s=s.style,u!=null){for(var p in u)!u.hasOwnProperty(p)||o!=null&&o.hasOwnProperty(p)||(p.indexOf("--")===0?s.setProperty(p,""):p==="float"?s.cssFloat="":s[p]="");for(var y in o)p=o[y],o.hasOwnProperty(y)&&u[y]!==p&&lg(s,y,p)}else for(var w in o)o.hasOwnProperty(w)&&lg(s,w,o[w])}function Gd(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var BS=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),jS=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Cu(s){return jS.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var zd=null;function qd(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var so=null,io=null;function ug(s){var o=q(s);if(o&&(s=o.stateNode)){var u=s[dn]||null;e:switch(s=o.stateNode,o.type){case"input":if(Nn(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+_t(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var p=u[o];if(p!==s&&p.form===s.form){var y=p[dn]||null;if(!y)throw Error(r(90));Nn(p,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(o=0;o<u.length;o++)p=u[o],p.form===s.form&&ro(p)}break e;case"textarea":bu(s,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&Ar(s,!!u.multiple,o,!1)}}}var Yd=!1;function fg(s,o,u){if(Yd)return s(o,u);Yd=!0;try{var p=s(o);return p}finally{if(Yd=!1,(so!==null||io!==null)&&(df(),so&&(o=so,s=io,io=so=null,ug(o),s)))for(o=0;o<s.length;o++)ug(s[o])}}function Al(s,o){var u=s.stateNode;if(u===null)return null;var p=u[dn]||null;if(p===null)return null;u=p[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(s=s.type,p=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!p;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(r(231,o,typeof u));return u}var $a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wd=!1;if($a)try{var kl={};Object.defineProperty(kl,"passive",{get:function(){Wd=!0}}),window.addEventListener("test",kl,kl),window.removeEventListener("test",kl,kl)}catch{Wd=!1}var ws=null,Jd=null,Au=null;function dg(){if(Au)return Au;var s,o=Jd,u=o.length,p,y="value"in ws?ws.value:ws.textContent,w=y.length;for(s=0;s<u&&o[s]===y[s];s++);var N=u-s;for(p=1;p<=N&&o[u-p]===y[w-p];p++);return Au=y.slice(s,1<p?1-p:void 0)}function ku(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function Nu(){return!0}function hg(){return!1}function _r(s){function o(u,p,y,w,N){this._reactName=u,this._targetInst=y,this.type=p,this.nativeEvent=w,this.target=N,this.currentTarget=null;for(var L in s)s.hasOwnProperty(L)&&(u=s[L],this[L]=u?u(w):w[L]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Nu:hg,this.isPropagationStopped=hg,this}return g(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Nu)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Nu)},persist:function(){},isPersistent:Nu}),o}var ci={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ru=_r(ci),Nl=g({},ci,{view:0,detail:0}),VS=_r(Nl),Kd,Xd,Rl,Du=g({},Nl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Rl&&(Rl&&s.type==="mousemove"?(Kd=s.screenX-Rl.screenX,Xd=s.screenY-Rl.screenY):Xd=Kd=0,Rl=s),Kd)},movementY:function(s){return"movementY"in s?s.movementY:Xd}}),mg=_r(Du),HS=g({},Du,{dataTransfer:0}),$S=_r(HS),GS=g({},Nl,{relatedTarget:0}),Zd=_r(GS),zS=g({},ci,{animationName:0,elapsedTime:0,pseudoElement:0}),qS=_r(zS),YS=g({},ci,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),WS=_r(YS),JS=g({},ci,{data:0}),pg=_r(JS),KS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},XS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ZS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function QS(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=ZS[s])?!!o[s]:!1}function Qd(){return QS}var eb=g({},Nl,{key:function(s){if(s.key){var o=KS[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=ku(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?XS[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qd,charCode:function(s){return s.type==="keypress"?ku(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?ku(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),tb=_r(eb),nb=g({},Du,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gg=_r(nb),rb=g({},Nl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qd}),ab=_r(rb),sb=g({},ci,{propertyName:0,elapsedTime:0,pseudoElement:0}),ib=_r(sb),ob=g({},Du,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),lb=_r(ob),cb=g({},ci,{newState:0,oldState:0}),ub=_r(cb),fb=[9,13,27,32],e0=$a&&"CompositionEvent"in window,Dl=null;$a&&"documentMode"in document&&(Dl=document.documentMode);var db=$a&&"TextEvent"in window&&!Dl,xg=$a&&(!e0||Dl&&8<Dl&&11>=Dl),vg=" ",yg=!1;function _g(s,o){switch(s){case"keyup":return fb.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wg(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var oo=!1;function hb(s,o){switch(s){case"compositionend":return wg(o);case"keypress":return o.which!==32?null:(yg=!0,vg);case"textInput":return s=o.data,s===vg&&yg?null:s;default:return null}}function mb(s,o){if(oo)return s==="compositionend"||!e0&&_g(s,o)?(s=dg(),Au=Jd=ws=null,oo=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return xg&&o.locale!=="ko"?null:o.data;default:return null}}var pb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tg(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!pb[s.type]:o==="textarea"}function Eg(s,o,u,p){so?io?io.push(p):io=[p]:so=p,o=vf(o,"onChange"),0<o.length&&(u=new Ru("onChange","change",null,u,p),s.push({event:u,listeners:o}))}var Ml=null,Il=null;function gb(s){r1(s,0)}function Mu(s){var o=fe(s);if(ro(o))return s}function Sg(s,o){if(s==="change")return o}var bg=!1;if($a){var t0;if($a){var n0="oninput"in document;if(!n0){var Cg=document.createElement("div");Cg.setAttribute("oninput","return;"),n0=typeof Cg.oninput=="function"}t0=n0}else t0=!1;bg=t0&&(!document.documentMode||9<document.documentMode)}function Ag(){Ml&&(Ml.detachEvent("onpropertychange",kg),Il=Ml=null)}function kg(s){if(s.propertyName==="value"&&Mu(Il)){var o=[];Eg(o,Il,s,qd(s)),fg(gb,o)}}function xb(s,o,u){s==="focusin"?(Ag(),Ml=o,Il=u,Ml.attachEvent("onpropertychange",kg)):s==="focusout"&&Ag()}function vb(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Mu(Il)}function yb(s,o){if(s==="click")return Mu(o)}function _b(s,o){if(s==="input"||s==="change")return Mu(o)}function wb(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var kr=typeof Object.is=="function"?Object.is:wb;function Fl(s,o){if(kr(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var u=Object.keys(s),p=Object.keys(o);if(u.length!==p.length)return!1;for(p=0;p<u.length;p++){var y=u[p];if(!Z.call(o,y)||!kr(s[y],o[y]))return!1}return!0}function Ng(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Rg(s,o){var u=Ng(s);s=0;for(var p;u;){if(u.nodeType===3){if(p=s+u.textContent.length,s<=o&&p>=o)return{node:u,offset:o-s};s=p}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Ng(u)}}function Dg(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?Dg(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function Mg(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=oi(s.document);o instanceof s.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)s=o.contentWindow;else break;o=oi(s.document)}return o}function r0(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var Tb=$a&&"documentMode"in document&&11>=document.documentMode,lo=null,a0=null,Ll=null,s0=!1;function Ig(s,o,u){var p=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;s0||lo==null||lo!==oi(p)||(p=lo,"selectionStart"in p&&r0(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Ll&&Fl(Ll,p)||(Ll=p,p=vf(a0,"onSelect"),0<p.length&&(o=new Ru("onSelect","select",null,o,u),s.push({event:o,listeners:p}),o.target=lo)))}function ui(s,o){var u={};return u[s.toLowerCase()]=o.toLowerCase(),u["Webkit"+s]="webkit"+o,u["Moz"+s]="moz"+o,u}var co={animationend:ui("Animation","AnimationEnd"),animationiteration:ui("Animation","AnimationIteration"),animationstart:ui("Animation","AnimationStart"),transitionrun:ui("Transition","TransitionRun"),transitionstart:ui("Transition","TransitionStart"),transitioncancel:ui("Transition","TransitionCancel"),transitionend:ui("Transition","TransitionEnd")},i0={},Fg={};$a&&(Fg=document.createElement("div").style,"AnimationEvent"in window||(delete co.animationend.animation,delete co.animationiteration.animation,delete co.animationstart.animation),"TransitionEvent"in window||delete co.transitionend.transition);function fi(s){if(i0[s])return i0[s];if(!co[s])return s;var o=co[s],u;for(u in o)if(o.hasOwnProperty(u)&&u in Fg)return i0[s]=o[u];return s}var Lg=fi("animationend"),Og=fi("animationiteration"),Pg=fi("animationstart"),Eb=fi("transitionrun"),Sb=fi("transitionstart"),bb=fi("transitioncancel"),Ug=fi("transitionend"),Bg=new Map,o0="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");o0.push("scrollEnd");function sa(s,o){Bg.set(s,o),Re(o,[s])}var jg=new WeakMap;function $r(s,o){if(typeof s=="object"&&s!==null){var u=jg.get(s);return u!==void 0?u:(o={value:s,source:o,stack:Hr(o)},jg.set(s,o),o)}return{value:s,source:o,stack:Hr(o)}}var Gr=[],uo=0,l0=0;function Iu(){for(var s=uo,o=l0=uo=0;o<s;){var u=Gr[o];Gr[o++]=null;var p=Gr[o];Gr[o++]=null;var y=Gr[o];Gr[o++]=null;var w=Gr[o];if(Gr[o++]=null,p!==null&&y!==null){var N=p.pending;N===null?y.next=y:(y.next=N.next,N.next=y),p.pending=y}w!==0&&Vg(u,y,w)}}function Fu(s,o,u,p){Gr[uo++]=s,Gr[uo++]=o,Gr[uo++]=u,Gr[uo++]=p,l0|=p,s.lanes|=p,s=s.alternate,s!==null&&(s.lanes|=p)}function c0(s,o,u,p){return Fu(s,o,u,p),Lu(s)}function fo(s,o){return Fu(s,null,null,o),Lu(s)}function Vg(s,o,u){s.lanes|=u;var p=s.alternate;p!==null&&(p.lanes|=u);for(var y=!1,w=s.return;w!==null;)w.childLanes|=u,p=w.alternate,p!==null&&(p.childLanes|=u),w.tag===22&&(s=w.stateNode,s===null||s._visibility&1||(y=!0)),s=w,w=w.return;return s.tag===3?(w=s.stateNode,y&&o!==null&&(y=31-it(u),s=w.hiddenUpdates,p=s[y],p===null?s[y]=[o]:p.push(o),o.lane=u|536870912),w):null}function Lu(s){if(50<ic)throw ic=0,ph=null,Error(r(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var ho={};function Cb(s,o,u,p){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nr(s,o,u,p){return new Cb(s,o,u,p)}function u0(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Ga(s,o){var u=s.alternate;return u===null?(u=Nr(s.tag,o,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=o,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,o=s.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function Hg(s,o){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,o=u.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function Ou(s,o,u,p,y,w){var N=0;if(p=s,typeof s=="function")u0(s)&&(N=1);else if(typeof s=="string")N=kC(s,u,K.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case P:return s=Nr(31,u,o,y),s.elementType=P,s.lanes=w,s;case E:return di(u.children,y,w,o);case S:N=8,y|=24;break;case b:return s=Nr(12,u,o,y|2),s.elementType=b,s.lanes=w,s;case B:return s=Nr(13,u,o,y),s.elementType=B,s.lanes=w,s;case j:return s=Nr(19,u,o,y),s.elementType=j,s.lanes=w,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case k:case C:N=10;break e;case A:N=9;break e;case I:N=11;break e;case F:N=14;break e;case X:N=16,p=null;break e}N=29,u=Error(r(130,s===null?"null":typeof s,"")),p=null}return o=Nr(N,u,o,y),o.elementType=s,o.type=p,o.lanes=w,o}function di(s,o,u,p){return s=Nr(7,s,p,o),s.lanes=u,s}function f0(s,o,u){return s=Nr(6,s,null,o),s.lanes=u,s}function d0(s,o,u){return o=Nr(4,s.children!==null?s.children:[],s.key,o),o.lanes=u,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var mo=[],po=0,Pu=null,Uu=0,zr=[],qr=0,hi=null,za=1,qa="";function mi(s,o){mo[po++]=Uu,mo[po++]=Pu,Pu=s,Uu=o}function $g(s,o,u){zr[qr++]=za,zr[qr++]=qa,zr[qr++]=hi,hi=s;var p=za;s=qa;var y=32-it(p)-1;p&=~(1<<y),u+=1;var w=32-it(o)+y;if(30<w){var N=y-y%5;w=(p&(1<<N)-1).toString(32),p>>=N,y-=N,za=1<<32-it(o)+y|u<<y|p,qa=w+s}else za=1<<w|u<<y|p,qa=s}function h0(s){s.return!==null&&(mi(s,1),$g(s,1,0))}function m0(s){for(;s===Pu;)Pu=mo[--po],mo[po]=null,Uu=mo[--po],mo[po]=null;for(;s===hi;)hi=zr[--qr],zr[qr]=null,qa=zr[--qr],zr[qr]=null,za=zr[--qr],zr[qr]=null}var fr=null,pn=null,Ut=!1,pi=null,wa=!1,p0=Error(r(519));function gi(s){var o=Error(r(418,""));throw Ul($r(o,s)),p0}function Gg(s){var o=s.stateNode,u=s.type,p=s.memoizedProps;switch(o[fn]=s,o[dn]=p,u){case"dialog":Tt("cancel",o),Tt("close",o);break;case"iframe":case"object":case"embed":Tt("load",o);break;case"video":case"audio":for(u=0;u<lc.length;u++)Tt(lc[u],o);break;case"source":Tt("error",o);break;case"img":case"image":case"link":Tt("error",o),Tt("load",o);break;case"details":Tt("toggle",o);break;case"input":Tt("invalid",o),li(o,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),_s(o);break;case"select":Tt("invalid",o);break;case"textarea":Tt("invalid",o),og(o,p.value,p.defaultValue,p.children),_s(o)}u=p.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||p.suppressHydrationWarning===!0||o1(o.textContent,u)?(p.popover!=null&&(Tt("beforetoggle",o),Tt("toggle",o)),p.onScroll!=null&&Tt("scroll",o),p.onScrollEnd!=null&&Tt("scrollend",o),p.onClick!=null&&(o.onclick=yf),o=!0):o=!1,o||gi(s)}function zg(s){for(fr=s.return;fr;)switch(fr.tag){case 5:case 13:wa=!1;return;case 27:case 3:wa=!0;return;default:fr=fr.return}}function Ol(s){if(s!==fr)return!1;if(!Ut)return zg(s),Ut=!0,!1;var o=s.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||Dh(s.type,s.memoizedProps)),u=!u),u&&pn&&gi(s),zg(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8)if(u=s.data,u==="/$"){if(o===0){pn=oa(s.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++;s=s.nextSibling}pn=null}}else o===27?(o=pn,Ps(s.type)?(s=Lh,Lh=null,pn=s):pn=o):pn=fr?oa(s.stateNode.nextSibling):null;return!0}function Pl(){pn=fr=null,Ut=!1}function qg(){var s=pi;return s!==null&&(Er===null?Er=s:Er.push.apply(Er,s),pi=null),s}function Ul(s){pi===null?pi=[s]:pi.push(s)}var g0=ee(null),xi=null,Ya=null;function Ts(s,o,u){Y(g0,o._currentValue),o._currentValue=u}function Wa(s){s._currentValue=g0.current,M(g0)}function x0(s,o,u){for(;s!==null;){var p=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,p!==null&&(p.childLanes|=o)):p!==null&&(p.childLanes&o)!==o&&(p.childLanes|=o),s===u)break;s=s.return}}function v0(s,o,u,p){var y=s.child;for(y!==null&&(y.return=s);y!==null;){var w=y.dependencies;if(w!==null){var N=y.child;w=w.firstContext;e:for(;w!==null;){var L=w;w=y;for(var ne=0;ne<o.length;ne++)if(L.context===o[ne]){w.lanes|=u,L=w.alternate,L!==null&&(L.lanes|=u),x0(w.return,u,s),p||(N=null);break e}w=L.next}}else if(y.tag===18){if(N=y.return,N===null)throw Error(r(341));N.lanes|=u,w=N.alternate,w!==null&&(w.lanes|=u),x0(N,u,s),N=null}else N=y.child;if(N!==null)N.return=y;else for(N=y;N!==null;){if(N===s){N=null;break}if(y=N.sibling,y!==null){y.return=N.return,N=y;break}N=N.return}y=N}}function Bl(s,o,u,p){s=null;for(var y=o,w=!1;y!==null;){if(!w){if((y.flags&524288)!==0)w=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var N=y.alternate;if(N===null)throw Error(r(387));if(N=N.memoizedProps,N!==null){var L=y.type;kr(y.pendingProps.value,N.value)||(s!==null?s.push(L):s=[L])}}else if(y===ve.current){if(N=y.alternate,N===null)throw Error(r(387));N.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(s!==null?s.push(mc):s=[mc])}y=y.return}s!==null&&v0(o,s,u,p),o.flags|=262144}function Bu(s){for(s=s.firstContext;s!==null;){if(!kr(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function vi(s){xi=s,Ya=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Qn(s){return Yg(xi,s)}function ju(s,o){return xi===null&&vi(s),Yg(s,o)}function Yg(s,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},Ya===null){if(s===null)throw Error(r(308));Ya=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else Ya=Ya.next=o;return u}var Ab=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(u,p){s.push(p)}};this.abort=function(){o.aborted=!0,s.forEach(function(u){return u()})}},kb=t.unstable_scheduleCallback,Nb=t.unstable_NormalPriority,Rn={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function y0(){return{controller:new Ab,data:new Map,refCount:0}}function jl(s){s.refCount--,s.refCount===0&&kb(Nb,function(){s.controller.abort()})}var Vl=null,_0=0,go=0,xo=null;function Rb(s,o){if(Vl===null){var u=Vl=[];_0=0,go=Th(),xo={status:"pending",value:void 0,then:function(p){u.push(p)}}}return _0++,o.then(Wg,Wg),o}function Wg(){if(--_0===0&&Vl!==null){xo!==null&&(xo.status="fulfilled");var s=Vl;Vl=null,go=0,xo=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function Db(s,o){var u=[],p={status:"pending",value:null,reason:null,then:function(y){u.push(y)}};return s.then(function(){p.status="fulfilled",p.value=o;for(var y=0;y<u.length;y++)(0,u[y])(o)},function(y){for(p.status="rejected",p.reason=y,y=0;y<u.length;y++)(0,u[y])(void 0)}),p}var Jg=se.S;se.S=function(s,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&Rb(s,o),Jg!==null&&Jg(s,o)};var yi=ee(null);function w0(){var s=yi.current;return s!==null?s:Jt.pooledCache}function Vu(s,o){o===null?Y(yi,yi.current):Y(yi,o.pool)}function Kg(){var s=w0();return s===null?null:{parent:Rn._currentValue,pool:s}}var Hl=Error(r(460)),Xg=Error(r(474)),Hu=Error(r(542)),T0={then:function(){}};function Zg(s){return s=s.status,s==="fulfilled"||s==="rejected"}function $u(){}function Qg(s,o,u){switch(u=s[u],u===void 0?s.push(o):u!==o&&(o.then($u,$u),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,tx(s),s;default:if(typeof o.status=="string")o.then($u,$u);else{if(s=Jt,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=o,s.status="pending",s.then(function(p){if(o.status==="pending"){var y=o;y.status="fulfilled",y.value=p}},function(p){if(o.status==="pending"){var y=o;y.status="rejected",y.reason=p}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,tx(s),s}throw $l=o,Hl}}var $l=null;function ex(){if($l===null)throw Error(r(459));var s=$l;return $l=null,s}function tx(s){if(s===Hl||s===Hu)throw Error(r(483))}var Es=!1;function E0(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function S0(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Ss(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function bs(s,o,u){var p=s.updateQueue;if(p===null)return null;if(p=p.shared,(Vt&2)!==0){var y=p.pending;return y===null?o.next=o:(o.next=y.next,y.next=o),p.pending=o,o=Lu(s),Vg(s,null,u),o}return Fu(s,p,o,u),Lu(s)}function Gl(s,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var p=o.lanes;p&=s.pendingLanes,u|=p,o.lanes=u,xs(s,u)}}function b0(s,o){var u=s.updateQueue,p=s.alternate;if(p!==null&&(p=p.updateQueue,u===p)){var y=null,w=null;if(u=u.firstBaseUpdate,u!==null){do{var N={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};w===null?y=w=N:w=w.next=N,u=u.next}while(u!==null);w===null?y=w=o:w=w.next=o}else y=w=o;u={baseState:p.baseState,firstBaseUpdate:y,lastBaseUpdate:w,shared:p.shared,callbacks:p.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=o:s.next=o,u.lastBaseUpdate=o}var C0=!1;function zl(){if(C0){var s=xo;if(s!==null)throw s}}function ql(s,o,u,p){C0=!1;var y=s.updateQueue;Es=!1;var w=y.firstBaseUpdate,N=y.lastBaseUpdate,L=y.shared.pending;if(L!==null){y.shared.pending=null;var ne=L,me=ne.next;ne.next=null,N===null?w=me:N.next=me,N=ne;var be=s.alternate;be!==null&&(be=be.updateQueue,L=be.lastBaseUpdate,L!==N&&(L===null?be.firstBaseUpdate=me:L.next=me,be.lastBaseUpdate=ne))}if(w!==null){var ke=y.baseState;N=0,be=me=ne=null,L=w;do{var ge=L.lane&-536870913,xe=ge!==L.lane;if(xe?(kt&ge)===ge:(p&ge)===ge){ge!==0&&ge===go&&(C0=!0),be!==null&&(be=be.next={lane:0,tag:L.tag,payload:L.payload,callback:null,next:null});e:{var Qe=s,Je=L;ge=o;var Yt=u;switch(Je.tag){case 1:if(Qe=Je.payload,typeof Qe=="function"){ke=Qe.call(Yt,ke,ge);break e}ke=Qe;break e;case 3:Qe.flags=Qe.flags&-65537|128;case 0:if(Qe=Je.payload,ge=typeof Qe=="function"?Qe.call(Yt,ke,ge):Qe,ge==null)break e;ke=g({},ke,ge);break e;case 2:Es=!0}}ge=L.callback,ge!==null&&(s.flags|=64,xe&&(s.flags|=8192),xe=y.callbacks,xe===null?y.callbacks=[ge]:xe.push(ge))}else xe={lane:ge,tag:L.tag,payload:L.payload,callback:L.callback,next:null},be===null?(me=be=xe,ne=ke):be=be.next=xe,N|=ge;if(L=L.next,L===null){if(L=y.shared.pending,L===null)break;xe=L,L=xe.next,xe.next=null,y.lastBaseUpdate=xe,y.shared.pending=null}}while(!0);be===null&&(ne=ke),y.baseState=ne,y.firstBaseUpdate=me,y.lastBaseUpdate=be,w===null&&(y.shared.lanes=0),Is|=N,s.lanes=N,s.memoizedState=ke}}function nx(s,o){if(typeof s!="function")throw Error(r(191,s));s.call(o)}function rx(s,o){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)nx(u[s],o)}var vo=ee(null),Gu=ee(0);function ax(s,o){s=ts,Y(Gu,s),Y(vo,o),ts=s|o.baseLanes}function A0(){Y(Gu,ts),Y(vo,vo.current)}function k0(){ts=Gu.current,M(vo),M(Gu)}var Cs=0,mt=null,zt=null,En=null,zu=!1,yo=!1,_i=!1,qu=0,Yl=0,_o=null,Mb=0;function _n(){throw Error(r(321))}function N0(s,o){if(o===null)return!1;for(var u=0;u<o.length&&u<s.length;u++)if(!kr(s[u],o[u]))return!1;return!0}function R0(s,o,u,p,y,w){return Cs=w,mt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,se.H=s===null||s.memoizedState===null?Vx:Hx,_i=!1,w=u(p,y),_i=!1,yo&&(w=ix(o,u,p,y)),sx(s),w}function sx(s){se.H=Zu;var o=zt!==null&&zt.next!==null;if(Cs=0,En=zt=mt=null,zu=!1,Yl=0,_o=null,o)throw Error(r(300));s===null||Un||(s=s.dependencies,s!==null&&Bu(s)&&(Un=!0))}function ix(s,o,u,p){mt=s;var y=0;do{if(yo&&(_o=null),Yl=0,yo=!1,25<=y)throw Error(r(301));if(y+=1,En=zt=null,s.updateQueue!=null){var w=s.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}se.H=Bb,w=o(u,p)}while(yo);return w}function Ib(){var s=se.H,o=s.useState()[0];return o=typeof o.then=="function"?Wl(o):o,s=s.useState()[0],(zt!==null?zt.memoizedState:null)!==s&&(mt.flags|=1024),o}function D0(){var s=qu!==0;return qu=0,s}function M0(s,o,u){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~u}function I0(s){if(zu){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}zu=!1}Cs=0,En=zt=mt=null,yo=!1,Yl=qu=0,_o=null}function wr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?mt.memoizedState=En=s:En=En.next=s,En}function Sn(){if(zt===null){var s=mt.alternate;s=s!==null?s.memoizedState:null}else s=zt.next;var o=En===null?mt.memoizedState:En.next;if(o!==null)En=o,zt=s;else{if(s===null)throw mt.alternate===null?Error(r(467)):Error(r(310));zt=s,s={memoizedState:zt.memoizedState,baseState:zt.baseState,baseQueue:zt.baseQueue,queue:zt.queue,next:null},En===null?mt.memoizedState=En=s:En=En.next=s}return En}function F0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Wl(s){var o=Yl;return Yl+=1,_o===null&&(_o=[]),s=Qg(_o,s,o),o=mt,(En===null?o.memoizedState:En.next)===null&&(o=o.alternate,se.H=o===null||o.memoizedState===null?Vx:Hx),s}function Yu(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Wl(s);if(s.$$typeof===C)return Qn(s)}throw Error(r(438,String(s)))}function L0(s){var o=null,u=mt.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var p=mt.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(o={data:p.data.map(function(y){return y.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=F0(),mt.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(s),p=0;p<s;p++)u[p]=re;return o.index++,u}function Ja(s,o){return typeof o=="function"?o(s):o}function Wu(s){var o=Sn();return O0(o,zt,s)}function O0(s,o,u){var p=s.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=u;var y=s.baseQueue,w=p.pending;if(w!==null){if(y!==null){var N=y.next;y.next=w.next,w.next=N}o.baseQueue=y=w,p.pending=null}if(w=s.baseState,y===null)s.memoizedState=w;else{o=y.next;var L=N=null,ne=null,me=o,be=!1;do{var ke=me.lane&-536870913;if(ke!==me.lane?(kt&ke)===ke:(Cs&ke)===ke){var ge=me.revertLane;if(ge===0)ne!==null&&(ne=ne.next={lane:0,revertLane:0,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null}),ke===go&&(be=!0);else if((Cs&ge)===ge){me=me.next,ge===go&&(be=!0);continue}else ke={lane:0,revertLane:me.revertLane,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null},ne===null?(L=ne=ke,N=w):ne=ne.next=ke,mt.lanes|=ge,Is|=ge;ke=me.action,_i&&u(w,ke),w=me.hasEagerState?me.eagerState:u(w,ke)}else ge={lane:ke,revertLane:me.revertLane,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null},ne===null?(L=ne=ge,N=w):ne=ne.next=ge,mt.lanes|=ke,Is|=ke;me=me.next}while(me!==null&&me!==o);if(ne===null?N=w:ne.next=L,!kr(w,s.memoizedState)&&(Un=!0,be&&(u=xo,u!==null)))throw u;s.memoizedState=w,s.baseState=N,s.baseQueue=ne,p.lastRenderedState=w}return y===null&&(p.lanes=0),[s.memoizedState,p.dispatch]}function P0(s){var o=Sn(),u=o.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=s;var p=u.dispatch,y=u.pending,w=o.memoizedState;if(y!==null){u.pending=null;var N=y=y.next;do w=s(w,N.action),N=N.next;while(N!==y);kr(w,o.memoizedState)||(Un=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),u.lastRenderedState=w}return[w,p]}function ox(s,o,u){var p=mt,y=Sn(),w=Ut;if(w){if(u===void 0)throw Error(r(407));u=u()}else u=o();var N=!kr((zt||y).memoizedState,u);N&&(y.memoizedState=u,Un=!0),y=y.queue;var L=ux.bind(null,p,y,s);if(Jl(2048,8,L,[s]),y.getSnapshot!==o||N||En!==null&&En.memoizedState.tag&1){if(p.flags|=2048,wo(9,Ju(),cx.bind(null,p,y,u,o),null),Jt===null)throw Error(r(349));w||(Cs&124)!==0||lx(p,o,u)}return u}function lx(s,o,u){s.flags|=16384,s={getSnapshot:o,value:u},o=mt.updateQueue,o===null?(o=F0(),mt.updateQueue=o,o.stores=[s]):(u=o.stores,u===null?o.stores=[s]:u.push(s))}function cx(s,o,u,p){o.value=u,o.getSnapshot=p,fx(o)&&dx(s)}function ux(s,o,u){return u(function(){fx(o)&&dx(s)})}function fx(s){var o=s.getSnapshot;s=s.value;try{var u=o();return!kr(s,u)}catch{return!0}}function dx(s){var o=fo(s,2);o!==null&&Fr(o,s,2)}function U0(s){var o=wr();if(typeof s=="function"){var u=s;if(s=u(),_i){Mt(!0);try{u()}finally{Mt(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:s},o}function hx(s,o,u,p){return s.baseState=u,O0(s,zt,typeof p=="function"?p:Ja)}function Fb(s,o,u,p,y){if(Xu(s))throw Error(r(485));if(s=o.action,s!==null){var w={payload:y,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){w.listeners.push(N)}};se.T!==null?u(!0):w.isTransition=!1,p(w),u=o.pending,u===null?(w.next=o.pending=w,mx(o,w)):(w.next=u.next,o.pending=u.next=w)}}function mx(s,o){var u=o.action,p=o.payload,y=s.state;if(o.isTransition){var w=se.T,N={};se.T=N;try{var L=u(y,p),ne=se.S;ne!==null&&ne(N,L),px(s,o,L)}catch(me){B0(s,o,me)}finally{se.T=w}}else try{w=u(y,p),px(s,o,w)}catch(me){B0(s,o,me)}}function px(s,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(p){gx(s,o,p)},function(p){return B0(s,o,p)}):gx(s,o,u)}function gx(s,o,u){o.status="fulfilled",o.value=u,xx(o),s.state=u,o=s.pending,o!==null&&(u=o.next,u===o?s.pending=null:(u=u.next,o.next=u,mx(s,u)))}function B0(s,o,u){var p=s.pending;if(s.pending=null,p!==null){p=p.next;do o.status="rejected",o.reason=u,xx(o),o=o.next;while(o!==p)}s.action=null}function xx(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function vx(s,o){return o}function yx(s,o){if(Ut){var u=Jt.formState;if(u!==null){e:{var p=mt;if(Ut){if(pn){t:{for(var y=pn,w=wa;y.nodeType!==8;){if(!w){y=null;break t}if(y=oa(y.nextSibling),y===null){y=null;break t}}w=y.data,y=w==="F!"||w==="F"?y:null}if(y){pn=oa(y.nextSibling),p=y.data==="F!";break e}}gi(p)}p=!1}p&&(o=u[0])}}return u=wr(),u.memoizedState=u.baseState=o,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vx,lastRenderedState:o},u.queue=p,u=Ux.bind(null,mt,p),p.dispatch=u,p=U0(!1),w=G0.bind(null,mt,!1,p.queue),p=wr(),y={state:o,dispatch:null,action:s,pending:null},p.queue=y,u=Fb.bind(null,mt,y,w,u),y.dispatch=u,p.memoizedState=s,[o,u,!1]}function _x(s){var o=Sn();return wx(o,zt,s)}function wx(s,o,u){if(o=O0(s,o,vx)[0],s=Wu(Ja)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var p=Wl(o)}catch(N){throw N===Hl?Hu:N}else p=o;o=Sn();var y=o.queue,w=y.dispatch;return u!==o.memoizedState&&(mt.flags|=2048,wo(9,Ju(),Lb.bind(null,y,u),null)),[p,w,s]}function Lb(s,o){s.action=o}function Tx(s){var o=Sn(),u=zt;if(u!==null)return wx(o,u,s);Sn(),o=o.memoizedState,u=Sn();var p=u.queue.dispatch;return u.memoizedState=s,[o,p,!1]}function wo(s,o,u,p){return s={tag:s,create:u,deps:p,inst:o,next:null},o=mt.updateQueue,o===null&&(o=F0(),mt.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=s.next=s:(p=u.next,u.next=s,s.next=p,o.lastEffect=s),s}function Ju(){return{destroy:void 0,resource:void 0}}function Ex(){return Sn().memoizedState}function Ku(s,o,u,p){var y=wr();p=p===void 0?null:p,mt.flags|=s,y.memoizedState=wo(1|o,Ju(),u,p)}function Jl(s,o,u,p){var y=Sn();p=p===void 0?null:p;var w=y.memoizedState.inst;zt!==null&&p!==null&&N0(p,zt.memoizedState.deps)?y.memoizedState=wo(o,w,u,p):(mt.flags|=s,y.memoizedState=wo(1|o,w,u,p))}function Sx(s,o){Ku(8390656,8,s,o)}function bx(s,o){Jl(2048,8,s,o)}function Cx(s,o){return Jl(4,2,s,o)}function Ax(s,o){return Jl(4,4,s,o)}function kx(s,o){if(typeof o=="function"){s=s();var u=o(s);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function Nx(s,o,u){u=u!=null?u.concat([s]):null,Jl(4,4,kx.bind(null,o,s),u)}function j0(){}function Rx(s,o){var u=Sn();o=o===void 0?null:o;var p=u.memoizedState;return o!==null&&N0(o,p[1])?p[0]:(u.memoizedState=[s,o],s)}function Dx(s,o){var u=Sn();o=o===void 0?null:o;var p=u.memoizedState;if(o!==null&&N0(o,p[1]))return p[0];if(p=s(),_i){Mt(!0);try{s()}finally{Mt(!1)}}return u.memoizedState=[p,o],p}function V0(s,o,u){return u===void 0||(Cs&1073741824)!==0?s.memoizedState=o:(s.memoizedState=u,s=Fv(),mt.lanes|=s,Is|=s,u)}function Mx(s,o,u,p){return kr(u,o)?u:vo.current!==null?(s=V0(s,u,p),kr(s,o)||(Un=!0),s):(Cs&42)===0?(Un=!0,s.memoizedState=u):(s=Fv(),mt.lanes|=s,Is|=s,o)}function Ix(s,o,u,p,y){var w=ue.p;ue.p=w!==0&&8>w?w:8;var N=se.T,L={};se.T=L,G0(s,!1,o,u);try{var ne=y(),me=se.S;if(me!==null&&me(L,ne),ne!==null&&typeof ne=="object"&&typeof ne.then=="function"){var be=Db(ne,p);Kl(s,o,be,Ir(s))}else Kl(s,o,p,Ir(s))}catch(ke){Kl(s,o,{then:function(){},status:"rejected",reason:ke},Ir())}finally{ue.p=w,se.T=N}}function Ob(){}function H0(s,o,u,p){if(s.tag!==5)throw Error(r(476));var y=Fx(s).queue;Ix(s,y,o,ae,u===null?Ob:function(){return Lx(s),u(p)})}function Fx(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:ae,baseState:ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:ae},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ja,lastRenderedState:u},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function Lx(s){var o=Fx(s).next.queue;Kl(s,o,{},Ir())}function $0(){return Qn(mc)}function Ox(){return Sn().memoizedState}function Px(){return Sn().memoizedState}function Pb(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var u=Ir();s=Ss(u);var p=bs(o,s,u);p!==null&&(Fr(p,o,u),Gl(p,o,u)),o={cache:y0()},s.payload=o;return}o=o.return}}function Ub(s,o,u){var p=Ir();u={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},Xu(s)?Bx(o,u):(u=c0(s,o,u,p),u!==null&&(Fr(u,s,p),jx(u,o,p)))}function Ux(s,o,u){var p=Ir();Kl(s,o,u,p)}function Kl(s,o,u,p){var y={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(Xu(s))Bx(o,y);else{var w=s.alternate;if(s.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var N=o.lastRenderedState,L=w(N,u);if(y.hasEagerState=!0,y.eagerState=L,kr(L,N))return Fu(s,o,y,0),Jt===null&&Iu(),!1}catch{}finally{}if(u=c0(s,o,y,p),u!==null)return Fr(u,s,p),jx(u,o,p),!0}return!1}function G0(s,o,u,p){if(p={lane:2,revertLane:Th(),action:p,hasEagerState:!1,eagerState:null,next:null},Xu(s)){if(o)throw Error(r(479))}else o=c0(s,u,p,2),o!==null&&Fr(o,s,2)}function Xu(s){var o=s.alternate;return s===mt||o!==null&&o===mt}function Bx(s,o){yo=zu=!0;var u=s.pending;u===null?o.next=o:(o.next=u.next,u.next=o),s.pending=o}function jx(s,o,u){if((u&4194048)!==0){var p=o.lanes;p&=s.pendingLanes,u|=p,o.lanes=u,xs(s,u)}}var Zu={readContext:Qn,use:Yu,useCallback:_n,useContext:_n,useEffect:_n,useImperativeHandle:_n,useLayoutEffect:_n,useInsertionEffect:_n,useMemo:_n,useReducer:_n,useRef:_n,useState:_n,useDebugValue:_n,useDeferredValue:_n,useTransition:_n,useSyncExternalStore:_n,useId:_n,useHostTransitionStatus:_n,useFormState:_n,useActionState:_n,useOptimistic:_n,useMemoCache:_n,useCacheRefresh:_n},Vx={readContext:Qn,use:Yu,useCallback:function(s,o){return wr().memoizedState=[s,o===void 0?null:o],s},useContext:Qn,useEffect:Sx,useImperativeHandle:function(s,o,u){u=u!=null?u.concat([s]):null,Ku(4194308,4,kx.bind(null,o,s),u)},useLayoutEffect:function(s,o){return Ku(4194308,4,s,o)},useInsertionEffect:function(s,o){Ku(4,2,s,o)},useMemo:function(s,o){var u=wr();o=o===void 0?null:o;var p=s();if(_i){Mt(!0);try{s()}finally{Mt(!1)}}return u.memoizedState=[p,o],p},useReducer:function(s,o,u){var p=wr();if(u!==void 0){var y=u(o);if(_i){Mt(!0);try{u(o)}finally{Mt(!1)}}}else y=o;return p.memoizedState=p.baseState=y,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:y},p.queue=s,s=s.dispatch=Ub.bind(null,mt,s),[p.memoizedState,s]},useRef:function(s){var o=wr();return s={current:s},o.memoizedState=s},useState:function(s){s=U0(s);var o=s.queue,u=Ux.bind(null,mt,o);return o.dispatch=u,[s.memoizedState,u]},useDebugValue:j0,useDeferredValue:function(s,o){var u=wr();return V0(u,s,o)},useTransition:function(){var s=U0(!1);return s=Ix.bind(null,mt,s.queue,!0,!1),wr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,u){var p=mt,y=wr();if(Ut){if(u===void 0)throw Error(r(407));u=u()}else{if(u=o(),Jt===null)throw Error(r(349));(kt&124)!==0||lx(p,o,u)}y.memoizedState=u;var w={value:u,getSnapshot:o};return y.queue=w,Sx(ux.bind(null,p,w,s),[s]),p.flags|=2048,wo(9,Ju(),cx.bind(null,p,w,u,o),null),u},useId:function(){var s=wr(),o=Jt.identifierPrefix;if(Ut){var u=qa,p=za;u=(p&~(1<<32-it(p)-1)).toString(32)+u,o="«"+o+"R"+u,u=qu++,0<u&&(o+="H"+u.toString(32)),o+="»"}else u=Mb++,o="«"+o+"r"+u.toString(32)+"»";return s.memoizedState=o},useHostTransitionStatus:$0,useFormState:yx,useActionState:yx,useOptimistic:function(s){var o=wr();o.memoizedState=o.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=G0.bind(null,mt,!0,u),u.dispatch=o,[s,o]},useMemoCache:L0,useCacheRefresh:function(){return wr().memoizedState=Pb.bind(null,mt)}},Hx={readContext:Qn,use:Yu,useCallback:Rx,useContext:Qn,useEffect:bx,useImperativeHandle:Nx,useInsertionEffect:Cx,useLayoutEffect:Ax,useMemo:Dx,useReducer:Wu,useRef:Ex,useState:function(){return Wu(Ja)},useDebugValue:j0,useDeferredValue:function(s,o){var u=Sn();return Mx(u,zt.memoizedState,s,o)},useTransition:function(){var s=Wu(Ja)[0],o=Sn().memoizedState;return[typeof s=="boolean"?s:Wl(s),o]},useSyncExternalStore:ox,useId:Ox,useHostTransitionStatus:$0,useFormState:_x,useActionState:_x,useOptimistic:function(s,o){var u=Sn();return hx(u,zt,s,o)},useMemoCache:L0,useCacheRefresh:Px},Bb={readContext:Qn,use:Yu,useCallback:Rx,useContext:Qn,useEffect:bx,useImperativeHandle:Nx,useInsertionEffect:Cx,useLayoutEffect:Ax,useMemo:Dx,useReducer:P0,useRef:Ex,useState:function(){return P0(Ja)},useDebugValue:j0,useDeferredValue:function(s,o){var u=Sn();return zt===null?V0(u,s,o):Mx(u,zt.memoizedState,s,o)},useTransition:function(){var s=P0(Ja)[0],o=Sn().memoizedState;return[typeof s=="boolean"?s:Wl(s),o]},useSyncExternalStore:ox,useId:Ox,useHostTransitionStatus:$0,useFormState:Tx,useActionState:Tx,useOptimistic:function(s,o){var u=Sn();return zt!==null?hx(u,zt,s,o):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:L0,useCacheRefresh:Px},To=null,Xl=0;function Qu(s){var o=Xl;return Xl+=1,To===null&&(To=[]),Qg(To,s,o)}function Zl(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function ef(s,o){throw o.$$typeof===v?Error(r(525)):(s=Object.prototype.toString.call(o),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function $x(s){var o=s._init;return o(s._payload)}function Gx(s){function o(ce,ie){if(s){var de=ce.deletions;de===null?(ce.deletions=[ie],ce.flags|=16):de.push(ie)}}function u(ce,ie){if(!s)return null;for(;ie!==null;)o(ce,ie),ie=ie.sibling;return null}function p(ce){for(var ie=new Map;ce!==null;)ce.key!==null?ie.set(ce.key,ce):ie.set(ce.index,ce),ce=ce.sibling;return ie}function y(ce,ie){return ce=Ga(ce,ie),ce.index=0,ce.sibling=null,ce}function w(ce,ie,de){return ce.index=de,s?(de=ce.alternate,de!==null?(de=de.index,de<ie?(ce.flags|=67108866,ie):de):(ce.flags|=67108866,ie)):(ce.flags|=1048576,ie)}function N(ce){return s&&ce.alternate===null&&(ce.flags|=67108866),ce}function L(ce,ie,de,Ce){return ie===null||ie.tag!==6?(ie=f0(de,ce.mode,Ce),ie.return=ce,ie):(ie=y(ie,de),ie.return=ce,ie)}function ne(ce,ie,de,Ce){var He=de.type;return He===E?be(ce,ie,de.props.children,Ce,de.key):ie!==null&&(ie.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===X&&$x(He)===ie.type)?(ie=y(ie,de.props),Zl(ie,de),ie.return=ce,ie):(ie=Ou(de.type,de.key,de.props,null,ce.mode,Ce),Zl(ie,de),ie.return=ce,ie)}function me(ce,ie,de,Ce){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==de.containerInfo||ie.stateNode.implementation!==de.implementation?(ie=d0(de,ce.mode,Ce),ie.return=ce,ie):(ie=y(ie,de.children||[]),ie.return=ce,ie)}function be(ce,ie,de,Ce,He){return ie===null||ie.tag!==7?(ie=di(de,ce.mode,Ce,He),ie.return=ce,ie):(ie=y(ie,de),ie.return=ce,ie)}function ke(ce,ie,de){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ie=f0(""+ie,ce.mode,de),ie.return=ce,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case _:return de=Ou(ie.type,ie.key,ie.props,null,ce.mode,de),Zl(de,ie),de.return=ce,de;case T:return ie=d0(ie,ce.mode,de),ie.return=ce,ie;case X:var Ce=ie._init;return ie=Ce(ie._payload),ke(ce,ie,de)}if(Ee(ie)||te(ie))return ie=di(ie,ce.mode,de,null),ie.return=ce,ie;if(typeof ie.then=="function")return ke(ce,Qu(ie),de);if(ie.$$typeof===C)return ke(ce,ju(ce,ie),de);ef(ce,ie)}return null}function ge(ce,ie,de,Ce){var He=ie!==null?ie.key:null;if(typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint")return He!==null?null:L(ce,ie,""+de,Ce);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case _:return de.key===He?ne(ce,ie,de,Ce):null;case T:return de.key===He?me(ce,ie,de,Ce):null;case X:return He=de._init,de=He(de._payload),ge(ce,ie,de,Ce)}if(Ee(de)||te(de))return He!==null?null:be(ce,ie,de,Ce,null);if(typeof de.then=="function")return ge(ce,ie,Qu(de),Ce);if(de.$$typeof===C)return ge(ce,ie,ju(ce,de),Ce);ef(ce,de)}return null}function xe(ce,ie,de,Ce,He){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return ce=ce.get(de)||null,L(ie,ce,""+Ce,He);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case _:return ce=ce.get(Ce.key===null?de:Ce.key)||null,ne(ie,ce,Ce,He);case T:return ce=ce.get(Ce.key===null?de:Ce.key)||null,me(ie,ce,Ce,He);case X:var gt=Ce._init;return Ce=gt(Ce._payload),xe(ce,ie,de,Ce,He)}if(Ee(Ce)||te(Ce))return ce=ce.get(de)||null,be(ie,ce,Ce,He,null);if(typeof Ce.then=="function")return xe(ce,ie,de,Qu(Ce),He);if(Ce.$$typeof===C)return xe(ce,ie,de,ju(ie,Ce),He);ef(ie,Ce)}return null}function Qe(ce,ie,de,Ce){for(var He=null,gt=null,Ye=ie,Xe=ie=0,jn=null;Ye!==null&&Xe<de.length;Xe++){Ye.index>Xe?(jn=Ye,Ye=null):jn=Ye.sibling;var Ot=ge(ce,Ye,de[Xe],Ce);if(Ot===null){Ye===null&&(Ye=jn);break}s&&Ye&&Ot.alternate===null&&o(ce,Ye),ie=w(Ot,ie,Xe),gt===null?He=Ot:gt.sibling=Ot,gt=Ot,Ye=jn}if(Xe===de.length)return u(ce,Ye),Ut&&mi(ce,Xe),He;if(Ye===null){for(;Xe<de.length;Xe++)Ye=ke(ce,de[Xe],Ce),Ye!==null&&(ie=w(Ye,ie,Xe),gt===null?He=Ye:gt.sibling=Ye,gt=Ye);return Ut&&mi(ce,Xe),He}for(Ye=p(Ye);Xe<de.length;Xe++)jn=xe(Ye,ce,Xe,de[Xe],Ce),jn!==null&&(s&&jn.alternate!==null&&Ye.delete(jn.key===null?Xe:jn.key),ie=w(jn,ie,Xe),gt===null?He=jn:gt.sibling=jn,gt=jn);return s&&Ye.forEach(function(Hs){return o(ce,Hs)}),Ut&&mi(ce,Xe),He}function Je(ce,ie,de,Ce){if(de==null)throw Error(r(151));for(var He=null,gt=null,Ye=ie,Xe=ie=0,jn=null,Ot=de.next();Ye!==null&&!Ot.done;Xe++,Ot=de.next()){Ye.index>Xe?(jn=Ye,Ye=null):jn=Ye.sibling;var Hs=ge(ce,Ye,Ot.value,Ce);if(Hs===null){Ye===null&&(Ye=jn);break}s&&Ye&&Hs.alternate===null&&o(ce,Ye),ie=w(Hs,ie,Xe),gt===null?He=Hs:gt.sibling=Hs,gt=Hs,Ye=jn}if(Ot.done)return u(ce,Ye),Ut&&mi(ce,Xe),He;if(Ye===null){for(;!Ot.done;Xe++,Ot=de.next())Ot=ke(ce,Ot.value,Ce),Ot!==null&&(ie=w(Ot,ie,Xe),gt===null?He=Ot:gt.sibling=Ot,gt=Ot);return Ut&&mi(ce,Xe),He}for(Ye=p(Ye);!Ot.done;Xe++,Ot=de.next())Ot=xe(Ye,ce,Xe,Ot.value,Ce),Ot!==null&&(s&&Ot.alternate!==null&&Ye.delete(Ot.key===null?Xe:Ot.key),ie=w(Ot,ie,Xe),gt===null?He=Ot:gt.sibling=Ot,gt=Ot);return s&&Ye.forEach(function(jC){return o(ce,jC)}),Ut&&mi(ce,Xe),He}function Yt(ce,ie,de,Ce){if(typeof de=="object"&&de!==null&&de.type===E&&de.key===null&&(de=de.props.children),typeof de=="object"&&de!==null){switch(de.$$typeof){case _:e:{for(var He=de.key;ie!==null;){if(ie.key===He){if(He=de.type,He===E){if(ie.tag===7){u(ce,ie.sibling),Ce=y(ie,de.props.children),Ce.return=ce,ce=Ce;break e}}else if(ie.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===X&&$x(He)===ie.type){u(ce,ie.sibling),Ce=y(ie,de.props),Zl(Ce,de),Ce.return=ce,ce=Ce;break e}u(ce,ie);break}else o(ce,ie);ie=ie.sibling}de.type===E?(Ce=di(de.props.children,ce.mode,Ce,de.key),Ce.return=ce,ce=Ce):(Ce=Ou(de.type,de.key,de.props,null,ce.mode,Ce),Zl(Ce,de),Ce.return=ce,ce=Ce)}return N(ce);case T:e:{for(He=de.key;ie!==null;){if(ie.key===He)if(ie.tag===4&&ie.stateNode.containerInfo===de.containerInfo&&ie.stateNode.implementation===de.implementation){u(ce,ie.sibling),Ce=y(ie,de.children||[]),Ce.return=ce,ce=Ce;break e}else{u(ce,ie);break}else o(ce,ie);ie=ie.sibling}Ce=d0(de,ce.mode,Ce),Ce.return=ce,ce=Ce}return N(ce);case X:return He=de._init,de=He(de._payload),Yt(ce,ie,de,Ce)}if(Ee(de))return Qe(ce,ie,de,Ce);if(te(de)){if(He=te(de),typeof He!="function")throw Error(r(150));return de=He.call(de),Je(ce,ie,de,Ce)}if(typeof de.then=="function")return Yt(ce,ie,Qu(de),Ce);if(de.$$typeof===C)return Yt(ce,ie,ju(ce,de),Ce);ef(ce,de)}return typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint"?(de=""+de,ie!==null&&ie.tag===6?(u(ce,ie.sibling),Ce=y(ie,de),Ce.return=ce,ce=Ce):(u(ce,ie),Ce=f0(de,ce.mode,Ce),Ce.return=ce,ce=Ce),N(ce)):u(ce,ie)}return function(ce,ie,de,Ce){try{Xl=0;var He=Yt(ce,ie,de,Ce);return To=null,He}catch(Ye){if(Ye===Hl||Ye===Hu)throw Ye;var gt=Nr(29,Ye,null,ce.mode);return gt.lanes=Ce,gt.return=ce,gt}finally{}}}var Eo=Gx(!0),zx=Gx(!1),Yr=ee(null),Ta=null;function As(s){var o=s.alternate;Y(Dn,Dn.current&1),Y(Yr,s),Ta===null&&(o===null||vo.current!==null||o.memoizedState!==null)&&(Ta=s)}function qx(s){if(s.tag===22){if(Y(Dn,Dn.current),Y(Yr,s),Ta===null){var o=s.alternate;o!==null&&o.memoizedState!==null&&(Ta=s)}}else ks()}function ks(){Y(Dn,Dn.current),Y(Yr,Yr.current)}function Ka(s){M(Yr),Ta===s&&(Ta=null),M(Dn)}var Dn=ee(0);function tf(s){for(var o=s;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||Fh(u)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function z0(s,o,u,p){o=s.memoizedState,u=u(p,o),u=u==null?o:g({},o,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var q0={enqueueSetState:function(s,o,u){s=s._reactInternals;var p=Ir(),y=Ss(p);y.payload=o,u!=null&&(y.callback=u),o=bs(s,y,p),o!==null&&(Fr(o,s,p),Gl(o,s,p))},enqueueReplaceState:function(s,o,u){s=s._reactInternals;var p=Ir(),y=Ss(p);y.tag=1,y.payload=o,u!=null&&(y.callback=u),o=bs(s,y,p),o!==null&&(Fr(o,s,p),Gl(o,s,p))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var u=Ir(),p=Ss(u);p.tag=2,o!=null&&(p.callback=o),o=bs(s,p,u),o!==null&&(Fr(o,s,u),Gl(o,s,u))}};function Yx(s,o,u,p,y,w,N){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(p,w,N):o.prototype&&o.prototype.isPureReactComponent?!Fl(u,p)||!Fl(y,w):!0}function Wx(s,o,u,p){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,p),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,p),o.state!==s&&q0.enqueueReplaceState(o,o.state,null)}function wi(s,o){var u=o;if("ref"in o){u={};for(var p in o)p!=="ref"&&(u[p]=o[p])}if(s=s.defaultProps){u===o&&(u=g({},u));for(var y in s)u[y]===void 0&&(u[y]=s[y])}return u}var nf=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Jx(s){nf(s)}function Kx(s){console.error(s)}function Xx(s){nf(s)}function rf(s,o){try{var u=s.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(p){setTimeout(function(){throw p})}}function Zx(s,o,u){try{var p=s.onCaughtError;p(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Y0(s,o,u){return u=Ss(u),u.tag=3,u.payload={element:null},u.callback=function(){rf(s,o)},u}function Qx(s){return s=Ss(s),s.tag=3,s}function ev(s,o,u,p){var y=u.type.getDerivedStateFromError;if(typeof y=="function"){var w=p.value;s.payload=function(){return y(w)},s.callback=function(){Zx(o,u,p)}}var N=u.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(s.callback=function(){Zx(o,u,p),typeof y!="function"&&(Fs===null?Fs=new Set([this]):Fs.add(this));var L=p.stack;this.componentDidCatch(p.value,{componentStack:L!==null?L:""})})}function jb(s,o,u,p,y){if(u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(o=u.alternate,o!==null&&Bl(o,u,y,!0),u=Yr.current,u!==null){switch(u.tag){case 13:return Ta===null?xh():u.alternate===null&&gn===0&&(gn=3),u.flags&=-257,u.flags|=65536,u.lanes=y,p===T0?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([p]):o.add(p),yh(s,p,y)),!1;case 22:return u.flags|=65536,p===T0?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([p])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([p]):u.add(p)),yh(s,p,y)),!1}throw Error(r(435,u.tag))}return yh(s,p,y),xh(),!1}if(Ut)return o=Yr.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=y,p!==p0&&(s=Error(r(422),{cause:p}),Ul($r(s,u)))):(p!==p0&&(o=Error(r(423),{cause:p}),Ul($r(o,u))),s=s.current.alternate,s.flags|=65536,y&=-y,s.lanes|=y,p=$r(p,u),y=Y0(s.stateNode,p,y),b0(s,y),gn!==4&&(gn=2)),!1;var w=Error(r(520),{cause:p});if(w=$r(w,u),sc===null?sc=[w]:sc.push(w),gn!==4&&(gn=2),o===null)return!0;p=$r(p,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,s=y&-y,u.lanes|=s,s=Y0(u.stateNode,p,s),b0(u,s),!1;case 1:if(o=u.type,w=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Fs===null||!Fs.has(w))))return u.flags|=65536,y&=-y,u.lanes|=y,y=Qx(y),ev(y,s,u,p),b0(u,y),!1}u=u.return}while(u!==null);return!1}var tv=Error(r(461)),Un=!1;function qn(s,o,u,p){o.child=s===null?zx(o,null,u,p):Eo(o,s.child,u,p)}function nv(s,o,u,p,y){u=u.render;var w=o.ref;if("ref"in p){var N={};for(var L in p)L!=="ref"&&(N[L]=p[L])}else N=p;return vi(o),p=R0(s,o,u,N,w,y),L=D0(),s!==null&&!Un?(M0(s,o,y),Xa(s,o,y)):(Ut&&L&&h0(o),o.flags|=1,qn(s,o,p,y),o.child)}function rv(s,o,u,p,y){if(s===null){var w=u.type;return typeof w=="function"&&!u0(w)&&w.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=w,av(s,o,w,p,y)):(s=Ou(u.type,null,p,o,o.mode,y),s.ref=o.ref,s.return=o,o.child=s)}if(w=s.child,!th(s,y)){var N=w.memoizedProps;if(u=u.compare,u=u!==null?u:Fl,u(N,p)&&s.ref===o.ref)return Xa(s,o,y)}return o.flags|=1,s=Ga(w,p),s.ref=o.ref,s.return=o,o.child=s}function av(s,o,u,p,y){if(s!==null){var w=s.memoizedProps;if(Fl(w,p)&&s.ref===o.ref)if(Un=!1,o.pendingProps=p=w,th(s,y))(s.flags&131072)!==0&&(Un=!0);else return o.lanes=s.lanes,Xa(s,o,y)}return W0(s,o,u,p,y)}function sv(s,o,u){var p=o.pendingProps,y=p.children,w=s!==null?s.memoizedState:null;if(p.mode==="hidden"){if((o.flags&128)!==0){if(p=w!==null?w.baseLanes|u:u,s!==null){for(y=o.child=s.child,w=0;y!==null;)w=w|y.lanes|y.childLanes,y=y.sibling;o.childLanes=w&~p}else o.childLanes=0,o.child=null;return iv(s,o,p,u)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&Vu(o,w!==null?w.cachePool:null),w!==null?ax(o,w):A0(),qx(o);else return o.lanes=o.childLanes=536870912,iv(s,o,w!==null?w.baseLanes|u:u,u)}else w!==null?(Vu(o,w.cachePool),ax(o,w),ks(),o.memoizedState=null):(s!==null&&Vu(o,null),A0(),ks());return qn(s,o,y,u),o.child}function iv(s,o,u,p){var y=w0();return y=y===null?null:{parent:Rn._currentValue,pool:y},o.memoizedState={baseLanes:u,cachePool:y},s!==null&&Vu(o,null),A0(),qx(o),s!==null&&Bl(s,o,p,!0),null}function af(s,o){var u=o.ref;if(u===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(r(284));(s===null||s.ref!==u)&&(o.flags|=4194816)}}function W0(s,o,u,p,y){return vi(o),u=R0(s,o,u,p,void 0,y),p=D0(),s!==null&&!Un?(M0(s,o,y),Xa(s,o,y)):(Ut&&p&&h0(o),o.flags|=1,qn(s,o,u,y),o.child)}function ov(s,o,u,p,y,w){return vi(o),o.updateQueue=null,u=ix(o,p,u,y),sx(s),p=D0(),s!==null&&!Un?(M0(s,o,w),Xa(s,o,w)):(Ut&&p&&h0(o),o.flags|=1,qn(s,o,u,w),o.child)}function lv(s,o,u,p,y){if(vi(o),o.stateNode===null){var w=ho,N=u.contextType;typeof N=="object"&&N!==null&&(w=Qn(N)),w=new u(p,w),o.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=q0,o.stateNode=w,w._reactInternals=o,w=o.stateNode,w.props=p,w.state=o.memoizedState,w.refs={},E0(o),N=u.contextType,w.context=typeof N=="object"&&N!==null?Qn(N):ho,w.state=o.memoizedState,N=u.getDerivedStateFromProps,typeof N=="function"&&(z0(o,u,N,p),w.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(N=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),N!==w.state&&q0.enqueueReplaceState(w,w.state,null),ql(o,p,w,y),zl(),w.state=o.memoizedState),typeof w.componentDidMount=="function"&&(o.flags|=4194308),p=!0}else if(s===null){w=o.stateNode;var L=o.memoizedProps,ne=wi(u,L);w.props=ne;var me=w.context,be=u.contextType;N=ho,typeof be=="object"&&be!==null&&(N=Qn(be));var ke=u.getDerivedStateFromProps;be=typeof ke=="function"||typeof w.getSnapshotBeforeUpdate=="function",L=o.pendingProps!==L,be||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(L||me!==N)&&Wx(o,w,p,N),Es=!1;var ge=o.memoizedState;w.state=ge,ql(o,p,w,y),zl(),me=o.memoizedState,L||ge!==me||Es?(typeof ke=="function"&&(z0(o,u,ke,p),me=o.memoizedState),(ne=Es||Yx(o,u,ne,p,ge,me,N))?(be||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(o.flags|=4194308)):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=p,o.memoizedState=me),w.props=p,w.state=me,w.context=N,p=ne):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),p=!1)}else{w=o.stateNode,S0(s,o),N=o.memoizedProps,be=wi(u,N),w.props=be,ke=o.pendingProps,ge=w.context,me=u.contextType,ne=ho,typeof me=="object"&&me!==null&&(ne=Qn(me)),L=u.getDerivedStateFromProps,(me=typeof L=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(N!==ke||ge!==ne)&&Wx(o,w,p,ne),Es=!1,ge=o.memoizedState,w.state=ge,ql(o,p,w,y),zl();var xe=o.memoizedState;N!==ke||ge!==xe||Es||s!==null&&s.dependencies!==null&&Bu(s.dependencies)?(typeof L=="function"&&(z0(o,u,L,p),xe=o.memoizedState),(be=Es||Yx(o,u,be,p,ge,xe,ne)||s!==null&&s.dependencies!==null&&Bu(s.dependencies))?(me||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(p,xe,ne),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(p,xe,ne)),typeof w.componentDidUpdate=="function"&&(o.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof w.componentDidUpdate!="function"||N===s.memoizedProps&&ge===s.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&ge===s.memoizedState||(o.flags|=1024),o.memoizedProps=p,o.memoizedState=xe),w.props=p,w.state=xe,w.context=ne,p=be):(typeof w.componentDidUpdate!="function"||N===s.memoizedProps&&ge===s.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&ge===s.memoizedState||(o.flags|=1024),p=!1)}return w=p,af(s,o),p=(o.flags&128)!==0,w||p?(w=o.stateNode,u=p&&typeof u.getDerivedStateFromError!="function"?null:w.render(),o.flags|=1,s!==null&&p?(o.child=Eo(o,s.child,null,y),o.child=Eo(o,null,u,y)):qn(s,o,u,y),o.memoizedState=w.state,s=o.child):s=Xa(s,o,y),s}function cv(s,o,u,p){return Pl(),o.flags|=256,qn(s,o,u,p),o.child}var J0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function K0(s){return{baseLanes:s,cachePool:Kg()}}function X0(s,o,u){return s=s!==null?s.childLanes&~u:0,o&&(s|=Wr),s}function uv(s,o,u){var p=o.pendingProps,y=!1,w=(o.flags&128)!==0,N;if((N=w)||(N=s!==null&&s.memoizedState===null?!1:(Dn.current&2)!==0),N&&(y=!0,o.flags&=-129),N=(o.flags&32)!==0,o.flags&=-33,s===null){if(Ut){if(y?As(o):ks(),Ut){var L=pn,ne;if(ne=L){e:{for(ne=L,L=wa;ne.nodeType!==8;){if(!L){L=null;break e}if(ne=oa(ne.nextSibling),ne===null){L=null;break e}}L=ne}L!==null?(o.memoizedState={dehydrated:L,treeContext:hi!==null?{id:za,overflow:qa}:null,retryLane:536870912,hydrationErrors:null},ne=Nr(18,null,null,0),ne.stateNode=L,ne.return=o,o.child=ne,fr=o,pn=null,ne=!0):ne=!1}ne||gi(o)}if(L=o.memoizedState,L!==null&&(L=L.dehydrated,L!==null))return Fh(L)?o.lanes=32:o.lanes=536870912,null;Ka(o)}return L=p.children,p=p.fallback,y?(ks(),y=o.mode,L=sf({mode:"hidden",children:L},y),p=di(p,y,u,null),L.return=o,p.return=o,L.sibling=p,o.child=L,y=o.child,y.memoizedState=K0(u),y.childLanes=X0(s,N,u),o.memoizedState=J0,p):(As(o),Z0(o,L))}if(ne=s.memoizedState,ne!==null&&(L=ne.dehydrated,L!==null)){if(w)o.flags&256?(As(o),o.flags&=-257,o=Q0(s,o,u)):o.memoizedState!==null?(ks(),o.child=s.child,o.flags|=128,o=null):(ks(),y=p.fallback,L=o.mode,p=sf({mode:"visible",children:p.children},L),y=di(y,L,u,null),y.flags|=2,p.return=o,y.return=o,p.sibling=y,o.child=p,Eo(o,s.child,null,u),p=o.child,p.memoizedState=K0(u),p.childLanes=X0(s,N,u),o.memoizedState=J0,o=y);else if(As(o),Fh(L)){if(N=L.nextSibling&&L.nextSibling.dataset,N)var me=N.dgst;N=me,p=Error(r(419)),p.stack="",p.digest=N,Ul({value:p,source:null,stack:null}),o=Q0(s,o,u)}else if(Un||Bl(s,o,u,!1),N=(u&s.childLanes)!==0,Un||N){if(N=Jt,N!==null&&(p=u&-u,p=(p&42)!==0?1:Va(p),p=(p&(N.suspendedLanes|u))!==0?0:p,p!==0&&p!==ne.retryLane))throw ne.retryLane=p,fo(s,p),Fr(N,s,p),tv;L.data==="$?"||xh(),o=Q0(s,o,u)}else L.data==="$?"?(o.flags|=192,o.child=s.child,o=null):(s=ne.treeContext,pn=oa(L.nextSibling),fr=o,Ut=!0,pi=null,wa=!1,s!==null&&(zr[qr++]=za,zr[qr++]=qa,zr[qr++]=hi,za=s.id,qa=s.overflow,hi=o),o=Z0(o,p.children),o.flags|=4096);return o}return y?(ks(),y=p.fallback,L=o.mode,ne=s.child,me=ne.sibling,p=Ga(ne,{mode:"hidden",children:p.children}),p.subtreeFlags=ne.subtreeFlags&65011712,me!==null?y=Ga(me,y):(y=di(y,L,u,null),y.flags|=2),y.return=o,p.return=o,p.sibling=y,o.child=p,p=y,y=o.child,L=s.child.memoizedState,L===null?L=K0(u):(ne=L.cachePool,ne!==null?(me=Rn._currentValue,ne=ne.parent!==me?{parent:me,pool:me}:ne):ne=Kg(),L={baseLanes:L.baseLanes|u,cachePool:ne}),y.memoizedState=L,y.childLanes=X0(s,N,u),o.memoizedState=J0,p):(As(o),u=s.child,s=u.sibling,u=Ga(u,{mode:"visible",children:p.children}),u.return=o,u.sibling=null,s!==null&&(N=o.deletions,N===null?(o.deletions=[s],o.flags|=16):N.push(s)),o.child=u,o.memoizedState=null,u)}function Z0(s,o){return o=sf({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function sf(s,o){return s=Nr(22,s,null,o),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function Q0(s,o,u){return Eo(o,s.child,null,u),s=Z0(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function fv(s,o,u){s.lanes|=o;var p=s.alternate;p!==null&&(p.lanes|=o),x0(s.return,o,u)}function eh(s,o,u,p,y){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:p,tail:u,tailMode:y}:(w.isBackwards=o,w.rendering=null,w.renderingStartTime=0,w.last=p,w.tail=u,w.tailMode=y)}function dv(s,o,u){var p=o.pendingProps,y=p.revealOrder,w=p.tail;if(qn(s,o,p.children,u),p=Dn.current,(p&2)!==0)p=p&1|2,o.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&fv(s,u,o);else if(s.tag===19)fv(s,u,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}p&=1}switch(Y(Dn,p),y){case"forwards":for(u=o.child,y=null;u!==null;)s=u.alternate,s!==null&&tf(s)===null&&(y=u),u=u.sibling;u=y,u===null?(y=o.child,o.child=null):(y=u.sibling,u.sibling=null),eh(o,!1,y,u,w);break;case"backwards":for(u=null,y=o.child,o.child=null;y!==null;){if(s=y.alternate,s!==null&&tf(s)===null){o.child=y;break}s=y.sibling,y.sibling=u,u=y,y=s}eh(o,!0,u,null,w);break;case"together":eh(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Xa(s,o,u){if(s!==null&&(o.dependencies=s.dependencies),Is|=o.lanes,(u&o.childLanes)===0)if(s!==null){if(Bl(s,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(r(153));if(o.child!==null){for(s=o.child,u=Ga(s,s.pendingProps),o.child=u,u.return=o;s.sibling!==null;)s=s.sibling,u=u.sibling=Ga(s,s.pendingProps),u.return=o;u.sibling=null}return o.child}function th(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&Bu(s)))}function Vb(s,o,u){switch(o.tag){case 3:Te(o,o.stateNode.containerInfo),Ts(o,Rn,s.memoizedState.cache),Pl();break;case 27:case 5:Se(o);break;case 4:Te(o,o.stateNode.containerInfo);break;case 10:Ts(o,o.type,o.memoizedProps.value);break;case 13:var p=o.memoizedState;if(p!==null)return p.dehydrated!==null?(As(o),o.flags|=128,null):(u&o.child.childLanes)!==0?uv(s,o,u):(As(o),s=Xa(s,o,u),s!==null?s.sibling:null);As(o);break;case 19:var y=(s.flags&128)!==0;if(p=(u&o.childLanes)!==0,p||(Bl(s,o,u,!1),p=(u&o.childLanes)!==0),y){if(p)return dv(s,o,u);o.flags|=128}if(y=o.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),Y(Dn,Dn.current),p)break;return null;case 22:case 23:return o.lanes=0,sv(s,o,u);case 24:Ts(o,Rn,s.memoizedState.cache)}return Xa(s,o,u)}function hv(s,o,u){if(s!==null)if(s.memoizedProps!==o.pendingProps)Un=!0;else{if(!th(s,u)&&(o.flags&128)===0)return Un=!1,Vb(s,o,u);Un=(s.flags&131072)!==0}else Un=!1,Ut&&(o.flags&1048576)!==0&&$g(o,Uu,o.index);switch(o.lanes=0,o.tag){case 16:e:{s=o.pendingProps;var p=o.elementType,y=p._init;if(p=y(p._payload),o.type=p,typeof p=="function")u0(p)?(s=wi(p,s),o.tag=1,o=lv(null,o,p,s,u)):(o.tag=0,o=W0(null,o,p,s,u));else{if(p!=null){if(y=p.$$typeof,y===I){o.tag=11,o=nv(null,o,p,s,u);break e}else if(y===F){o.tag=14,o=rv(null,o,p,s,u);break e}}throw o=Ne(p)||p,Error(r(306,o,""))}}return o;case 0:return W0(s,o,o.type,o.pendingProps,u);case 1:return p=o.type,y=wi(p,o.pendingProps),lv(s,o,p,y,u);case 3:e:{if(Te(o,o.stateNode.containerInfo),s===null)throw Error(r(387));p=o.pendingProps;var w=o.memoizedState;y=w.element,S0(s,o),ql(o,p,null,u);var N=o.memoizedState;if(p=N.cache,Ts(o,Rn,p),p!==w.cache&&v0(o,[Rn],u,!0),zl(),p=N.element,w.isDehydrated)if(w={element:p,isDehydrated:!1,cache:N.cache},o.updateQueue.baseState=w,o.memoizedState=w,o.flags&256){o=cv(s,o,p,u);break e}else if(p!==y){y=$r(Error(r(424)),o),Ul(y),o=cv(s,o,p,u);break e}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(pn=oa(s.firstChild),fr=o,Ut=!0,pi=null,wa=!0,u=zx(o,null,p,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Pl(),p===y){o=Xa(s,o,u);break e}qn(s,o,p,u)}o=o.child}return o;case 26:return af(s,o),s===null?(u=x1(o.type,null,o.pendingProps,null))?o.memoizedState=u:Ut||(u=o.type,s=o.pendingProps,p=_f(oe.current).createElement(u),p[fn]=o,p[dn]=s,Wn(p,u,s),le(p),o.stateNode=p):o.memoizedState=x1(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return Se(o),s===null&&Ut&&(p=o.stateNode=m1(o.type,o.pendingProps,oe.current),fr=o,wa=!0,y=pn,Ps(o.type)?(Lh=y,pn=oa(p.firstChild)):pn=y),qn(s,o,o.pendingProps.children,u),af(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&Ut&&((y=p=pn)&&(p=pC(p,o.type,o.pendingProps,wa),p!==null?(o.stateNode=p,fr=o,pn=oa(p.firstChild),wa=!1,y=!0):y=!1),y||gi(o)),Se(o),y=o.type,w=o.pendingProps,N=s!==null?s.memoizedProps:null,p=w.children,Dh(y,w)?p=null:N!==null&&Dh(y,N)&&(o.flags|=32),o.memoizedState!==null&&(y=R0(s,o,Ib,null,null,u),mc._currentValue=y),af(s,o),qn(s,o,p,u),o.child;case 6:return s===null&&Ut&&((s=u=pn)&&(u=gC(u,o.pendingProps,wa),u!==null?(o.stateNode=u,fr=o,pn=null,s=!0):s=!1),s||gi(o)),null;case 13:return uv(s,o,u);case 4:return Te(o,o.stateNode.containerInfo),p=o.pendingProps,s===null?o.child=Eo(o,null,p,u):qn(s,o,p,u),o.child;case 11:return nv(s,o,o.type,o.pendingProps,u);case 7:return qn(s,o,o.pendingProps,u),o.child;case 8:return qn(s,o,o.pendingProps.children,u),o.child;case 12:return qn(s,o,o.pendingProps.children,u),o.child;case 10:return p=o.pendingProps,Ts(o,o.type,p.value),qn(s,o,p.children,u),o.child;case 9:return y=o.type._context,p=o.pendingProps.children,vi(o),y=Qn(y),p=p(y),o.flags|=1,qn(s,o,p,u),o.child;case 14:return rv(s,o,o.type,o.pendingProps,u);case 15:return av(s,o,o.type,o.pendingProps,u);case 19:return dv(s,o,u);case 31:return p=o.pendingProps,u=o.mode,p={mode:p.mode,children:p.children},s===null?(u=sf(p,u),u.ref=o.ref,o.child=u,u.return=o,o=u):(u=Ga(s.child,p),u.ref=o.ref,o.child=u,u.return=o,o=u),o;case 22:return sv(s,o,u);case 24:return vi(o),p=Qn(Rn),s===null?(y=w0(),y===null&&(y=Jt,w=y0(),y.pooledCache=w,w.refCount++,w!==null&&(y.pooledCacheLanes|=u),y=w),o.memoizedState={parent:p,cache:y},E0(o),Ts(o,Rn,y)):((s.lanes&u)!==0&&(S0(s,o),ql(o,null,null,u),zl()),y=s.memoizedState,w=o.memoizedState,y.parent!==p?(y={parent:p,cache:p},o.memoizedState=y,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=y),Ts(o,Rn,p)):(p=w.cache,Ts(o,Rn,p),p!==y.cache&&v0(o,[Rn],u,!0))),qn(s,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(r(156,o.tag))}function Za(s){s.flags|=4}function mv(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!T1(o)){if(o=Yr.current,o!==null&&((kt&4194048)===kt?Ta!==null:(kt&62914560)!==kt&&(kt&536870912)===0||o!==Ta))throw $l=T0,Xg;s.flags|=8192}}function of(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?Zn():536870912,s.lanes|=o,Ao|=o)}function Ql(s,o){if(!Ut)switch(s.tailMode){case"hidden":o=s.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:p.sibling=null}}function ln(s){var o=s.alternate!==null&&s.alternate.child===s.child,u=0,p=0;if(o)for(var y=s.child;y!==null;)u|=y.lanes|y.childLanes,p|=y.subtreeFlags&65011712,p|=y.flags&65011712,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)u|=y.lanes|y.childLanes,p|=y.subtreeFlags,p|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=p,s.childLanes=u,o}function Hb(s,o,u){var p=o.pendingProps;switch(m0(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ln(o),null;case 1:return ln(o),null;case 3:return u=o.stateNode,p=null,s!==null&&(p=s.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),Wa(Rn),De(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(Ol(o)?Za(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,qg())),ln(o),null;case 26:return u=o.memoizedState,s===null?(Za(o),u!==null?(ln(o),mv(o,u)):(ln(o),o.flags&=-16777217)):u?u!==s.memoizedState?(Za(o),ln(o),mv(o,u)):(ln(o),o.flags&=-16777217):(s.memoizedProps!==p&&Za(o),ln(o),o.flags&=-16777217),null;case 27:Be(o),u=oe.current;var y=o.type;if(s!==null&&o.stateNode!=null)s.memoizedProps!==p&&Za(o);else{if(!p){if(o.stateNode===null)throw Error(r(166));return ln(o),null}s=K.current,Ol(o)?Gg(o):(s=m1(y,p,u),o.stateNode=s,Za(o))}return ln(o),null;case 5:if(Be(o),u=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==p&&Za(o);else{if(!p){if(o.stateNode===null)throw Error(r(166));return ln(o),null}if(s=K.current,Ol(o))Gg(o);else{switch(y=_f(oe.current),s){case 1:s=y.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:s=y.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":s=y.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":s=y.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":s=y.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof p.is=="string"?y.createElement("select",{is:p.is}):y.createElement("select"),p.multiple?s.multiple=!0:p.size&&(s.size=p.size);break;default:s=typeof p.is=="string"?y.createElement(u,{is:p.is}):y.createElement(u)}}s[fn]=o,s[dn]=p;e:for(y=o.child;y!==null;){if(y.tag===5||y.tag===6)s.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===o)break e;for(;y.sibling===null;){if(y.return===null||y.return===o)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}o.stateNode=s;e:switch(Wn(s,u,p),u){case"button":case"input":case"select":case"textarea":s=!!p.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Za(o)}}return ln(o),o.flags&=-16777217,null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==p&&Za(o);else{if(typeof p!="string"&&o.stateNode===null)throw Error(r(166));if(s=oe.current,Ol(o)){if(s=o.stateNode,u=o.memoizedProps,p=null,y=fr,y!==null)switch(y.tag){case 27:case 5:p=y.memoizedProps}s[fn]=o,s=!!(s.nodeValue===u||p!==null&&p.suppressHydrationWarning===!0||o1(s.nodeValue,u)),s||gi(o)}else s=_f(s).createTextNode(p),s[fn]=o,o.stateNode=s}return ln(o),null;case 13:if(p=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(y=Ol(o),p!==null&&p.dehydrated!==null){if(s===null){if(!y)throw Error(r(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(r(317));y[fn]=o}else Pl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;ln(o),y=!1}else y=qg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=y),y=!0;if(!y)return o.flags&256?(Ka(o),o):(Ka(o),null)}if(Ka(o),(o.flags&128)!==0)return o.lanes=u,o;if(u=p!==null,s=s!==null&&s.memoizedState!==null,u){p=o.child,y=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(y=p.alternate.memoizedState.cachePool.pool);var w=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(w=p.memoizedState.cachePool.pool),w!==y&&(p.flags|=2048)}return u!==s&&u&&(o.child.flags|=8192),of(o,o.updateQueue),ln(o),null;case 4:return De(),s===null&&Ch(o.stateNode.containerInfo),ln(o),null;case 10:return Wa(o.type),ln(o),null;case 19:if(M(Dn),y=o.memoizedState,y===null)return ln(o),null;if(p=(o.flags&128)!==0,w=y.rendering,w===null)if(p)Ql(y,!1);else{if(gn!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(w=tf(s),w!==null){for(o.flags|=128,Ql(y,!1),s=w.updateQueue,o.updateQueue=s,of(o,s),o.subtreeFlags=0,s=u,u=o.child;u!==null;)Hg(u,s),u=u.sibling;return Y(Dn,Dn.current&1|2),o.child}s=s.sibling}y.tail!==null&&Ie()>uf&&(o.flags|=128,p=!0,Ql(y,!1),o.lanes=4194304)}else{if(!p)if(s=tf(w),s!==null){if(o.flags|=128,p=!0,s=s.updateQueue,o.updateQueue=s,of(o,s),Ql(y,!0),y.tail===null&&y.tailMode==="hidden"&&!w.alternate&&!Ut)return ln(o),null}else 2*Ie()-y.renderingStartTime>uf&&u!==536870912&&(o.flags|=128,p=!0,Ql(y,!1),o.lanes=4194304);y.isBackwards?(w.sibling=o.child,o.child=w):(s=y.last,s!==null?s.sibling=w:o.child=w,y.last=w)}return y.tail!==null?(o=y.tail,y.rendering=o,y.tail=o.sibling,y.renderingStartTime=Ie(),o.sibling=null,s=Dn.current,Y(Dn,p?s&1|2:s&1),o):(ln(o),null);case 22:case 23:return Ka(o),k0(),p=o.memoizedState!==null,s!==null?s.memoizedState!==null!==p&&(o.flags|=8192):p&&(o.flags|=8192),p?(u&536870912)!==0&&(o.flags&128)===0&&(ln(o),o.subtreeFlags&6&&(o.flags|=8192)):ln(o),u=o.updateQueue,u!==null&&of(o,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),p=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),p!==u&&(o.flags|=2048),s!==null&&M(yi),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),Wa(Rn),ln(o),null;case 25:return null;case 30:return null}throw Error(r(156,o.tag))}function $b(s,o){switch(m0(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return Wa(Rn),De(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return Be(o),null;case 13:if(Ka(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(r(340));Pl()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return M(Dn),null;case 4:return De(),null;case 10:return Wa(o.type),null;case 22:case 23:return Ka(o),k0(),s!==null&&M(yi),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return Wa(Rn),null;case 25:return null;default:return null}}function pv(s,o){switch(m0(o),o.tag){case 3:Wa(Rn),De();break;case 26:case 27:case 5:Be(o);break;case 4:De();break;case 13:Ka(o);break;case 19:M(Dn);break;case 10:Wa(o.type);break;case 22:case 23:Ka(o),k0(),s!==null&&M(yi);break;case 24:Wa(Rn)}}function ec(s,o){try{var u=o.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var y=p.next;u=y;do{if((u.tag&s)===s){p=void 0;var w=u.create,N=u.inst;p=w(),N.destroy=p}u=u.next}while(u!==y)}}catch(L){Wt(o,o.return,L)}}function Ns(s,o,u){try{var p=o.updateQueue,y=p!==null?p.lastEffect:null;if(y!==null){var w=y.next;p=w;do{if((p.tag&s)===s){var N=p.inst,L=N.destroy;if(L!==void 0){N.destroy=void 0,y=o;var ne=u,me=L;try{me()}catch(be){Wt(y,ne,be)}}}p=p.next}while(p!==w)}}catch(be){Wt(o,o.return,be)}}function gv(s){var o=s.updateQueue;if(o!==null){var u=s.stateNode;try{rx(o,u)}catch(p){Wt(s,s.return,p)}}}function xv(s,o,u){u.props=wi(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(p){Wt(s,o,p)}}function tc(s,o){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var p=s.stateNode;break;case 30:p=s.stateNode;break;default:p=s.stateNode}typeof u=="function"?s.refCleanup=u(p):u.current=p}}catch(y){Wt(s,o,y)}}function Ea(s,o){var u=s.ref,p=s.refCleanup;if(u!==null)if(typeof p=="function")try{p()}catch(y){Wt(s,o,y)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(y){Wt(s,o,y)}else u.current=null}function vv(s){var o=s.type,u=s.memoizedProps,p=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&p.focus();break e;case"img":u.src?p.src=u.src:u.srcSet&&(p.srcset=u.srcSet)}}catch(y){Wt(s,s.return,y)}}function nh(s,o,u){try{var p=s.stateNode;uC(p,s.type,u,o),p[dn]=o}catch(y){Wt(s,s.return,y)}}function yv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Ps(s.type)||s.tag===4}function rh(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||yv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Ps(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function ah(s,o,u){var p=s.tag;if(p===5||p===6)s=s.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(s),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=yf));else if(p!==4&&(p===27&&Ps(s.type)&&(u=s.stateNode,o=null),s=s.child,s!==null))for(ah(s,o,u),s=s.sibling;s!==null;)ah(s,o,u),s=s.sibling}function lf(s,o,u){var p=s.tag;if(p===5||p===6)s=s.stateNode,o?u.insertBefore(s,o):u.appendChild(s);else if(p!==4&&(p===27&&Ps(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(lf(s,o,u),s=s.sibling;s!==null;)lf(s,o,u),s=s.sibling}function _v(s){var o=s.stateNode,u=s.memoizedProps;try{for(var p=s.type,y=o.attributes;y.length;)o.removeAttributeNode(y[0]);Wn(o,p,u),o[fn]=s,o[dn]=u}catch(w){Wt(s,s.return,w)}}var Qa=!1,wn=!1,sh=!1,wv=typeof WeakSet=="function"?WeakSet:Set,Bn=null;function Gb(s,o){if(s=s.containerInfo,Nh=Cf,s=Mg(s),r0(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var p=u.getSelection&&u.getSelection();if(p&&p.rangeCount!==0){u=p.anchorNode;var y=p.anchorOffset,w=p.focusNode;p=p.focusOffset;try{u.nodeType,w.nodeType}catch{u=null;break e}var N=0,L=-1,ne=-1,me=0,be=0,ke=s,ge=null;t:for(;;){for(var xe;ke!==u||y!==0&&ke.nodeType!==3||(L=N+y),ke!==w||p!==0&&ke.nodeType!==3||(ne=N+p),ke.nodeType===3&&(N+=ke.nodeValue.length),(xe=ke.firstChild)!==null;)ge=ke,ke=xe;for(;;){if(ke===s)break t;if(ge===u&&++me===y&&(L=N),ge===w&&++be===p&&(ne=N),(xe=ke.nextSibling)!==null)break;ke=ge,ge=ke.parentNode}ke=xe}u=L===-1||ne===-1?null:{start:L,end:ne}}else u=null}u=u||{start:0,end:0}}else u=null;for(Rh={focusedElem:s,selectionRange:u},Cf=!1,Bn=o;Bn!==null;)if(o=Bn,s=o.child,(o.subtreeFlags&1024)!==0&&s!==null)s.return=o,Bn=s;else for(;Bn!==null;){switch(o=Bn,w=o.alternate,s=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&w!==null){s=void 0,u=o,y=w.memoizedProps,w=w.memoizedState,p=u.stateNode;try{var Qe=wi(u.type,y,u.elementType===u.type);s=p.getSnapshotBeforeUpdate(Qe,w),p.__reactInternalSnapshotBeforeUpdate=s}catch(Je){Wt(u,u.return,Je)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,u=s.nodeType,u===9)Ih(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Ih(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=o.sibling,s!==null){s.return=o.return,Bn=s;break}Bn=o.return}}function Tv(s,o,u){var p=u.flags;switch(u.tag){case 0:case 11:case 15:Rs(s,u),p&4&&ec(5,u);break;case 1:if(Rs(s,u),p&4)if(s=u.stateNode,o===null)try{s.componentDidMount()}catch(N){Wt(u,u.return,N)}else{var y=wi(u.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(y,o,s.__reactInternalSnapshotBeforeUpdate)}catch(N){Wt(u,u.return,N)}}p&64&&gv(u),p&512&&tc(u,u.return);break;case 3:if(Rs(s,u),p&64&&(s=u.updateQueue,s!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{rx(s,o)}catch(N){Wt(u,u.return,N)}}break;case 27:o===null&&p&4&&_v(u);case 26:case 5:Rs(s,u),o===null&&p&4&&vv(u),p&512&&tc(u,u.return);break;case 12:Rs(s,u);break;case 13:Rs(s,u),p&4&&bv(s,u),p&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=Qb.bind(null,u),xC(s,u))));break;case 22:if(p=u.memoizedState!==null||Qa,!p){o=o!==null&&o.memoizedState!==null||wn,y=Qa;var w=wn;Qa=p,(wn=o)&&!w?Ds(s,u,(u.subtreeFlags&8772)!==0):Rs(s,u),Qa=y,wn=w}break;case 30:break;default:Rs(s,u)}}function Ev(s){var o=s.alternate;o!==null&&(s.alternate=null,Ev(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&H(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var nn=null,Tr=!1;function es(s,o,u){for(u=u.child;u!==null;)Sv(s,o,u),u=u.sibling}function Sv(s,o,u){if(Qt&&typeof Qt.onCommitFiberUnmount=="function")try{Qt.onCommitFiberUnmount(yn,u)}catch{}switch(u.tag){case 26:wn||Ea(u,o),es(s,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:wn||Ea(u,o);var p=nn,y=Tr;Ps(u.type)&&(nn=u.stateNode,Tr=!1),es(s,o,u),uc(u.stateNode),nn=p,Tr=y;break;case 5:wn||Ea(u,o);case 6:if(p=nn,y=Tr,nn=null,es(s,o,u),nn=p,Tr=y,nn!==null)if(Tr)try{(nn.nodeType===9?nn.body:nn.nodeName==="HTML"?nn.ownerDocument.body:nn).removeChild(u.stateNode)}catch(w){Wt(u,o,w)}else try{nn.removeChild(u.stateNode)}catch(w){Wt(u,o,w)}break;case 18:nn!==null&&(Tr?(s=nn,d1(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),vc(s)):d1(nn,u.stateNode));break;case 4:p=nn,y=Tr,nn=u.stateNode.containerInfo,Tr=!0,es(s,o,u),nn=p,Tr=y;break;case 0:case 11:case 14:case 15:wn||Ns(2,u,o),wn||Ns(4,u,o),es(s,o,u);break;case 1:wn||(Ea(u,o),p=u.stateNode,typeof p.componentWillUnmount=="function"&&xv(u,o,p)),es(s,o,u);break;case 21:es(s,o,u);break;case 22:wn=(p=wn)||u.memoizedState!==null,es(s,o,u),wn=p;break;default:es(s,o,u)}}function bv(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{vc(s)}catch(u){Wt(o,o.return,u)}}function zb(s){switch(s.tag){case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new wv),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new wv),o;default:throw Error(r(435,s.tag))}}function ih(s,o){var u=zb(s);o.forEach(function(p){var y=eC.bind(null,s,p);u.has(p)||(u.add(p),p.then(y,y))})}function Rr(s,o){var u=o.deletions;if(u!==null)for(var p=0;p<u.length;p++){var y=u[p],w=s,N=o,L=N;e:for(;L!==null;){switch(L.tag){case 27:if(Ps(L.type)){nn=L.stateNode,Tr=!1;break e}break;case 5:nn=L.stateNode,Tr=!1;break e;case 3:case 4:nn=L.stateNode.containerInfo,Tr=!0;break e}L=L.return}if(nn===null)throw Error(r(160));Sv(w,N,y),nn=null,Tr=!1,w=y.alternate,w!==null&&(w.return=null),y.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)Cv(o,s),o=o.sibling}var ia=null;function Cv(s,o){var u=s.alternate,p=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Rr(o,s),Dr(s),p&4&&(Ns(3,s,s.return),ec(3,s),Ns(5,s,s.return));break;case 1:Rr(o,s),Dr(s),p&512&&(wn||u===null||Ea(u,u.return)),p&64&&Qa&&(s=s.updateQueue,s!==null&&(p=s.callbacks,p!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?p:u.concat(p))));break;case 26:var y=ia;if(Rr(o,s),Dr(s),p&512&&(wn||u===null||Ea(u,u.return)),p&4){var w=u!==null?u.memoizedState:null;if(p=s.memoizedState,u===null)if(p===null)if(s.stateNode===null){e:{p=s.type,u=s.memoizedProps,y=y.ownerDocument||y;t:switch(p){case"title":w=y.getElementsByTagName("title")[0],(!w||w[O]||w[fn]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=y.createElement(p),y.head.insertBefore(w,y.querySelector("head > title"))),Wn(w,p,u),w[fn]=s,le(w),p=w;break e;case"link":var N=_1("link","href",y).get(p+(u.href||""));if(N){for(var L=0;L<N.length;L++)if(w=N[L],w.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&w.getAttribute("rel")===(u.rel==null?null:u.rel)&&w.getAttribute("title")===(u.title==null?null:u.title)&&w.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){N.splice(L,1);break t}}w=y.createElement(p),Wn(w,p,u),y.head.appendChild(w);break;case"meta":if(N=_1("meta","content",y).get(p+(u.content||""))){for(L=0;L<N.length;L++)if(w=N[L],w.getAttribute("content")===(u.content==null?null:""+u.content)&&w.getAttribute("name")===(u.name==null?null:u.name)&&w.getAttribute("property")===(u.property==null?null:u.property)&&w.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&w.getAttribute("charset")===(u.charSet==null?null:u.charSet)){N.splice(L,1);break t}}w=y.createElement(p),Wn(w,p,u),y.head.appendChild(w);break;default:throw Error(r(468,p))}w[fn]=s,le(w),p=w}s.stateNode=p}else w1(y,s.type,s.stateNode);else s.stateNode=y1(y,p,s.memoizedProps);else w!==p?(w===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):w.count--,p===null?w1(y,s.type,s.stateNode):y1(y,p,s.memoizedProps)):p===null&&s.stateNode!==null&&nh(s,s.memoizedProps,u.memoizedProps)}break;case 27:Rr(o,s),Dr(s),p&512&&(wn||u===null||Ea(u,u.return)),u!==null&&p&4&&nh(s,s.memoizedProps,u.memoizedProps);break;case 5:if(Rr(o,s),Dr(s),p&512&&(wn||u===null||Ea(u,u.return)),s.flags&32){y=s.stateNode;try{ao(y,"")}catch(xe){Wt(s,s.return,xe)}}p&4&&s.stateNode!=null&&(y=s.memoizedProps,nh(s,y,u!==null?u.memoizedProps:y)),p&1024&&(sh=!0);break;case 6:if(Rr(o,s),Dr(s),p&4){if(s.stateNode===null)throw Error(r(162));p=s.memoizedProps,u=s.stateNode;try{u.nodeValue=p}catch(xe){Wt(s,s.return,xe)}}break;case 3:if(Ef=null,y=ia,ia=wf(o.containerInfo),Rr(o,s),ia=y,Dr(s),p&4&&u!==null&&u.memoizedState.isDehydrated)try{vc(o.containerInfo)}catch(xe){Wt(s,s.return,xe)}sh&&(sh=!1,Av(s));break;case 4:p=ia,ia=wf(s.stateNode.containerInfo),Rr(o,s),Dr(s),ia=p;break;case 12:Rr(o,s),Dr(s);break;case 13:Rr(o,s),Dr(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(dh=Ie()),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,ih(s,p)));break;case 22:y=s.memoizedState!==null;var ne=u!==null&&u.memoizedState!==null,me=Qa,be=wn;if(Qa=me||y,wn=be||ne,Rr(o,s),wn=be,Qa=me,Dr(s),p&8192)e:for(o=s.stateNode,o._visibility=y?o._visibility&-2:o._visibility|1,y&&(u===null||ne||Qa||wn||Ti(s)),u=null,o=s;;){if(o.tag===5||o.tag===26){if(u===null){ne=u=o;try{if(w=ne.stateNode,y)N=w.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{L=ne.stateNode;var ke=ne.memoizedProps.style,ge=ke!=null&&ke.hasOwnProperty("display")?ke.display:null;L.style.display=ge==null||typeof ge=="boolean"?"":(""+ge).trim()}}catch(xe){Wt(ne,ne.return,xe)}}}else if(o.tag===6){if(u===null){ne=o;try{ne.stateNode.nodeValue=y?"":ne.memoizedProps}catch(xe){Wt(ne,ne.return,xe)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}p&4&&(p=s.updateQueue,p!==null&&(u=p.retryQueue,u!==null&&(p.retryQueue=null,ih(s,u))));break;case 19:Rr(o,s),Dr(s),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,ih(s,p)));break;case 30:break;case 21:break;default:Rr(o,s),Dr(s)}}function Dr(s){var o=s.flags;if(o&2){try{for(var u,p=s.return;p!==null;){if(yv(p)){u=p;break}p=p.return}if(u==null)throw Error(r(160));switch(u.tag){case 27:var y=u.stateNode,w=rh(s);lf(s,w,y);break;case 5:var N=u.stateNode;u.flags&32&&(ao(N,""),u.flags&=-33);var L=rh(s);lf(s,L,N);break;case 3:case 4:var ne=u.stateNode.containerInfo,me=rh(s);ah(s,me,ne);break;default:throw Error(r(161))}}catch(be){Wt(s,s.return,be)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function Av(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;Av(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function Rs(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Tv(s,o.alternate,o),o=o.sibling}function Ti(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:Ns(4,o,o.return),Ti(o);break;case 1:Ea(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&xv(o,o.return,u),Ti(o);break;case 27:uc(o.stateNode);case 26:case 5:Ea(o,o.return),Ti(o);break;case 22:o.memoizedState===null&&Ti(o);break;case 30:Ti(o);break;default:Ti(o)}s=s.sibling}}function Ds(s,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var p=o.alternate,y=s,w=o,N=w.flags;switch(w.tag){case 0:case 11:case 15:Ds(y,w,u),ec(4,w);break;case 1:if(Ds(y,w,u),p=w,y=p.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(me){Wt(p,p.return,me)}if(p=w,y=p.updateQueue,y!==null){var L=p.stateNode;try{var ne=y.shared.hiddenCallbacks;if(ne!==null)for(y.shared.hiddenCallbacks=null,y=0;y<ne.length;y++)nx(ne[y],L)}catch(me){Wt(p,p.return,me)}}u&&N&64&&gv(w),tc(w,w.return);break;case 27:_v(w);case 26:case 5:Ds(y,w,u),u&&p===null&&N&4&&vv(w),tc(w,w.return);break;case 12:Ds(y,w,u);break;case 13:Ds(y,w,u),u&&N&4&&bv(y,w);break;case 22:w.memoizedState===null&&Ds(y,w,u),tc(w,w.return);break;case 30:break;default:Ds(y,w,u)}o=o.sibling}}function oh(s,o){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&jl(u))}function lh(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&jl(s))}function Sa(s,o,u,p){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)kv(s,o,u,p),o=o.sibling}function kv(s,o,u,p){var y=o.flags;switch(o.tag){case 0:case 11:case 15:Sa(s,o,u,p),y&2048&&ec(9,o);break;case 1:Sa(s,o,u,p);break;case 3:Sa(s,o,u,p),y&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&jl(s)));break;case 12:if(y&2048){Sa(s,o,u,p),s=o.stateNode;try{var w=o.memoizedProps,N=w.id,L=w.onPostCommit;typeof L=="function"&&L(N,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(ne){Wt(o,o.return,ne)}}else Sa(s,o,u,p);break;case 13:Sa(s,o,u,p);break;case 23:break;case 22:w=o.stateNode,N=o.alternate,o.memoizedState!==null?w._visibility&2?Sa(s,o,u,p):nc(s,o):w._visibility&2?Sa(s,o,u,p):(w._visibility|=2,So(s,o,u,p,(o.subtreeFlags&10256)!==0)),y&2048&&oh(N,o);break;case 24:Sa(s,o,u,p),y&2048&&lh(o.alternate,o);break;default:Sa(s,o,u,p)}}function So(s,o,u,p,y){for(y=y&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var w=s,N=o,L=u,ne=p,me=N.flags;switch(N.tag){case 0:case 11:case 15:So(w,N,L,ne,y),ec(8,N);break;case 23:break;case 22:var be=N.stateNode;N.memoizedState!==null?be._visibility&2?So(w,N,L,ne,y):nc(w,N):(be._visibility|=2,So(w,N,L,ne,y)),y&&me&2048&&oh(N.alternate,N);break;case 24:So(w,N,L,ne,y),y&&me&2048&&lh(N.alternate,N);break;default:So(w,N,L,ne,y)}o=o.sibling}}function nc(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=s,p=o,y=p.flags;switch(p.tag){case 22:nc(u,p),y&2048&&oh(p.alternate,p);break;case 24:nc(u,p),y&2048&&lh(p.alternate,p);break;default:nc(u,p)}o=o.sibling}}var rc=8192;function bo(s){if(s.subtreeFlags&rc)for(s=s.child;s!==null;)Nv(s),s=s.sibling}function Nv(s){switch(s.tag){case 26:bo(s),s.flags&rc&&s.memoizedState!==null&&RC(ia,s.memoizedState,s.memoizedProps);break;case 5:bo(s);break;case 3:case 4:var o=ia;ia=wf(s.stateNode.containerInfo),bo(s),ia=o;break;case 22:s.memoizedState===null&&(o=s.alternate,o!==null&&o.memoizedState!==null?(o=rc,rc=16777216,bo(s),rc=o):bo(s));break;default:bo(s)}}function Rv(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function ac(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];Bn=p,Mv(p,s)}Rv(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Dv(s),s=s.sibling}function Dv(s){switch(s.tag){case 0:case 11:case 15:ac(s),s.flags&2048&&Ns(9,s,s.return);break;case 3:ac(s);break;case 12:ac(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,cf(s)):ac(s);break;default:ac(s)}}function cf(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];Bn=p,Mv(p,s)}Rv(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:Ns(8,o,o.return),cf(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,cf(o));break;default:cf(o)}s=s.sibling}}function Mv(s,o){for(;Bn!==null;){var u=Bn;switch(u.tag){case 0:case 11:case 15:Ns(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var p=u.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:jl(u.memoizedState.cache)}if(p=u.child,p!==null)p.return=u,Bn=p;else e:for(u=s;Bn!==null;){p=Bn;var y=p.sibling,w=p.return;if(Ev(p),p===u){Bn=null;break e}if(y!==null){y.return=w,Bn=y;break e}Bn=w}}}var qb={getCacheForType:function(s){var o=Qn(Rn),u=o.data.get(s);return u===void 0&&(u=s(),o.data.set(s,u)),u}},Yb=typeof WeakMap=="function"?WeakMap:Map,Vt=0,Jt=null,wt=null,kt=0,Ht=0,Mr=null,Ms=!1,Co=!1,ch=!1,ts=0,gn=0,Is=0,Ei=0,uh=0,Wr=0,Ao=0,sc=null,Er=null,fh=!1,dh=0,uf=1/0,ff=null,Fs=null,Yn=0,Ls=null,ko=null,No=0,hh=0,mh=null,Iv=null,ic=0,ph=null;function Ir(){if((Vt&2)!==0&&kt!==0)return kt&-kt;if(se.T!==null){var s=go;return s!==0?s:Th()}return vs()}function Fv(){Wr===0&&(Wr=(kt&536870912)===0||Ut?pt():536870912);var s=Yr.current;return s!==null&&(s.flags|=32),Wr}function Fr(s,o,u){(s===Jt&&(Ht===2||Ht===9)||s.cancelPendingCommit!==null)&&(Ro(s,0),Os(s,kt,Wr,!1)),ra(s,u),((Vt&2)===0||s!==Jt)&&(s===Jt&&((Vt&2)===0&&(Ei|=u),gn===4&&Os(s,kt,Wr,!1)),ba(s))}function Lv(s,o,u){if((Vt&6)!==0)throw Error(r(327));var p=!u&&(o&124)===0&&(o&s.expiredLanes)===0||Ge(s,o),y=p?Kb(s,o):vh(s,o,!0),w=p;do{if(y===0){Co&&!p&&Os(s,o,0,!1);break}else{if(u=s.current.alternate,w&&!Wb(u)){y=vh(s,o,!1),w=!1;continue}if(y===2){if(w=o,s.errorRecoveryDisabledLanes&w)var N=0;else N=s.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){o=N;e:{var L=s;y=sc;var ne=L.current.memoizedState.isDehydrated;if(ne&&(Ro(L,N).flags|=256),N=vh(L,N,!1),N!==2){if(ch&&!ne){L.errorRecoveryDisabledLanes|=w,Ei|=w,y=4;break e}w=Er,Er=y,w!==null&&(Er===null?Er=w:Er.push.apply(Er,w))}y=N}if(w=!1,y!==2)continue}}if(y===1){Ro(s,0),Os(s,o,0,!0);break}e:{switch(p=s,w=y,w){case 0:case 1:throw Error(r(345));case 4:if((o&4194048)!==o)break;case 6:Os(p,o,Wr,!Ms);break e;case 2:Er=null;break;case 3:case 5:break;default:throw Error(r(329))}if((o&62914560)===o&&(y=dh+300-Ie(),10<y)){if(Os(p,o,Wr,!Ms),We(p,0,!0)!==0)break e;p.timeoutHandle=u1(Ov.bind(null,p,u,Er,ff,fh,o,Wr,Ei,Ao,Ms,w,2,-0,0),y);break e}Ov(p,u,Er,ff,fh,o,Wr,Ei,Ao,Ms,w,0,-0,0)}}break}while(!0);ba(s)}function Ov(s,o,u,p,y,w,N,L,ne,me,be,ke,ge,xe){if(s.timeoutHandle=-1,ke=o.subtreeFlags,(ke&8192||(ke&16785408)===16785408)&&(hc={stylesheets:null,count:0,unsuspend:NC},Nv(o),ke=DC(),ke!==null)){s.cancelPendingCommit=ke($v.bind(null,s,o,w,u,p,y,N,L,ne,be,1,ge,xe)),Os(s,w,N,!me);return}$v(s,o,w,u,p,y,N,L,ne)}function Wb(s){for(var o=s;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var p=0;p<u.length;p++){var y=u[p],w=y.getSnapshot;y=y.value;try{if(!kr(w(),y))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Os(s,o,u,p){o&=~uh,o&=~Ei,s.suspendedLanes|=o,s.pingedLanes&=~o,p&&(s.warmLanes|=o),p=s.expirationTimes;for(var y=o;0<y;){var w=31-it(y),N=1<<w;p[w]=-1,y&=~N}u!==0&&gs(s,u,o)}function df(){return(Vt&6)===0?(oc(0),!1):!0}function gh(){if(wt!==null){if(Ht===0)var s=wt.return;else s=wt,Ya=xi=null,I0(s),To=null,Xl=0,s=wt;for(;s!==null;)pv(s.alternate,s),s=s.return;wt=null}}function Ro(s,o){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,dC(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),gh(),Jt=s,wt=u=Ga(s.current,null),kt=o,Ht=0,Mr=null,Ms=!1,Co=Ge(s,o),ch=!1,Ao=Wr=uh=Ei=Is=gn=0,Er=sc=null,fh=!1,(o&8)!==0&&(o|=o&32);var p=s.entangledLanes;if(p!==0)for(s=s.entanglements,p&=o;0<p;){var y=31-it(p),w=1<<y;o|=s[y],p&=~w}return ts=o,Iu(),u}function Pv(s,o){mt=null,se.H=Zu,o===Hl||o===Hu?(o=ex(),Ht=3):o===Xg?(o=ex(),Ht=4):Ht=o===tv?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Mr=o,wt===null&&(gn=1,rf(s,$r(o,s.current)))}function Uv(){var s=se.H;return se.H=Zu,s===null?Zu:s}function Bv(){var s=se.A;return se.A=qb,s}function xh(){gn=4,Ms||(kt&4194048)!==kt&&Yr.current!==null||(Co=!0),(Is&134217727)===0&&(Ei&134217727)===0||Jt===null||Os(Jt,kt,Wr,!1)}function vh(s,o,u){var p=Vt;Vt|=2;var y=Uv(),w=Bv();(Jt!==s||kt!==o)&&(ff=null,Ro(s,o)),o=!1;var N=gn;e:do try{if(Ht!==0&&wt!==null){var L=wt,ne=Mr;switch(Ht){case 8:gh(),N=6;break e;case 3:case 2:case 9:case 6:Yr.current===null&&(o=!0);var me=Ht;if(Ht=0,Mr=null,Do(s,L,ne,me),u&&Co){N=0;break e}break;default:me=Ht,Ht=0,Mr=null,Do(s,L,ne,me)}}Jb(),N=gn;break}catch(be){Pv(s,be)}while(!0);return o&&s.shellSuspendCounter++,Ya=xi=null,Vt=p,se.H=y,se.A=w,wt===null&&(Jt=null,kt=0,Iu()),N}function Jb(){for(;wt!==null;)jv(wt)}function Kb(s,o){var u=Vt;Vt|=2;var p=Uv(),y=Bv();Jt!==s||kt!==o?(ff=null,uf=Ie()+500,Ro(s,o)):Co=Ge(s,o);e:do try{if(Ht!==0&&wt!==null){o=wt;var w=Mr;t:switch(Ht){case 1:Ht=0,Mr=null,Do(s,o,w,1);break;case 2:case 9:if(Zg(w)){Ht=0,Mr=null,Vv(o);break}o=function(){Ht!==2&&Ht!==9||Jt!==s||(Ht=7),ba(s)},w.then(o,o);break e;case 3:Ht=7;break e;case 4:Ht=5;break e;case 7:Zg(w)?(Ht=0,Mr=null,Vv(o)):(Ht=0,Mr=null,Do(s,o,w,7));break;case 5:var N=null;switch(wt.tag){case 26:N=wt.memoizedState;case 5:case 27:var L=wt;if(!N||T1(N)){Ht=0,Mr=null;var ne=L.sibling;if(ne!==null)wt=ne;else{var me=L.return;me!==null?(wt=me,hf(me)):wt=null}break t}}Ht=0,Mr=null,Do(s,o,w,5);break;case 6:Ht=0,Mr=null,Do(s,o,w,6);break;case 8:gh(),gn=6;break e;default:throw Error(r(462))}}Xb();break}catch(be){Pv(s,be)}while(!0);return Ya=xi=null,se.H=p,se.A=y,Vt=u,wt!==null?0:(Jt=null,kt=0,Iu(),gn)}function Xb(){for(;wt!==null&&!xt();)jv(wt)}function jv(s){var o=hv(s.alternate,s,ts);s.memoizedProps=s.pendingProps,o===null?hf(s):wt=o}function Vv(s){var o=s,u=o.alternate;switch(o.tag){case 15:case 0:o=ov(u,o,o.pendingProps,o.type,void 0,kt);break;case 11:o=ov(u,o,o.pendingProps,o.type.render,o.ref,kt);break;case 5:I0(o);default:pv(u,o),o=wt=Hg(o,ts),o=hv(u,o,ts)}s.memoizedProps=s.pendingProps,o===null?hf(s):wt=o}function Do(s,o,u,p){Ya=xi=null,I0(o),To=null,Xl=0;var y=o.return;try{if(jb(s,y,o,u,kt)){gn=1,rf(s,$r(u,s.current)),wt=null;return}}catch(w){if(y!==null)throw wt=y,w;gn=1,rf(s,$r(u,s.current)),wt=null;return}o.flags&32768?(Ut||p===1?s=!0:Co||(kt&536870912)!==0?s=!1:(Ms=s=!0,(p===2||p===9||p===3||p===6)&&(p=Yr.current,p!==null&&p.tag===13&&(p.flags|=16384))),Hv(o,s)):hf(o)}function hf(s){var o=s;do{if((o.flags&32768)!==0){Hv(o,Ms);return}s=o.return;var u=Hb(o.alternate,o,ts);if(u!==null){wt=u;return}if(o=o.sibling,o!==null){wt=o;return}wt=o=s}while(o!==null);gn===0&&(gn=5)}function Hv(s,o){do{var u=$b(s.alternate,s);if(u!==null){u.flags&=32767,wt=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(s=s.sibling,s!==null)){wt=s;return}wt=s=u}while(s!==null);gn=6,wt=null}function $v(s,o,u,p,y,w,N,L,ne){s.cancelPendingCommit=null;do mf();while(Yn!==0);if((Vt&6)!==0)throw Error(r(327));if(o!==null){if(o===s.current)throw Error(r(177));if(w=o.lanes|o.childLanes,w|=l0,_a(s,u,w,N,L,ne),s===Jt&&(wt=Jt=null,kt=0),ko=o,Ls=s,No=u,hh=w,mh=y,Iv=p,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,tC(un,function(){return Wv(),null})):(s.callbackNode=null,s.callbackPriority=0),p=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||p){p=se.T,se.T=null,y=ue.p,ue.p=2,N=Vt,Vt|=4;try{Gb(s,o,u)}finally{Vt=N,ue.p=y,se.T=p}}Yn=1,Gv(),zv(),qv()}}function Gv(){if(Yn===1){Yn=0;var s=Ls,o=ko,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=se.T,se.T=null;var p=ue.p;ue.p=2;var y=Vt;Vt|=4;try{Cv(o,s);var w=Rh,N=Mg(s.containerInfo),L=w.focusedElem,ne=w.selectionRange;if(N!==L&&L&&L.ownerDocument&&Dg(L.ownerDocument.documentElement,L)){if(ne!==null&&r0(L)){var me=ne.start,be=ne.end;if(be===void 0&&(be=me),"selectionStart"in L)L.selectionStart=me,L.selectionEnd=Math.min(be,L.value.length);else{var ke=L.ownerDocument||document,ge=ke&&ke.defaultView||window;if(ge.getSelection){var xe=ge.getSelection(),Qe=L.textContent.length,Je=Math.min(ne.start,Qe),Yt=ne.end===void 0?Je:Math.min(ne.end,Qe);!xe.extend&&Je>Yt&&(N=Yt,Yt=Je,Je=N);var ce=Rg(L,Je),ie=Rg(L,Yt);if(ce&&ie&&(xe.rangeCount!==1||xe.anchorNode!==ce.node||xe.anchorOffset!==ce.offset||xe.focusNode!==ie.node||xe.focusOffset!==ie.offset)){var de=ke.createRange();de.setStart(ce.node,ce.offset),xe.removeAllRanges(),Je>Yt?(xe.addRange(de),xe.extend(ie.node,ie.offset)):(de.setEnd(ie.node,ie.offset),xe.addRange(de))}}}}for(ke=[],xe=L;xe=xe.parentNode;)xe.nodeType===1&&ke.push({element:xe,left:xe.scrollLeft,top:xe.scrollTop});for(typeof L.focus=="function"&&L.focus(),L=0;L<ke.length;L++){var Ce=ke[L];Ce.element.scrollLeft=Ce.left,Ce.element.scrollTop=Ce.top}}Cf=!!Nh,Rh=Nh=null}finally{Vt=y,ue.p=p,se.T=u}}s.current=o,Yn=2}}function zv(){if(Yn===2){Yn=0;var s=Ls,o=ko,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=se.T,se.T=null;var p=ue.p;ue.p=2;var y=Vt;Vt|=4;try{Tv(s,o.alternate,o)}finally{Vt=y,ue.p=p,se.T=u}}Yn=3}}function qv(){if(Yn===4||Yn===3){Yn=0,nt();var s=Ls,o=ko,u=No,p=Iv;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Yn=5:(Yn=0,ko=Ls=null,Yv(s,s.pendingLanes));var y=s.pendingLanes;if(y===0&&(Fs=null),Ha(u),o=o.stateNode,Qt&&typeof Qt.onCommitFiberRoot=="function")try{Qt.onCommitFiberRoot(yn,o,void 0,(o.current.flags&128)===128)}catch{}if(p!==null){o=se.T,y=ue.p,ue.p=2,se.T=null;try{for(var w=s.onRecoverableError,N=0;N<p.length;N++){var L=p[N];w(L.value,{componentStack:L.stack})}}finally{se.T=o,ue.p=y}}(No&3)!==0&&mf(),ba(s),y=s.pendingLanes,(u&4194090)!==0&&(y&42)!==0?s===ph?ic++:(ic=0,ph=s):ic=0,oc(0)}}function Yv(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,jl(o)))}function mf(s){return Gv(),zv(),qv(),Wv()}function Wv(){if(Yn!==5)return!1;var s=Ls,o=hh;hh=0;var u=Ha(No),p=se.T,y=ue.p;try{ue.p=32>u?32:u,se.T=null,u=mh,mh=null;var w=Ls,N=No;if(Yn=0,ko=Ls=null,No=0,(Vt&6)!==0)throw Error(r(331));var L=Vt;if(Vt|=4,Dv(w.current),kv(w,w.current,N,u),Vt=L,oc(0,!1),Qt&&typeof Qt.onPostCommitFiberRoot=="function")try{Qt.onPostCommitFiberRoot(yn,w)}catch{}return!0}finally{ue.p=y,se.T=p,Yv(s,o)}}function Jv(s,o,u){o=$r(u,o),o=Y0(s.stateNode,o,2),s=bs(s,o,2),s!==null&&(ra(s,2),ba(s))}function Wt(s,o,u){if(s.tag===3)Jv(s,s,u);else for(;o!==null;){if(o.tag===3){Jv(o,s,u);break}else if(o.tag===1){var p=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Fs===null||!Fs.has(p))){s=$r(u,s),u=Qx(2),p=bs(o,u,2),p!==null&&(ev(u,p,o,s),ra(p,2),ba(p));break}}o=o.return}}function yh(s,o,u){var p=s.pingCache;if(p===null){p=s.pingCache=new Yb;var y=new Set;p.set(o,y)}else y=p.get(o),y===void 0&&(y=new Set,p.set(o,y));y.has(u)||(ch=!0,y.add(u),s=Zb.bind(null,s,o,u),o.then(s,s))}function Zb(s,o,u){var p=s.pingCache;p!==null&&p.delete(o),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,Jt===s&&(kt&u)===u&&(gn===4||gn===3&&(kt&62914560)===kt&&300>Ie()-dh?(Vt&2)===0&&Ro(s,0):uh|=u,Ao===kt&&(Ao=0)),ba(s)}function Kv(s,o){o===0&&(o=Zn()),s=fo(s,o),s!==null&&(ra(s,o),ba(s))}function Qb(s){var o=s.memoizedState,u=0;o!==null&&(u=o.retryLane),Kv(s,u)}function eC(s,o){var u=0;switch(s.tag){case 13:var p=s.stateNode,y=s.memoizedState;y!==null&&(u=y.retryLane);break;case 19:p=s.stateNode;break;case 22:p=s.stateNode._retryCache;break;default:throw Error(r(314))}p!==null&&p.delete(o),Kv(s,u)}function tC(s,o){return dt(s,o)}var pf=null,Mo=null,_h=!1,gf=!1,wh=!1,Si=0;function ba(s){s!==Mo&&s.next===null&&(Mo===null?pf=Mo=s:Mo=Mo.next=s),gf=!0,_h||(_h=!0,rC())}function oc(s,o){if(!wh&&gf){wh=!0;do for(var u=!1,p=pf;p!==null;){if(s!==0){var y=p.pendingLanes;if(y===0)var w=0;else{var N=p.suspendedLanes,L=p.pingedLanes;w=(1<<31-it(42|s)+1)-1,w&=y&~(N&~L),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(u=!0,e1(p,w))}else w=kt,w=We(p,p===Jt?w:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(w&3)===0||Ge(p,w)||(u=!0,e1(p,w));p=p.next}while(u);wh=!1}}function nC(){Xv()}function Xv(){gf=_h=!1;var s=0;Si!==0&&(fC()&&(s=Si),Si=0);for(var o=Ie(),u=null,p=pf;p!==null;){var y=p.next,w=Zv(p,o);w===0?(p.next=null,u===null?pf=y:u.next=y,y===null&&(Mo=u)):(u=p,(s!==0||(w&3)!==0)&&(gf=!0)),p=y}oc(s)}function Zv(s,o){for(var u=s.suspendedLanes,p=s.pingedLanes,y=s.expirationTimes,w=s.pendingLanes&-62914561;0<w;){var N=31-it(w),L=1<<N,ne=y[N];ne===-1?((L&u)===0||(L&p)!==0)&&(y[N]=Ze(L,o)):ne<=o&&(s.expiredLanes|=L),w&=~L}if(o=Jt,u=kt,u=We(s,s===o?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),p=s.callbackNode,u===0||s===o&&(Ht===2||Ht===9)||s.cancelPendingCommit!==null)return p!==null&&p!==null&&Ke(p),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||Ge(s,u)){if(o=u&-u,o===s.callbackPriority)return o;switch(p!==null&&Ke(p),Ha(u)){case 2:case 8:u=sn;break;case 32:u=un;break;case 268435456:u=vt;break;default:u=un}return p=Qv.bind(null,s),u=dt(u,p),s.callbackPriority=o,s.callbackNode=u,o}return p!==null&&p!==null&&Ke(p),s.callbackPriority=2,s.callbackNode=null,2}function Qv(s,o){if(Yn!==0&&Yn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(mf()&&s.callbackNode!==u)return null;var p=kt;return p=We(s,s===Jt?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),p===0?null:(Lv(s,p,o),Zv(s,Ie()),s.callbackNode!=null&&s.callbackNode===u?Qv.bind(null,s):null)}function e1(s,o){if(mf())return null;Lv(s,o,!0)}function rC(){hC(function(){(Vt&6)!==0?dt(an,nC):Xv()})}function Th(){return Si===0&&(Si=pt()),Si}function t1(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Cu(""+s)}function n1(s,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,s.id&&u.setAttribute("form",s.id),o.parentNode.insertBefore(u,o),s=new FormData(s),u.parentNode.removeChild(u),s}function aC(s,o,u,p,y){if(o==="submit"&&u&&u.stateNode===y){var w=t1((y[dn]||null).action),N=p.submitter;N&&(o=(o=N[dn]||null)?t1(o.formAction):N.getAttribute("formAction"),o!==null&&(w=o,N=null));var L=new Ru("action","action",null,p,y);s.push({event:L,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Si!==0){var ne=N?n1(y,N):new FormData(y);H0(u,{pending:!0,data:ne,method:y.method,action:w},null,ne)}}else typeof w=="function"&&(L.preventDefault(),ne=N?n1(y,N):new FormData(y),H0(u,{pending:!0,data:ne,method:y.method,action:w},w,ne))},currentTarget:y}]})}}for(var Eh=0;Eh<o0.length;Eh++){var Sh=o0[Eh],sC=Sh.toLowerCase(),iC=Sh[0].toUpperCase()+Sh.slice(1);sa(sC,"on"+iC)}sa(Lg,"onAnimationEnd"),sa(Og,"onAnimationIteration"),sa(Pg,"onAnimationStart"),sa("dblclick","onDoubleClick"),sa("focusin","onFocus"),sa("focusout","onBlur"),sa(Eb,"onTransitionRun"),sa(Sb,"onTransitionStart"),sa(bb,"onTransitionCancel"),sa(Ug,"onTransitionEnd"),Fe("onMouseEnter",["mouseout","mouseover"]),Fe("onMouseLeave",["mouseout","mouseover"]),Fe("onPointerEnter",["pointerout","pointerover"]),Fe("onPointerLeave",["pointerout","pointerover"]),Re("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Re("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Re("onBeforeInput",["compositionend","keypress","textInput","paste"]),Re("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Re("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Re("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),oC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(lc));function r1(s,o){o=(o&4)!==0;for(var u=0;u<s.length;u++){var p=s[u],y=p.event;p=p.listeners;e:{var w=void 0;if(o)for(var N=p.length-1;0<=N;N--){var L=p[N],ne=L.instance,me=L.currentTarget;if(L=L.listener,ne!==w&&y.isPropagationStopped())break e;w=L,y.currentTarget=me;try{w(y)}catch(be){nf(be)}y.currentTarget=null,w=ne}else for(N=0;N<p.length;N++){if(L=p[N],ne=L.instance,me=L.currentTarget,L=L.listener,ne!==w&&y.isPropagationStopped())break e;w=L,y.currentTarget=me;try{w(y)}catch(be){nf(be)}y.currentTarget=null,w=ne}}}}function Tt(s,o){var u=o[yt];u===void 0&&(u=o[yt]=new Set);var p=s+"__bubble";u.has(p)||(a1(o,s,2,!1),u.add(p))}function bh(s,o,u){var p=0;o&&(p|=4),a1(u,s,p,o)}var xf="_reactListening"+Math.random().toString(36).slice(2);function Ch(s){if(!s[xf]){s[xf]=!0,he.forEach(function(u){u!=="selectionchange"&&(oC.has(u)||bh(u,!1,s),bh(u,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[xf]||(o[xf]=!0,bh("selectionchange",!1,o))}}function a1(s,o,u,p){switch(k1(o)){case 2:var y=FC;break;case 8:y=LC;break;default:y=jh}u=y.bind(null,o,u,s),y=void 0,!Wd||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(y=!0),p?y!==void 0?s.addEventListener(o,u,{capture:!0,passive:y}):s.addEventListener(o,u,!0):y!==void 0?s.addEventListener(o,u,{passive:y}):s.addEventListener(o,u,!1)}function Ah(s,o,u,p,y){var w=p;if((o&1)===0&&(o&2)===0&&p!==null)e:for(;;){if(p===null)return;var N=p.tag;if(N===3||N===4){var L=p.stateNode.containerInfo;if(L===y)break;if(N===4)for(N=p.return;N!==null;){var ne=N.tag;if((ne===3||ne===4)&&N.stateNode.containerInfo===y)return;N=N.return}for(;L!==null;){if(N=z(L),N===null)return;if(ne=N.tag,ne===5||ne===6||ne===26||ne===27){p=w=N;continue e}L=L.parentNode}}p=p.return}fg(function(){var me=w,be=qd(u),ke=[];e:{var ge=Bg.get(s);if(ge!==void 0){var xe=Ru,Qe=s;switch(s){case"keypress":if(ku(u)===0)break e;case"keydown":case"keyup":xe=tb;break;case"focusin":Qe="focus",xe=Zd;break;case"focusout":Qe="blur",xe=Zd;break;case"beforeblur":case"afterblur":xe=Zd;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xe=mg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xe=$S;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xe=ab;break;case Lg:case Og:case Pg:xe=qS;break;case Ug:xe=ib;break;case"scroll":case"scrollend":xe=VS;break;case"wheel":xe=lb;break;case"copy":case"cut":case"paste":xe=WS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xe=gg;break;case"toggle":case"beforetoggle":xe=ub}var Je=(o&4)!==0,Yt=!Je&&(s==="scroll"||s==="scrollend"),ce=Je?ge!==null?ge+"Capture":null:ge;Je=[];for(var ie=me,de;ie!==null;){var Ce=ie;if(de=Ce.stateNode,Ce=Ce.tag,Ce!==5&&Ce!==26&&Ce!==27||de===null||ce===null||(Ce=Al(ie,ce),Ce!=null&&Je.push(cc(ie,Ce,de))),Yt)break;ie=ie.return}0<Je.length&&(ge=new xe(ge,Qe,null,u,be),ke.push({event:ge,listeners:Je}))}}if((o&7)===0){e:{if(ge=s==="mouseover"||s==="pointerover",xe=s==="mouseout"||s==="pointerout",ge&&u!==zd&&(Qe=u.relatedTarget||u.fromElement)&&(z(Qe)||Qe[Vr]))break e;if((xe||ge)&&(ge=be.window===be?be:(ge=be.ownerDocument)?ge.defaultView||ge.parentWindow:window,xe?(Qe=u.relatedTarget||u.toElement,xe=me,Qe=Qe?z(Qe):null,Qe!==null&&(Yt=i(Qe),Je=Qe.tag,Qe!==Yt||Je!==5&&Je!==27&&Je!==6)&&(Qe=null)):(xe=null,Qe=me),xe!==Qe)){if(Je=mg,Ce="onMouseLeave",ce="onMouseEnter",ie="mouse",(s==="pointerout"||s==="pointerover")&&(Je=gg,Ce="onPointerLeave",ce="onPointerEnter",ie="pointer"),Yt=xe==null?ge:fe(xe),de=Qe==null?ge:fe(Qe),ge=new Je(Ce,ie+"leave",xe,u,be),ge.target=Yt,ge.relatedTarget=de,Ce=null,z(be)===me&&(Je=new Je(ce,ie+"enter",Qe,u,be),Je.target=de,Je.relatedTarget=Yt,Ce=Je),Yt=Ce,xe&&Qe)t:{for(Je=xe,ce=Qe,ie=0,de=Je;de;de=Io(de))ie++;for(de=0,Ce=ce;Ce;Ce=Io(Ce))de++;for(;0<ie-de;)Je=Io(Je),ie--;for(;0<de-ie;)ce=Io(ce),de--;for(;ie--;){if(Je===ce||ce!==null&&Je===ce.alternate)break t;Je=Io(Je),ce=Io(ce)}Je=null}else Je=null;xe!==null&&s1(ke,ge,xe,Je,!1),Qe!==null&&Yt!==null&&s1(ke,Yt,Qe,Je,!0)}}e:{if(ge=me?fe(me):window,xe=ge.nodeName&&ge.nodeName.toLowerCase(),xe==="select"||xe==="input"&&ge.type==="file")var He=Sg;else if(Tg(ge))if(bg)He=_b;else{He=vb;var gt=xb}else xe=ge.nodeName,!xe||xe.toLowerCase()!=="input"||ge.type!=="checkbox"&&ge.type!=="radio"?me&&Gd(me.elementType)&&(He=Sg):He=yb;if(He&&(He=He(s,me))){Eg(ke,He,u,be);break e}gt&&gt(s,ge,me),s==="focusout"&&me&&ge.type==="number"&&me.memoizedProps.value!=null&&aa(ge,"number",ge.value)}switch(gt=me?fe(me):window,s){case"focusin":(Tg(gt)||gt.contentEditable==="true")&&(lo=gt,a0=me,Ll=null);break;case"focusout":Ll=a0=lo=null;break;case"mousedown":s0=!0;break;case"contextmenu":case"mouseup":case"dragend":s0=!1,Ig(ke,u,be);break;case"selectionchange":if(Tb)break;case"keydown":case"keyup":Ig(ke,u,be)}var Ye;if(e0)e:{switch(s){case"compositionstart":var Xe="onCompositionStart";break e;case"compositionend":Xe="onCompositionEnd";break e;case"compositionupdate":Xe="onCompositionUpdate";break e}Xe=void 0}else oo?_g(s,u)&&(Xe="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(Xe="onCompositionStart");Xe&&(xg&&u.locale!=="ko"&&(oo||Xe!=="onCompositionStart"?Xe==="onCompositionEnd"&&oo&&(Ye=dg()):(ws=be,Jd="value"in ws?ws.value:ws.textContent,oo=!0)),gt=vf(me,Xe),0<gt.length&&(Xe=new pg(Xe,s,null,u,be),ke.push({event:Xe,listeners:gt}),Ye?Xe.data=Ye:(Ye=wg(u),Ye!==null&&(Xe.data=Ye)))),(Ye=db?hb(s,u):mb(s,u))&&(Xe=vf(me,"onBeforeInput"),0<Xe.length&&(gt=new pg("onBeforeInput","beforeinput",null,u,be),ke.push({event:gt,listeners:Xe}),gt.data=Ye)),aC(ke,s,me,u,be)}r1(ke,o)})}function cc(s,o,u){return{instance:s,listener:o,currentTarget:u}}function vf(s,o){for(var u=o+"Capture",p=[];s!==null;){var y=s,w=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||w===null||(y=Al(s,u),y!=null&&p.unshift(cc(s,y,w)),y=Al(s,o),y!=null&&p.push(cc(s,y,w))),s.tag===3)return p;s=s.return}return[]}function Io(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function s1(s,o,u,p,y){for(var w=o._reactName,N=[];u!==null&&u!==p;){var L=u,ne=L.alternate,me=L.stateNode;if(L=L.tag,ne!==null&&ne===p)break;L!==5&&L!==26&&L!==27||me===null||(ne=me,y?(me=Al(u,w),me!=null&&N.unshift(cc(u,me,ne))):y||(me=Al(u,w),me!=null&&N.push(cc(u,me,ne)))),u=u.return}N.length!==0&&s.push({event:o,listeners:N})}var lC=/\r\n?/g,cC=/\u0000|\uFFFD/g;function i1(s){return(typeof s=="string"?s:""+s).replace(lC,`
`).replace(cC,"")}function o1(s,o){return o=i1(o),i1(s)===o}function yf(){}function qt(s,o,u,p,y,w){switch(u){case"children":typeof p=="string"?o==="body"||o==="textarea"&&p===""||ao(s,p):(typeof p=="number"||typeof p=="bigint")&&o!=="body"&&ao(s,""+p);break;case"className":Pe(s,"class",p);break;case"tabIndex":Pe(s,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Pe(s,u,p);break;case"style":cg(s,p,w);break;case"data":if(o!=="object"){Pe(s,"data",p);break}case"src":case"href":if(p===""&&(o!=="a"||u!=="href")){s.removeAttribute(u);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){s.removeAttribute(u);break}p=Cu(""+p),s.setAttribute(u,p);break;case"action":case"formAction":if(typeof p=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(u==="formAction"?(o!=="input"&&qt(s,o,"name",y.name,y,null),qt(s,o,"formEncType",y.formEncType,y,null),qt(s,o,"formMethod",y.formMethod,y,null),qt(s,o,"formTarget",y.formTarget,y,null)):(qt(s,o,"encType",y.encType,y,null),qt(s,o,"method",y.method,y,null),qt(s,o,"target",y.target,y,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){s.removeAttribute(u);break}p=Cu(""+p),s.setAttribute(u,p);break;case"onClick":p!=null&&(s.onclick=yf);break;case"onScroll":p!=null&&Tt("scroll",s);break;case"onScrollEnd":p!=null&&Tt("scrollend",s);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(u=p.__html,u!=null){if(y.children!=null)throw Error(r(60));s.innerHTML=u}}break;case"multiple":s.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":s.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){s.removeAttribute("xlink:href");break}u=Cu(""+p),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(u,""+p):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":p===!0?s.setAttribute(u,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(u,p):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?s.setAttribute(u,p):s.removeAttribute(u);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?s.removeAttribute(u):s.setAttribute(u,p);break;case"popover":Tt("beforetoggle",s),Tt("toggle",s),Ae(s,"popover",p);break;case"xlinkActuate":Ve(s,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Ve(s,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Ve(s,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Ve(s,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Ve(s,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Ve(s,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Ve(s,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Ve(s,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Ve(s,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Ae(s,"is",p);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=BS.get(u)||u,Ae(s,u,p))}}function kh(s,o,u,p,y,w){switch(u){case"style":cg(s,p,w);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(u=p.__html,u!=null){if(y.children!=null)throw Error(r(60));s.innerHTML=u}}break;case"children":typeof p=="string"?ao(s,p):(typeof p=="number"||typeof p=="bigint")&&ao(s,""+p);break;case"onScroll":p!=null&&Tt("scroll",s);break;case"onScrollEnd":p!=null&&Tt("scrollend",s);break;case"onClick":p!=null&&(s.onclick=yf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!pe.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(y=u.endsWith("Capture"),o=u.slice(2,y?u.length-7:void 0),w=s[dn]||null,w=w!=null?w[u]:null,typeof w=="function"&&s.removeEventListener(o,w,y),typeof p=="function")){typeof w!="function"&&w!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(o,p,y);break e}u in s?s[u]=p:p===!0?s.setAttribute(u,""):Ae(s,u,p)}}}function Wn(s,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Tt("error",s),Tt("load",s);var p=!1,y=!1,w;for(w in u)if(u.hasOwnProperty(w)){var N=u[w];if(N!=null)switch(w){case"src":p=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:qt(s,o,w,N,u,null)}}y&&qt(s,o,"srcSet",u.srcSet,u,null),p&&qt(s,o,"src",u.src,u,null);return;case"input":Tt("invalid",s);var L=w=N=y=null,ne=null,me=null;for(p in u)if(u.hasOwnProperty(p)){var be=u[p];if(be!=null)switch(p){case"name":y=be;break;case"type":N=be;break;case"checked":ne=be;break;case"defaultChecked":me=be;break;case"value":w=be;break;case"defaultValue":L=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(r(137,o));break;default:qt(s,o,p,be,u,null)}}li(s,w,L,ne,me,N,y,!1),_s(s);return;case"select":Tt("invalid",s),p=N=w=null;for(y in u)if(u.hasOwnProperty(y)&&(L=u[y],L!=null))switch(y){case"value":w=L;break;case"defaultValue":N=L;break;case"multiple":p=L;default:qt(s,o,y,L,u,null)}o=w,u=N,s.multiple=!!p,o!=null?Ar(s,!!p,o,!1):u!=null&&Ar(s,!!p,u,!0);return;case"textarea":Tt("invalid",s),w=y=p=null;for(N in u)if(u.hasOwnProperty(N)&&(L=u[N],L!=null))switch(N){case"value":p=L;break;case"defaultValue":y=L;break;case"children":w=L;break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(r(91));break;default:qt(s,o,N,L,u,null)}og(s,p,y,w),_s(s);return;case"option":for(ne in u)if(u.hasOwnProperty(ne)&&(p=u[ne],p!=null))switch(ne){case"selected":s.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:qt(s,o,ne,p,u,null)}return;case"dialog":Tt("beforetoggle",s),Tt("toggle",s),Tt("cancel",s),Tt("close",s);break;case"iframe":case"object":Tt("load",s);break;case"video":case"audio":for(p=0;p<lc.length;p++)Tt(lc[p],s);break;case"image":Tt("error",s),Tt("load",s);break;case"details":Tt("toggle",s);break;case"embed":case"source":case"link":Tt("error",s),Tt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(me in u)if(u.hasOwnProperty(me)&&(p=u[me],p!=null))switch(me){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:qt(s,o,me,p,u,null)}return;default:if(Gd(o)){for(be in u)u.hasOwnProperty(be)&&(p=u[be],p!==void 0&&kh(s,o,be,p,u,void 0));return}}for(L in u)u.hasOwnProperty(L)&&(p=u[L],p!=null&&qt(s,o,L,p,u,null))}function uC(s,o,u,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,w=null,N=null,L=null,ne=null,me=null,be=null;for(xe in u){var ke=u[xe];if(u.hasOwnProperty(xe)&&ke!=null)switch(xe){case"checked":break;case"value":break;case"defaultValue":ne=ke;default:p.hasOwnProperty(xe)||qt(s,o,xe,null,p,ke)}}for(var ge in p){var xe=p[ge];if(ke=u[ge],p.hasOwnProperty(ge)&&(xe!=null||ke!=null))switch(ge){case"type":w=xe;break;case"name":y=xe;break;case"checked":me=xe;break;case"defaultChecked":be=xe;break;case"value":N=xe;break;case"defaultValue":L=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(r(137,o));break;default:xe!==ke&&qt(s,o,ge,xe,p,ke)}}Nn(s,N,L,ne,me,be,w,y);return;case"select":xe=N=L=ge=null;for(w in u)if(ne=u[w],u.hasOwnProperty(w)&&ne!=null)switch(w){case"value":break;case"multiple":xe=ne;default:p.hasOwnProperty(w)||qt(s,o,w,null,p,ne)}for(y in p)if(w=p[y],ne=u[y],p.hasOwnProperty(y)&&(w!=null||ne!=null))switch(y){case"value":ge=w;break;case"defaultValue":L=w;break;case"multiple":N=w;default:w!==ne&&qt(s,o,y,w,p,ne)}o=L,u=N,p=xe,ge!=null?Ar(s,!!u,ge,!1):!!p!=!!u&&(o!=null?Ar(s,!!u,o,!0):Ar(s,!!u,u?[]:"",!1));return;case"textarea":xe=ge=null;for(L in u)if(y=u[L],u.hasOwnProperty(L)&&y!=null&&!p.hasOwnProperty(L))switch(L){case"value":break;case"children":break;default:qt(s,o,L,null,p,y)}for(N in p)if(y=p[N],w=u[N],p.hasOwnProperty(N)&&(y!=null||w!=null))switch(N){case"value":ge=y;break;case"defaultValue":xe=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(r(91));break;default:y!==w&&qt(s,o,N,y,p,w)}bu(s,ge,xe);return;case"option":for(var Qe in u)if(ge=u[Qe],u.hasOwnProperty(Qe)&&ge!=null&&!p.hasOwnProperty(Qe))switch(Qe){case"selected":s.selected=!1;break;default:qt(s,o,Qe,null,p,ge)}for(ne in p)if(ge=p[ne],xe=u[ne],p.hasOwnProperty(ne)&&ge!==xe&&(ge!=null||xe!=null))switch(ne){case"selected":s.selected=ge&&typeof ge!="function"&&typeof ge!="symbol";break;default:qt(s,o,ne,ge,p,xe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Je in u)ge=u[Je],u.hasOwnProperty(Je)&&ge!=null&&!p.hasOwnProperty(Je)&&qt(s,o,Je,null,p,ge);for(me in p)if(ge=p[me],xe=u[me],p.hasOwnProperty(me)&&ge!==xe&&(ge!=null||xe!=null))switch(me){case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,o));break;default:qt(s,o,me,ge,p,xe)}return;default:if(Gd(o)){for(var Yt in u)ge=u[Yt],u.hasOwnProperty(Yt)&&ge!==void 0&&!p.hasOwnProperty(Yt)&&kh(s,o,Yt,void 0,p,ge);for(be in p)ge=p[be],xe=u[be],!p.hasOwnProperty(be)||ge===xe||ge===void 0&&xe===void 0||kh(s,o,be,ge,p,xe);return}}for(var ce in u)ge=u[ce],u.hasOwnProperty(ce)&&ge!=null&&!p.hasOwnProperty(ce)&&qt(s,o,ce,null,p,ge);for(ke in p)ge=p[ke],xe=u[ke],!p.hasOwnProperty(ke)||ge===xe||ge==null&&xe==null||qt(s,o,ke,ge,p,xe)}var Nh=null,Rh=null;function _f(s){return s.nodeType===9?s:s.ownerDocument}function l1(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function c1(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function Dh(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Mh=null;function fC(){var s=window.event;return s&&s.type==="popstate"?s===Mh?!1:(Mh=s,!0):(Mh=null,!1)}var u1=typeof setTimeout=="function"?setTimeout:void 0,dC=typeof clearTimeout=="function"?clearTimeout:void 0,f1=typeof Promise=="function"?Promise:void 0,hC=typeof queueMicrotask=="function"?queueMicrotask:typeof f1<"u"?function(s){return f1.resolve(null).then(s).catch(mC)}:u1;function mC(s){setTimeout(function(){throw s})}function Ps(s){return s==="head"}function d1(s,o){var u=o,p=0,y=0;do{var w=u.nextSibling;if(s.removeChild(u),w&&w.nodeType===8)if(u=w.data,u==="/$"){if(0<p&&8>p){u=p;var N=s.ownerDocument;if(u&1&&uc(N.documentElement),u&2&&uc(N.body),u&4)for(u=N.head,uc(u),N=u.firstChild;N;){var L=N.nextSibling,ne=N.nodeName;N[O]||ne==="SCRIPT"||ne==="STYLE"||ne==="LINK"&&N.rel.toLowerCase()==="stylesheet"||u.removeChild(N),N=L}}if(y===0){s.removeChild(w),vc(o);return}y--}else u==="$"||u==="$?"||u==="$!"?y++:p=u.charCodeAt(0)-48;else p=0;u=w}while(u);vc(o)}function Ih(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Ih(u),H(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function pC(s,o,u,p){for(;s.nodeType===1;){var y=u;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!p&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(p){if(!s[O])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(w=s.getAttribute("rel"),w==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(w!==y.rel||s.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||s.getAttribute("title")!==(y.title==null?null:y.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(w=s.getAttribute("src"),(w!==(y.src==null?null:y.src)||s.getAttribute("type")!==(y.type==null?null:y.type)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&w&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var w=y.name==null?null:""+y.name;if(y.type==="hidden"&&s.getAttribute("name")===w)return s}else return s;if(s=oa(s.nextSibling),s===null)break}return null}function gC(s,o,u){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=oa(s.nextSibling),s===null))return null;return s}function Fh(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function xC(s,o){var u=s.ownerDocument;if(s.data!=="$?"||u.readyState==="complete")o();else{var p=function(){o(),u.removeEventListener("DOMContentLoaded",p)};u.addEventListener("DOMContentLoaded",p),s._reactRetry=p}}function oa(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return s}var Lh=null;function h1(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return s;o--}else u==="/$"&&o++}s=s.previousSibling}return null}function m1(s,o,u){switch(o=_f(u),s){case"html":if(s=o.documentElement,!s)throw Error(r(452));return s;case"head":if(s=o.head,!s)throw Error(r(453));return s;case"body":if(s=o.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function uc(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);H(s)}var Jr=new Map,p1=new Set;function wf(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ns=ue.d;ue.d={f:vC,r:yC,D:_C,C:wC,L:TC,m:EC,X:bC,S:SC,M:CC};function vC(){var s=ns.f(),o=df();return s||o}function yC(s){var o=q(s);o!==null&&o.tag===5&&o.type==="form"?Lx(o):ns.r(s)}var Fo=typeof document>"u"?null:document;function g1(s,o,u){var p=Fo;if(p&&typeof o=="string"&&o){var y=_t(o);y='link[rel="'+s+'"][href="'+y+'"]',typeof u=="string"&&(y+='[crossorigin="'+u+'"]'),p1.has(y)||(p1.add(y),s={rel:s,crossOrigin:u,href:o},p.querySelector(y)===null&&(o=p.createElement("link"),Wn(o,"link",s),le(o),p.head.appendChild(o)))}}function _C(s){ns.D(s),g1("dns-prefetch",s,null)}function wC(s,o){ns.C(s,o),g1("preconnect",s,o)}function TC(s,o,u){ns.L(s,o,u);var p=Fo;if(p&&s&&o){var y='link[rel="preload"][as="'+_t(o)+'"]';o==="image"&&u&&u.imageSrcSet?(y+='[imagesrcset="'+_t(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(y+='[imagesizes="'+_t(u.imageSizes)+'"]')):y+='[href="'+_t(s)+'"]';var w=y;switch(o){case"style":w=Lo(s);break;case"script":w=Oo(s)}Jr.has(w)||(s=g({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:s,as:o},u),Jr.set(w,s),p.querySelector(y)!==null||o==="style"&&p.querySelector(fc(w))||o==="script"&&p.querySelector(dc(w))||(o=p.createElement("link"),Wn(o,"link",s),le(o),p.head.appendChild(o)))}}function EC(s,o){ns.m(s,o);var u=Fo;if(u&&s){var p=o&&typeof o.as=="string"?o.as:"script",y='link[rel="modulepreload"][as="'+_t(p)+'"][href="'+_t(s)+'"]',w=y;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Oo(s)}if(!Jr.has(w)&&(s=g({rel:"modulepreload",href:s},o),Jr.set(w,s),u.querySelector(y)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(dc(w)))return}p=u.createElement("link"),Wn(p,"link",s),le(p),u.head.appendChild(p)}}}function SC(s,o,u){ns.S(s,o,u);var p=Fo;if(p&&s){var y=ye(p).hoistableStyles,w=Lo(s);o=o||"default";var N=y.get(w);if(!N){var L={loading:0,preload:null};if(N=p.querySelector(fc(w)))L.loading=5;else{s=g({rel:"stylesheet",href:s,"data-precedence":o},u),(u=Jr.get(w))&&Oh(s,u);var ne=N=p.createElement("link");le(ne),Wn(ne,"link",s),ne._p=new Promise(function(me,be){ne.onload=me,ne.onerror=be}),ne.addEventListener("load",function(){L.loading|=1}),ne.addEventListener("error",function(){L.loading|=2}),L.loading|=4,Tf(N,o,p)}N={type:"stylesheet",instance:N,count:1,state:L},y.set(w,N)}}}function bC(s,o){ns.X(s,o);var u=Fo;if(u&&s){var p=ye(u).hoistableScripts,y=Oo(s),w=p.get(y);w||(w=u.querySelector(dc(y)),w||(s=g({src:s,async:!0},o),(o=Jr.get(y))&&Ph(s,o),w=u.createElement("script"),le(w),Wn(w,"link",s),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},p.set(y,w))}}function CC(s,o){ns.M(s,o);var u=Fo;if(u&&s){var p=ye(u).hoistableScripts,y=Oo(s),w=p.get(y);w||(w=u.querySelector(dc(y)),w||(s=g({src:s,async:!0,type:"module"},o),(o=Jr.get(y))&&Ph(s,o),w=u.createElement("script"),le(w),Wn(w,"link",s),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},p.set(y,w))}}function x1(s,o,u,p){var y=(y=oe.current)?wf(y):null;if(!y)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Lo(u.href),u=ye(y).hoistableStyles,p=u.get(o),p||(p={type:"style",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=Lo(u.href);var w=ye(y).hoistableStyles,N=w.get(s);if(N||(y=y.ownerDocument||y,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(s,N),(w=y.querySelector(fc(s)))&&!w._p&&(N.instance=w,N.state.loading=5),Jr.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Jr.set(s,u),w||AC(y,s,u,N.state))),o&&p===null)throw Error(r(528,""));return N}if(o&&p!==null)throw Error(r(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Oo(u),u=ye(y).hoistableScripts,p=u.get(o),p||(p={type:"script",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Lo(s){return'href="'+_t(s)+'"'}function fc(s){return'link[rel="stylesheet"]['+s+"]"}function v1(s){return g({},s,{"data-precedence":s.precedence,precedence:null})}function AC(s,o,u,p){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?p.loading=1:(o=s.createElement("link"),p.preload=o,o.addEventListener("load",function(){return p.loading|=1}),o.addEventListener("error",function(){return p.loading|=2}),Wn(o,"link",u),le(o),s.head.appendChild(o))}function Oo(s){return'[src="'+_t(s)+'"]'}function dc(s){return"script[async]"+s}function y1(s,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var p=s.querySelector('style[data-href~="'+_t(u.href)+'"]');if(p)return o.instance=p,le(p),p;var y=g({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return p=(s.ownerDocument||s).createElement("style"),le(p),Wn(p,"style",y),Tf(p,u.precedence,s),o.instance=p;case"stylesheet":y=Lo(u.href);var w=s.querySelector(fc(y));if(w)return o.state.loading|=4,o.instance=w,le(w),w;p=v1(u),(y=Jr.get(y))&&Oh(p,y),w=(s.ownerDocument||s).createElement("link"),le(w);var N=w;return N._p=new Promise(function(L,ne){N.onload=L,N.onerror=ne}),Wn(w,"link",p),o.state.loading|=4,Tf(w,u.precedence,s),o.instance=w;case"script":return w=Oo(u.src),(y=s.querySelector(dc(w)))?(o.instance=y,le(y),y):(p=u,(y=Jr.get(w))&&(p=g({},u),Ph(p,y)),s=s.ownerDocument||s,y=s.createElement("script"),le(y),Wn(y,"link",p),s.head.appendChild(y),o.instance=y);case"void":return null;default:throw Error(r(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(p=o.instance,o.state.loading|=4,Tf(p,u.precedence,s));return o.instance}function Tf(s,o,u){for(var p=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=p.length?p[p.length-1]:null,w=y,N=0;N<p.length;N++){var L=p[N];if(L.dataset.precedence===o)w=L;else if(w!==y)break}w?w.parentNode.insertBefore(s,w.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(s,o.firstChild))}function Oh(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function Ph(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var Ef=null;function _1(s,o,u){if(Ef===null){var p=new Map,y=Ef=new Map;y.set(u,p)}else y=Ef,p=y.get(u),p||(p=new Map,y.set(u,p));if(p.has(s))return p;for(p.set(s,null),u=u.getElementsByTagName(s),y=0;y<u.length;y++){var w=u[y];if(!(w[O]||w[fn]||s==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var N=w.getAttribute(o)||"";N=s+N;var L=p.get(N);L?L.push(w):p.set(N,[w])}}return p}function w1(s,o,u){s=s.ownerDocument||s,s.head.insertBefore(u,o==="title"?s.querySelector("head > title"):null)}function kC(s,o,u){if(u===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function T1(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var hc=null;function NC(){}function RC(s,o,u){if(hc===null)throw Error(r(475));var p=hc;if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var y=Lo(u.href),w=s.querySelector(fc(y));if(w){s=w._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(p.count++,p=Sf.bind(p),s.then(p,p)),o.state.loading|=4,o.instance=w,le(w);return}w=s.ownerDocument||s,u=v1(u),(y=Jr.get(y))&&Oh(u,y),w=w.createElement("link"),le(w);var N=w;N._p=new Promise(function(L,ne){N.onload=L,N.onerror=ne}),Wn(w,"link",u),o.instance=w}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(p.count++,o=Sf.bind(p),s.addEventListener("load",o),s.addEventListener("error",o))}}function DC(){if(hc===null)throw Error(r(475));var s=hc;return s.stylesheets&&s.count===0&&Uh(s,s.stylesheets),0<s.count?function(o){var u=setTimeout(function(){if(s.stylesheets&&Uh(s,s.stylesheets),s.unsuspend){var p=s.unsuspend;s.unsuspend=null,p()}},6e4);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(u)}}:null}function Sf(){if(this.count--,this.count===0){if(this.stylesheets)Uh(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var bf=null;function Uh(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,bf=new Map,o.forEach(MC,s),bf=null,Sf.call(s))}function MC(s,o){if(!(o.state.loading&4)){var u=bf.get(s);if(u)var p=u.get(null);else{u=new Map,bf.set(s,u);for(var y=s.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<y.length;w++){var N=y[w];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(u.set(N.dataset.precedence,N),p=N)}p&&u.set(null,p)}y=o.instance,N=y.getAttribute("data-precedence"),w=u.get(N)||p,w===p&&u.set(null,y),u.set(N,y),this.count++,p=Sf.bind(this),y.addEventListener("load",p),y.addEventListener("error",p),w?w.parentNode.insertBefore(y,w.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(y,s.firstChild)),o.state.loading|=4}}var mc={$$typeof:C,Provider:null,Consumer:null,_currentValue:ae,_currentValue2:ae,_threadCount:0};function IC(s,o,u,p,y,w,N,L){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=jr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jr(0),this.hiddenUpdates=jr(null),this.identifierPrefix=p,this.onUncaughtError=y,this.onCaughtError=w,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=L,this.incompleteTransitions=new Map}function E1(s,o,u,p,y,w,N,L,ne,me,be,ke){return s=new IC(s,o,u,N,L,ne,me,ke),o=1,w===!0&&(o|=24),w=Nr(3,null,null,o),s.current=w,w.stateNode=s,o=y0(),o.refCount++,s.pooledCache=o,o.refCount++,w.memoizedState={element:p,isDehydrated:u,cache:o},E0(w),s}function S1(s){return s?(s=ho,s):ho}function b1(s,o,u,p,y,w){y=S1(y),p.context===null?p.context=y:p.pendingContext=y,p=Ss(o),p.payload={element:u},w=w===void 0?null:w,w!==null&&(p.callback=w),u=bs(s,p,o),u!==null&&(Fr(u,s,o),Gl(u,s,o))}function C1(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<o?u:o}}function Bh(s,o){C1(s,o),(s=s.alternate)&&C1(s,o)}function A1(s){if(s.tag===13){var o=fo(s,67108864);o!==null&&Fr(o,s,67108864),Bh(s,67108864)}}var Cf=!0;function FC(s,o,u,p){var y=se.T;se.T=null;var w=ue.p;try{ue.p=2,jh(s,o,u,p)}finally{ue.p=w,se.T=y}}function LC(s,o,u,p){var y=se.T;se.T=null;var w=ue.p;try{ue.p=8,jh(s,o,u,p)}finally{ue.p=w,se.T=y}}function jh(s,o,u,p){if(Cf){var y=Vh(p);if(y===null)Ah(s,o,p,Af,u),N1(s,p);else if(PC(y,s,o,u,p))p.stopPropagation();else if(N1(s,p),o&4&&-1<OC.indexOf(s)){for(;y!==null;){var w=q(y);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var N=Oe(w.pendingLanes);if(N!==0){var L=w;for(L.pendingLanes|=2,L.entangledLanes|=2;N;){var ne=1<<31-it(N);L.entanglements[1]|=ne,N&=~ne}ba(w),(Vt&6)===0&&(uf=Ie()+500,oc(0))}}break;case 13:L=fo(w,2),L!==null&&Fr(L,w,2),df(),Bh(w,2)}if(w=Vh(p),w===null&&Ah(s,o,p,Af,u),w===y)break;y=w}y!==null&&p.stopPropagation()}else Ah(s,o,p,null,u)}}function Vh(s){return s=qd(s),Hh(s)}var Af=null;function Hh(s){if(Af=null,s=z(s),s!==null){var o=i(s);if(o===null)s=null;else{var u=o.tag;if(u===13){if(s=l(o),s!==null)return s;s=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return Af=s,null}function k1(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Bt()){case an:return 2;case sn:return 8;case un:case On:return 32;case vt:return 268435456;default:return 32}default:return 32}}var $h=!1,Us=null,Bs=null,js=null,pc=new Map,gc=new Map,Vs=[],OC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function N1(s,o){switch(s){case"focusin":case"focusout":Us=null;break;case"dragenter":case"dragleave":Bs=null;break;case"mouseover":case"mouseout":js=null;break;case"pointerover":case"pointerout":pc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":gc.delete(o.pointerId)}}function xc(s,o,u,p,y,w){return s===null||s.nativeEvent!==w?(s={blockedOn:o,domEventName:u,eventSystemFlags:p,nativeEvent:w,targetContainers:[y]},o!==null&&(o=q(o),o!==null&&A1(o)),s):(s.eventSystemFlags|=p,o=s.targetContainers,y!==null&&o.indexOf(y)===-1&&o.push(y),s)}function PC(s,o,u,p,y){switch(o){case"focusin":return Us=xc(Us,s,o,u,p,y),!0;case"dragenter":return Bs=xc(Bs,s,o,u,p,y),!0;case"mouseover":return js=xc(js,s,o,u,p,y),!0;case"pointerover":var w=y.pointerId;return pc.set(w,xc(pc.get(w)||null,s,o,u,p,y)),!0;case"gotpointercapture":return w=y.pointerId,gc.set(w,xc(gc.get(w)||null,s,o,u,p,y)),!0}return!1}function R1(s){var o=z(s.target);if(o!==null){var u=i(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){s.blockedOn=o,ii(s.priority,function(){if(u.tag===13){var p=Ir();p=Va(p);var y=fo(u,p);y!==null&&Fr(y,u,p),Bh(u,p)}});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function kf(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var u=Vh(s.nativeEvent);if(u===null){u=s.nativeEvent;var p=new u.constructor(u.type,u);zd=p,u.target.dispatchEvent(p),zd=null}else return o=q(u),o!==null&&A1(o),s.blockedOn=u,!1;o.shift()}return!0}function D1(s,o,u){kf(s)&&u.delete(o)}function UC(){$h=!1,Us!==null&&kf(Us)&&(Us=null),Bs!==null&&kf(Bs)&&(Bs=null),js!==null&&kf(js)&&(js=null),pc.forEach(D1),gc.forEach(D1)}function Nf(s,o){s.blockedOn===o&&(s.blockedOn=null,$h||($h=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,UC)))}var Rf=null;function M1(s){Rf!==s&&(Rf=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Rf===s&&(Rf=null);for(var o=0;o<s.length;o+=3){var u=s[o],p=s[o+1],y=s[o+2];if(typeof p!="function"){if(Hh(p||u)===null)continue;break}var w=q(u);w!==null&&(s.splice(o,3),o-=3,H0(w,{pending:!0,data:y,method:u.method,action:p},p,y))}}))}function vc(s){function o(ne){return Nf(ne,s)}Us!==null&&Nf(Us,s),Bs!==null&&Nf(Bs,s),js!==null&&Nf(js,s),pc.forEach(o),gc.forEach(o);for(var u=0;u<Vs.length;u++){var p=Vs[u];p.blockedOn===s&&(p.blockedOn=null)}for(;0<Vs.length&&(u=Vs[0],u.blockedOn===null);)R1(u),u.blockedOn===null&&Vs.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(p=0;p<u.length;p+=3){var y=u[p],w=u[p+1],N=y[dn]||null;if(typeof w=="function")N||M1(u);else if(N){var L=null;if(w&&w.hasAttribute("formAction")){if(y=w,N=w[dn]||null)L=N.formAction;else if(Hh(y)!==null)continue}else L=N.action;typeof L=="function"?u[p+1]=L:(u.splice(p,3),p-=3),M1(u)}}}function Gh(s){this._internalRoot=s}Df.prototype.render=Gh.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(r(409));var u=o.current,p=Ir();b1(u,p,s,o,null,null)},Df.prototype.unmount=Gh.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;b1(s.current,2,null,s,null,null),df(),o[Vr]=null}};function Df(s){this._internalRoot=s}Df.prototype.unstable_scheduleHydration=function(s){if(s){var o=vs();s={blockedOn:null,target:s,priority:o};for(var u=0;u<Vs.length&&o!==0&&o<Vs[u].priority;u++);Vs.splice(u,0,s),u===0&&R1(s)}};var I1=e.version;if(I1!=="19.1.0")throw Error(r(527,I1,"19.1.0"));ue.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=d(o),s=s!==null?f(s):null,s=s===null?null:s.stateNode,s};var BC={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:se,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mf.isDisabled&&Mf.supportsFiber)try{yn=Mf.inject(BC),Qt=Mf}catch{}}return _c.createRoot=function(s,o){if(!a(s))throw Error(r(299));var u=!1,p="",y=Jx,w=Kx,N=Xx,L=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(N=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(L=o.unstable_transitionCallbacks)),o=E1(s,1,!1,null,null,u,p,y,w,N,L,null),s[Vr]=o.current,Ch(s),new Gh(o)},_c.hydrateRoot=function(s,o,u){if(!a(s))throw Error(r(299));var p=!1,y="",w=Jx,N=Kx,L=Xx,ne=null,me=null;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onUncaughtError!==void 0&&(w=u.onUncaughtError),u.onCaughtError!==void 0&&(N=u.onCaughtError),u.onRecoverableError!==void 0&&(L=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(ne=u.unstable_transitionCallbacks),u.formState!==void 0&&(me=u.formState)),o=E1(s,1,!0,o,u??null,p,y,w,N,L,ne,me),o.context=S1(null),u=o.current,p=Ir(),p=Va(p),y=Ss(p),y.callback=null,bs(u,y,p),u=p,o.current.lanes=u,ra(o,u),ba(o),s[Vr]=o.current,Ch(s),new Df(o)},_c.version="19.1.0",_c}var $1;function KC(){if($1)return Yh.exports;$1=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Yh.exports=JC(),Yh.exports}var XC=KC();const ZC=up(XC);var wc={},G1;function QC(){if(G1)return wc;G1=1,Object.defineProperty(wc,"__esModule",{value:!0}),wc.parse=l,wc.serialize=f;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,i=(()=>{const _=function(){};return _.prototype=Object.create(null),_})();function l(_,T){const E=new i,S=_.length;if(S<2)return E;const b=(T==null?void 0:T.decode)||g;let k=0;do{const A=_.indexOf("=",k);if(A===-1)break;const C=_.indexOf(";",k),I=C===-1?S:C;if(A>I){k=_.lastIndexOf(";",A-1)+1;continue}const B=c(_,k,A),j=d(_,A,B),F=_.slice(B,j);if(E[F]===void 0){let X=c(_,A+1,I),P=d(_,I,X);const re=b(_.slice(X,P));E[F]=re}k=I+1}while(k<S);return E}function c(_,T,E){do{const S=_.charCodeAt(T);if(S!==32&&S!==9)return T}while(++T<E);return E}function d(_,T,E){for(;T>E;){const S=_.charCodeAt(--T);if(S!==32&&S!==9)return T+1}return E}function f(_,T,E){const S=(E==null?void 0:E.encode)||encodeURIComponent;if(!t.test(_))throw new TypeError(`argument name is invalid: ${_}`);const b=S(T);if(!e.test(b))throw new TypeError(`argument val is invalid: ${T}`);let k=_+"="+b;if(!E)return k;if(E.maxAge!==void 0){if(!Number.isInteger(E.maxAge))throw new TypeError(`option maxAge is invalid: ${E.maxAge}`);k+="; Max-Age="+E.maxAge}if(E.domain){if(!n.test(E.domain))throw new TypeError(`option domain is invalid: ${E.domain}`);k+="; Domain="+E.domain}if(E.path){if(!r.test(E.path))throw new TypeError(`option path is invalid: ${E.path}`);k+="; Path="+E.path}if(E.expires){if(!v(E.expires)||!Number.isFinite(E.expires.valueOf()))throw new TypeError(`option expires is invalid: ${E.expires}`);k+="; Expires="+E.expires.toUTCString()}if(E.httpOnly&&(k+="; HttpOnly"),E.secure&&(k+="; Secure"),E.partitioned&&(k+="; Partitioned"),E.priority)switch(typeof E.priority=="string"?E.priority.toLowerCase():void 0){case"low":k+="; Priority=Low";break;case"medium":k+="; Priority=Medium";break;case"high":k+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${E.priority}`)}if(E.sameSite)switch(typeof E.sameSite=="string"?E.sameSite.toLowerCase():E.sameSite){case!0:case"strict":k+="; SameSite=Strict";break;case"lax":k+="; SameSite=Lax";break;case"none":k+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${E.sameSite}`)}return k}function g(_){if(_.indexOf("%")===-1)return _;try{return decodeURIComponent(_)}catch{return _}}function v(_){return a.call(_)==="[object Date]"}return wc}QC();var z1="popstate";function eA(t={}){function e(r,a){let{pathname:i,search:l,hash:c}=r.location;return Tm("",{pathname:i,search:l,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:Wc(a)}return nA(e,n,null,t)}function cn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ia(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function tA(){return Math.random().toString(36).substring(2,10)}function q1(t,e){return{usr:t.state,key:t.key,idx:e}}function Tm(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?pl(e):e,state:n,key:e&&e.key||r||tA()}}function Wc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function pl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function nA(t,e,n,r={}){let{window:a=document.defaultView,v5Compat:i=!1}=r,l=a.history,c="POP",d=null,f=g();f==null&&(f=0,l.replaceState({...l.state,idx:f},""));function g(){return(l.state||{idx:null}).idx}function v(){c="POP";let b=g(),k=b==null?null:b-f;f=b,d&&d({action:c,location:S.location,delta:k})}function _(b,k){c="PUSH";let A=Tm(S.location,b,k);f=g()+1;let C=q1(A,f),I=S.createHref(A);try{l.pushState(C,"",I)}catch(B){if(B instanceof DOMException&&B.name==="DataCloneError")throw B;a.location.assign(I)}i&&d&&d({action:c,location:S.location,delta:1})}function T(b,k){c="REPLACE";let A=Tm(S.location,b,k);f=g();let C=q1(A,f),I=S.createHref(A);l.replaceState(C,"",I),i&&d&&d({action:c,location:S.location,delta:0})}function E(b){return rA(b)}let S={get action(){return c},get location(){return t(a,l)},listen(b){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(z1,v),d=b,()=>{a.removeEventListener(z1,v),d=null}},createHref(b){return e(a,b)},createURL:E,encodeLocation(b){let k=E(b);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:_,replace:T,go(b){return l.go(b)}};return S}function rA(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),cn(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Wc(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function yT(t,e,n="/"){return aA(t,e,n,!1)}function aA(t,e,n,r){let a=typeof e=="string"?pl(e):e,i=us(a.pathname||"/",n);if(i==null)return null;let l=_T(t);sA(l);let c=null;for(let d=0;c==null&&d<l.length;++d){let f=gA(i);c=mA(l[d],f,r)}return c}function _T(t,e=[],n=[],r=""){let a=(i,l,c)=>{let d={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};d.relativePath.startsWith("/")&&(cn(d.relativePath.startsWith(r),`Absolute route path "${d.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(r.length));let f=is([r,d.relativePath]),g=n.concat(d);i.children&&i.children.length>0&&(cn(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),_T(i.children,e,g,f)),!(i.path==null&&!i.index)&&e.push({path:f,score:dA(f,i.index),routesMeta:g})};return t.forEach((i,l)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))a(i,l);else for(let d of wT(i.path))a(i,l,d)}),e}function wT(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return a?[i,""]:[i];let l=wT(r.join("/")),c=[];return c.push(...l.map(d=>d===""?i:[i,d].join("/"))),a&&c.push(...l),c.map(d=>t.startsWith("/")&&d===""?"/":d)}function sA(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:hA(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var iA=/^:[\w-]+$/,oA=3,lA=2,cA=1,uA=10,fA=-2,Y1=t=>t==="*";function dA(t,e){let n=t.split("/"),r=n.length;return n.some(Y1)&&(r+=fA),e&&(r+=lA),n.filter(a=>!Y1(a)).reduce((a,i)=>a+(iA.test(i)?oA:i===""?cA:uA),r)}function hA(t,e){return t.length===e.length&&t.slice(0,-1).every((r,a)=>r===e[a])?t[t.length-1]-e[e.length-1]:0}function mA(t,e,n=!1){let{routesMeta:r}=t,a={},i="/",l=[];for(let c=0;c<r.length;++c){let d=r[c],f=c===r.length-1,g=i==="/"?e:e.slice(i.length)||"/",v=rd({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},g),_=d.route;if(!v&&f&&n&&!r[r.length-1].route.index&&(v=rd({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},g)),!v)return null;Object.assign(a,v.params),l.push({params:a,pathname:is([i,v.pathname]),pathnameBase:_A(is([i,v.pathnameBase])),route:_}),v.pathnameBase!=="/"&&(i=is([i,v.pathnameBase]))}return l}function rd(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=pA(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let i=a[0],l=i.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:r.reduce((f,{paramName:g,isOptional:v},_)=>{if(g==="*"){let E=c[_]||"";l=i.slice(0,i.length-E.length).replace(/(.)\/+$/,"$1")}const T=c[_];return v&&!T?f[g]=void 0:f[g]=(T||"").replace(/%2F/g,"/"),f},{}),pathname:i,pathnameBase:l,pattern:t}}function pA(t,e=!1,n=!0){Ia(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,c,d)=>(r.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function gA(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ia(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function us(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function xA(t,e="/"){let{pathname:n,search:r="",hash:a=""}=typeof t=="string"?pl(t):t;return{pathname:n?n.startsWith("/")?n:vA(n,e):e,search:wA(r),hash:TA(a)}}function vA(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function Xh(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function yA(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function TT(t){let e=yA(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function ET(t,e,n,r=!1){let a;typeof t=="string"?a=pl(t):(a={...t},cn(!a.pathname||!a.pathname.includes("?"),Xh("?","pathname","search",a)),cn(!a.pathname||!a.pathname.includes("#"),Xh("#","pathname","hash",a)),cn(!a.search||!a.search.includes("#"),Xh("#","search","hash",a)));let i=t===""||a.pathname==="",l=i?"/":a.pathname,c;if(l==null)c=n;else{let v=e.length-1;if(!r&&l.startsWith("..")){let _=l.split("/");for(;_[0]==="..";)_.shift(),v-=1;a.pathname=_.join("/")}c=v>=0?e[v]:"/"}let d=xA(a,c),f=l&&l!=="/"&&l.endsWith("/"),g=(i||l===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(f||g)&&(d.pathname+="/"),d}var is=t=>t.join("/").replace(/\/\/+/g,"/"),_A=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),wA=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,TA=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function EA(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var ST=["POST","PUT","PATCH","DELETE"];new Set(ST);var SA=["GET",...ST];new Set(SA);var gl=U.createContext(null);gl.displayName="DataRouter";var kd=U.createContext(null);kd.displayName="DataRouterState";var bT=U.createContext({isTransitioning:!1});bT.displayName="ViewTransition";var bA=U.createContext(new Map);bA.displayName="Fetchers";var CA=U.createContext(null);CA.displayName="Await";var Oa=U.createContext(null);Oa.displayName="Navigation";var uu=U.createContext(null);uu.displayName="Location";var Pa=U.createContext({outlet:null,matches:[],isDataRoute:!1});Pa.displayName="Route";var dp=U.createContext(null);dp.displayName="RouteError";function AA(t,{relative:e}={}){cn(fu(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=U.useContext(Oa),{hash:a,pathname:i,search:l}=du(t,{relative:e}),c=i;return n!=="/"&&(c=i==="/"?n:is([n,i])),r.createHref({pathname:c,search:l,hash:a})}function fu(){return U.useContext(uu)!=null}function zi(){return cn(fu(),"useLocation() may be used only in the context of a <Router> component."),U.useContext(uu).location}var CT="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function AT(t){U.useContext(Oa).static||U.useLayoutEffect(t)}function kT(){let{isDataRoute:t}=U.useContext(Pa);return t?VA():kA()}function kA(){cn(fu(),"useNavigate() may be used only in the context of a <Router> component.");let t=U.useContext(gl),{basename:e,navigator:n}=U.useContext(Oa),{matches:r}=U.useContext(Pa),{pathname:a}=zi(),i=JSON.stringify(TT(r)),l=U.useRef(!1);return AT(()=>{l.current=!0}),U.useCallback((d,f={})=>{if(Ia(l.current,CT),!l.current)return;if(typeof d=="number"){n.go(d);return}let g=ET(d,JSON.parse(i),a,f.relative==="path");t==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:is([e,g.pathname])),(f.replace?n.replace:n.push)(g,f.state,f)},[e,n,i,a,t])}U.createContext(null);function NA(){let{matches:t}=U.useContext(Pa),e=t[t.length-1];return e?e.params:{}}function du(t,{relative:e}={}){let{matches:n}=U.useContext(Pa),{pathname:r}=zi(),a=JSON.stringify(TT(n));return U.useMemo(()=>ET(t,JSON.parse(a),r,e==="path"),[t,a,r,e])}function RA(t,e){return NT(t,e)}function NT(t,e,n,r){var k;cn(fu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=U.useContext(Oa),{matches:i}=U.useContext(Pa),l=i[i.length-1],c=l?l.params:{},d=l?l.pathname:"/",f=l?l.pathnameBase:"/",g=l&&l.route;{let A=g&&g.path||"";RT(d,!g||A.endsWith("*")||A.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${A}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${A}"> to <Route path="${A==="/"?"*":`${A}/*`}">.`)}let v=zi(),_;if(e){let A=typeof e=="string"?pl(e):e;cn(f==="/"||((k=A.pathname)==null?void 0:k.startsWith(f)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${A.pathname}" was given in the \`location\` prop.`),_=A}else _=v;let T=_.pathname||"/",E=T;if(f!=="/"){let A=f.replace(/^\//,"").split("/");E="/"+T.replace(/^\//,"").split("/").slice(A.length).join("/")}let S=yT(t,{pathname:E});Ia(g||S!=null,`No routes matched location "${_.pathname}${_.search}${_.hash}" `),Ia(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${_.pathname}${_.search}${_.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let b=LA(S&&S.map(A=>Object.assign({},A,{params:Object.assign({},c,A.params),pathname:is([f,a.encodeLocation?a.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?f:is([f,a.encodeLocation?a.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),i,n,r);return e&&b?U.createElement(uu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",..._},navigationType:"POP"}},b):b}function DA(){let t=jA(),e=EA(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",t),l=U.createElement(U.Fragment,null,U.createElement("p",null,"💿 Hey developer 👋"),U.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",U.createElement("code",{style:i},"ErrorBoundary")," or"," ",U.createElement("code",{style:i},"errorElement")," prop on your route.")),U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},e),n?U.createElement("pre",{style:a},n):null,l)}var MA=U.createElement(DA,null),IA=class extends U.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?U.createElement(Pa.Provider,{value:this.props.routeContext},U.createElement(dp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function FA({routeContext:t,match:e,children:n}){let r=U.useContext(gl);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),U.createElement(Pa.Provider,{value:t},n)}function LA(t,e=[],n=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,i=n==null?void 0:n.errors;if(i!=null){let d=a.findIndex(f=>f.route.id&&(i==null?void 0:i[f.route.id])!==void 0);cn(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,d+1))}let l=!1,c=-1;if(n)for(let d=0;d<a.length;d++){let f=a[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(c=d),f.route.id){let{loaderData:g,errors:v}=n,_=f.route.loader&&!g.hasOwnProperty(f.route.id)&&(!v||v[f.route.id]===void 0);if(f.route.lazy||_){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((d,f,g)=>{let v,_=!1,T=null,E=null;n&&(v=i&&f.route.id?i[f.route.id]:void 0,T=f.route.errorElement||MA,l&&(c<0&&g===0?(RT("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,E=null):c===g&&(_=!0,E=f.route.hydrateFallbackElement||null)));let S=e.concat(a.slice(0,g+1)),b=()=>{let k;return v?k=T:_?k=E:f.route.Component?k=U.createElement(f.route.Component,null):f.route.element?k=f.route.element:k=d,U.createElement(FA,{match:f,routeContext:{outlet:d,matches:S,isDataRoute:n!=null},children:k})};return n&&(f.route.ErrorBoundary||f.route.errorElement||g===0)?U.createElement(IA,{location:n.location,revalidation:n.revalidation,component:T,error:v,children:b(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):b()},null)}function hp(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function OA(t){let e=U.useContext(gl);return cn(e,hp(t)),e}function PA(t){let e=U.useContext(kd);return cn(e,hp(t)),e}function UA(t){let e=U.useContext(Pa);return cn(e,hp(t)),e}function mp(t){let e=UA(t),n=e.matches[e.matches.length-1];return cn(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function BA(){return mp("useRouteId")}function jA(){var r;let t=U.useContext(dp),e=PA("useRouteError"),n=mp("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function VA(){let{router:t}=OA("useNavigate"),e=mp("useNavigate"),n=U.useRef(!1);return AT(()=>{n.current=!0}),U.useCallback(async(a,i={})=>{Ia(n.current,CT),n.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...i}))},[t,e])}var W1={};function RT(t,e,n){!e&&!W1[t]&&(W1[t]=!0,Ia(!1,n))}U.memo(HA);function HA({routes:t,future:e,state:n}){return NT(t,void 0,n,e)}function Em(t){cn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function $A({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:a,static:i=!1}){cn(!fu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),c=U.useMemo(()=>({basename:l,navigator:a,static:i,future:{}}),[l,a,i]);typeof n=="string"&&(n=pl(n));let{pathname:d="/",search:f="",hash:g="",state:v=null,key:_="default"}=n,T=U.useMemo(()=>{let E=us(d,l);return E==null?null:{location:{pathname:E,search:f,hash:g,state:v,key:_},navigationType:r}},[l,d,f,g,v,_,r]);return Ia(T!=null,`<Router basename="${l}"> is not able to match the URL "${d}${f}${g}" because it does not start with the basename, so the <Router> won't render anything.`),T==null?null:U.createElement(Oa.Provider,{value:c},U.createElement(uu.Provider,{children:e,value:T}))}function GA({children:t,location:e}){return RA(Sm(t),e)}function Sm(t,e=[]){let n=[];return U.Children.forEach(t,(r,a)=>{if(!U.isValidElement(r))return;let i=[...e,a];if(r.type===U.Fragment){n.push.apply(n,Sm(r.props.children,i));return}cn(r.type===Em,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),cn(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=Sm(r.props.children,i)),n.push(l)}),n}var Zf="get",Qf="application/x-www-form-urlencoded";function Nd(t){return t!=null&&typeof t.tagName=="string"}function zA(t){return Nd(t)&&t.tagName.toLowerCase()==="button"}function qA(t){return Nd(t)&&t.tagName.toLowerCase()==="form"}function YA(t){return Nd(t)&&t.tagName.toLowerCase()==="input"}function WA(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function JA(t,e){return t.button===0&&(!e||e==="_self")&&!WA(t)}var If=null;function KA(){if(If===null)try{new FormData(document.createElement("form"),0),If=!1}catch{If=!0}return If}var XA=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Zh(t){return t!=null&&!XA.has(t)?(Ia(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Qf}"`),null):t}function ZA(t,e){let n,r,a,i,l;if(qA(t)){let c=t.getAttribute("action");r=c?us(c,e):null,n=t.getAttribute("method")||Zf,a=Zh(t.getAttribute("enctype"))||Qf,i=new FormData(t)}else if(zA(t)||YA(t)&&(t.type==="submit"||t.type==="image")){let c=t.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=t.getAttribute("formaction")||c.getAttribute("action");if(r=d?us(d,e):null,n=t.getAttribute("formmethod")||c.getAttribute("method")||Zf,a=Zh(t.getAttribute("formenctype"))||Zh(c.getAttribute("enctype"))||Qf,i=new FormData(c,t),!KA()){let{name:f,type:g,value:v}=t;if(g==="image"){let _=f?`${f}.`:"";i.append(`${_}x`,"0"),i.append(`${_}y`,"0")}else f&&i.append(f,v)}}else{if(Nd(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Zf,r=null,a=Qf,l=t}return i&&a==="text/plain"&&(l=i,i=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:i,body:l}}function pp(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function QA(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function ek(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function tk(t,e,n){let r=await Promise.all(t.map(async a=>{let i=e.routes[a.route.id];if(i){let l=await QA(i,n);return l.links?l.links():[]}return[]}));return sk(r.flat(1).filter(ek).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function J1(t,e,n,r,a,i){let l=(d,f)=>n[f]?d.route.id!==n[f].route.id:!0,c=(d,f)=>{var g;return n[f].pathname!==d.pathname||((g=n[f].route.path)==null?void 0:g.endsWith("*"))&&n[f].params["*"]!==d.params["*"]};return i==="assets"?e.filter((d,f)=>l(d,f)||c(d,f)):i==="data"?e.filter((d,f)=>{var v;let g=r.routes[d.route.id];if(!g||!g.hasLoader)return!1;if(l(d,f)||c(d,f))return!0;if(d.route.shouldRevalidate){let _=d.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((v=n[0])==null?void 0:v.params)||{},nextUrl:new URL(t,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof _=="boolean")return _}return!0}):[]}function nk(t,e,{includeHydrateFallback:n}={}){return rk(t.map(r=>{let a=e.routes[r.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function rk(t){return[...new Set(t)]}function ak(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function sk(t,e){let n=new Set;return new Set(e),t.reduce((r,a)=>{let i=JSON.stringify(ak(a));return n.has(i)||(n.add(i),r.push({key:i,link:a})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var ik=new Set([100,101,204,205]);function ok(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&us(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function DT(){let t=U.useContext(gl);return pp(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function lk(){let t=U.useContext(kd);return pp(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var gp=U.createContext(void 0);gp.displayName="FrameworkContext";function MT(){let t=U.useContext(gp);return pp(t,"You must render this element inside a <HydratedRouter> element"),t}function ck(t,e){let n=U.useContext(gp),[r,a]=U.useState(!1),[i,l]=U.useState(!1),{onFocus:c,onBlur:d,onMouseEnter:f,onMouseLeave:g,onTouchStart:v}=e,_=U.useRef(null);U.useEffect(()=>{if(t==="render"&&l(!0),t==="viewport"){let S=k=>{k.forEach(A=>{l(A.isIntersecting)})},b=new IntersectionObserver(S,{threshold:.5});return _.current&&b.observe(_.current),()=>{b.disconnect()}}},[t]),U.useEffect(()=>{if(r){let S=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(S)}}},[r]);let T=()=>{a(!0)},E=()=>{a(!1),l(!1)};return n?t!=="intent"?[i,_,{}]:[i,_,{onFocus:Tc(c,T),onBlur:Tc(d,E),onMouseEnter:Tc(f,T),onMouseLeave:Tc(g,E),onTouchStart:Tc(v,T)}]:[!1,_,{}]}function Tc(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function uk({page:t,...e}){let{router:n}=DT(),r=U.useMemo(()=>yT(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?U.createElement(dk,{page:t,matches:r,...e}):null}function fk(t){let{manifest:e,routeModules:n}=MT(),[r,a]=U.useState([]);return U.useEffect(()=>{let i=!1;return tk(t,e,n).then(l=>{i||a(l)}),()=>{i=!0}},[t,e,n]),r}function dk({page:t,matches:e,...n}){let r=zi(),{manifest:a,routeModules:i}=MT(),{basename:l}=DT(),{loaderData:c,matches:d}=lk(),f=U.useMemo(()=>J1(t,e,d,a,r,"data"),[t,e,d,a,r]),g=U.useMemo(()=>J1(t,e,d,a,r,"assets"),[t,e,d,a,r]),v=U.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let E=new Set,S=!1;if(e.forEach(k=>{var C;let A=a.routes[k.route.id];!A||!A.hasLoader||(!f.some(I=>I.route.id===k.route.id)&&k.route.id in c&&((C=i[k.route.id])!=null&&C.shouldRevalidate)||A.hasClientLoader?S=!0:E.add(k.route.id))}),E.size===0)return[];let b=ok(t,l);return S&&E.size>0&&b.searchParams.set("_routes",e.filter(k=>E.has(k.route.id)).map(k=>k.route.id).join(",")),[b.pathname+b.search]},[l,c,r,a,f,e,t,i]),_=U.useMemo(()=>nk(g,a),[g,a]),T=fk(g);return U.createElement(U.Fragment,null,v.map(E=>U.createElement("link",{key:E,rel:"prefetch",as:"fetch",href:E,...n})),_.map(E=>U.createElement("link",{key:E,rel:"modulepreload",href:E,...n})),T.map(({key:E,link:S})=>U.createElement("link",{key:E,...S})))}function hk(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var IT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{IT&&(window.__reactRouterVersion="7.6.3")}catch{}function mk({basename:t,children:e,window:n}){let r=U.useRef();r.current==null&&(r.current=eA({window:n,v5Compat:!0}));let a=r.current,[i,l]=U.useState({action:a.action,location:a.location}),c=U.useCallback(d=>{U.startTransition(()=>l(d))},[l]);return U.useLayoutEffect(()=>a.listen(c),[a,c]),U.createElement($A,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:a})}var FT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,LT=U.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:a,reloadDocument:i,replace:l,state:c,target:d,to:f,preventScrollReset:g,viewTransition:v,..._},T){let{basename:E}=U.useContext(Oa),S=typeof f=="string"&&FT.test(f),b,k=!1;if(typeof f=="string"&&S&&(b=f,IT))try{let P=new URL(window.location.href),re=f.startsWith("//")?new URL(P.protocol+f):new URL(f),G=us(re.pathname,E);re.origin===P.origin&&G!=null?f=G+re.search+re.hash:k=!0}catch{Ia(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let A=AA(f,{relative:a}),[C,I,B]=ck(r,_),j=vk(f,{replace:l,state:c,target:d,preventScrollReset:g,relative:a,viewTransition:v});function F(P){e&&e(P),P.defaultPrevented||j(P)}let X=U.createElement("a",{..._,...B,href:b||A,onClick:k||i?e:F,ref:hk(T,I),target:d,"data-discover":!S&&n==="render"?"true":void 0});return C&&!S?U.createElement(U.Fragment,null,X,U.createElement(uk,{page:A})):X});LT.displayName="Link";var pk=U.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:a=!1,style:i,to:l,viewTransition:c,children:d,...f},g){let v=du(l,{relative:f.relative}),_=zi(),T=U.useContext(kd),{navigator:E,basename:S}=U.useContext(Oa),b=T!=null&&Ek(v)&&c===!0,k=E.encodeLocation?E.encodeLocation(v).pathname:v.pathname,A=_.pathname,C=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;n||(A=A.toLowerCase(),C=C?C.toLowerCase():null,k=k.toLowerCase()),C&&S&&(C=us(C,S)||C);const I=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let B=A===k||!a&&A.startsWith(k)&&A.charAt(I)==="/",j=C!=null&&(C===k||!a&&C.startsWith(k)&&C.charAt(k.length)==="/"),F={isActive:B,isPending:j,isTransitioning:b},X=B?e:void 0,P;typeof r=="function"?P=r(F):P=[r,B?"active":null,j?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let re=typeof i=="function"?i(F):i;return U.createElement(LT,{...f,"aria-current":X,className:P,ref:g,style:re,to:l,viewTransition:c},typeof d=="function"?d(F):d)});pk.displayName="NavLink";var gk=U.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:a,state:i,method:l=Zf,action:c,onSubmit:d,relative:f,preventScrollReset:g,viewTransition:v,..._},T)=>{let E=wk(),S=Tk(c,{relative:f}),b=l.toLowerCase()==="get"?"get":"post",k=typeof c=="string"&&FT.test(c),A=C=>{if(d&&d(C),C.defaultPrevented)return;C.preventDefault();let I=C.nativeEvent.submitter,B=(I==null?void 0:I.getAttribute("formmethod"))||l;E(I||C.currentTarget,{fetcherKey:e,method:B,navigate:n,replace:a,state:i,relative:f,preventScrollReset:g,viewTransition:v})};return U.createElement("form",{ref:T,method:b,action:S,onSubmit:r?d:A,..._,"data-discover":!k&&t==="render"?"true":void 0})});gk.displayName="Form";function xk(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function OT(t){let e=U.useContext(gl);return cn(e,xk(t)),e}function vk(t,{target:e,replace:n,state:r,preventScrollReset:a,relative:i,viewTransition:l}={}){let c=kT(),d=zi(),f=du(t,{relative:i});return U.useCallback(g=>{if(JA(g,e)){g.preventDefault();let v=n!==void 0?n:Wc(d)===Wc(f);c(t,{replace:v,state:r,preventScrollReset:a,relative:i,viewTransition:l})}},[d,c,f,n,r,e,t,a,i,l])}var yk=0,_k=()=>`__${String(++yk)}__`;function wk(){let{router:t}=OT("useSubmit"),{basename:e}=U.useContext(Oa),n=BA();return U.useCallback(async(r,a={})=>{let{action:i,method:l,encType:c,formData:d,body:f}=ZA(r,e);if(a.navigate===!1){let g=a.fetcherKey||_k();await t.fetch(g,n,a.action||i,{preventScrollReset:a.preventScrollReset,formData:d,body:f,formMethod:a.method||l,formEncType:a.encType||c,flushSync:a.flushSync})}else await t.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:d,body:f,formMethod:a.method||l,formEncType:a.encType||c,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,n])}function Tk(t,{relative:e}={}){let{basename:n}=U.useContext(Oa),r=U.useContext(Pa);cn(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),i={...du(t||".",{relative:e})},l=zi();if(t==null){i.search=l.search;let c=new URLSearchParams(i.search),d=c.getAll("index");if(d.some(g=>g==="")){c.delete("index"),d.filter(v=>v).forEach(v=>c.append("index",v));let g=c.toString();i.search=g?`?${g}`:""}}return(!t||t===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:is([n,i.pathname])),Wc(i)}function Ek(t,e={}){let n=U.useContext(bT);cn(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=OT("useViewTransitionState"),a=du(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=us(n.currentLocation.pathname,r)||n.currentLocation.pathname,l=us(n.nextLocation.pathname,r)||n.nextLocation.pathname;return rd(a.pathname,l)!=null||rd(a.pathname,i)!=null}[...ik];const Sk="modulepreload",bk=function(t){return"/"+t},K1={},hu=function(e,n,r){let a=Promise.resolve();if(n&&n.length>0){let l=function(f){return Promise.all(f.map(g=>Promise.resolve(g).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));a=l(n.map(f=>{if(f=bk(f),f in K1)return;K1[f]=!0;const g=f.endsWith(".css"),v=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${v}`))return;const _=document.createElement("link");if(_.rel=g?"stylesheet":Sk,g||(_.as="script"),_.crossOrigin="",_.href=f,d&&_.setAttribute("nonce",d),document.head.appendChild(_),g)return new Promise((T,E)=>{_.addEventListener("load",T),_.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${f}`)))})}))}function i(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return a.then(l=>{for(const c of l||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})},Ck=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>hu(async()=>{const{default:r}=await Promise.resolve().then(()=>xl);return{default:r}},[]).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class xp extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class Ak extends xp{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class X1 extends xp{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Z1 extends xp{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var bm;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(bm||(bm={}));var kk=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};class Nk{constructor(e,{headers:n={},customFetch:r,region:a=bm.Any}={}){this.url=e,this.headers=n,this.region=a,this.fetch=Ck(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return kk(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:l}=n;let c={},{region:d}=n;d||(d=this.region);const f=new URL(`${this.url}/${e}`);d&&d!=="any"&&(c["x-region"]=d,f.searchParams.set("forceFunctionRegion",d));let g;l&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",g=l):typeof l=="string"?(c["Content-Type"]="text/plain",g=l):typeof FormData<"u"&&l instanceof FormData?g=l:(c["Content-Type"]="application/json",g=JSON.stringify(l)));const v=yield this.fetch(f.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),a),body:g}).catch(S=>{throw new Ak(S)}),_=v.headers.get("x-relay-error");if(_&&_==="true")throw new X1(v);if(!v.ok)throw new Z1(v);let T=((r=v.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),E;return T==="application/json"?E=yield v.json():T==="application/octet-stream"?E=yield v.blob():T==="text/event-stream"?E=v:T==="multipart/form-data"?E=yield v.formData():E=yield v.text(),{data:E,error:null,response:v}}catch(a){return{data:null,error:a,response:a instanceof Z1||a instanceof X1?a.context:void 0}}})}}var Vn={},Po={},Uo={},Bo={},jo={},Vo={},Rk=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},il=Rk();const Dk=il.fetch,PT=il.fetch.bind(il),UT=il.Headers,Mk=il.Request,Ik=il.Response,xl=Object.freeze(Object.defineProperty({__proto__:null,Headers:UT,Request:Mk,Response:Ik,default:PT,fetch:Dk},Symbol.toStringTag,{value:"Module"})),Fk=VC(xl);var Ff={},Q1;function BT(){if(Q1)return Ff;Q1=1,Object.defineProperty(Ff,"__esModule",{value:!0});class t extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}}return Ff.default=t,Ff}var ey;function jT(){if(ey)return Vo;ey=1;var t=Vo&&Vo.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Vo,"__esModule",{value:!0});const e=t(Fk),n=t(BT());class r{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,l){return this.headers=Object.assign({},this.headers),this.headers[i]=l,this}then(i,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const c=this.fetch;let d=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var g,v,_;let T=null,E=null,S=null,b=f.status,k=f.statusText;if(f.ok){if(this.method!=="HEAD"){const B=await f.text();B===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?E=B:E=JSON.parse(B))}const C=(g=this.headers.Prefer)===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),I=(v=f.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");C&&I&&I.length>1&&(S=parseInt(I[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(E)&&(E.length>1?(T={code:"PGRST116",details:`Results contain ${E.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},E=null,S=null,b=406,k="Not Acceptable"):E.length===1?E=E[0]:E=null)}else{const C=await f.text();try{T=JSON.parse(C),Array.isArray(T)&&f.status===404&&(E=[],T=null,b=200,k="OK")}catch{f.status===404&&C===""?(b=204,k="No Content"):T={message:C}}if(T&&this.isMaybeSingle&&(!((_=T==null?void 0:T.details)===null||_===void 0)&&_.includes("0 rows"))&&(T=null,b=200,k="OK"),T&&this.shouldThrowOnError)throw new n.default(T)}return{error:T,data:E,count:S,status:b,statusText:k}});return this.shouldThrowOnError||(d=d.catch(f=>{var g,v,_;return{error:{message:`${(g=f==null?void 0:f.name)!==null&&g!==void 0?g:"FetchError"}: ${f==null?void 0:f.message}`,details:`${(v=f==null?void 0:f.stack)!==null&&v!==void 0?v:""}`,hint:"",code:`${(_=f==null?void 0:f.code)!==null&&_!==void 0?_:""}`},data:null,count:null,status:0,statusText:""}})),d.then(i,l)}returns(){return this}overrideTypes(){return this}}return Vo.default=r,Vo}var ty;function VT(){if(ty)return jo;ty=1;var t=jo&&jo.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(jo,"__esModule",{value:!0});const e=t(jT());class n extends e.default{select(a){let i=!1;const l=(a??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",l),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(a,{ascending:i=!0,nullsFirst:l,foreignTable:c,referencedTable:d=c}={}){const f=d?`${d}.order`:"order",g=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${g?`${g},`:""}${a}.${i?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:i,referencedTable:l=i}={}){const c=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${a}`),this}range(a,i,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"offset":`${c}.offset`,f=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${a}`),this.url.searchParams.set(f,`${i-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:a=!1,verbose:i=!1,settings:l=!1,buffers:c=!1,wal:d=!1,format:f="text"}={}){var g;const v=[a?"analyze":null,i?"verbose":null,l?"settings":null,c?"buffers":null,d?"wal":null].filter(Boolean).join("|"),_=(g=this.headers.Accept)!==null&&g!==void 0?g:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${f}; for="${_}"; options=${v};`,f==="json"?this:this}rollback(){var a;return((a=this.headers.Prefer)!==null&&a!==void 0?a:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return jo.default=n,jo}var ny;function vp(){if(ny)return Bo;ny=1;var t=Bo&&Bo.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Bo,"__esModule",{value:!0});const e=t(VT());class n extends e.default{eq(a,i){return this.url.searchParams.append(a,`eq.${i}`),this}neq(a,i){return this.url.searchParams.append(a,`neq.${i}`),this}gt(a,i){return this.url.searchParams.append(a,`gt.${i}`),this}gte(a,i){return this.url.searchParams.append(a,`gte.${i}`),this}lt(a,i){return this.url.searchParams.append(a,`lt.${i}`),this}lte(a,i){return this.url.searchParams.append(a,`lte.${i}`),this}like(a,i){return this.url.searchParams.append(a,`like.${i}`),this}likeAllOf(a,i){return this.url.searchParams.append(a,`like(all).{${i.join(",")}}`),this}likeAnyOf(a,i){return this.url.searchParams.append(a,`like(any).{${i.join(",")}}`),this}ilike(a,i){return this.url.searchParams.append(a,`ilike.${i}`),this}ilikeAllOf(a,i){return this.url.searchParams.append(a,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(a,i){return this.url.searchParams.append(a,`ilike(any).{${i.join(",")}}`),this}is(a,i){return this.url.searchParams.append(a,`is.${i}`),this}in(a,i){const l=Array.from(new Set(i)).map(c=>typeof c=="string"&&new RegExp("[,()]").test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cs.{${i.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(i)}`),this}containedBy(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cd.{${i.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(i)}`),this}rangeGt(a,i){return this.url.searchParams.append(a,`sr.${i}`),this}rangeGte(a,i){return this.url.searchParams.append(a,`nxl.${i}`),this}rangeLt(a,i){return this.url.searchParams.append(a,`sl.${i}`),this}rangeLte(a,i){return this.url.searchParams.append(a,`nxr.${i}`),this}rangeAdjacent(a,i){return this.url.searchParams.append(a,`adj.${i}`),this}overlaps(a,i){return typeof i=="string"?this.url.searchParams.append(a,`ov.${i}`):this.url.searchParams.append(a,`ov.{${i.join(",")}}`),this}textSearch(a,i,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const f=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${d}fts${f}.${i}`),this}match(a){return Object.entries(a).forEach(([i,l])=>{this.url.searchParams.append(i,`eq.${l}`)}),this}not(a,i,l){return this.url.searchParams.append(a,`not.${i}.${l}`),this}or(a,{foreignTable:i,referencedTable:l=i}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,i,l){return this.url.searchParams.append(a,`${i}.${l}`),this}}return Bo.default=n,Bo}var ry;function HT(){if(ry)return Uo;ry=1;var t=Uo&&Uo.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Uo,"__esModule",{value:!0});const e=t(vp());class n{constructor(a,{headers:i={},schema:l,fetch:c}){this.url=a,this.headers=i,this.schema=l,this.fetch=c}select(a,{head:i=!1,count:l}={}){const c=i?"HEAD":"GET";let d=!1;const f=(a??"*").split("").map(g=>/\s/.test(g)&&!d?"":(g==='"'&&(d=!d),g)).join("");return this.url.searchParams.set("select",f),l&&(this.headers.Prefer=`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(a,{count:i,defaultToNull:l=!0}={}){const c="POST",d=[];if(this.headers.Prefer&&d.push(this.headers.Prefer),i&&d.push(`count=${i}`),l||d.push("missing=default"),this.headers.Prefer=d.join(","),Array.isArray(a)){const f=a.reduce((g,v)=>g.concat(Object.keys(v)),[]);if(f.length>0){const g=[...new Set(f)].map(v=>`"${v}"`);this.url.searchParams.set("columns",g.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}upsert(a,{onConflict:i,ignoreDuplicates:l=!1,count:c,defaultToNull:d=!0}={}){const f="POST",g=[`resolution=${l?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&g.push(this.headers.Prefer),c&&g.push(`count=${c}`),d||g.push("missing=default"),this.headers.Prefer=g.join(","),Array.isArray(a)){const v=a.reduce((_,T)=>_.concat(Object.keys(T)),[]);if(v.length>0){const _=[...new Set(v)].map(T=>`"${T}"`);this.url.searchParams.set("columns",_.join(","))}}return new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}update(a,{count:i}={}){const l="PATCH",c=[];return this.headers.Prefer&&c.push(this.headers.Prefer),i&&c.push(`count=${i}`),this.headers.Prefer=c.join(","),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}delete({count:a}={}){const i="DELETE",l=[];return a&&l.push(`count=${a}`),this.headers.Prefer&&l.unshift(this.headers.Prefer),this.headers.Prefer=l.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Uo.default=n,Uo}var Ec={},Sc={},ay;function Lk(){return ay||(ay=1,Object.defineProperty(Sc,"__esModule",{value:!0}),Sc.version=void 0,Sc.version="0.0.0-automated"),Sc}var sy;function Ok(){if(sy)return Ec;sy=1,Object.defineProperty(Ec,"__esModule",{value:!0}),Ec.DEFAULT_HEADERS=void 0;const t=Lk();return Ec.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${t.version}`},Ec}var iy;function Pk(){if(iy)return Po;iy=1;var t=Po&&Po.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Po,"__esModule",{value:!0});const e=t(HT()),n=t(vp()),r=Ok();class a{constructor(l,{headers:c={},schema:d,fetch:f}={}){this.url=l,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),c),this.schemaName=d,this.fetch=f}from(l){const c=new URL(`${this.url}/${l}`);return new e.default(c,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new a(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:f=!1,count:g}={}){let v;const _=new URL(`${this.url}/rpc/${l}`);let T;d||f?(v=d?"HEAD":"GET",Object.entries(c).filter(([S,b])=>b!==void 0).map(([S,b])=>[S,Array.isArray(b)?`{${b.join(",")}}`:`${b}`]).forEach(([S,b])=>{_.searchParams.append(S,b)})):(v="POST",T=c);const E=Object.assign({},this.headers);return g&&(E.Prefer=`count=${g}`),new n.default({method:v,url:_,headers:E,schema:this.schemaName,body:T,fetch:this.fetch,allowEmpty:!1})}}return Po.default=a,Po}var oy;function Uk(){if(oy)return Vn;oy=1;var t=Vn&&Vn.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.PostgrestError=Vn.PostgrestBuilder=Vn.PostgrestTransformBuilder=Vn.PostgrestFilterBuilder=Vn.PostgrestQueryBuilder=Vn.PostgrestClient=void 0;const e=t(Pk());Vn.PostgrestClient=e.default;const n=t(HT());Vn.PostgrestQueryBuilder=n.default;const r=t(vp());Vn.PostgrestFilterBuilder=r.default;const a=t(VT());Vn.PostgrestTransformBuilder=a.default;const i=t(jT());Vn.PostgrestBuilder=i.default;const l=t(BT());return Vn.PostgrestError=l.default,Vn.default={PostgrestClient:e.default,PostgrestQueryBuilder:n.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:i.default,PostgrestError:l.default},Vn}var Bk=Uk();const jk=up(Bk),{PostgrestClient:Vk,PostgrestQueryBuilder:gG,PostgrestFilterBuilder:xG,PostgrestTransformBuilder:vG,PostgrestBuilder:yG,PostgrestError:_G}=jk;function Hk(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const $k=Hk(),Gk="2.11.15",zk=`realtime-js/${Gk}`,qk="1.0.0",$T=1e4,Yk=1e3;var Fc;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Fc||(Fc={}));var nr;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(nr||(nr={}));var da;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(da||(da={}));var Cm;(function(t){t.websocket="websocket"})(Cm||(Cm={}));var ki;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(ki||(ki={}));class Wk{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const a=n.getUint8(1),i=n.getUint8(2);let l=this.HEADER_LENGTH+2;const c=r.decode(e.slice(l,l+a));l=l+a;const d=r.decode(e.slice(l,l+i));l=l+i;const f=JSON.parse(r.decode(e.slice(l,e.byteLength)));return{ref:null,topic:c,event:d,payload:f}}}class GT{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Kt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Kt||(Kt={}));const ly=(t,e,n={})=>{var r;const a=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,l)=>(i[l]=Jk(l,t,e,a),i),{})},Jk=(t,e,n,r)=>{const a=e.find(c=>c.name===t),i=a==null?void 0:a.type,l=n[t];return i&&!r.includes(i)?zT(i,l):Am(l)},zT=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return Qk(e,n)}switch(t){case Kt.bool:return Kk(e);case Kt.float4:case Kt.float8:case Kt.int2:case Kt.int4:case Kt.int8:case Kt.numeric:case Kt.oid:return Xk(e);case Kt.json:case Kt.jsonb:return Zk(e);case Kt.timestamp:return e4(e);case Kt.abstime:case Kt.date:case Kt.daterange:case Kt.int4range:case Kt.int8range:case Kt.money:case Kt.reltime:case Kt.text:case Kt.time:case Kt.timestamptz:case Kt.timetz:case Kt.tsrange:case Kt.tstzrange:return Am(e);default:return Am(e)}},Am=t=>t,Kk=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Xk=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Zk=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Qk=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let i;const l=t.slice(1,n);try{i=JSON.parse("["+l+"]")}catch{i=l?l.split(","):[]}return i.map(c=>zT(e,c))}return t},e4=t=>typeof t=="string"?t.replace(" ","T"):t,qT=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Qh{constructor(e,n,r={},a=$T){this.channel=e,this.event=n,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var cy;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(cy||(cy={}));class Lc{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:i,onLeave:l,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Lc.syncState(this.state,a,i,l),this.pendingDiffs.forEach(d=>{this.state=Lc.syncDiff(this.state,d,i,l)}),this.pendingDiffs=[],c()}),this.channel._on(r.diff,{},a=>{const{onJoin:i,onLeave:l,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Lc.syncDiff(this.state,a,i,l),c())}),this.onJoin((a,i,l)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:l})}),this.onLeave((a,i,l)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,a){const i=this.cloneDeep(e),l=this.transformState(n),c={},d={};return this.map(i,(f,g)=>{l[f]||(d[f]=g)}),this.map(l,(f,g)=>{const v=i[f];if(v){const _=g.map(b=>b.presence_ref),T=v.map(b=>b.presence_ref),E=g.filter(b=>T.indexOf(b.presence_ref)<0),S=v.filter(b=>_.indexOf(b.presence_ref)<0);E.length>0&&(c[f]=E),S.length>0&&(d[f]=S)}else c[f]=g}),this.syncDiff(i,{joins:c,leaves:d},r,a)}static syncDiff(e,n,r,a){const{joins:i,leaves:l}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(i,(c,d)=>{var f;const g=(f=e[c])!==null&&f!==void 0?f:[];if(e[c]=this.cloneDeep(d),g.length>0){const v=e[c].map(T=>T.presence_ref),_=g.filter(T=>v.indexOf(T.presence_ref)<0);e[c].unshift(..._)}r(c,g,d)}),this.map(l,(c,d)=>{let f=e[c];if(!f)return;const g=d.map(v=>v.presence_ref);f=f.filter(v=>g.indexOf(v.presence_ref)<0),e[c]=f,a(c,f,d),f.length===0&&delete e[c]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const a=e[r];return"metas"in a?n[r]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[r]=a,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var uy;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(uy||(uy={}));var fy;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(fy||(fy={}));var as;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(as||(as={}));class yp{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=nr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Qh(this,da.join,this.params,this.timeout),this.rejoinTimer=new GT(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=nr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=nr.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=nr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=nr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(da.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new Lc(this),this.broadcastEndpointURL=qT(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,a;if(this.socket.isConnected()||this.socket.connect(),this.state==nr.closed){const{config:{broadcast:i,presence:l,private:c}}=this.params;this._onError(g=>e==null?void 0:e(as.CHANNEL_ERROR,g)),this._onClose(()=>e==null?void 0:e(as.CLOSED));const d={},f={broadcast:i,presence:l,postgres_changes:(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(g=>g.filter))!==null&&a!==void 0?a:[],private:c};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:f},d)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:g})=>{var v;if(this.socket.setAuth(),g===void 0){e==null||e(as.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,T=(v=_==null?void 0:_.length)!==null&&v!==void 0?v:0,E=[];for(let S=0;S<T;S++){const b=_[S],{filter:{event:k,schema:A,table:C,filter:I}}=b,B=g&&g[S];if(B&&B.event===k&&B.schema===A&&B.table===C&&B.filter===I)E.push(Object.assign(Object.assign({},b),{id:B.id}));else{this.unsubscribe(),this.state=nr.errored,e==null||e(as.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,e&&e(as.SUBSCRIBED);return}}).receive("error",g=>{this.state=nr.errored,e==null||e(as.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(as.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this._on(e,n,r)}async send(e,n={}){var r,a;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:l}=e,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:l,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=f.body)===null||a===void 0?void 0:a.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var l,c,d;const f=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&i("ok"),f.receive("ok",()=>i("ok")),f.receive("error",()=>i("error")),f.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=nr.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(da.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new Qh(this,da.leave,{},e),r.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,n,r){const a=new AbortController,i=setTimeout(()=>a.abort(),r),l=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(i),l}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Qh(this,e,n,r);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var a,i;const l=e.toLocaleLowerCase(),{close:c,error:d,leave:f,join:g}=da;if(r&&[c,d,f,g].indexOf(l)>=0&&r!==this._joinRef())return;let _=this._onMessage(l,n,r);if(n&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(T=>{var E,S,b;return((E=T.filter)===null||E===void 0?void 0:E.event)==="*"||((b=(S=T.filter)===null||S===void 0?void 0:S.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===l}).map(T=>T.callback(_,r)):(i=this.bindings[l])===null||i===void 0||i.filter(T=>{var E,S,b,k,A,C;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in T){const I=T.id,B=(E=T.filter)===null||E===void 0?void 0:E.event;return I&&((S=n.ids)===null||S===void 0?void 0:S.includes(I))&&(B==="*"||(B==null?void 0:B.toLocaleLowerCase())===((b=n.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const I=(A=(k=T==null?void 0:T.filter)===null||k===void 0?void 0:k.event)===null||A===void 0?void 0:A.toLocaleLowerCase();return I==="*"||I===((C=n==null?void 0:n.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return T.type.toLocaleLowerCase()===l}).map(T=>{if(typeof _=="object"&&"ids"in _){const E=_.data,{schema:S,table:b,commit_timestamp:k,type:A,errors:C}=E;_=Object.assign(Object.assign({},{schema:S,table:b,commit_timestamp:k,eventType:A,new:{},old:{},errors:C}),this._getPayloadRecords(E))}T.callback(_,r)})}_isClosed(){return this.state===nr.closed}_isJoined(){return this.state===nr.joined}_isJoining(){return this.state===nr.joining}_isLeaving(){return this.state===nr.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const a=e.toLocaleLowerCase(),i={type:a,filter:n,callback:r};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&yp.isEqual(a.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(da.close,{},e)}_onError(e){this._on(da.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=nr.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=ly(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=ly(e.columns,e.old_record)),n}}const dy=()=>{},t4=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class n4{constructor(e,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=$T,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=dy,this.ref=0,this.logger=dy,this.conn=null,this.sendBuffer=[],this.serializer=new Wk,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let l;return i?l=i:typeof fetch>"u"?l=(...c)=>hu(async()=>{const{default:d}=await Promise.resolve().then(()=>xl);return{default:d}},void 0).then(({default:d})=>d(...c)):l=fetch,(...c)=>l(...c)},this.endPoint=`${e}/${Cm.websocket}`,this.httpEndpoint=qT(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const a=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(i,l)=>l(JSON.stringify(i)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new GT(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=$k),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:qk}))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Fc.connecting:return ki.Connecting;case Fc.open:return ki.Open;case Fc.closing:return ki.Closing;default:return ki.Closed}}isConnected(){return this.connectionState()===ki.Open}channel(e,n={config:{}}){const r=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===r);if(a)return a;{const i=new yp(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:r,payload:a,ref:i}=e,l=()=>{this.encode(e,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${n} ${r} (${i})`,a),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){let n=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const a={access_token:n,version:zk};n&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(da.access_token,{access_token:n})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(Yk,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:r,event:a,payload:i,ref:l}=n;r==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(n.payload.status=="ok"?"ok":"error"),l&&l===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${a} ${l&&"("+l+")"||""}`,i),Array.from(this.channels).filter(c=>c._isMember(r)).forEach(c=>c._trigger(a,i,l)),this.stateChangeCallbacks.message.forEach(c=>c(n))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(da.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${e}${r}${a}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([t4],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class _p extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Hn(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class r4 extends _p{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class km extends _p{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var a4=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const YT=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>hu(async()=>{const{default:r}=await Promise.resolve().then(()=>xl);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},s4=()=>a4(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield hu(()=>Promise.resolve().then(()=>xl),void 0)).Response:Response}),Nm=t=>{if(Array.isArray(t))return t.map(n=>Nm(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const a=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=Nm(r)}),e};var qi=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const em=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),i4=(t,e,n)=>qi(void 0,void 0,void 0,function*(){const r=yield s4();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(a=>{e(new r4(em(a),t.status||500))}).catch(a=>{e(new km(em(a),a))}):e(new km(em(t),t))}),o4=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(a.body=JSON.stringify(r)),Object.assign(Object.assign({},a),n))};function mu(t,e,n,r,a,i){return qi(this,void 0,void 0,function*(){return new Promise((l,c)=>{t(n,o4(e,r,a,i)).then(d=>{if(!d.ok)throw d;return r!=null&&r.noResolveJson?d:d.json()}).then(d=>l(d)).catch(d=>i4(d,c,r))})})}function ad(t,e,n,r){return qi(this,void 0,void 0,function*(){return mu(t,"GET",e,n,r)})}function zs(t,e,n,r,a){return qi(this,void 0,void 0,function*(){return mu(t,"POST",e,r,a,n)})}function l4(t,e,n,r,a){return qi(this,void 0,void 0,function*(){return mu(t,"PUT",e,r,a,n)})}function c4(t,e,n,r){return qi(this,void 0,void 0,function*(){return mu(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function WT(t,e,n,r,a){return qi(this,void 0,void 0,function*(){return mu(t,"DELETE",e,r,a,n)})}var Sr=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const u4={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},hy={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class f4{constructor(e,n={},r,a){this.url=e,this.headers=n,this.bucketId=r,this.fetch=YT(a)}uploadOrUpdate(e,n,r,a){return Sr(this,void 0,void 0,function*(){try{let i;const l=Object.assign(Object.assign({},hy),a);let c=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const d=l.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",l.cacheControl),d&&i.append("metadata",this.encodeMetadata(d)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",l.cacheControl),d&&i.append("metadata",this.encodeMetadata(d))):(i=r,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,d&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),a!=null&&a.headers&&(c=Object.assign(Object.assign({},c),a.headers));const f=this._removeEmptyFolders(n),g=this._getFinalPath(f),v=yield this.fetch(`${this.url}/object/${g}`,Object.assign({method:e,body:i,headers:c},l!=null&&l.duplex?{duplex:l.duplex}:{})),_=yield v.json();return v.ok?{data:{path:f,id:_.Id,fullPath:_.Key},error:null}:{data:null,error:_}}catch(i){if(Hn(i))return{data:null,error:i};throw i}})}upload(e,n,r){return Sr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,a){return Sr(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),l=this._getFinalPath(i),c=new URL(this.url+`/object/upload/sign/${l}`);c.searchParams.set("token",n);try{let d;const f=Object.assign({upsert:hy.upsert},a),g=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",f.cacheControl),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.append("cacheControl",f.cacheControl)):(d=r,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType);const v=yield this.fetch(c.toString(),{method:"PUT",body:d,headers:g}),_=yield v.json();return v.ok?{data:{path:i,fullPath:_.Key},error:null}:{data:null,error:_}}catch(d){if(Hn(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(e,n){return Sr(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const a=Object.assign({},this.headers);n!=null&&n.upsert&&(a["x-upsert"]="true");const i=yield zs(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),l=new URL(this.url+i.url),c=l.searchParams.get("token");if(!c)throw new _p("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:c},error:null}}catch(r){if(Hn(r))return{data:null,error:r};throw r}})}update(e,n,r){return Sr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return Sr(this,void 0,void 0,function*(){try{return{data:yield zs(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Hn(a))return{data:null,error:a};throw a}})}copy(e,n,r){return Sr(this,void 0,void 0,function*(){try{return{data:{path:(yield zs(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Hn(a))return{data:null,error:a};throw a}})}createSignedUrl(e,n,r){return Sr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),i=yield zs(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${l}`)},{data:i,error:null}}catch(a){if(Hn(a))return{data:null,error:a};throw a}})}createSignedUrls(e,n,r){return Sr(this,void 0,void 0,function*(){try{const a=yield zs(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${i}`):null})),error:null}}catch(a){if(Hn(a))return{data:null,error:a};throw a}})}download(e,n){return Sr(this,void 0,void 0,function*(){const a=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),l=i?`?${i}`:"";try{const c=this._getFinalPath(e);return{data:yield(yield ad(this.fetch,`${this.url}/${a}/${c}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(c){if(Hn(c))return{data:null,error:c};throw c}})}info(e){return Sr(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield ad(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Nm(r),error:null}}catch(r){if(Hn(r))return{data:null,error:r};throw r}})}exists(e){return Sr(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield c4(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Hn(r)&&r instanceof km){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),a=[],i=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";i!==""&&a.push(i);const c=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});d!==""&&a.push(d);let f=a.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${r}${f}`)}}}remove(e){return Sr(this,void 0,void 0,function*(){try{return{data:yield WT(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(Hn(n))return{data:null,error:n};throw n}})}list(e,n,r){return Sr(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},u4),n),{prefix:e||""});return{data:yield zs(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(Hn(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const d4="2.7.1",h4={"X-Client-Info":`storage-js/${d4}`};var Ho=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};class m4{constructor(e,n={},r){this.url=e,this.headers=Object.assign(Object.assign({},h4),n),this.fetch=YT(r)}listBuckets(){return Ho(this,void 0,void 0,function*(){try{return{data:yield ad(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Hn(e))return{data:null,error:e};throw e}})}getBucket(e){return Ho(this,void 0,void 0,function*(){try{return{data:yield ad(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(Hn(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return Ho(this,void 0,void 0,function*(){try{return{data:yield zs(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Hn(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return Ho(this,void 0,void 0,function*(){try{return{data:yield l4(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Hn(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Ho(this,void 0,void 0,function*(){try{return{data:yield zs(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(Hn(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Ho(this,void 0,void 0,function*(){try{return{data:yield WT(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(Hn(n))return{data:null,error:n};throw n}})}}class p4 extends m4{constructor(e,n={},r){super(e,n,r)}from(e){return new f4(this.url,this.headers,e,this.fetch)}}const g4="2.50.3";let Cc="";typeof Deno<"u"?Cc="deno":typeof document<"u"?Cc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Cc="react-native":Cc="node";const x4={"X-Client-Info":`supabase-js-${Cc}/${g4}`},v4={headers:x4},y4={schema:"public"},_4={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},w4={};var T4=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};const E4=t=>{let e;return t?e=t:typeof fetch>"u"?e=PT:e=fetch,(...n)=>e(...n)},S4=()=>typeof Headers>"u"?UT:Headers,b4=(t,e,n)=>{const r=E4(n),a=S4();return(i,l)=>T4(void 0,void 0,void 0,function*(){var c;const d=(c=yield e())!==null&&c!==void 0?c:t;let f=new a(l==null?void 0:l.headers);return f.has("apikey")||f.set("apikey",t),f.has("Authorization")||f.set("Authorization",`Bearer ${d}`),r(i,Object.assign(Object.assign({},l),{headers:f}))})};var C4=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};function A4(t){return t.endsWith("/")?t:t+"/"}function k4(t,e){var n,r;const{db:a,auth:i,realtime:l,global:c}=t,{db:d,auth:f,realtime:g,global:v}=e,_={db:Object.assign(Object.assign({},d),a),auth:Object.assign(Object.assign({},f),i),realtime:Object.assign(Object.assign({},g),l),global:Object.assign(Object.assign(Object.assign({},v),c),{headers:Object.assign(Object.assign({},(n=v==null?void 0:v.headers)!==null&&n!==void 0?n:{}),(r=c==null?void 0:c.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>C4(this,void 0,void 0,function*(){return""})};return t.accessToken?_.accessToken=t.accessToken:delete _.accessToken,_}const JT="2.70.0",Ko=30*1e3,Rm=3,tm=Rm*Ko,N4="http://localhost:9999",R4="supabase.auth.token",D4={"X-Client-Info":`gotrue-js/${JT}`},Dm="X-Supabase-Api-Version",KT={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},M4=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,I4=6e5;class wp extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function ct(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class F4 extends wp{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function L4(t){return ct(t)&&t.name==="AuthApiError"}class XT extends wp{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class ai extends wp{constructor(e,n,r,a){super(e,r,a),this.name=n,this.status=r}}class Gs extends ai{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function O4(t){return ct(t)&&t.name==="AuthSessionMissingError"}class Lf extends ai{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Of extends ai{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Pf extends ai{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function P4(t){return ct(t)&&t.name==="AuthImplicitGrantRedirectError"}class my extends ai{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Mm extends ai{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function nm(t){return ct(t)&&t.name==="AuthRetryableFetchError"}class py extends ai{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class Oc extends ai{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const sd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),gy=` 	
\r=`.split(""),U4=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<gy.length;e+=1)t[gy[e].charCodeAt(0)]=-2;for(let e=0;e<sd.length;e+=1)t[sd[e].charCodeAt(0)]=e;return t})();function xy(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(sd[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(sd[r]),e.queuedBits-=6}}function ZT(t,e,n){const r=U4[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function vy(t){const e=[],n=l=>{e.push(String.fromCodePoint(l))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=l=>{V4(l,r,n)};for(let l=0;l<t.length;l+=1)ZT(t.charCodeAt(l),a,i);return e.join("")}function B4(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function j4(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}B4(r,e)}}function V4(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if((t>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function H4(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)ZT(t.charCodeAt(a),n,r);return new Uint8Array(e)}function $4(t){const e=[];return j4(t,n=>e.push(n)),new Uint8Array(e)}function G4(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};return t.forEach(a=>xy(a,n,r)),xy(null,n,r),e.join("")}function z4(t){return Math.round(Date.now()/1e3)+t}function q4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const fa=()=>typeof window<"u"&&typeof document<"u",bi={tested:!1,writable:!1},Pc=()=>{if(!fa())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(bi.tested)return bi.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),bi.tested=!0,bi.writable=!0}catch{bi.tested=!0,bi.writable=!1}return bi.writable};function Y4(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return n.searchParams.forEach((r,a)=>{e[a]=r}),e}const QT=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>hu(async()=>{const{default:r}=await Promise.resolve().then(()=>xl);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},W4=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",e2=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Uf=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Bf=async(t,e)=>{await t.removeItem(e)};class Rd{constructor(){this.promise=new Rd.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Rd.promiseConstructor=Promise;function rm(t){const e=t.split(".");if(e.length!==3)throw new Oc("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!M4.test(e[r]))throw new Oc("JWT not in base64url format");return{header:JSON.parse(vy(e[0])),payload:JSON.parse(vy(e[1])),signature:H4(e[2]),raw:{header:e[0],payload:e[1]}}}async function J4(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function K4(t,e){return new Promise((r,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const l=await t(i);if(!e(i,null,l)){r(l);return}}catch(l){if(!e(i,l)){a(l);return}}})()})}function X4(t){return("0"+t.toString(16)).substr(-2)}function Z4(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let a="";for(let i=0;i<56;i++)a+=n.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(e),Array.from(e,X4).join("")}async function Q4(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(r);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function eN(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await Q4(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $o(t,e,n=!1){const r=Z4();let a=r;n&&(a+="/PASSWORD_RECOVERY"),await e2(t,`${e}-code-verifier`,a);const i=await eN(r);return[i,r===i?"plain":"s256"]}const tN=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function nN(t){const e=t.headers.get(Dm);if(!e||!e.match(tN))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function rN(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function aN(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const sN=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Go(t){if(!sN.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var iN=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};const Ai=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),oN=[502,503,504];async function yy(t){var e;if(!W4(t))throw new Mm(Ai(t),0);if(oN.includes(t.status))throw new Mm(Ai(t),t.status);let n;try{n=await t.json()}catch(i){throw new XT(Ai(i),i)}let r;const a=nN(t);if(a&&a.getTime()>=KT["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new py(Ai(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Gs}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,l)=>i&&typeof l=="string",!0))throw new py(Ai(n),t.status,n.weak_password.reasons);throw new F4(Ai(n),t.status||500,r)}const lN=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),n))};async function Et(t,e,n,r){var a;const i=Object.assign({},r==null?void 0:r.headers);i[Dm]||(i[Dm]=KT["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const l=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(l.redirect_to=r.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",d=await cN(t,e,n+c,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(d):{data:Object.assign({},d),error:null}}async function cN(t,e,n,r,a,i){const l=lN(e,r,a,i);let c;try{c=await t(n,Object.assign({},l))}catch(d){throw console.error(d),new Mm(Ai(d),0)}if(c.ok||await yy(c),r!=null&&r.noResolveJson)return c;try{return await c.json()}catch(d){await yy(d)}}function rs(t){var e;let n=null;hN(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=z4(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function _y(t){const e=rs(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Ys(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function uN(t){return{data:t,error:null}}function fN(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:i}=t,l=iN(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:i},d=Object.assign({},l);return{data:{properties:c,user:d},error:null}}function dN(t){return t}function hN(t){return t.access_token&&t.refresh_token&&t.expires_in}const am=["global","local","others"];var mN=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};class pN{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=QT(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=am[0]){if(am.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${am.join(", ")}`);try{return await Et(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ct(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await Et(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Ys})}catch(r){if(ct(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=mN(e,["options"]),a=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await Et(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:fN,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(ct(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await Et(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ys})}catch(n){if(ct(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,a,i,l,c,d;try{const f={nextPage:null,lastPage:0,total:0},g=await Et(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:dN});if(g.error)throw g.error;const v=await g.json(),_=(l=g.headers.get("x-total-count"))!==null&&l!==void 0?l:0,T=(d=(c=g.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return T.length>0&&(T.forEach(E=>{const S=parseInt(E.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(E.split(";")[1].split("=")[1]);f[`${b}Page`]=S}),f.total=parseInt(_)),{data:Object.assign(Object.assign({},v),f),error:null}}catch(f){if(ct(f))return{data:{users:[]},error:f};throw f}}async getUserById(e){Go(e);try{return await Et(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ys})}catch(n){if(ct(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Go(e);try{return await Et(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Ys})}catch(r){if(ct(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){Go(e);try{return await Et(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Ys})}catch(r){if(ct(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Go(e.userId);try{const{data:n,error:r}=await Et(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:r}}catch(n){if(ct(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Go(e.userId),Go(e.id);try{return{data:await Et(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(ct(n))return{data:null,error:n};throw n}}}const gN={getItem:t=>Pc()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{Pc()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{Pc()&&globalThis.localStorage.removeItem(t)}};function wy(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function xN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const zo={debug:!!(globalThis&&Pc()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class t2 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class vN extends t2{}async function yN(t,e,n){zo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),zo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){zo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await n()}finally{zo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw zo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new vN(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(zo.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}xN();const _N={url:N4,storageKey:R4,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:D4,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Ty(t,e,n){return await n()}class Jc{constructor(e){var n,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Jc.nextInstanceID,Jc.nextInstanceID+=1,this.instanceID>0&&fa()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},_N),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new pN({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=QT(a.fetch),this.lock=a.lock||Ty,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:fa()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=yN:this.lock=Ty,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:Pc()?this.storage=gN:(this.memoryStorage={},this.storage=wy(this.memoryStorage)):(this.memoryStorage={},this.storage=wy(this.memoryStorage)),fa()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${JT}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=Y4(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),fa()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:i}=await this._getSessionFromURL(n,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),P4(i)){const d=(e=i.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:l,redirectType:c}=a;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),await this._saveSession(l),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ct(n)?{error:n}:{error:new XT("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,a;try{const i=await Et(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:rs}),{data:l,error:c}=i;if(c||!l)return{data:{user:null,session:null},error:c};const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(i){if(ct(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var n,r,a;try{let i;if("email"in e){const{email:g,password:v,options:_}=e;let T=null,E=null;this.flowType==="pkce"&&([T,E]=await $o(this.storage,this.storageKey)),i=await Et(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_==null?void 0:_.emailRedirectTo,body:{email:g,password:v,data:(n=_==null?void 0:_.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken},code_challenge:T,code_challenge_method:E},xform:rs})}else if("phone"in e){const{phone:g,password:v,options:_}=e;i=await Et(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:v,data:(r=_==null?void 0:_.data)!==null&&r!==void 0?r:{},channel:(a=_==null?void 0:_.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:_==null?void 0:_.captchaToken}},xform:rs})}else throw new Of("You must provide either an email or phone number and a password");const{data:l,error:c}=i;if(c||!l)return{data:{user:null,session:null},error:c};const d=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(i){if(ct(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:l,options:c}=e;n=await Et(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:_y})}else if("phone"in e){const{phone:i,password:l,options:c}=e;n=await Et(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:_y})}else throw new Of("You must provide either an email or phone number and a password");const{data:r,error:a}=n;return a?{data:{user:null,session:null},error:a}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Lf}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(n){if(ct(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,a,i,l,c,d,f,g,v,_,T;let E,S;if("message"in e)E=e.message,S=e.signature;else{const{chain:b,wallet:k,statement:A,options:C}=e;let I;if(fa())if(typeof k=="object")I=k;else{const j=window;if("solana"in j&&typeof j.solana=="object"&&("signIn"in j.solana&&typeof j.solana.signIn=="function"||"signMessage"in j.solana&&typeof j.solana.signMessage=="function"))I=j.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!(C!=null&&C.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");I=k}const B=new URL((n=C==null?void 0:C.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in I&&I.signIn){const j=await I.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C==null?void 0:C.signInWithSolana),{version:"1",domain:B.host,uri:B.href}),A?{statement:A}:null));let F;if(Array.isArray(j)&&j[0]&&typeof j[0]=="object")F=j[0];else if(j&&typeof j=="object"&&"signedMessage"in j&&"signature"in j)F=j;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in F&&"signature"in F&&(typeof F.signedMessage=="string"||F.signedMessage instanceof Uint8Array)&&F.signature instanceof Uint8Array)E=typeof F.signedMessage=="string"?F.signedMessage:new TextDecoder().decode(F.signedMessage),S=F.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in I)||typeof I.signMessage!="function"||!("publicKey"in I)||typeof I!="object"||!I.publicKey||!("toBase58"in I.publicKey)||typeof I.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");E=[`${B.host} wants you to sign in with your Solana account:`,I.publicKey.toBase58(),...A?["",A,""]:[""],"Version: 1",`URI: ${B.href}`,`Issued At: ${(a=(r=C==null?void 0:C.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=C==null?void 0:C.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((l=C==null?void 0:C.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((c=C==null?void 0:C.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((d=C==null?void 0:C.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((f=C==null?void 0:C.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((v=(g=C==null?void 0:C.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||v===void 0)&&v.length?["Resources",...C.signInWithSolana.resources.map(F=>`- ${F}`)]:[]].join(`
`);const j=await I.signMessage(new TextEncoder().encode(E),"utf8");if(!j||!(j instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");S=j}}try{const{data:b,error:k}=await Et(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:E,signature:G4(S)},!((_=e.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(T=e.options)===null||T===void 0?void 0:T.captchaToken}}:null),xform:rs});if(k)throw k;return!b||!b.session||!b.user?{data:{user:null,session:null},error:new Lf}:(b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),{data:Object.assign({},b),error:k})}catch(b){if(ct(b))return{data:{user:null,session:null},error:b};throw b}}async _exchangeCodeForSession(e){const n=await Uf(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(n??"").split("/");try{const{data:i,error:l}=await Et(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:rs});if(await Bf(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Lf}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:l})}catch(i){if(ct(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:n,provider:r,token:a,access_token:i,nonce:l}=e,c=await Et(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:i,nonce:l,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:rs}),{data:d,error:f}=c;return f?{data:{user:null,session:null},error:f}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new Lf}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:f})}catch(n){if(ct(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,a,i,l;try{if("email"in e){const{email:c,options:d}=e;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await $o(this.storage,this.storageKey));const{error:v}=await Et(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},create_user:(r=d==null?void 0:d.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:g},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:v}}if("phone"in e){const{phone:c,options:d}=e,{data:f,error:g}=await Et(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(a=d==null?void 0:d.data)!==null&&a!==void 0?a:{},create_user:(i=d==null?void 0:d.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(l=d==null?void 0:d.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:g}}throw new Of("You must provide either an email or phone number.")}catch(c){if(ct(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(e){var n,r;try{let a,i;"options"in e&&(a=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:l,error:c}=await Et(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:rs});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");const d=l.session,f=l.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:f,session:d},error:null}}catch(a){if(ct(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var n,r,a;try{let i=null,l=null;return this.flowType==="pkce"&&([i,l]=await $o(this.storage,this.storageKey)),await Et(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:l}),headers:this.headers,xform:uN})}catch(i){if(ct(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Gs;const{error:a}=await Et(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(ct(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:a,options:i}=e,{error:l}=await Et(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in e){const{phone:r,type:a,options:i}=e,{data:l,error:c}=await Et(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:c}}throw new Of("You must provide either an email or phone number and a type")}catch(n){if(ct(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Uf(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<tm:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let l=this.suppressGetSessionWarning;e=new Proxy(e,{get:(d,f,g)=>(!l&&f==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,f,g))})}return{data:{session:e},error:null}}const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Et(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ys}):await this._useSession(async n=>{var r,a,i;const{data:l,error:c}=n;if(c)throw c;return!(!((r=l.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Gs}:await Et(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:Ys})})}catch(n){if(ct(n))return O4(n)&&(await this._removeSession(),await Bf(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:a,error:i}=r;if(i)throw i;if(!a.session)throw new Gs;const l=a.session;let c=null,d=null;this.flowType==="pkce"&&e.email!=null&&([c,d]=await $o(this.storage,this.storageKey));const{data:f,error:g}=await Et(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:d}),jwt:l.access_token,xform:Ys});if(g)throw g;return l.user=f.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(r){if(ct(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Gs;const n=Date.now()/1e3;let r=n,a=!0,i=null;const{payload:l}=rm(e.access_token);if(l.exp&&(r=l.exp,a=r<=n),a){const{session:c,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!c)return{data:{user:null,session:null},error:null};i=c}else{const{data:c,error:d}=await this._getUser(e.access_token);if(d)throw d;i={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(n){if(ct(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:l,error:c}=n;if(c)throw c;e=(r=l.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Gs;const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(ct(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!fa())throw new Pf("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Pf(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new my("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Pf("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new my("No code detected.");const{data:A,error:C}=await this._exchangeCodeForSession(e.code);if(C)throw C;const I=new URL(window.location.href);return I.searchParams.delete("code"),window.history.replaceState(window.history.state,"",I.toString()),{data:{session:A.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:i,refresh_token:l,expires_in:c,expires_at:d,token_type:f}=e;if(!i||!c||!l||!f)throw new Pf("No session defined in URL");const g=Math.round(Date.now()/1e3),v=parseInt(c);let _=g+v;d&&(_=parseInt(d));const T=_-g;T*1e3<=Ko&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${T}s, should have been closer to ${v}s`);const E=_-v;g-E>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",E,_,g):g-E<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",E,_,g);const{data:S,error:b}=await this._getUser(i);if(b)throw b;const k={provider_token:r,provider_refresh_token:a,access_token:i,expires_in:v,expires_at:_,refresh_token:l,token_type:f,user:S.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:k,redirectType:e.type},error:null}}catch(r){if(ct(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Uf(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:a,error:i}=n;if(i)return{error:i};const l=(r=a.session)===null||r===void 0?void 0:r.access_token;if(l){const{error:c}=await this.admin.signOut(l,e);if(c&&!(L4(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return e!=="others"&&(await this._removeSession(),await Bf(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=q4(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,a;try{const{data:{session:i},error:l}=n;if(l)throw l;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await $o(this.storage,this.storageKey,!0));try{return await Et(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(ct(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(ct(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:a}=await this._useSession(async i=>{var l,c,d,f,g;const{data:v,error:_}=i;if(_)throw _;const T=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await Et(this.fetch,"GET",T,{headers:this.headers,jwt:(g=(f=v.session)===null||f===void 0?void 0:f.access_token)!==null&&g!==void 0?g:void 0})});if(a)throw a;return fa()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(ct(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,a;const{data:i,error:l}=n;if(l)throw l;return await Et(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(ct(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await K4(async a=>(a>0&&await J4(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await Et(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:rs})),(a,i)=>{const l=200*Math.pow(2,a);return i&&nm(i)&&Date.now()+l-r<Ko})}catch(r){if(this._debug(n,"error",r),ct(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),fa()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await Uf(this.storage,this.storageKey);if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const a=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<tm;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${tm}s`),a){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=await this._callRefreshToken(r.refresh_token);i&&(console.error(i),nm(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Gs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Rd;const{data:i,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!i.session)throw new Gs;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const c={session:i.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(i){if(this._debug(a,"error",i),ct(i)){const l={session:null,error:i};return nm(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(l),l}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,n,r=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],l=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,n)}catch(d){i.push(d)}});if(await Promise.all(l),i.length>0){for(let c=0;c<i.length;c+=1)console.error(i[c]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await e2(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Bf(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&fa()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ko);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-e)/Ko);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Ko}ms, refresh threshold is ${Rm} ticks`),a<=Rm&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof t2)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!fa()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const a=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,l]=await $o(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(l)}`});a.push(c.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);a.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;return i?{data:null,error:i}:await Et(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ct(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,a;const{data:i,error:l}=n;if(l)return{data:null,error:l};const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:d,error:f}=await Et(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return f?{data:null,error:f}:(e.factorType==="totp"&&(!((a=d==null?void 0:d.totp)===null||a===void 0)&&a.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(n){if(ct(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;if(i)return{data:null,error:i};const{data:l,error:c}=await Et(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:c})})}catch(n){if(ct(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;return i?{data:null,error:i}:await Et(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ct(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],a=r.filter(l=>l.factor_type==="totp"&&l.status==="verified"),i=r.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:r,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:a},error:i}=e;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=rm(a.access_token);let c=null;l.aal&&(c=l.aal);let d=c;((r=(n=a.user.factors)===null||n===void 0?void 0:n.filter(v=>v.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(d="aal2");const g=l.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:g},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(l=>l.kid===e);if(r||(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+I4>Date.now()))return r;const{data:a,error:i}=await Et(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!a.keys||a.keys.length===0)throw new Oc("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),r=a.keys.find(l=>l.kid===e),!r)throw new Oc("No matching signing key found in JWKS");return r}async getClaims(e,n={keys:[]}){try{let r=e;if(!r){const{data:T,error:E}=await this.getSession();if(E||!T.session)return{data:null,error:E};r=T.session.access_token}const{header:a,payload:i,signature:l,raw:{header:c,payload:d}}=rm(r);if(rN(i.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:T}=await this.getUser(r);if(T)throw T;return{data:{claims:i,header:a,signature:l},error:null}}const f=aN(a.alg),g=await this.fetchJwk(a.kid,n),v=await crypto.subtle.importKey("jwk",g,f,!0,["verify"]);if(!await crypto.subtle.verify(f,v,l,$4(`${c}.${d}`)))throw new Oc("Invalid JWT signature");return{data:{claims:i,header:a,signature:l},error:null}}catch(r){if(ct(r))return{data:null,error:r};throw r}}}Jc.nextInstanceID=0;const wN=Jc;class TN extends wN{constructor(e){super(e)}}var EN=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function c(g){try{f(r.next(g))}catch(v){l(v)}}function d(g){try{f(r.throw(g))}catch(v){l(v)}}function f(g){g.done?i(g.value):a(g.value).then(c,d)}f((r=r.apply(t,e||[])).next())})};class SN{constructor(e,n,r){var a,i,l;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const c=A4(e),d=new URL(c);this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const f=`sb-${d.hostname.split(".")[0]}-auth-token`,g={db:y4,realtime:w4,auth:Object.assign(Object.assign({},_4),{storageKey:f}),global:v4},v=k4(r??{},g);this.storageKey=(a=v.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=v.global.headers)!==null&&i!==void 0?i:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(_,T)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(T)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=v.auth)!==null&&l!==void 0?l:{},this.headers,v.global.fetch),this.fetch=b4(n,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.rest=new Vk(new URL("rest/v1",d).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),v.accessToken||this._listenForAuthEvents()}get functions(){return new Nk(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new p4(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return EN(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,storageKey:i,flowType:l,lock:c,debug:d},f,g){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new TN({url:this.authUrl.href,headers:Object.assign(Object.assign({},v),f),storageKey:i,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,flowType:l,lock:c,debug:d,fetch:g,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new n4(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const bN=(t,e,n)=>new SN(t,e,n),CN="https://znpylxcqmerkfinbzoge.supabase.co",AN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpucHlseGNxbWVya2ZpbmJ6b2dlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIwMjYyNjQsImV4cCI6MjA2NzYwMjI2NH0.6kHzp3nPH3nIP9NJ7M9-lT_OtUHLjifM86ryjfCa65I",at=bN(CN,AN);var dr=(t=>(t.NOT_STARTED="Not Started",t.IN_PROGRESS="In Progress",t.COMPLETED="Completed",t))(dr||{}),Im=(t=>(t.PENDING="pending",t.ACHIEVED="achieved",t.MISSED="missed",t))(Im||{}),Ri=(t=>(t.NOT_STARTED="Not Started",t.IN_PROGRESS="In Progress",t.COMPLETED="Completed",t.BLOCKED="Blocked",t))(Ri||{}),ka=(t=>(t[t.INPUT_FORM=0]="INPUT_FORM",t[t.PROJECT_FLOW=1]="PROJECT_FLOW",t[t.TASK_DETAIL=2]="TASK_DETAIL",t))(ka||{}),Pt;(function(t){t.assertEqual=a=>{};function e(a){}t.assertIs=e;function n(a){throw new Error}t.assertNever=n,t.arrayToEnum=a=>{const i={};for(const l of a)i[l]=l;return i},t.getValidEnumValues=a=>{const i=t.objectKeys(a).filter(c=>typeof a[a[c]]!="number"),l={};for(const c of i)l[c]=a[c];return t.objectValues(l)},t.objectValues=a=>t.objectKeys(a).map(function(i){return a[i]}),t.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const l in a)Object.prototype.hasOwnProperty.call(a,l)&&i.push(l);return i},t.find=(a,i)=>{for(const l of a)if(i(l))return l},t.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function r(a,i=" | "){return a.map(l=>typeof l=="string"?`'${l}'`:l).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(Pt||(Pt={}));var Ey;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(Ey||(Ey={}));const $e=Pt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),qs=t=>{switch(typeof t){case"undefined":return $e.undefined;case"string":return $e.string;case"number":return Number.isNaN(t)?$e.nan:$e.number;case"boolean":return $e.boolean;case"function":return $e.function;case"bigint":return $e.bigint;case"symbol":return $e.symbol;case"object":return Array.isArray(t)?$e.array:t===null?$e.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?$e.promise:typeof Map<"u"&&t instanceof Map?$e.map:typeof Set<"u"&&t instanceof Set?$e.set:typeof Date<"u"&&t instanceof Date?$e.date:$e.object;default:return $e.unknown}},Le=Pt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class fs extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(i){return i.message},r={_errors:[]},a=i=>{for(const l of i.issues)if(l.code==="invalid_union")l.unionErrors.map(a);else if(l.code==="invalid_return_type")a(l.returnTypeError);else if(l.code==="invalid_arguments")a(l.argumentsError);else if(l.path.length===0)r._errors.push(n(l));else{let c=r,d=0;for(;d<l.path.length;){const f=l.path[d];d===l.path.length-1?(c[f]=c[f]||{_errors:[]},c[f]._errors.push(n(l))):c[f]=c[f]||{_errors:[]},c=c[f],d++}}};return a(this),r}static assert(e){if(!(e instanceof fs))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Pt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const a of this.issues)if(a.path.length>0){const i=a.path[0];n[i]=n[i]||[],n[i].push(e(a))}else r.push(e(a));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}fs.create=t=>new fs(t);const Fm=(t,e)=>{let n;switch(t.code){case Le.invalid_type:t.received===$e.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case Le.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Pt.jsonStringifyReplacer)}`;break;case Le.unrecognized_keys:n=`Unrecognized key(s) in object: ${Pt.joinValues(t.keys,", ")}`;break;case Le.invalid_union:n="Invalid input";break;case Le.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Pt.joinValues(t.options)}`;break;case Le.invalid_enum_value:n=`Invalid enum value. Expected ${Pt.joinValues(t.options)}, received '${t.received}'`;break;case Le.invalid_arguments:n="Invalid function arguments";break;case Le.invalid_return_type:n="Invalid function return type";break;case Le.invalid_date:n="Invalid date";break;case Le.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Pt.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case Le.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case Le.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case Le.custom:n="Invalid input";break;case Le.invalid_intersection_types:n="Intersection results could not be merged";break;case Le.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case Le.not_finite:n="Number must be finite";break;default:n=e.defaultError,Pt.assertNever(t)}return{message:n}};let kN=Fm;function NN(){return kN}const RN=t=>{const{data:e,path:n,errorMaps:r,issueData:a}=t,i=[...n,...a.path||[]],l={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let c="";const d=r.filter(f=>!!f).slice().reverse();for(const f of d)c=f(l,{data:e,defaultError:c}).message;return{...a,path:i,message:c}};function je(t,e){const n=NN(),r=RN({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===Fm?void 0:Fm].filter(a=>!!a)});t.common.issues.push(r)}class xr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const a of n){if(a.status==="aborted")return st;a.status==="dirty"&&e.dirty(),r.push(a.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const a of n){const i=await a.key,l=await a.value;r.push({key:i,value:l})}return xr.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const a of n){const{key:i,value:l}=a;if(i.status==="aborted"||l.status==="aborted")return st;i.status==="dirty"&&e.dirty(),l.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof l.value<"u"||a.alwaysSet)&&(r[i.value]=l.value)}return{status:e.value,value:r}}}const st=Object.freeze({status:"aborted"}),Ac=t=>({status:"dirty",value:t}),ta=t=>({status:"valid",value:t}),Sy=t=>t.status==="aborted",by=t=>t.status==="dirty",ol=t=>t.status==="valid",id=t=>typeof Promise<"u"&&t instanceof Promise;var ze;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(ze||(ze={}));class Fa{constructor(e,n,r,a){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Cy=(t,e)=>{if(ol(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new fs(t.common.issues);return this._error=n,this._error}}};function ht(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:a}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(l,c)=>{const{message:d}=t;return l.code==="invalid_enum_value"?{message:d??c.defaultError}:typeof c.data>"u"?{message:d??r??c.defaultError}:l.code!=="invalid_type"?{message:c.defaultError}:{message:d??n??c.defaultError}},description:a}}class At{get description(){return this._def.description}_getType(e){return qs(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:qs(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new xr,ctx:{common:e.parent.common,data:e.data,parsedType:qs(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(id(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:qs(e)},a=this._parseSync({data:e,path:r.path,parent:r});return Cy(r,a)}"~validate"(e){var r,a;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:qs(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:n});return ol(i)?{value:i.value}:{issues:n.common.issues}}catch(i){(a=(r=i==null?void 0:i.message)==null?void 0:r.toLowerCase())!=null&&a.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(i=>ol(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:qs(e)},a=this._parse({data:e,path:r.path,parent:r}),i=await(id(a)?a:Promise.resolve(a));return Cy(r,i)}refine(e,n){const r=a=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(a):n;return this._refinement((a,i)=>{const l=e(a),c=()=>i.addIssue({code:Le.custom,...r(a)});return typeof Promise<"u"&&l instanceof Promise?l.then(d=>d?!0:(c(),!1)):l?!0:(c(),!1)})}refinement(e,n){return this._refinement((r,a)=>e(r)?!0:(a.addIssue(typeof n=="function"?n(r,a):n),!1))}_refinement(e){return new ul({schema:this,typeName:rt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Xs.create(this,this._def)}nullable(){return fl.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ma.create(this)}promise(){return fd.create(this,this._def)}or(e){return ld.create([this,e],this._def)}and(e){return cd.create(this,e,this._def)}transform(e){return new ul({...ht(this._def),schema:this,typeName:rt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new Um({...ht(this._def),innerType:this,defaultValue:n,typeName:rt.ZodDefault})}brand(){return new QN({typeName:rt.ZodBranded,type:this,...ht(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new Bm({...ht(this._def),innerType:this,catchValue:n,typeName:rt.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return Tp.create(this,e)}readonly(){return jm.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const DN=/^c[^\s-]{8,}$/i,MN=/^[0-9a-z]+$/,IN=/^[0-9A-HJKMNP-TV-Z]{26}$/i,FN=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,LN=/^[a-z0-9_-]{21}$/i,ON=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,PN=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,UN=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,BN="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let sm;const jN=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,VN=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,HN=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,$N=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,GN=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,zN=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,n2="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",qN=new RegExp(`^${n2}$`);function r2(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function YN(t){return new RegExp(`^${r2(t)}$`)}function WN(t){let e=`${n2}T${r2(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function JN(t,e){return!!((e==="v4"||!e)&&jN.test(t)||(e==="v6"||!e)&&HN.test(t))}function KN(t,e){if(!ON.test(t))return!1;try{const[n]=t.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),a=JSON.parse(atob(r));return!(typeof a!="object"||a===null||"typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||e&&a.alg!==e)}catch{return!1}}function XN(t,e){return!!((e==="v4"||!e)&&VN.test(t)||(e==="v6"||!e)&&$N.test(t))}class Ra extends At{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==$e.string){const i=this._getOrReturnCtx(e);return je(i,{code:Le.invalid_type,expected:$e.string,received:i.parsedType}),st}const r=new xr;let a;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(a=this._getOrReturnCtx(e,a),je(a,{code:Le.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(a=this._getOrReturnCtx(e,a),je(a,{code:Le.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const l=e.data.length>i.value,c=e.data.length<i.value;(l||c)&&(a=this._getOrReturnCtx(e,a),l?je(a,{code:Le.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&je(a,{code:Le.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")UN.test(e.data)||(a=this._getOrReturnCtx(e,a),je(a,{validation:"email",code:Le.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")sm||(sm=new RegExp(BN,"u")),sm.test(e.data)||(a=this._getOrReturnCtx(e,a),je(a,{validation:"emoji",code:Le.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")FN.test(e.data)||(a=this._getOrReturnCtx(e,a),je(a,{validation:"uuid",code:Le.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")LN.test(e.data)||(a=this._getOrReturnCtx(e,a),je(a,{validation:"nanoid",code:Le.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")DN.test(e.data)||(a=this._getOrReturnCtx(e,a),je(a,{validation:"cuid",code:Le.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")MN.test(e.data)||(a=this._getOrReturnCtx(e,a),je(a,{validation:"cuid2",code:Le.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")IN.test(e.data)||(a=this._getOrReturnCtx(e,a),je(a,{validation:"ulid",code:Le.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),je(a,{validation:"url",code:Le.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),je(a,{validation:"regex",code:Le.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(e,a),je(a,{code:Le.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(a=this._getOrReturnCtx(e,a),je(a,{code:Le.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(a=this._getOrReturnCtx(e,a),je(a,{code:Le.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?WN(i).test(e.data)||(a=this._getOrReturnCtx(e,a),je(a,{code:Le.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?qN.test(e.data)||(a=this._getOrReturnCtx(e,a),je(a,{code:Le.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?YN(i).test(e.data)||(a=this._getOrReturnCtx(e,a),je(a,{code:Le.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?PN.test(e.data)||(a=this._getOrReturnCtx(e,a),je(a,{validation:"duration",code:Le.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?JN(e.data,i.version)||(a=this._getOrReturnCtx(e,a),je(a,{validation:"ip",code:Le.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?KN(e.data,i.alg)||(a=this._getOrReturnCtx(e,a),je(a,{validation:"jwt",code:Le.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?XN(e.data,i.version)||(a=this._getOrReturnCtx(e,a),je(a,{validation:"cidr",code:Le.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?GN.test(e.data)||(a=this._getOrReturnCtx(e,a),je(a,{validation:"base64",code:Le.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?zN.test(e.data)||(a=this._getOrReturnCtx(e,a),je(a,{validation:"base64url",code:Le.invalid_string,message:i.message}),r.dirty()):Pt.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(a=>e.test(a),{validation:n,code:Le.invalid_string,...ze.errToObj(r)})}_addCheck(e){return new Ra({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ze.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ze.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ze.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ze.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ze.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ze.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ze.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ze.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ze.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...ze.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...ze.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ze.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...ze.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...ze.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...ze.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...ze.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...ze.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...ze.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...ze.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...ze.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...ze.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...ze.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...ze.errToObj(n)})}nonempty(e){return this.min(1,ze.errToObj(e))}trim(){return new Ra({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ra({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ra({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Ra.create=t=>new Ra({checks:[],typeName:rt.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...ht(t)});function ZN(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,a=n>r?n:r,i=Number.parseInt(t.toFixed(a).replace(".","")),l=Number.parseInt(e.toFixed(a).replace(".",""));return i%l/10**a}class Li extends At{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==$e.number){const i=this._getOrReturnCtx(e);return je(i,{code:Le.invalid_type,expected:$e.number,received:i.parsedType}),st}let r;const a=new xr;for(const i of this._def.checks)i.kind==="int"?Pt.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),je(r,{code:Le.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),je(r,{code:Le.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),je(r,{code:Le.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?ZN(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),je(r,{code:Le.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),je(r,{code:Le.not_finite,message:i.message}),a.dirty()):Pt.assertNever(i);return{status:a.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,ze.toString(n))}gt(e,n){return this.setLimit("min",e,!1,ze.toString(n))}lte(e,n){return this.setLimit("max",e,!0,ze.toString(n))}lt(e,n){return this.setLimit("max",e,!1,ze.toString(n))}setLimit(e,n,r,a){return new Li({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:ze.toString(a)}]})}_addCheck(e){return new Li({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ze.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ze.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ze.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ze.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ze.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:ze.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:ze.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ze.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ze.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Pt.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Li.create=t=>new Li({checks:[],typeName:rt.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...ht(t)});class Oi extends At{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==$e.bigint)return this._getInvalidInput(e);let r;const a=new xr;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),je(r,{code:Le.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),je(r,{code:Le.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),je(r,{code:Le.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):Pt.assertNever(i);return{status:a.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return je(n,{code:Le.invalid_type,expected:$e.bigint,received:n.parsedType}),st}gte(e,n){return this.setLimit("min",e,!0,ze.toString(n))}gt(e,n){return this.setLimit("min",e,!1,ze.toString(n))}lte(e,n){return this.setLimit("max",e,!0,ze.toString(n))}lt(e,n){return this.setLimit("max",e,!1,ze.toString(n))}setLimit(e,n,r,a){return new Oi({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:ze.toString(a)}]})}_addCheck(e){return new Oi({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ze.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ze.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ze.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ze.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:ze.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Oi.create=t=>new Oi({checks:[],typeName:rt.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...ht(t)});class od extends At{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==$e.boolean){const r=this._getOrReturnCtx(e);return je(r,{code:Le.invalid_type,expected:$e.boolean,received:r.parsedType}),st}return ta(e.data)}}od.create=t=>new od({typeName:rt.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...ht(t)});class ll extends At{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==$e.date){const i=this._getOrReturnCtx(e);return je(i,{code:Le.invalid_type,expected:$e.date,received:i.parsedType}),st}if(Number.isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return je(i,{code:Le.invalid_date}),st}const r=new xr;let a;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(a=this._getOrReturnCtx(e,a),je(a,{code:Le.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(a=this._getOrReturnCtx(e,a),je(a,{code:Le.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Pt.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ll({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:ze.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:ze.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}ll.create=t=>new ll({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:rt.ZodDate,...ht(t)});class Ay extends At{_parse(e){if(this._getType(e)!==$e.symbol){const r=this._getOrReturnCtx(e);return je(r,{code:Le.invalid_type,expected:$e.symbol,received:r.parsedType}),st}return ta(e.data)}}Ay.create=t=>new Ay({typeName:rt.ZodSymbol,...ht(t)});class ky extends At{_parse(e){if(this._getType(e)!==$e.undefined){const r=this._getOrReturnCtx(e);return je(r,{code:Le.invalid_type,expected:$e.undefined,received:r.parsedType}),st}return ta(e.data)}}ky.create=t=>new ky({typeName:rt.ZodUndefined,...ht(t)});class Ny extends At{_parse(e){if(this._getType(e)!==$e.null){const r=this._getOrReturnCtx(e);return je(r,{code:Le.invalid_type,expected:$e.null,received:r.parsedType}),st}return ta(e.data)}}Ny.create=t=>new Ny({typeName:rt.ZodNull,...ht(t)});class Ry extends At{constructor(){super(...arguments),this._any=!0}_parse(e){return ta(e.data)}}Ry.create=t=>new Ry({typeName:rt.ZodAny,...ht(t)});class Lm extends At{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ta(e.data)}}Lm.create=t=>new Lm({typeName:rt.ZodUnknown,...ht(t)});class ti extends At{_parse(e){const n=this._getOrReturnCtx(e);return je(n,{code:Le.invalid_type,expected:$e.never,received:n.parsedType}),st}}ti.create=t=>new ti({typeName:rt.ZodNever,...ht(t)});class Dy extends At{_parse(e){if(this._getType(e)!==$e.undefined){const r=this._getOrReturnCtx(e);return je(r,{code:Le.invalid_type,expected:$e.void,received:r.parsedType}),st}return ta(e.data)}}Dy.create=t=>new Dy({typeName:rt.ZodVoid,...ht(t)});class Ma extends At{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),a=this._def;if(n.parsedType!==$e.array)return je(n,{code:Le.invalid_type,expected:$e.array,received:n.parsedType}),st;if(a.exactLength!==null){const l=n.data.length>a.exactLength.value,c=n.data.length<a.exactLength.value;(l||c)&&(je(n,{code:l?Le.too_big:Le.too_small,minimum:c?a.exactLength.value:void 0,maximum:l?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&n.data.length<a.minLength.value&&(je(n,{code:Le.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&n.data.length>a.maxLength.value&&(je(n,{code:Le.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((l,c)=>a.type._parseAsync(new Fa(n,l,n.path,c)))).then(l=>xr.mergeArray(r,l));const i=[...n.data].map((l,c)=>a.type._parseSync(new Fa(n,l,n.path,c)));return xr.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new Ma({...this._def,minLength:{value:e,message:ze.toString(n)}})}max(e,n){return new Ma({...this._def,maxLength:{value:e,message:ze.toString(n)}})}length(e,n){return new Ma({...this._def,exactLength:{value:e,message:ze.toString(n)}})}nonempty(e){return this.min(1,e)}}Ma.create=(t,e)=>new Ma({type:t,minLength:null,maxLength:null,exactLength:null,typeName:rt.ZodArray,...ht(e)});function Xo(t){if(t instanceof kn){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=Xs.create(Xo(r))}return new kn({...t._def,shape:()=>e})}else return t instanceof Ma?new Ma({...t._def,type:Xo(t.element)}):t instanceof Xs?Xs.create(Xo(t.unwrap())):t instanceof fl?fl.create(Xo(t.unwrap())):t instanceof Pi?Pi.create(t.items.map(e=>Xo(e))):t}class kn extends At{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Pt.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==$e.object){const f=this._getOrReturnCtx(e);return je(f,{code:Le.invalid_type,expected:$e.object,received:f.parsedType}),st}const{status:r,ctx:a}=this._processInputParams(e),{shape:i,keys:l}=this._getCached(),c=[];if(!(this._def.catchall instanceof ti&&this._def.unknownKeys==="strip"))for(const f in a.data)l.includes(f)||c.push(f);const d=[];for(const f of l){const g=i[f],v=a.data[f];d.push({key:{status:"valid",value:f},value:g._parse(new Fa(a,v,a.path,f)),alwaysSet:f in a.data})}if(this._def.catchall instanceof ti){const f=this._def.unknownKeys;if(f==="passthrough")for(const g of c)d.push({key:{status:"valid",value:g},value:{status:"valid",value:a.data[g]}});else if(f==="strict")c.length>0&&(je(a,{code:Le.unrecognized_keys,keys:c}),r.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const g of c){const v=a.data[g];d.push({key:{status:"valid",value:g},value:f._parse(new Fa(a,v,a.path,g)),alwaysSet:g in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const f=[];for(const g of d){const v=await g.key,_=await g.value;f.push({key:v,value:_,alwaysSet:g.alwaysSet})}return f}).then(f=>xr.mergeObjectSync(r,f)):xr.mergeObjectSync(r,d)}get shape(){return this._def.shape()}strict(e){return ze.errToObj,new kn({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var i,l;const a=((l=(i=this._def).errorMap)==null?void 0:l.call(i,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:ze.errToObj(e).message??a}:{message:a}}}:{}})}strip(){return new kn({...this._def,unknownKeys:"strip"})}passthrough(){return new kn({...this._def,unknownKeys:"passthrough"})}extend(e){return new kn({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new kn({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:rt.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new kn({...this._def,catchall:e})}pick(e){const n={};for(const r of Pt.objectKeys(e))e[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new kn({...this._def,shape:()=>n})}omit(e){const n={};for(const r of Pt.objectKeys(this.shape))e[r]||(n[r]=this.shape[r]);return new kn({...this._def,shape:()=>n})}deepPartial(){return Xo(this)}partial(e){const n={};for(const r of Pt.objectKeys(this.shape)){const a=this.shape[r];e&&!e[r]?n[r]=a:n[r]=a.optional()}return new kn({...this._def,shape:()=>n})}required(e){const n={};for(const r of Pt.objectKeys(this.shape))if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Xs;)i=i._def.innerType;n[r]=i}return new kn({...this._def,shape:()=>n})}keyof(){return a2(Pt.objectKeys(this.shape))}}kn.create=(t,e)=>new kn({shape:()=>t,unknownKeys:"strip",catchall:ti.create(),typeName:rt.ZodObject,...ht(e)});kn.strictCreate=(t,e)=>new kn({shape:()=>t,unknownKeys:"strict",catchall:ti.create(),typeName:rt.ZodObject,...ht(e)});kn.lazycreate=(t,e)=>new kn({shape:t,unknownKeys:"strip",catchall:ti.create(),typeName:rt.ZodObject,...ht(e)});class ld extends At{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function a(i){for(const c of i)if(c.result.status==="valid")return c.result;for(const c of i)if(c.result.status==="dirty")return n.common.issues.push(...c.ctx.common.issues),c.result;const l=i.map(c=>new fs(c.ctx.common.issues));return je(n,{code:Le.invalid_union,unionErrors:l}),st}if(n.common.async)return Promise.all(r.map(async i=>{const l={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:l}),ctx:l}})).then(a);{let i;const l=[];for(const d of r){const f={...n,common:{...n.common,issues:[]},parent:null},g=d._parseSync({data:n.data,path:n.path,parent:f});if(g.status==="valid")return g;g.status==="dirty"&&!i&&(i={result:g,ctx:f}),f.common.issues.length&&l.push(f.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const c=l.map(d=>new fs(d));return je(n,{code:Le.invalid_union,unionErrors:c}),st}}get options(){return this._def.options}}ld.create=(t,e)=>new ld({options:t,typeName:rt.ZodUnion,...ht(e)});function Om(t,e){const n=qs(t),r=qs(e);if(t===e)return{valid:!0,data:t};if(n===$e.object&&r===$e.object){const a=Pt.objectKeys(e),i=Pt.objectKeys(t).filter(c=>a.indexOf(c)!==-1),l={...t,...e};for(const c of i){const d=Om(t[c],e[c]);if(!d.valid)return{valid:!1};l[c]=d.data}return{valid:!0,data:l}}else if(n===$e.array&&r===$e.array){if(t.length!==e.length)return{valid:!1};const a=[];for(let i=0;i<t.length;i++){const l=t[i],c=e[i],d=Om(l,c);if(!d.valid)return{valid:!1};a.push(d.data)}return{valid:!0,data:a}}else return n===$e.date&&r===$e.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class cd extends At{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),a=(i,l)=>{if(Sy(i)||Sy(l))return st;const c=Om(i.value,l.value);return c.valid?((by(i)||by(l))&&n.dirty(),{status:n.value,value:c.data}):(je(r,{code:Le.invalid_intersection_types}),st)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,l])=>a(i,l)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}cd.create=(t,e,n)=>new cd({left:t,right:e,typeName:rt.ZodIntersection,...ht(n)});class Pi extends At{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==$e.array)return je(r,{code:Le.invalid_type,expected:$e.array,received:r.parsedType}),st;if(r.data.length<this._def.items.length)return je(r,{code:Le.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),st;!this._def.rest&&r.data.length>this._def.items.length&&(je(r,{code:Le.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((l,c)=>{const d=this._def.items[c]||this._def.rest;return d?d._parse(new Fa(r,l,r.path,c)):null}).filter(l=>!!l);return r.common.async?Promise.all(i).then(l=>xr.mergeArray(n,l)):xr.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new Pi({...this._def,rest:e})}}Pi.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Pi({items:t,typeName:rt.ZodTuple,rest:null,...ht(e)})};class ud extends At{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==$e.object)return je(r,{code:Le.invalid_type,expected:$e.object,received:r.parsedType}),st;const a=[],i=this._def.keyType,l=this._def.valueType;for(const c in r.data)a.push({key:i._parse(new Fa(r,c,r.path,c)),value:l._parse(new Fa(r,r.data[c],r.path,c)),alwaysSet:c in r.data});return r.common.async?xr.mergeObjectAsync(n,a):xr.mergeObjectSync(n,a)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof At?new ud({keyType:e,valueType:n,typeName:rt.ZodRecord,...ht(r)}):new ud({keyType:Ra.create(),valueType:e,typeName:rt.ZodRecord,...ht(n)})}}class My extends At{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==$e.map)return je(r,{code:Le.invalid_type,expected:$e.map,received:r.parsedType}),st;const a=this._def.keyType,i=this._def.valueType,l=[...r.data.entries()].map(([c,d],f)=>({key:a._parse(new Fa(r,c,r.path,[f,"key"])),value:i._parse(new Fa(r,d,r.path,[f,"value"]))}));if(r.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const d of l){const f=await d.key,g=await d.value;if(f.status==="aborted"||g.status==="aborted")return st;(f.status==="dirty"||g.status==="dirty")&&n.dirty(),c.set(f.value,g.value)}return{status:n.value,value:c}})}else{const c=new Map;for(const d of l){const f=d.key,g=d.value;if(f.status==="aborted"||g.status==="aborted")return st;(f.status==="dirty"||g.status==="dirty")&&n.dirty(),c.set(f.value,g.value)}return{status:n.value,value:c}}}}My.create=(t,e,n)=>new My({valueType:e,keyType:t,typeName:rt.ZodMap,...ht(n)});class Kc extends At{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==$e.set)return je(r,{code:Le.invalid_type,expected:$e.set,received:r.parsedType}),st;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(je(r,{code:Le.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),n.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(je(r,{code:Le.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),n.dirty());const i=this._def.valueType;function l(d){const f=new Set;for(const g of d){if(g.status==="aborted")return st;g.status==="dirty"&&n.dirty(),f.add(g.value)}return{status:n.value,value:f}}const c=[...r.data.values()].map((d,f)=>i._parse(new Fa(r,d,r.path,f)));return r.common.async?Promise.all(c).then(d=>l(d)):l(c)}min(e,n){return new Kc({...this._def,minSize:{value:e,message:ze.toString(n)}})}max(e,n){return new Kc({...this._def,maxSize:{value:e,message:ze.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Kc.create=(t,e)=>new Kc({valueType:t,minSize:null,maxSize:null,typeName:rt.ZodSet,...ht(e)});class Pm extends At{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Pm.create=(t,e)=>new Pm({getter:t,typeName:rt.ZodLazy,...ht(e)});class Iy extends At{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return je(n,{received:n.data,code:Le.invalid_literal,expected:this._def.value}),st}return{status:"valid",value:e.data}}get value(){return this._def.value}}Iy.create=(t,e)=>new Iy({value:t,typeName:rt.ZodLiteral,...ht(e)});function a2(t,e){return new cl({values:t,typeName:rt.ZodEnum,...ht(e)})}class cl extends At{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return je(n,{expected:Pt.joinValues(r),received:n.parsedType,code:Le.invalid_type}),st}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return je(n,{received:n.data,code:Le.invalid_enum_value,options:r}),st}return ta(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return cl.create(e,{...this._def,...n})}exclude(e,n=this._def){return cl.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}cl.create=a2;class Fy extends At{_parse(e){const n=Pt.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==$e.string&&r.parsedType!==$e.number){const a=Pt.objectValues(n);return je(r,{expected:Pt.joinValues(a),received:r.parsedType,code:Le.invalid_type}),st}if(this._cache||(this._cache=new Set(Pt.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const a=Pt.objectValues(n);return je(r,{received:r.data,code:Le.invalid_enum_value,options:a}),st}return ta(e.data)}get enum(){return this._def.values}}Fy.create=(t,e)=>new Fy({values:t,typeName:rt.ZodNativeEnum,...ht(e)});class fd extends At{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==$e.promise&&n.common.async===!1)return je(n,{code:Le.invalid_type,expected:$e.promise,received:n.parsedType}),st;const r=n.parsedType===$e.promise?n.data:Promise.resolve(n.data);return ta(r.then(a=>this._def.type.parseAsync(a,{path:n.path,errorMap:n.common.contextualErrorMap})))}}fd.create=(t,e)=>new fd({type:t,typeName:rt.ZodPromise,...ht(e)});class ul extends At{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===rt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),a=this._def.effect||null,i={addIssue:l=>{je(r,l),l.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const l=a.transform(r.data,i);if(r.common.async)return Promise.resolve(l).then(async c=>{if(n.value==="aborted")return st;const d=await this._def.schema._parseAsync({data:c,path:r.path,parent:r});return d.status==="aborted"?st:d.status==="dirty"||n.value==="dirty"?Ac(d.value):d});{if(n.value==="aborted")return st;const c=this._def.schema._parseSync({data:l,path:r.path,parent:r});return c.status==="aborted"?st:c.status==="dirty"||n.value==="dirty"?Ac(c.value):c}}if(a.type==="refinement"){const l=c=>{const d=a.refinement(c,i);if(r.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(r.common.async===!1){const c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return c.status==="aborted"?st:(c.status==="dirty"&&n.dirty(),l(c.value),{status:n.value,value:c.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>c.status==="aborted"?st:(c.status==="dirty"&&n.dirty(),l(c.value).then(()=>({status:n.value,value:c.value}))))}if(a.type==="transform")if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!ol(l))return st;const c=a.transform(l.value,i);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:c}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>ol(l)?Promise.resolve(a.transform(l.value,i)).then(c=>({status:n.value,value:c})):st);Pt.assertNever(a)}}ul.create=(t,e,n)=>new ul({schema:t,typeName:rt.ZodEffects,effect:e,...ht(n)});ul.createWithPreprocess=(t,e,n)=>new ul({schema:e,effect:{type:"preprocess",transform:t},typeName:rt.ZodEffects,...ht(n)});class Xs extends At{_parse(e){return this._getType(e)===$e.undefined?ta(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Xs.create=(t,e)=>new Xs({innerType:t,typeName:rt.ZodOptional,...ht(e)});class fl extends At{_parse(e){return this._getType(e)===$e.null?ta(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}fl.create=(t,e)=>new fl({innerType:t,typeName:rt.ZodNullable,...ht(e)});class Um extends At{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===$e.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Um.create=(t,e)=>new Um({innerType:t,typeName:rt.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ht(e)});class Bm extends At{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return id(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new fs(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new fs(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Bm.create=(t,e)=>new Bm({innerType:t,typeName:rt.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ht(e)});class Ly extends At{_parse(e){if(this._getType(e)!==$e.nan){const r=this._getOrReturnCtx(e);return je(r,{code:Le.invalid_type,expected:$e.nan,received:r.parsedType}),st}return{status:"valid",value:e.data}}}Ly.create=t=>new Ly({typeName:rt.ZodNaN,...ht(t)});class QN extends At{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Tp extends At{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?st:i.status==="dirty"?(n.dirty(),Ac(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?st:a.status==="dirty"?(n.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(e,n){return new Tp({in:e,out:n,typeName:rt.ZodPipeline})}}class jm extends At{_parse(e){const n=this._def.innerType._parse(e),r=a=>(ol(a)&&(a.value=Object.freeze(a.value)),a);return id(n)?n.then(a=>r(a)):r(n)}unwrap(){return this._def.innerType}}jm.create=(t,e)=>new jm({innerType:t,typeName:rt.ZodReadonly,...ht(e)});var rt;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(rt||(rt={}));const Ci=Ra.create,Oy=Li.create;Oi.create;const eR=od.create;ll.create;const Py=Lm.create;ti.create;const kc=Ma.create,tR=kn.create,nR=ld.create;cd.create;Pi.create;const rR=ud.create,aR=Pm.create,sR=cl.create;fd.create;Xs.create;fl.create;const qo={string:t=>Ra.create({...t,coerce:!0}),number:t=>Li.create({...t,coerce:!0}),boolean:t=>od.create({...t,coerce:!0}),bigint:t=>Oi.create({...t,coerce:!0}),date:t=>ll.create({...t,coerce:!0})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let iR,oR;function lR(){return{geminiUrl:iR,vertexUrl:oR}}function cR(t,e,n){var r,a,i;if(!(!((r=t.httpOptions)===null||r===void 0)&&r.baseUrl)){const l=lR();return t.vertexai?(a=l.vertexUrl)!==null&&a!==void 0?a:e:(i=l.geminiUrl)!==null&&i!==void 0?i:n}return t.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Yi{}function qe(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,a)=>{if(Object.prototype.hasOwnProperty.call(e,a)){const i=e[a];return i!=null?String(i):""}else throw new Error(`Key '${a}' not found in valueMap.`)})}function m(t,e,n){for(let i=0;i<e.length-1;i++){const l=e[i];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in t))if(Array.isArray(n))t[c]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(t[c])){const d=t[c];if(Array.isArray(n))for(let f=0;f<d.length;f++){const g=d[f];m(g,e.slice(i+1),n[f])}else for(const f of d)m(f,e.slice(i+1),n)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in t||(t[c]=[{}]);const d=t[c];m(d[0],e.slice(i+1),n);return}(!t[l]||typeof t[l]!="object")&&(t[l]={}),t=t[l]}const r=e[e.length-1],a=t[r];if(a!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===a)return;if(typeof a=="object"&&typeof n=="object"&&a!==null&&n!==null)Object.assign(a,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else t[r]=n}function h(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const r=e[n];if(r.endsWith("[]")){const a=r.slice(0,-2);if(a in t){const i=t[a];return Array.isArray(i)?i.map(l=>h(l,e.slice(n+1))):void 0}else return}else t=t[r]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Uy;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Uy||(Uy={}));var By;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(By||(By={}));var Da;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Da||(Da={}));var jy;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(jy||(jy={}));var Vy;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Vy||(Vy={}));var Hy;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Hy||(Hy={}));var $y;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})($y||($y={}));var Gy;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Gy||(Gy={}));var zy;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(zy||(zy={}));var qy;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(qy||(qy={}));var Yy;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(Yy||(Yy={}));var Wy;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(Wy||(Wy={}));var Jy;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Jy||(Jy={}));var Ky;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Ky||(Ky={}));var Xy;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY"})(Xy||(Xy={}));var Zy;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Zy||(Zy={}));var dd;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(dd||(dd={}));var Qy;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Qy||(Qy={}));var Vm;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Vm||(Vm={}));var e_;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(e_||(e_={}));var t_;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(t_||(t_={}));var n_;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(n_||(n_={}));var r_;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(r_||(r_={}));var a_;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(a_||(a_={}));var s_;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(s_||(s_={}));var i_;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(i_||(i_={}));var o_;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi"})(o_||(o_={}));var l_;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(l_||(l_={}));var c_;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(c_||(c_={}));var u_;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(u_||(u_={}));var f_;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(f_||(f_={}));var d_;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(d_||(d_={}));var h_;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(h_||(h_={}));var m_;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(m_||(m_={}));var p_;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(p_||(p_={}));var g_;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(g_||(g_={}));var x_;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(x_||(x_={}));var v_;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(v_||(v_={}));var y_;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(y_||(y_={}));var __;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(__||(__={}));var w_;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(w_||(w_={}));var Qo;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Qo||(Qo={}));class Hm{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class bc{get text(){var e,n,r,a,i,l,c,d;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let f="",g=!1;const v=[];for(const _ of(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[T,E]of Object.entries(_))T!=="text"&&T!=="thought"&&(E!==null||E!==void 0)&&v.push(T);if(typeof _.text=="string"){if(typeof _.thought=="boolean"&&_.thought)continue;g=!0,f+=_.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),g?f:void 0}get data(){var e,n,r,a,i,l,c,d;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let f="";const g=[];for(const v of(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[_,T]of Object.entries(v))_!=="inlineData"&&(T!==null||T!==void 0)&&g.push(_);v.inlineData&&typeof v.inlineData.data=="string"&&(f+=atob(v.inlineData.data))}return g.length>0&&console.warn(`there are non-data parts ${g} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),f.length>0?btoa(f):void 0}get functionCalls(){var e,n,r,a,i,l,c,d;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const f=(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(g=>g.functionCall).map(g=>g.functionCall).filter(g=>g!==void 0);if((f==null?void 0:f.length)!==0)return f}get executableCode(){var e,n,r,a,i,l,c,d,f;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const g=(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if((g==null?void 0:g.length)!==0)return(f=g==null?void 0:g[0])===null||f===void 0?void 0:f.code}get codeExecutionResult(){var e,n,r,a,i,l,c,d,f;if(((a=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||a===void 0?void 0:a.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const g=(d=(c=(l=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if((g==null?void 0:g.length)!==0)return(f=g==null?void 0:g[0])===null||f===void 0?void 0:f.output}}class T_{}class E_{}class uR{}class fR{}class S_{}class b_{}class C_{}class dR{}class A_{}class k_{}class N_{}class hR{}class mR{}class pR{}class R_{}class gR{get text(){var e,n,r;let a="",i=!1;const l=[];for(const c of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[d,f]of Object.entries(c))d!=="text"&&d!=="thought"&&f!==null&&l.push(d);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;i=!0,a+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?a:void 0}get data(){var e,n,r;let a="";const i=[];for(const l of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[c,d]of Object.entries(l))c!=="inlineData"&&d!==null&&i.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(a+=atob(l.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),a.length>0?btoa(a):void 0}}class xR{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $t(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function s2(t,e){const n=$t(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function i2(t){return Array.isArray(t)?t.map(e=>hd(e)):[hd(t)]}function hd(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function o2(t){const e=hd(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function l2(t){const e=hd(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function D_(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function c2(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>D_(e)):[D_(t)]}function $m(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function M_(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function I_(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function ir(t){if(t==null)throw new Error("ContentUnion is required");return $m(t)?t:{role:"user",parts:c2(t)}}function u2(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=ir(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=ir(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>ir(n)):[ir(e)]}function Qr(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(M_(t)||I_(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ir(t)]}const e=[],n=[],r=$m(t[0]);for(const a of t){const i=$m(a);if(i!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(i)e.push(a);else{if(M_(a)||I_(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(a)}}return r||e.push({role:"user",parts:c2(n)}),e}const vR=new Set(["type","format","title","description","default","items","minItems","maxItems","enum","properties","required","minProperties","maxProperties","minimum","maximum","minLength","maxLength","pattern","anyOf","propertyOrdering"]),F_=sR(["string","number","integer","object","array","boolean","null"]),yR=nR([F_,kc(F_)]);function _R(t=!0){const e=aR(()=>{const n=tR({type:yR.optional(),format:Ci().optional(),title:Ci().optional(),description:Ci().optional(),default:Py().optional(),items:e.optional(),minItems:qo.string().optional(),maxItems:qo.string().optional(),enum:kc(Py()).optional(),properties:rR(Ci(),e).optional(),required:kc(Ci()).optional(),minProperties:qo.string().optional(),maxProperties:qo.string().optional(),propertyOrdering:kc(Ci()).optional(),minimum:Oy().optional(),maximum:Oy().optional(),minLength:qo.string().optional(),maxLength:qo.string().optional(),pattern:Ci().optional(),anyOf:kc(e).optional(),additionalProperties:eR().optional()});return t?n.strict():n});return e}function wR(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(Da).includes(n[0].toUpperCase())?n[0].toUpperCase():Da.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(Da).includes(r.toUpperCase())?r.toUpperCase():Da.TYPE_UNSPECIFIED})}}function tl(t){const e={},n=["items"],r=["anyOf"],a=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const i=t.anyOf;i!=null&&i.length==2&&(i[0].type==="null"?(e.nullable=!0,t=i[1]):i[1].type==="null"&&(e.nullable=!0,t=i[0])),t.type instanceof Array&&wR(t.type,e);for(const[l,c]of Object.entries(t))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(Da).includes(c.toUpperCase())?c.toUpperCase():Da.TYPE_UNSPECIFIED}else if(n.includes(l))e[l]=tl(c);else if(r.includes(l)){const d=[];for(const f of c){if(f.type=="null"){e.nullable=!0;continue}d.push(tl(f))}e[l]=d}else if(a.includes(l)){const d={};for(const[f,g]of Object.entries(c))d[f]=tl(g);e[l]=d}else{if(l==="additionalProperties")continue;e[l]=c}return e}function Xc(t){if(Object.keys(t).includes("$schema")){delete t.$schema;const e=_R().parse(t);return tl(e)}else return tl(t)}function Ep(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function Sp(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function vl(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(e.parameters=Xc(e.parameters)),e.response&&(e.response=Xc(e.response));return t}function yl(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function TR(t,e,n,r=1){const a=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:a?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:a?`${n}/${e}`:e}function hs(t,e){if(typeof e!="string")throw new Error("name must be a string");return TR(t,e,"cachedContents")}function f2(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function ms(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function ER(t){return t!=null&&typeof t=="object"&&"name"in t}function SR(t){return t!=null&&typeof t=="object"&&"video"in t}function bR(t){return t!=null&&typeof t=="object"&&"uri"in t}function d2(t){var e;let n;if(ER(t)&&(n=t.name),!(bR(t)&&(n=t.uri,n===void 0))&&!(SR(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const a=n.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${n}`);n=a[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function h2(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function m2(t){for(const e of["models","tunedModels","publisherModels"])if(CR(t,e))return t[e];return[]}function CR(t,e){return t!==null&&typeof t=="object"&&e in t}function AR(t,e={}){const n=t,r={name:n.name,description:n.description,parameters:tl(Dd(n.inputSchema))};return e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function kR(t,e={}){const n=[],r=new Set;for(const a of t){const i=a.name;if(r.has(i))throw new Error(`Duplicate function name ${i} found in MCP tools. Please ensure function names are unique.`);r.add(i);const l=AR(a,e);l.functionDeclarations&&n.push(...l.functionDeclarations)}return{functionDeclarations:n}}function NR(t){const e=[];for(const n of t)e.push(Dd(n));return e}function RR(t){const e={};for(const[n,r]of Object.entries(t)){const a=r;e[n]=Dd(a)}return e}function Dd(t){const e=new Set(["items"]),n=new Set(["anyOf"]),r=new Set(["properties"]),a={};for(const[i,l]of Object.entries(t))if(e.has(i))a[i]=Dd(l);else if(n.has(i))a[i]=NR(l);else if(r.has(i))a[i]=RR(l);else if(i==="type"){const c=l.toUpperCase();a[i]=Object.values(Da).includes(c)?c:Da.TYPE_UNSPECIFIED}else vR.has(i)&&(a[i]=l);return a}function p2(t,e){if(typeof e!="string"&&!Array.isArray(e)){if(t&&t.isVertexAI()){if(e.gcsUri&&e.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!e.gcsUri&&!e.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(e.inlinedRequests&&e.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!e.inlinedRequests&&!e.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return e}else{if(Array.isArray(e))return{inlinedRequests:e};if(typeof e=="string"){if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:[e]};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};if(e.startsWith("files/"))return{fileName:e}}}throw new Error(`Unsupported source: ${e}`)}function DR(t){const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function _l(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function g2(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function MR(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function IR(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function FR(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function LR(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],MR(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],IR(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],FR(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function x2(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>LR(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function OR(t){const e={},n=h(t,["anyOf"]);n!=null&&m(e,["anyOf"],n);const r=h(t,["default"]);r!=null&&m(e,["default"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["enum"]);i!=null&&m(e,["enum"],i);const l=h(t,["example"]);l!=null&&m(e,["example"],l);const c=h(t,["format"]);c!=null&&m(e,["format"],c);const d=h(t,["items"]);d!=null&&m(e,["items"],d);const f=h(t,["maxItems"]);f!=null&&m(e,["maxItems"],f);const g=h(t,["maxLength"]);g!=null&&m(e,["maxLength"],g);const v=h(t,["maxProperties"]);v!=null&&m(e,["maxProperties"],v);const _=h(t,["maximum"]);_!=null&&m(e,["maximum"],_);const T=h(t,["minItems"]);T!=null&&m(e,["minItems"],T);const E=h(t,["minLength"]);E!=null&&m(e,["minLength"],E);const S=h(t,["minProperties"]);S!=null&&m(e,["minProperties"],S);const b=h(t,["minimum"]);b!=null&&m(e,["minimum"],b);const k=h(t,["nullable"]);k!=null&&m(e,["nullable"],k);const A=h(t,["pattern"]);A!=null&&m(e,["pattern"],A);const C=h(t,["properties"]);C!=null&&m(e,["properties"],C);const I=h(t,["propertyOrdering"]);I!=null&&m(e,["propertyOrdering"],I);const B=h(t,["required"]);B!=null&&m(e,["required"],B);const j=h(t,["title"]);j!=null&&m(e,["title"],j);const F=h(t,["type"]);return F!=null&&m(e,["type"],F),e}function PR(t){const e={};if(h(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=h(t,["category"]);n!=null&&m(e,["category"],n);const r=h(t,["threshold"]);return r!=null&&m(e,["threshold"],r),e}function UR(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function BR(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function jR(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],BR(n)),e}function VR(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function HR(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],VR(n)),e}function $R(){return{}}function GR(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>UR(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],jR(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],HR(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],$R());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function zR(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function qR(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function YR(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],qR(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function WR(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],zR(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],YR(r)),e}function JR(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function v2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],JR(n)),e}function KR(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],v2(r)),e}function XR(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>KR(a))),m(e,["speakerVoiceConfigs"],r)}return e}function ZR(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],v2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],XR(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function QR(t){const e={},n=h(t,["includeThoughts"]);n!=null&&m(e,["includeThoughts"],n);const r=h(t,["thinkingBudget"]);return r!=null&&m(e,["thinkingBudget"],r),e}function e3(t,e,n){const r={},a=h(e,["systemInstruction"]);n!==void 0&&a!=null&&m(n,["systemInstruction"],x2(ir(a)));const i=h(e,["temperature"]);i!=null&&m(r,["temperature"],i);const l=h(e,["topP"]);l!=null&&m(r,["topP"],l);const c=h(e,["topK"]);c!=null&&m(r,["topK"],c);const d=h(e,["candidateCount"]);d!=null&&m(r,["candidateCount"],d);const f=h(e,["maxOutputTokens"]);f!=null&&m(r,["maxOutputTokens"],f);const g=h(e,["stopSequences"]);g!=null&&m(r,["stopSequences"],g);const v=h(e,["responseLogprobs"]);v!=null&&m(r,["responseLogprobs"],v);const _=h(e,["logprobs"]);_!=null&&m(r,["logprobs"],_);const T=h(e,["presencePenalty"]);T!=null&&m(r,["presencePenalty"],T);const E=h(e,["frequencyPenalty"]);E!=null&&m(r,["frequencyPenalty"],E);const S=h(e,["seed"]);S!=null&&m(r,["seed"],S);const b=h(e,["responseMimeType"]);b!=null&&m(r,["responseMimeType"],b);const k=h(e,["responseSchema"]);k!=null&&m(r,["responseSchema"],OR(Xc(k)));const A=h(e,["responseJsonSchema"]);if(A!=null&&m(r,["responseJsonSchema"],A),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const C=h(e,["safetySettings"]);if(n!==void 0&&C!=null){let G=C;Array.isArray(G)&&(G=G.map(te=>PR(te))),m(n,["safetySettings"],G)}const I=h(e,["tools"]);if(n!==void 0&&I!=null){let G=yl(I);Array.isArray(G)&&(G=G.map(te=>GR(vl(te)))),m(n,["tools"],G)}const B=h(e,["toolConfig"]);if(n!==void 0&&B!=null&&m(n,["toolConfig"],WR(B)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const j=h(e,["cachedContent"]);n!==void 0&&j!=null&&m(n,["cachedContent"],hs(t,j));const F=h(e,["responseModalities"]);F!=null&&m(r,["responseModalities"],F);const X=h(e,["mediaResolution"]);X!=null&&m(r,["mediaResolution"],X);const P=h(e,["speechConfig"]);if(P!=null&&m(r,["speechConfig"],ZR(Ep(P))),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const re=h(e,["thinkingConfig"]);return re!=null&&m(r,["thinkingConfig"],QR(re)),r}function t3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["request","model"],$t(t,r));const a=h(e,["contents"]);if(a!=null){let l=Qr(a);Array.isArray(l)&&(l=l.map(c=>x2(c))),m(n,["request","contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["request","generationConfig"],e3(t,i,n)),n}function n3(t,e){const n={};if(h(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(h(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=h(e,["fileName"]);r!=null&&m(n,["fileName"],r);const a=h(e,["inlinedRequests"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(l=>t3(t,l))),m(n,["requests","requests"],i)}return n}function r3(t,e){const n={},r=h(t,["displayName"]);if(e!==void 0&&r!=null&&m(e,["batch","displayName"],r),h(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function a3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["src"]);a!=null&&m(n,["batch","inputConfig"],n3(t,p2(t,a)));const i=h(e,["config"]);return i!=null&&m(n,["config"],r3(i,n)),n}function s3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],_l(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function i3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],_l(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function o3(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);if(e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),h(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function l3(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],o3(n,e)),e}function c3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],_l(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function u3(t){const e={},n=h(t,["format"]);n!=null&&m(e,["instancesFormat"],n);const r=h(t,["gcsUri"]);r!=null&&m(e,["gcsSource","uris"],r);const a=h(t,["bigqueryUri"]);if(a!=null&&m(e,["bigquerySource","inputUri"],a),h(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function f3(t){const e={},n=h(t,["format"]);n!=null&&m(e,["predictionsFormat"],n);const r=h(t,["gcsUri"]);r!=null&&m(e,["gcsDestination","outputUriPrefix"],r);const a=h(t,["bigqueryUri"]);if(a!=null&&m(e,["bigqueryDestination","outputUri"],a),h(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return e}function d3(t,e){const n={},r=h(t,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(t,["dest"]);return e!==void 0&&a!=null&&m(e,["outputConfig"],f3(DR(a))),n}function h3(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["model"],$t(t,r));const a=h(e,["src"]);a!=null&&m(n,["inputConfig"],u3(p2(t,a)));const i=h(e,["config"]);return i!=null&&m(n,["config"],d3(i,n)),n}function m3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],_l(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function p3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],_l(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function g3(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const i=h(t,["filter"]);return e!==void 0&&i!=null&&m(e,["_query","filter"],i),n}function x3(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],g3(n,e)),e}function v3(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],_l(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function y2(){return{}}function y3(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function _3(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function w3(t){const e={},n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function T3(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],y3(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],_3(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],w3(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function E3(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>T3(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function S3(t){const e={},n=h(t,["citationSources"]);return n!=null&&m(e,["citations"],n),e}function b3(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function C3(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>b3(a))),m(e,["urlMetadata"],r)}return e}function A3(t){const e={},n=h(t,["content"]);n!=null&&m(e,["content"],E3(n));const r=h(t,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],S3(r));const a=h(t,["tokenCount"]);a!=null&&m(e,["tokenCount"],a);const i=h(t,["finishReason"]);i!=null&&m(e,["finishReason"],i);const l=h(t,["urlContextMetadata"]);l!=null&&m(e,["urlContextMetadata"],C3(l));const c=h(t,["avgLogprobs"]);c!=null&&m(e,["avgLogprobs"],c);const d=h(t,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(t,["index"]);f!=null&&m(e,["index"],f);const g=h(t,["logprobsResult"]);g!=null&&m(e,["logprobsResult"],g);const v=h(t,["safetyRatings"]);return v!=null&&m(e,["safetyRatings"],v),e}function k3(t){const e={},n=h(t,["candidates"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>A3(c))),m(e,["candidates"],l)}const r=h(t,["modelVersion"]);r!=null&&m(e,["modelVersion"],r);const a=h(t,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const i=h(t,["usageMetadata"]);return i!=null&&m(e,["usageMetadata"],i),e}function N3(t){const e={},n=h(t,["response"]);return n!=null&&m(e,["response"],k3(n)),h(t,["error"])!=null&&m(e,["error"],y2()),e}function R3(t){const e={},n=h(t,["responsesFile"]);n!=null&&m(e,["fileName"],n);const r=h(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>N3(i))),m(e,["inlinedResponses"],a)}return e}function Gm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata","displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["metadata","state"]);a!=null&&m(e,["state"],g2(a));const i=h(t,["metadata","createTime"]);i!=null&&m(e,["createTime"],i);const l=h(t,["metadata","endTime"]);l!=null&&m(e,["endTime"],l);const c=h(t,["metadata","updateTime"]);c!=null&&m(e,["updateTime"],c);const d=h(t,["metadata","model"]);d!=null&&m(e,["model"],d);const f=h(t,["metadata","output"]);return f!=null&&m(e,["dest"],R3(f)),e}function D3(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["operations"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>Gm(i))),m(e,["batchJobs"],a)}return e}function M3(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["done"]);return r!=null&&m(e,["done"],r),h(t,["error"])!=null&&m(e,["error"],y2()),e}function _2(t){const e={},n=h(t,["details"]);n!=null&&m(e,["details"],n);const r=h(t,["code"]);r!=null&&m(e,["code"],r);const a=h(t,["message"]);return a!=null&&m(e,["message"],a),e}function I3(t){const e={},n=h(t,["instancesFormat"]);n!=null&&m(e,["format"],n);const r=h(t,["gcsSource","uris"]);r!=null&&m(e,["gcsUri"],r);const a=h(t,["bigquerySource","inputUri"]);return a!=null&&m(e,["bigqueryUri"],a),e}function F3(t){const e={},n=h(t,["predictionsFormat"]);n!=null&&m(e,["format"],n);const r=h(t,["gcsDestination","outputUriPrefix"]);r!=null&&m(e,["gcsUri"],r);const a=h(t,["bigqueryDestination","outputUri"]);return a!=null&&m(e,["bigqueryUri"],a),e}function zm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["state"]);a!=null&&m(e,["state"],g2(a));const i=h(t,["error"]);i!=null&&m(e,["error"],_2(i));const l=h(t,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(t,["startTime"]);c!=null&&m(e,["startTime"],c);const d=h(t,["endTime"]);d!=null&&m(e,["endTime"],d);const f=h(t,["updateTime"]);f!=null&&m(e,["updateTime"],f);const g=h(t,["model"]);g!=null&&m(e,["model"],g);const v=h(t,["inputConfig"]);v!=null&&m(e,["src"],I3(v));const _=h(t,["outputConfig"]);return _!=null&&m(e,["dest"],F3(_)),e}function L3(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["batchPredictionJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>zm(i))),m(e,["batchJobs"],a)}return e}function O3(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["done"]);r!=null&&m(e,["done"],r);const a=h(t,["error"]);return a!=null&&m(e,["error"],_2(a)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ui;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Ui||(Ui={}));class pu{constructor(e,n,r,a){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,a)}init(e,n,r){var a,i;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let l={config:{}};r?typeof r=="object"?l=Object.assign({},r):l=r:l={config:{}},l.config&&(l.config.pageToken=n.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(i=(a=l.config)===null||a===void 0?void 0:a.pageSize)!==null&&i!==void 0?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class P3 extends Yi{constructor(e){super(),this.apiClient=e,this.create=async n=>{if(this.apiClient.isVertexAI()){const a=Date.now().toString();if(Array.isArray(n.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(n.config=n.config||{},n.config.displayName===void 0&&(n.config.displayName="genaiBatchJob_${timestampStr}"),n.config.dest===void 0&&typeof n.src=="string")if(n.src.startsWith("gs://")&&n.src.endsWith(".jsonl"))n.config.dest=`${n.src.slice(0,-6)}/dest`;else if(n.src.startsWith("bq://"))n.config.dest=`${n.src}_dest_${a}`;else throw new Error("Unsupported source:"+n.src)}return await this.createInternal(n)},this.list=async(n={})=>new pu(Ui.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}async createInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=h3(this.apiClient,e);return c=qe("batchPredictionJobs",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>zm(g))}else{const f=a3(this.apiClient,e);return c=qe("{model}:batchGenerateContent",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Gm(g))}}async get(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=m3(this.apiClient,e);return c=qe("batchPredictionJobs/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>zm(g))}else{const f=s3(this.apiClient,e);return c=qe("batches/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Gm(g))}}async cancel(e){var n,r,a,i;let l="",c={};if(this.apiClient.isVertexAI()){const d=p3(this.apiClient,e);l=qe("batchPredictionJobs/{name}:cancel",d._url),c=d._query,delete d.config,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const d=i3(this.apiClient,e);l=qe("batches/{name}:cancel",d._url),c=d._query,delete d.config,delete d._url,delete d._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=x3(e);return c=qe("batchPredictionJobs",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=L3(g),_=new R_;return Object.assign(_,v),_})}else{const f=l3(e);return c=qe("batches",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const v=D3(g),_=new R_;return Object.assign(_,v),_})}}async delete(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=v3(this.apiClient,e);return c=qe("batchPredictionJobs/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>O3(g))}else{const f=c3(this.apiClient,e);return c=qe("batches/{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>M3(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function U3(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function B3(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function j3(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function V3(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],U3(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],B3(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],j3(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function L_(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>V3(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function H3(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function $3(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function G3(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],$3(n)),e}function z3(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function q3(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],z3(n)),e}function Y3(){return{}}function W3(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>H3(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],G3(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],q3(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],Y3());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function J3(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function K3(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function X3(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],K3(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function Z3(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],J3(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],X3(r)),e}function Q3(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);e!==void 0&&a!=null&&m(e,["expireTime"],a);const i=h(t,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const l=h(t,["contents"]);if(e!==void 0&&l!=null){let g=Qr(l);Array.isArray(g)&&(g=g.map(v=>L_(v))),m(e,["contents"],g)}const c=h(t,["systemInstruction"]);e!==void 0&&c!=null&&m(e,["systemInstruction"],L_(ir(c)));const d=h(t,["tools"]);if(e!==void 0&&d!=null){let g=d;Array.isArray(g)&&(g=g.map(v=>W3(v))),m(e,["tools"],g)}const f=h(t,["toolConfig"]);if(e!==void 0&&f!=null&&m(e,["toolConfig"],Z3(f)),h(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function e5(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["model"],s2(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],Q3(a,n)),n}function t5(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],hs(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function n5(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],hs(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function r5(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);return e!==void 0&&a!=null&&m(e,["expireTime"],a),n}function a5(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],hs(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],r5(a,n)),n}function s5(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);return e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),n}function i5(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],s5(n,e)),e}function o5(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function l5(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function c5(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function u5(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],o5(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],l5(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],c5(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function O_(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>u5(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function f5(t){const e={};if(h(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=h(t,["description"]);n!=null&&m(e,["description"],n);const r=h(t,["name"]);r!=null&&m(e,["name"],r);const a=h(t,["parameters"]);a!=null&&m(e,["parameters"],a);const i=h(t,["parametersJsonSchema"]);i!=null&&m(e,["parametersJsonSchema"],i);const l=h(t,["response"]);l!=null&&m(e,["response"],l);const c=h(t,["responseJsonSchema"]);return c!=null&&m(e,["responseJsonSchema"],c),e}function d5(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function h5(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],d5(n)),e}function m5(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function p5(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],m5(n)),e}function g5(){return{}}function x5(t){const e={},n=h(t,["apiKeyString"]);return n!=null&&m(e,["apiKeyString"],n),e}function v5(t){const e={},n=h(t,["apiKeyConfig"]);n!=null&&m(e,["apiKeyConfig"],x5(n));const r=h(t,["authType"]);r!=null&&m(e,["authType"],r);const a=h(t,["googleServiceAccountConfig"]);a!=null&&m(e,["googleServiceAccountConfig"],a);const i=h(t,["httpBasicAuthConfig"]);i!=null&&m(e,["httpBasicAuthConfig"],i);const l=h(t,["oauthConfig"]);l!=null&&m(e,["oauthConfig"],l);const c=h(t,["oidcConfig"]);return c!=null&&m(e,["oidcConfig"],c),e}function y5(t){const e={},n=h(t,["authConfig"]);return n!=null&&m(e,["authConfig"],v5(n)),e}function _5(){return{}}function w5(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let v=n;Array.isArray(v)&&(v=v.map(_=>f5(_))),m(e,["functionDeclarations"],v)}const r=h(t,["retrieval"]);r!=null&&m(e,["retrieval"],r);const a=h(t,["googleSearch"]);a!=null&&m(e,["googleSearch"],h5(a));const i=h(t,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],p5(i)),h(t,["enterpriseWebSearch"])!=null&&m(e,["enterpriseWebSearch"],g5());const c=h(t,["googleMaps"]);c!=null&&m(e,["googleMaps"],y5(c)),h(t,["urlContext"])!=null&&m(e,["urlContext"],_5());const f=h(t,["codeExecution"]);f!=null&&m(e,["codeExecution"],f);const g=h(t,["computerUse"]);return g!=null&&m(e,["computerUse"],g),e}function T5(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function E5(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function S5(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],E5(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function b5(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],T5(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],S5(r)),e}function C5(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);e!==void 0&&a!=null&&m(e,["expireTime"],a);const i=h(t,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const l=h(t,["contents"]);if(e!==void 0&&l!=null){let v=Qr(l);Array.isArray(v)&&(v=v.map(_=>O_(_))),m(e,["contents"],v)}const c=h(t,["systemInstruction"]);e!==void 0&&c!=null&&m(e,["systemInstruction"],O_(ir(c)));const d=h(t,["tools"]);if(e!==void 0&&d!=null){let v=d;Array.isArray(v)&&(v=v.map(_=>w5(_))),m(e,["tools"],v)}const f=h(t,["toolConfig"]);e!==void 0&&f!=null&&m(e,["toolConfig"],b5(f));const g=h(t,["kmsKeyName"]);return e!==void 0&&g!=null&&m(e,["encryption_spec","kmsKeyName"],g),n}function A5(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["model"],s2(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],C5(a,n)),n}function k5(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],hs(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function N5(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],hs(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function R5(t,e){const n={},r=h(t,["ttl"]);e!==void 0&&r!=null&&m(e,["ttl"],r);const a=h(t,["expireTime"]);return e!==void 0&&a!=null&&m(e,["expireTime"],a),n}function D5(t,e){const n={},r=h(e,["name"]);r!=null&&m(n,["_url","name"],hs(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],R5(a,n)),n}function M5(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);return e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),n}function I5(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],M5(n,e)),e}function ed(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["model"]);a!=null&&m(e,["model"],a);const i=h(t,["createTime"]);i!=null&&m(e,["createTime"],i);const l=h(t,["updateTime"]);l!=null&&m(e,["updateTime"],l);const c=h(t,["expireTime"]);c!=null&&m(e,["expireTime"],c);const d=h(t,["usageMetadata"]);return d!=null&&m(e,["usageMetadata"],d),e}function F5(){return{}}function L5(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>ed(i))),m(e,["cachedContents"],a)}return e}function td(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["model"]);a!=null&&m(e,["model"],a);const i=h(t,["createTime"]);i!=null&&m(e,["createTime"],i);const l=h(t,["updateTime"]);l!=null&&m(e,["updateTime"],l);const c=h(t,["expireTime"]);c!=null&&m(e,["expireTime"],c);const d=h(t,["usageMetadata"]);return d!=null&&m(e,["usageMetadata"],d),e}function O5(){return{}}function P5(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["cachedContents"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>td(i))),m(e,["cachedContents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class U5 extends Yi{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new pu(Ui.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=A5(this.apiClient,e);return c=qe("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>td(g))}else{const f=e5(this.apiClient,e);return c=qe("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>ed(g))}}async get(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=k5(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>td(g))}else{const f=t5(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>ed(g))}}async delete(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=N5(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(()=>{const g=O5(),v=new k_;return Object.assign(v,g),v})}else{const f=n5(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(()=>{const g=F5(),v=new k_;return Object.assign(v,g),v})}}async update(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=D5(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>td(g))}else{const f=a5(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>ed(g))}}async listInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=I5(e);return c=qe("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=P5(g),_=new N_;return Object.assign(_,v),_})}else{const f=i5(e);return c=qe("cachedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const v=L5(g),_=new N_;return Object.assign(_,v),_})}}}function P_(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function en(t){return this instanceof en?(this.v=t,this):new en(t)}function nl(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),a,i=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),a[Symbol.asyncIterator]=function(){return this},a;function l(T){return function(E){return Promise.resolve(E).then(T,v)}}function c(T,E){r[T]&&(a[T]=function(S){return new Promise(function(b,k){i.push([T,S,b,k])>1||d(T,S)})},E&&(a[T]=E(a[T])))}function d(T,E){try{f(r[T](E))}catch(S){_(i[0][3],S)}}function f(T){T.value instanceof en?Promise.resolve(T.value.v).then(g,v):_(i[0][2],T)}function g(T){d("next",T)}function v(T){d("throw",T)}function _(T,E){T(E),i.shift(),i.length&&d(i[0][0],i[0][1])}}function Uc(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof P_=="function"?P_(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(l){return new Promise(function(c,d){l=t[i](l),a(c,d,l.done,l.value)})}}function a(i,l,c,d){Promise.resolve(d).then(function(f){i({value:f,done:c})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function B5(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:w2(n)}function w2(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function j5(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function U_(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const a=[];let i=!0;for(;r<n&&t[r].role==="model";)a.push(t[r]),i&&!w2(t[r])&&(i=!1),r++;i?e.push(...a):e.pop()}return e}class V5{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new H5(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class H5{constructor(e,n,r,a={},i=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=a,this.history=i,this.sendPromise=Promise.resolve(),j5(i)}async sendMessage(e){var n;await this.sendPromise;const r=ir(e.message),a=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var i,l,c;const d=await a,f=(l=(i=d.candidates)===null||i===void 0?void 0:i[0])===null||l===void 0?void 0:l.content,g=d.automaticFunctionCallingHistory,v=this.getHistory(!0).length;let _=[];g!=null&&(_=(c=g.slice(v))!==null&&c!==void 0?c:[]);const T=f?[f]:[];this.recordHistory(r,T,_)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),a}async sendMessageStream(e){var n;await this.sendPromise;const r=ir(e.message),a=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=a.then(()=>{}).catch(()=>{});const i=await a;return this.processStreamResponse(i,r)}getHistory(e=!1){const n=e?U_(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,a;return nl(this,arguments,function*(){var l,c,d,f;const g=[];try{for(var v=!0,_=Uc(e),T;T=yield en(_.next()),l=T.done,!l;v=!0){f=T.value,v=!1;const E=f;if(B5(E)){const S=(a=(r=E.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content;S!==void 0&&g.push(S)}yield yield en(E)}}catch(E){c={error:E}}finally{try{!v&&!l&&(d=_.return)&&(yield en(d.call(_)))}finally{if(c)throw c.error}}this.recordHistory(n,g)})}recordHistory(e,n,r){let a=[];n.length>0&&n.every(i=>i.role!==void 0)?a=n:a.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...U_(r)):this.history.push(e),this.history.push(...a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Md extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Md.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $5(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);return e!==void 0&&a!=null&&m(e,["_query","pageToken"],a),n}function G5(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],$5(n,e)),e}function z5(t){const e={},n=h(t,["details"]);n!=null&&m(e,["details"],n);const r=h(t,["message"]);r!=null&&m(e,["message"],r);const a=h(t,["code"]);return a!=null&&m(e,["code"],a),e}function q5(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["mimeType"]);a!=null&&m(e,["mimeType"],a);const i=h(t,["sizeBytes"]);i!=null&&m(e,["sizeBytes"],i);const l=h(t,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(t,["expirationTime"]);c!=null&&m(e,["expirationTime"],c);const d=h(t,["updateTime"]);d!=null&&m(e,["updateTime"],d);const f=h(t,["sha256Hash"]);f!=null&&m(e,["sha256Hash"],f);const g=h(t,["uri"]);g!=null&&m(e,["uri"],g);const v=h(t,["downloadUri"]);v!=null&&m(e,["downloadUri"],v);const _=h(t,["state"]);_!=null&&m(e,["state"],_);const T=h(t,["source"]);T!=null&&m(e,["source"],T);const E=h(t,["videoMetadata"]);E!=null&&m(e,["videoMetadata"],E);const S=h(t,["error"]);return S!=null&&m(e,["error"],z5(S)),e}function Y5(t){const e={},n=h(t,["file"]);n!=null&&m(e,["file"],q5(n));const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function W5(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","file"],d2(n));const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function J5(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","file"],d2(n));const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function K5(t){const e={},n=h(t,["details"]);n!=null&&m(e,["details"],n);const r=h(t,["message"]);r!=null&&m(e,["message"],r);const a=h(t,["code"]);return a!=null&&m(e,["code"],a),e}function qm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["mimeType"]);a!=null&&m(e,["mimeType"],a);const i=h(t,["sizeBytes"]);i!=null&&m(e,["sizeBytes"],i);const l=h(t,["createTime"]);l!=null&&m(e,["createTime"],l);const c=h(t,["expirationTime"]);c!=null&&m(e,["expirationTime"],c);const d=h(t,["updateTime"]);d!=null&&m(e,["updateTime"],d);const f=h(t,["sha256Hash"]);f!=null&&m(e,["sha256Hash"],f);const g=h(t,["uri"]);g!=null&&m(e,["uri"],g);const v=h(t,["downloadUri"]);v!=null&&m(e,["downloadUri"],v);const _=h(t,["state"]);_!=null&&m(e,["state"],_);const T=h(t,["source"]);T!=null&&m(e,["source"],T);const E=h(t,["videoMetadata"]);E!=null&&m(e,["videoMetadata"],E);const S=h(t,["error"]);return S!=null&&m(e,["error"],K5(S)),e}function X5(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["files"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>qm(i))),m(e,["files"],a)}return e}function Z5(){return{}}function Q5(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class eD extends Yi{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new pu(Ui.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>qm(n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=G5(e);return i=qe("files",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=X5(d),g=new hR;return Object.assign(g,f),g})}}async createInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Y5(e);return i=qe("upload/v1beta/files",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(()=>{const d=Z5(),f=new mR;return Object.assign(f,d),f})}}async get(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=W5(e);return i=qe("files/{file}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>qm(d))}}async delete(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=J5(e);return i=qe("files/{file}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(()=>{const d=Q5(),f=new pR;return Object.assign(f,d),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tD(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function nD(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function T2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],tD(n)),e}function rD(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],nD(n)),e}function aD(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],T2(r)),e}function sD(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>aD(a))),m(e,["speakerVoiceConfigs"],r)}return e}function iD(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],T2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],sD(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function oD(t){const e={},n=h(t,["voiceConfig"]);if(n!=null&&m(e,["voiceConfig"],rD(n)),h(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function lD(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function cD(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function uD(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function fD(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function dD(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function hD(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function mD(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],lD(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],uD(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],dD(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function pD(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],cD(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],fD(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],hD(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function gD(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>mD(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function xD(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>pD(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function vD(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function yD(t){const e={};if(h(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=h(t,["description"]);n!=null&&m(e,["description"],n);const r=h(t,["name"]);r!=null&&m(e,["name"],r);const a=h(t,["parameters"]);a!=null&&m(e,["parameters"],a);const i=h(t,["parametersJsonSchema"]);i!=null&&m(e,["parametersJsonSchema"],i);const l=h(t,["response"]);l!=null&&m(e,["response"],l);const c=h(t,["responseJsonSchema"]);return c!=null&&m(e,["responseJsonSchema"],c),e}function _D(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function wD(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function TD(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],_D(n)),e}function ED(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],wD(n)),e}function SD(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function bD(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function CD(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],SD(n)),e}function AD(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],bD(n)),e}function kD(){return{}}function ND(t){const e={},n=h(t,["apiKeyString"]);return n!=null&&m(e,["apiKeyString"],n),e}function RD(t){const e={},n=h(t,["apiKeyConfig"]);n!=null&&m(e,["apiKeyConfig"],ND(n));const r=h(t,["authType"]);r!=null&&m(e,["authType"],r);const a=h(t,["googleServiceAccountConfig"]);a!=null&&m(e,["googleServiceAccountConfig"],a);const i=h(t,["httpBasicAuthConfig"]);i!=null&&m(e,["httpBasicAuthConfig"],i);const l=h(t,["oauthConfig"]);l!=null&&m(e,["oauthConfig"],l);const c=h(t,["oidcConfig"]);return c!=null&&m(e,["oidcConfig"],c),e}function DD(t){const e={},n=h(t,["authConfig"]);return n!=null&&m(e,["authConfig"],RD(n)),e}function MD(){return{}}function ID(){return{}}function FD(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>vD(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],TD(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],CD(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],MD());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function LD(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let v=n;Array.isArray(v)&&(v=v.map(_=>yD(_))),m(e,["functionDeclarations"],v)}const r=h(t,["retrieval"]);r!=null&&m(e,["retrieval"],r);const a=h(t,["googleSearch"]);a!=null&&m(e,["googleSearch"],ED(a));const i=h(t,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],AD(i)),h(t,["enterpriseWebSearch"])!=null&&m(e,["enterpriseWebSearch"],kD());const c=h(t,["googleMaps"]);c!=null&&m(e,["googleMaps"],DD(c)),h(t,["urlContext"])!=null&&m(e,["urlContext"],ID());const f=h(t,["codeExecution"]);f!=null&&m(e,["codeExecution"],f);const g=h(t,["computerUse"]);return g!=null&&m(e,["computerUse"],g),e}function OD(t){const e={},n=h(t,["handle"]);if(n!=null&&m(e,["handle"],n),h(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function PD(t){const e={},n=h(t,["handle"]);n!=null&&m(e,["handle"],n);const r=h(t,["transparent"]);return r!=null&&m(e,["transparent"],r),e}function B_(){return{}}function j_(){return{}}function UD(t){const e={},n=h(t,["disabled"]);n!=null&&m(e,["disabled"],n);const r=h(t,["startOfSpeechSensitivity"]);r!=null&&m(e,["startOfSpeechSensitivity"],r);const a=h(t,["endOfSpeechSensitivity"]);a!=null&&m(e,["endOfSpeechSensitivity"],a);const i=h(t,["prefixPaddingMs"]);i!=null&&m(e,["prefixPaddingMs"],i);const l=h(t,["silenceDurationMs"]);return l!=null&&m(e,["silenceDurationMs"],l),e}function BD(t){const e={},n=h(t,["disabled"]);n!=null&&m(e,["disabled"],n);const r=h(t,["startOfSpeechSensitivity"]);r!=null&&m(e,["startOfSpeechSensitivity"],r);const a=h(t,["endOfSpeechSensitivity"]);a!=null&&m(e,["endOfSpeechSensitivity"],a);const i=h(t,["prefixPaddingMs"]);i!=null&&m(e,["prefixPaddingMs"],i);const l=h(t,["silenceDurationMs"]);return l!=null&&m(e,["silenceDurationMs"],l),e}function jD(t){const e={},n=h(t,["automaticActivityDetection"]);n!=null&&m(e,["automaticActivityDetection"],UD(n));const r=h(t,["activityHandling"]);r!=null&&m(e,["activityHandling"],r);const a=h(t,["turnCoverage"]);return a!=null&&m(e,["turnCoverage"],a),e}function VD(t){const e={},n=h(t,["automaticActivityDetection"]);n!=null&&m(e,["automaticActivityDetection"],BD(n));const r=h(t,["activityHandling"]);r!=null&&m(e,["activityHandling"],r);const a=h(t,["turnCoverage"]);return a!=null&&m(e,["turnCoverage"],a),e}function HD(t){const e={},n=h(t,["targetTokens"]);return n!=null&&m(e,["targetTokens"],n),e}function $D(t){const e={},n=h(t,["targetTokens"]);return n!=null&&m(e,["targetTokens"],n),e}function GD(t){const e={},n=h(t,["triggerTokens"]);n!=null&&m(e,["triggerTokens"],n);const r=h(t,["slidingWindow"]);return r!=null&&m(e,["slidingWindow"],HD(r)),e}function zD(t){const e={},n=h(t,["triggerTokens"]);n!=null&&m(e,["triggerTokens"],n);const r=h(t,["slidingWindow"]);return r!=null&&m(e,["slidingWindow"],$D(r)),e}function qD(t){const e={},n=h(t,["proactiveAudio"]);return n!=null&&m(e,["proactiveAudio"],n),e}function YD(t){const e={},n=h(t,["proactiveAudio"]);return n!=null&&m(e,["proactiveAudio"],n),e}function WD(t,e){const n={},r=h(t,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const a=h(t,["responseModalities"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","responseModalities"],a);const i=h(t,["temperature"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig","temperature"],i);const l=h(t,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(t,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const d=h(t,["maxOutputTokens"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","maxOutputTokens"],d);const f=h(t,["mediaResolution"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","mediaResolution"],f);const g=h(t,["seed"]);e!==void 0&&g!=null&&m(e,["setup","generationConfig","seed"],g);const v=h(t,["speechConfig"]);e!==void 0&&v!=null&&m(e,["setup","generationConfig","speechConfig"],iD(Sp(v)));const _=h(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],_);const T=h(t,["systemInstruction"]);e!==void 0&&T!=null&&m(e,["setup","systemInstruction"],gD(ir(T)));const E=h(t,["tools"]);if(e!==void 0&&E!=null){let B=yl(E);Array.isArray(B)&&(B=B.map(j=>FD(vl(j)))),m(e,["setup","tools"],B)}const S=h(t,["sessionResumption"]);e!==void 0&&S!=null&&m(e,["setup","sessionResumption"],OD(S));const b=h(t,["inputAudioTranscription"]);e!==void 0&&b!=null&&m(e,["setup","inputAudioTranscription"],B_());const k=h(t,["outputAudioTranscription"]);e!==void 0&&k!=null&&m(e,["setup","outputAudioTranscription"],B_());const A=h(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&m(e,["setup","realtimeInputConfig"],jD(A));const C=h(t,["contextWindowCompression"]);e!==void 0&&C!=null&&m(e,["setup","contextWindowCompression"],GD(C));const I=h(t,["proactivity"]);return e!==void 0&&I!=null&&m(e,["setup","proactivity"],qD(I)),n}function JD(t,e){const n={},r=h(t,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const a=h(t,["responseModalities"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","responseModalities"],a);const i=h(t,["temperature"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig","temperature"],i);const l=h(t,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(t,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const d=h(t,["maxOutputTokens"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","maxOutputTokens"],d);const f=h(t,["mediaResolution"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","mediaResolution"],f);const g=h(t,["seed"]);e!==void 0&&g!=null&&m(e,["setup","generationConfig","seed"],g);const v=h(t,["speechConfig"]);e!==void 0&&v!=null&&m(e,["setup","generationConfig","speechConfig"],oD(Sp(v)));const _=h(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],_);const T=h(t,["systemInstruction"]);e!==void 0&&T!=null&&m(e,["setup","systemInstruction"],xD(ir(T)));const E=h(t,["tools"]);if(e!==void 0&&E!=null){let B=yl(E);Array.isArray(B)&&(B=B.map(j=>LD(vl(j)))),m(e,["setup","tools"],B)}const S=h(t,["sessionResumption"]);e!==void 0&&S!=null&&m(e,["setup","sessionResumption"],PD(S));const b=h(t,["inputAudioTranscription"]);e!==void 0&&b!=null&&m(e,["setup","inputAudioTranscription"],j_());const k=h(t,["outputAudioTranscription"]);e!==void 0&&k!=null&&m(e,["setup","outputAudioTranscription"],j_());const A=h(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&m(e,["setup","realtimeInputConfig"],VD(A));const C=h(t,["contextWindowCompression"]);e!==void 0&&C!=null&&m(e,["setup","contextWindowCompression"],zD(C));const I=h(t,["proactivity"]);return e!==void 0&&I!=null&&m(e,["setup","proactivity"],YD(I)),n}function KD(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["setup","model"],$t(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],WD(a,n)),n}function XD(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["setup","model"],$t(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],JD(a,n)),n}function ZD(){return{}}function QD(){return{}}function eM(){return{}}function tM(){return{}}function nM(t){const e={},n=h(t,["media"]);n!=null&&m(e,["mediaChunks"],i2(n));const r=h(t,["audio"]);r!=null&&m(e,["audio"],l2(r));const a=h(t,["audioStreamEnd"]);a!=null&&m(e,["audioStreamEnd"],a);const i=h(t,["video"]);i!=null&&m(e,["video"],o2(i));const l=h(t,["text"]);return l!=null&&m(e,["text"],l),h(t,["activityStart"])!=null&&m(e,["activityStart"],ZD()),h(t,["activityEnd"])!=null&&m(e,["activityEnd"],eM()),e}function rM(t){const e={},n=h(t,["media"]);n!=null&&m(e,["mediaChunks"],i2(n));const r=h(t,["audio"]);r!=null&&m(e,["audio"],l2(r));const a=h(t,["audioStreamEnd"]);a!=null&&m(e,["audioStreamEnd"],a);const i=h(t,["video"]);i!=null&&m(e,["video"],o2(i));const l=h(t,["text"]);return l!=null&&m(e,["text"],l),h(t,["activityStart"])!=null&&m(e,["activityStart"],QD()),h(t,["activityEnd"])!=null&&m(e,["activityEnd"],tM()),e}function E2(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["weight"]);return r!=null&&m(e,["weight"],r),e}function aM(t){const e={},n=h(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>E2(a))),m(e,["weightedPrompts"],r)}return e}function S2(t){const e={},n=h(t,["temperature"]);n!=null&&m(e,["temperature"],n);const r=h(t,["topK"]);r!=null&&m(e,["topK"],r);const a=h(t,["seed"]);a!=null&&m(e,["seed"],a);const i=h(t,["guidance"]);i!=null&&m(e,["guidance"],i);const l=h(t,["bpm"]);l!=null&&m(e,["bpm"],l);const c=h(t,["density"]);c!=null&&m(e,["density"],c);const d=h(t,["brightness"]);d!=null&&m(e,["brightness"],d);const f=h(t,["scale"]);f!=null&&m(e,["scale"],f);const g=h(t,["muteBass"]);g!=null&&m(e,["muteBass"],g);const v=h(t,["muteDrums"]);v!=null&&m(e,["muteDrums"],v);const _=h(t,["onlyBassAndDrums"]);return _!=null&&m(e,["onlyBassAndDrums"],_),e}function sM(t){const e={},n=h(t,["musicGenerationConfig"]);return n!=null&&m(e,["musicGenerationConfig"],S2(n)),e}function b2(t){const e={},n=h(t,["model"]);return n!=null&&m(e,["model"],n),e}function C2(t){const e={},n=h(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>E2(a))),m(e,["weightedPrompts"],r)}return e}function Ym(t){const e={},n=h(t,["setup"]);n!=null&&m(e,["setup"],b2(n));const r=h(t,["clientContent"]);r!=null&&m(e,["clientContent"],C2(r));const a=h(t,["musicGenerationConfig"]);a!=null&&m(e,["musicGenerationConfig"],S2(a));const i=h(t,["playbackControl"]);return i!=null&&m(e,["playbackControl"],i),e}function iM(){return{}}function oM(t){const e={},n=h(t,["sessionId"]);return n!=null&&m(e,["sessionId"],n),e}function lM(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function cM(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function uM(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function fM(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function dM(t){const e={},n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function hM(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function mM(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],lM(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],uM(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],dM(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function pM(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],cM(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],fM(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],hM(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function gM(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>mM(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function xM(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>pM(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function V_(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["finished"]);return r!=null&&m(e,["finished"],r),e}function H_(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["finished"]);return r!=null&&m(e,["finished"],r),e}function vM(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function yM(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>vM(a))),m(e,["urlMetadata"],r)}return e}function _M(t){const e={},n=h(t,["modelTurn"]);n!=null&&m(e,["modelTurn"],gM(n));const r=h(t,["turnComplete"]);r!=null&&m(e,["turnComplete"],r);const a=h(t,["interrupted"]);a!=null&&m(e,["interrupted"],a);const i=h(t,["groundingMetadata"]);i!=null&&m(e,["groundingMetadata"],i);const l=h(t,["generationComplete"]);l!=null&&m(e,["generationComplete"],l);const c=h(t,["inputTranscription"]);c!=null&&m(e,["inputTranscription"],V_(c));const d=h(t,["outputTranscription"]);d!=null&&m(e,["outputTranscription"],V_(d));const f=h(t,["urlContextMetadata"]);return f!=null&&m(e,["urlContextMetadata"],yM(f)),e}function wM(t){const e={},n=h(t,["modelTurn"]);n!=null&&m(e,["modelTurn"],xM(n));const r=h(t,["turnComplete"]);r!=null&&m(e,["turnComplete"],r);const a=h(t,["interrupted"]);a!=null&&m(e,["interrupted"],a);const i=h(t,["groundingMetadata"]);i!=null&&m(e,["groundingMetadata"],i);const l=h(t,["generationComplete"]);l!=null&&m(e,["generationComplete"],l);const c=h(t,["inputTranscription"]);c!=null&&m(e,["inputTranscription"],H_(c));const d=h(t,["outputTranscription"]);return d!=null&&m(e,["outputTranscription"],H_(d)),e}function TM(t){const e={},n=h(t,["id"]);n!=null&&m(e,["id"],n);const r=h(t,["args"]);r!=null&&m(e,["args"],r);const a=h(t,["name"]);return a!=null&&m(e,["name"],a),e}function EM(t){const e={},n=h(t,["args"]);n!=null&&m(e,["args"],n);const r=h(t,["name"]);return r!=null&&m(e,["name"],r),e}function SM(t){const e={},n=h(t,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>TM(a))),m(e,["functionCalls"],r)}return e}function bM(t){const e={},n=h(t,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>EM(a))),m(e,["functionCalls"],r)}return e}function CM(t){const e={},n=h(t,["ids"]);return n!=null&&m(e,["ids"],n),e}function AM(t){const e={},n=h(t,["ids"]);return n!=null&&m(e,["ids"],n),e}function jf(t){const e={},n=h(t,["modality"]);n!=null&&m(e,["modality"],n);const r=h(t,["tokenCount"]);return r!=null&&m(e,["tokenCount"],r),e}function Vf(t){const e={},n=h(t,["modality"]);n!=null&&m(e,["modality"],n);const r=h(t,["tokenCount"]);return r!=null&&m(e,["tokenCount"],r),e}function kM(t){const e={},n=h(t,["promptTokenCount"]);n!=null&&m(e,["promptTokenCount"],n);const r=h(t,["cachedContentTokenCount"]);r!=null&&m(e,["cachedContentTokenCount"],r);const a=h(t,["responseTokenCount"]);a!=null&&m(e,["responseTokenCount"],a);const i=h(t,["toolUsePromptTokenCount"]);i!=null&&m(e,["toolUsePromptTokenCount"],i);const l=h(t,["thoughtsTokenCount"]);l!=null&&m(e,["thoughtsTokenCount"],l);const c=h(t,["totalTokenCount"]);c!=null&&m(e,["totalTokenCount"],c);const d=h(t,["promptTokensDetails"]);if(d!=null){let _=d;Array.isArray(_)&&(_=_.map(T=>jf(T))),m(e,["promptTokensDetails"],_)}const f=h(t,["cacheTokensDetails"]);if(f!=null){let _=f;Array.isArray(_)&&(_=_.map(T=>jf(T))),m(e,["cacheTokensDetails"],_)}const g=h(t,["responseTokensDetails"]);if(g!=null){let _=g;Array.isArray(_)&&(_=_.map(T=>jf(T))),m(e,["responseTokensDetails"],_)}const v=h(t,["toolUsePromptTokensDetails"]);if(v!=null){let _=v;Array.isArray(_)&&(_=_.map(T=>jf(T))),m(e,["toolUsePromptTokensDetails"],_)}return e}function NM(t){const e={},n=h(t,["promptTokenCount"]);n!=null&&m(e,["promptTokenCount"],n);const r=h(t,["cachedContentTokenCount"]);r!=null&&m(e,["cachedContentTokenCount"],r);const a=h(t,["candidatesTokenCount"]);a!=null&&m(e,["responseTokenCount"],a);const i=h(t,["toolUsePromptTokenCount"]);i!=null&&m(e,["toolUsePromptTokenCount"],i);const l=h(t,["thoughtsTokenCount"]);l!=null&&m(e,["thoughtsTokenCount"],l);const c=h(t,["totalTokenCount"]);c!=null&&m(e,["totalTokenCount"],c);const d=h(t,["promptTokensDetails"]);if(d!=null){let T=d;Array.isArray(T)&&(T=T.map(E=>Vf(E))),m(e,["promptTokensDetails"],T)}const f=h(t,["cacheTokensDetails"]);if(f!=null){let T=f;Array.isArray(T)&&(T=T.map(E=>Vf(E))),m(e,["cacheTokensDetails"],T)}const g=h(t,["candidatesTokensDetails"]);if(g!=null){let T=g;Array.isArray(T)&&(T=T.map(E=>Vf(E))),m(e,["responseTokensDetails"],T)}const v=h(t,["toolUsePromptTokensDetails"]);if(v!=null){let T=v;Array.isArray(T)&&(T=T.map(E=>Vf(E))),m(e,["toolUsePromptTokensDetails"],T)}const _=h(t,["trafficType"]);return _!=null&&m(e,["trafficType"],_),e}function RM(t){const e={},n=h(t,["timeLeft"]);return n!=null&&m(e,["timeLeft"],n),e}function DM(t){const e={},n=h(t,["timeLeft"]);return n!=null&&m(e,["timeLeft"],n),e}function MM(t){const e={},n=h(t,["newHandle"]);n!=null&&m(e,["newHandle"],n);const r=h(t,["resumable"]);r!=null&&m(e,["resumable"],r);const a=h(t,["lastConsumedClientMessageIndex"]);return a!=null&&m(e,["lastConsumedClientMessageIndex"],a),e}function IM(t){const e={},n=h(t,["newHandle"]);n!=null&&m(e,["newHandle"],n);const r=h(t,["resumable"]);r!=null&&m(e,["resumable"],r);const a=h(t,["lastConsumedClientMessageIndex"]);return a!=null&&m(e,["lastConsumedClientMessageIndex"],a),e}function FM(t){const e={};h(t,["setupComplete"])!=null&&m(e,["setupComplete"],iM());const r=h(t,["serverContent"]);r!=null&&m(e,["serverContent"],_M(r));const a=h(t,["toolCall"]);a!=null&&m(e,["toolCall"],SM(a));const i=h(t,["toolCallCancellation"]);i!=null&&m(e,["toolCallCancellation"],CM(i));const l=h(t,["usageMetadata"]);l!=null&&m(e,["usageMetadata"],kM(l));const c=h(t,["goAway"]);c!=null&&m(e,["goAway"],RM(c));const d=h(t,["sessionResumptionUpdate"]);return d!=null&&m(e,["sessionResumptionUpdate"],MM(d)),e}function LM(t){const e={},n=h(t,["setupComplete"]);n!=null&&m(e,["setupComplete"],oM(n));const r=h(t,["serverContent"]);r!=null&&m(e,["serverContent"],wM(r));const a=h(t,["toolCall"]);a!=null&&m(e,["toolCall"],bM(a));const i=h(t,["toolCallCancellation"]);i!=null&&m(e,["toolCallCancellation"],AM(i));const l=h(t,["usageMetadata"]);l!=null&&m(e,["usageMetadata"],NM(l));const c=h(t,["goAway"]);c!=null&&m(e,["goAway"],DM(c));const d=h(t,["sessionResumptionUpdate"]);return d!=null&&m(e,["sessionResumptionUpdate"],IM(d)),e}function OM(){return{}}function PM(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["weight"]);return r!=null&&m(e,["weight"],r),e}function UM(t){const e={},n=h(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>PM(a))),m(e,["weightedPrompts"],r)}return e}function BM(t){const e={},n=h(t,["temperature"]);n!=null&&m(e,["temperature"],n);const r=h(t,["topK"]);r!=null&&m(e,["topK"],r);const a=h(t,["seed"]);a!=null&&m(e,["seed"],a);const i=h(t,["guidance"]);i!=null&&m(e,["guidance"],i);const l=h(t,["bpm"]);l!=null&&m(e,["bpm"],l);const c=h(t,["density"]);c!=null&&m(e,["density"],c);const d=h(t,["brightness"]);d!=null&&m(e,["brightness"],d);const f=h(t,["scale"]);f!=null&&m(e,["scale"],f);const g=h(t,["muteBass"]);g!=null&&m(e,["muteBass"],g);const v=h(t,["muteDrums"]);v!=null&&m(e,["muteDrums"],v);const _=h(t,["onlyBassAndDrums"]);return _!=null&&m(e,["onlyBassAndDrums"],_),e}function jM(t){const e={},n=h(t,["clientContent"]);n!=null&&m(e,["clientContent"],UM(n));const r=h(t,["musicGenerationConfig"]);return r!=null&&m(e,["musicGenerationConfig"],BM(r)),e}function VM(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);r!=null&&m(e,["mimeType"],r);const a=h(t,["sourceMetadata"]);return a!=null&&m(e,["sourceMetadata"],jM(a)),e}function HM(t){const e={},n=h(t,["audioChunks"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>VM(a))),m(e,["audioChunks"],r)}return e}function $M(t){const e={},n=h(t,["text"]);n!=null&&m(e,["text"],n);const r=h(t,["filteredReason"]);return r!=null&&m(e,["filteredReason"],r),e}function GM(t){const e={};h(t,["setupComplete"])!=null&&m(e,["setupComplete"],OM());const r=h(t,["serverContent"]);r!=null&&m(e,["serverContent"],HM(r));const a=h(t,["filteredPrompt"]);return a!=null&&m(e,["filteredPrompt"],$M(a)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zM(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function qM(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function YM(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function WM(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],zM(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],qM(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],YM(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function Id(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>WM(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function JM(t){const e={},n=h(t,["anyOf"]);n!=null&&m(e,["anyOf"],n);const r=h(t,["default"]);r!=null&&m(e,["default"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["enum"]);i!=null&&m(e,["enum"],i);const l=h(t,["example"]);l!=null&&m(e,["example"],l);const c=h(t,["format"]);c!=null&&m(e,["format"],c);const d=h(t,["items"]);d!=null&&m(e,["items"],d);const f=h(t,["maxItems"]);f!=null&&m(e,["maxItems"],f);const g=h(t,["maxLength"]);g!=null&&m(e,["maxLength"],g);const v=h(t,["maxProperties"]);v!=null&&m(e,["maxProperties"],v);const _=h(t,["maximum"]);_!=null&&m(e,["maximum"],_);const T=h(t,["minItems"]);T!=null&&m(e,["minItems"],T);const E=h(t,["minLength"]);E!=null&&m(e,["minLength"],E);const S=h(t,["minProperties"]);S!=null&&m(e,["minProperties"],S);const b=h(t,["minimum"]);b!=null&&m(e,["minimum"],b);const k=h(t,["nullable"]);k!=null&&m(e,["nullable"],k);const A=h(t,["pattern"]);A!=null&&m(e,["pattern"],A);const C=h(t,["properties"]);C!=null&&m(e,["properties"],C);const I=h(t,["propertyOrdering"]);I!=null&&m(e,["propertyOrdering"],I);const B=h(t,["required"]);B!=null&&m(e,["required"],B);const j=h(t,["title"]);j!=null&&m(e,["title"],j);const F=h(t,["type"]);return F!=null&&m(e,["type"],F),e}function KM(t){const e={};if(h(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=h(t,["category"]);n!=null&&m(e,["category"],n);const r=h(t,["threshold"]);return r!=null&&m(e,["threshold"],r),e}function XM(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function ZM(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function QM(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],ZM(n)),e}function eI(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function tI(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],eI(n)),e}function nI(){return{}}function rI(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>XM(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],QM(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],tI(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],nI());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function aI(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function sI(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function iI(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],sI(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function oI(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],aI(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],iI(r)),e}function lI(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function A2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],lI(n)),e}function cI(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],A2(r)),e}function uI(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>cI(a))),m(e,["speakerVoiceConfigs"],r)}return e}function fI(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],A2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],uI(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function dI(t){const e={},n=h(t,["includeThoughts"]);n!=null&&m(e,["includeThoughts"],n);const r=h(t,["thinkingBudget"]);return r!=null&&m(e,["thinkingBudget"],r),e}function hI(t,e,n){const r={},a=h(e,["systemInstruction"]);n!==void 0&&a!=null&&m(n,["systemInstruction"],Id(ir(a)));const i=h(e,["temperature"]);i!=null&&m(r,["temperature"],i);const l=h(e,["topP"]);l!=null&&m(r,["topP"],l);const c=h(e,["topK"]);c!=null&&m(r,["topK"],c);const d=h(e,["candidateCount"]);d!=null&&m(r,["candidateCount"],d);const f=h(e,["maxOutputTokens"]);f!=null&&m(r,["maxOutputTokens"],f);const g=h(e,["stopSequences"]);g!=null&&m(r,["stopSequences"],g);const v=h(e,["responseLogprobs"]);v!=null&&m(r,["responseLogprobs"],v);const _=h(e,["logprobs"]);_!=null&&m(r,["logprobs"],_);const T=h(e,["presencePenalty"]);T!=null&&m(r,["presencePenalty"],T);const E=h(e,["frequencyPenalty"]);E!=null&&m(r,["frequencyPenalty"],E);const S=h(e,["seed"]);S!=null&&m(r,["seed"],S);const b=h(e,["responseMimeType"]);b!=null&&m(r,["responseMimeType"],b);const k=h(e,["responseSchema"]);k!=null&&m(r,["responseSchema"],JM(Xc(k)));const A=h(e,["responseJsonSchema"]);if(A!=null&&m(r,["responseJsonSchema"],A),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const C=h(e,["safetySettings"]);if(n!==void 0&&C!=null){let G=C;Array.isArray(G)&&(G=G.map(te=>KM(te))),m(n,["safetySettings"],G)}const I=h(e,["tools"]);if(n!==void 0&&I!=null){let G=yl(I);Array.isArray(G)&&(G=G.map(te=>rI(vl(te)))),m(n,["tools"],G)}const B=h(e,["toolConfig"]);if(n!==void 0&&B!=null&&m(n,["toolConfig"],oI(B)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const j=h(e,["cachedContent"]);n!==void 0&&j!=null&&m(n,["cachedContent"],hs(t,j));const F=h(e,["responseModalities"]);F!=null&&m(r,["responseModalities"],F);const X=h(e,["mediaResolution"]);X!=null&&m(r,["mediaResolution"],X);const P=h(e,["speechConfig"]);if(P!=null&&m(r,["speechConfig"],fI(Ep(P))),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const re=h(e,["thinkingConfig"]);return re!=null&&m(r,["thinkingConfig"],dI(re)),r}function $_(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["contents"]);if(a!=null){let l=Qr(a);Array.isArray(l)&&(l=l.map(c=>Id(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["generationConfig"],hI(t,i,n)),n}function mI(t,e){const n={},r=h(t,["taskType"]);e!==void 0&&r!=null&&m(e,["requests[]","taskType"],r);const a=h(t,["title"]);e!==void 0&&a!=null&&m(e,["requests[]","title"],a);const i=h(t,["outputDimensionality"]);if(e!==void 0&&i!=null&&m(e,["requests[]","outputDimensionality"],i),h(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function pI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["contents"]);a!=null&&m(n,["requests[]","content"],u2(t,a));const i=h(e,["config"]);i!=null&&m(n,["config"],mI(i,n));const l=h(e,["model"]);return l!==void 0&&m(n,["requests[]","model"],$t(t,l)),n}function gI(t,e){const n={};if(h(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=h(t,["numberOfImages"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const a=h(t,["aspectRatio"]);e!==void 0&&a!=null&&m(e,["parameters","aspectRatio"],a);const i=h(t,["guidanceScale"]);if(e!==void 0&&i!=null&&m(e,["parameters","guidanceScale"],i),h(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=h(t,["safetyFilterLevel"]);e!==void 0&&l!=null&&m(e,["parameters","safetySetting"],l);const c=h(t,["personGeneration"]);e!==void 0&&c!=null&&m(e,["parameters","personGeneration"],c);const d=h(t,["includeSafetyAttributes"]);e!==void 0&&d!=null&&m(e,["parameters","includeSafetyAttributes"],d);const f=h(t,["includeRaiReason"]);e!==void 0&&f!=null&&m(e,["parameters","includeRaiReason"],f);const g=h(t,["language"]);e!==void 0&&g!=null&&m(e,["parameters","language"],g);const v=h(t,["outputMimeType"]);e!==void 0&&v!=null&&m(e,["parameters","outputOptions","mimeType"],v);const _=h(t,["outputCompressionQuality"]);if(e!==void 0&&_!=null&&m(e,["parameters","outputOptions","compressionQuality"],_),h(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(h(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function xI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["config"]);return i!=null&&m(n,["config"],gI(i,n)),n}function vI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],$t(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function yI(t,e,n){const r={},a=h(e,["pageSize"]);n!==void 0&&a!=null&&m(n,["_query","pageSize"],a);const i=h(e,["pageToken"]);n!==void 0&&i!=null&&m(n,["_query","pageToken"],i);const l=h(e,["filter"]);n!==void 0&&l!=null&&m(n,["_query","filter"],l);const c=h(e,["queryBase"]);return n!==void 0&&c!=null&&m(n,["_url","models_url"],h2(t,c)),r}function _I(t,e){const n={},r=h(e,["config"]);return r!=null&&m(n,["config"],yI(t,r,n)),n}function wI(t,e){const n={},r=h(t,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);e!==void 0&&a!=null&&m(e,["description"],a);const i=h(t,["defaultCheckpointId"]);return e!==void 0&&i!=null&&m(e,["defaultCheckpointId"],i),n}function TI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],$t(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],wI(a,n)),n}function EI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],$t(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function SI(t){const e={};if(h(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(h(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(h(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function bI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["contents"]);if(a!=null){let l=Qr(a);Array.isArray(l)&&(l=l.map(c=>Id(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["config"],SI(i)),n}function CI(t){const e={};if(h(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=h(t,["imageBytes"]);n!=null&&m(e,["bytesBase64Encoded"],ms(n));const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function AI(t,e){const n={},r=h(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r),h(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=h(t,["durationSeconds"]);if(e!==void 0&&a!=null&&m(e,["parameters","durationSeconds"],a),h(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const i=h(t,["aspectRatio"]);if(e!==void 0&&i!=null&&m(e,["parameters","aspectRatio"],i),h(t,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=h(t,["personGeneration"]);if(e!==void 0&&l!=null&&m(e,["parameters","personGeneration"],l),h(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=h(t,["negativePrompt"]);e!==void 0&&c!=null&&m(e,["parameters","negativePrompt"],c);const d=h(t,["enhancePrompt"]);if(e!==void 0&&d!=null&&m(e,["parameters","enhancePrompt"],d),h(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(h(t,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(h(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function kI(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["image"]);if(i!=null&&m(n,["instances[0]","image"],CI(i)),h(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const l=h(e,["config"]);return l!=null&&m(n,["config"],AI(l,n)),n}function NI(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function RI(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function DI(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function MI(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],NI(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],RI(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],DI(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function wl(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>MI(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function II(t){const e={},n=h(t,["anyOf"]);n!=null&&m(e,["anyOf"],n);const r=h(t,["default"]);r!=null&&m(e,["default"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["enum"]);i!=null&&m(e,["enum"],i);const l=h(t,["example"]);l!=null&&m(e,["example"],l);const c=h(t,["format"]);c!=null&&m(e,["format"],c);const d=h(t,["items"]);d!=null&&m(e,["items"],d);const f=h(t,["maxItems"]);f!=null&&m(e,["maxItems"],f);const g=h(t,["maxLength"]);g!=null&&m(e,["maxLength"],g);const v=h(t,["maxProperties"]);v!=null&&m(e,["maxProperties"],v);const _=h(t,["maximum"]);_!=null&&m(e,["maximum"],_);const T=h(t,["minItems"]);T!=null&&m(e,["minItems"],T);const E=h(t,["minLength"]);E!=null&&m(e,["minLength"],E);const S=h(t,["minProperties"]);S!=null&&m(e,["minProperties"],S);const b=h(t,["minimum"]);b!=null&&m(e,["minimum"],b);const k=h(t,["nullable"]);k!=null&&m(e,["nullable"],k);const A=h(t,["pattern"]);A!=null&&m(e,["pattern"],A);const C=h(t,["properties"]);C!=null&&m(e,["properties"],C);const I=h(t,["propertyOrdering"]);I!=null&&m(e,["propertyOrdering"],I);const B=h(t,["required"]);B!=null&&m(e,["required"],B);const j=h(t,["title"]);j!=null&&m(e,["title"],j);const F=h(t,["type"]);return F!=null&&m(e,["type"],F),e}function FI(t){const e={},n=h(t,["featureSelectionPreference"]);return n!=null&&m(e,["featureSelectionPreference"],n),e}function LI(t){const e={},n=h(t,["method"]);n!=null&&m(e,["method"],n);const r=h(t,["category"]);r!=null&&m(e,["category"],r);const a=h(t,["threshold"]);return a!=null&&m(e,["threshold"],a),e}function OI(t){const e={};if(h(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=h(t,["description"]);n!=null&&m(e,["description"],n);const r=h(t,["name"]);r!=null&&m(e,["name"],r);const a=h(t,["parameters"]);a!=null&&m(e,["parameters"],a);const i=h(t,["parametersJsonSchema"]);i!=null&&m(e,["parametersJsonSchema"],i);const l=h(t,["response"]);l!=null&&m(e,["response"],l);const c=h(t,["responseJsonSchema"]);return c!=null&&m(e,["responseJsonSchema"],c),e}function PI(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function UI(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],PI(n)),e}function BI(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function jI(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],BI(n)),e}function VI(){return{}}function HI(t){const e={},n=h(t,["apiKeyString"]);return n!=null&&m(e,["apiKeyString"],n),e}function $I(t){const e={},n=h(t,["apiKeyConfig"]);n!=null&&m(e,["apiKeyConfig"],HI(n));const r=h(t,["authType"]);r!=null&&m(e,["authType"],r);const a=h(t,["googleServiceAccountConfig"]);a!=null&&m(e,["googleServiceAccountConfig"],a);const i=h(t,["httpBasicAuthConfig"]);i!=null&&m(e,["httpBasicAuthConfig"],i);const l=h(t,["oauthConfig"]);l!=null&&m(e,["oauthConfig"],l);const c=h(t,["oidcConfig"]);return c!=null&&m(e,["oidcConfig"],c),e}function GI(t){const e={},n=h(t,["authConfig"]);return n!=null&&m(e,["authConfig"],$I(n)),e}function zI(){return{}}function k2(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let v=n;Array.isArray(v)&&(v=v.map(_=>OI(_))),m(e,["functionDeclarations"],v)}const r=h(t,["retrieval"]);r!=null&&m(e,["retrieval"],r);const a=h(t,["googleSearch"]);a!=null&&m(e,["googleSearch"],UI(a));const i=h(t,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],jI(i)),h(t,["enterpriseWebSearch"])!=null&&m(e,["enterpriseWebSearch"],VI());const c=h(t,["googleMaps"]);c!=null&&m(e,["googleMaps"],GI(c)),h(t,["urlContext"])!=null&&m(e,["urlContext"],zI());const f=h(t,["codeExecution"]);f!=null&&m(e,["codeExecution"],f);const g=h(t,["computerUse"]);return g!=null&&m(e,["computerUse"],g),e}function qI(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["allowedFunctionNames"]);return r!=null&&m(e,["allowedFunctionNames"],r),e}function YI(t){const e={},n=h(t,["latitude"]);n!=null&&m(e,["latitude"],n);const r=h(t,["longitude"]);return r!=null&&m(e,["longitude"],r),e}function WI(t){const e={},n=h(t,["latLng"]);n!=null&&m(e,["latLng"],YI(n));const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function JI(t){const e={},n=h(t,["functionCallingConfig"]);n!=null&&m(e,["functionCallingConfig"],qI(n));const r=h(t,["retrievalConfig"]);return r!=null&&m(e,["retrievalConfig"],WI(r)),e}function KI(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function XI(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],KI(n)),e}function ZI(t){const e={},n=h(t,["voiceConfig"]);if(n!=null&&m(e,["voiceConfig"],XI(n)),h(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=h(t,["languageCode"]);return r!=null&&m(e,["languageCode"],r),e}function QI(t){const e={},n=h(t,["includeThoughts"]);n!=null&&m(e,["includeThoughts"],n);const r=h(t,["thinkingBudget"]);return r!=null&&m(e,["thinkingBudget"],r),e}function e6(t,e,n){const r={},a=h(e,["systemInstruction"]);n!==void 0&&a!=null&&m(n,["systemInstruction"],wl(ir(a)));const i=h(e,["temperature"]);i!=null&&m(r,["temperature"],i);const l=h(e,["topP"]);l!=null&&m(r,["topP"],l);const c=h(e,["topK"]);c!=null&&m(r,["topK"],c);const d=h(e,["candidateCount"]);d!=null&&m(r,["candidateCount"],d);const f=h(e,["maxOutputTokens"]);f!=null&&m(r,["maxOutputTokens"],f);const g=h(e,["stopSequences"]);g!=null&&m(r,["stopSequences"],g);const v=h(e,["responseLogprobs"]);v!=null&&m(r,["responseLogprobs"],v);const _=h(e,["logprobs"]);_!=null&&m(r,["logprobs"],_);const T=h(e,["presencePenalty"]);T!=null&&m(r,["presencePenalty"],T);const E=h(e,["frequencyPenalty"]);E!=null&&m(r,["frequencyPenalty"],E);const S=h(e,["seed"]);S!=null&&m(r,["seed"],S);const b=h(e,["responseMimeType"]);b!=null&&m(r,["responseMimeType"],b);const k=h(e,["responseSchema"]);k!=null&&m(r,["responseSchema"],II(Xc(k)));const A=h(e,["responseJsonSchema"]);A!=null&&m(r,["responseJsonSchema"],A);const C=h(e,["routingConfig"]);C!=null&&m(r,["routingConfig"],C);const I=h(e,["modelSelectionConfig"]);I!=null&&m(r,["modelConfig"],FI(I));const B=h(e,["safetySettings"]);if(n!==void 0&&B!=null){let Ee=B;Array.isArray(Ee)&&(Ee=Ee.map(se=>LI(se))),m(n,["safetySettings"],Ee)}const j=h(e,["tools"]);if(n!==void 0&&j!=null){let Ee=yl(j);Array.isArray(Ee)&&(Ee=Ee.map(se=>k2(vl(se)))),m(n,["tools"],Ee)}const F=h(e,["toolConfig"]);n!==void 0&&F!=null&&m(n,["toolConfig"],JI(F));const X=h(e,["labels"]);n!==void 0&&X!=null&&m(n,["labels"],X);const P=h(e,["cachedContent"]);n!==void 0&&P!=null&&m(n,["cachedContent"],hs(t,P));const re=h(e,["responseModalities"]);re!=null&&m(r,["responseModalities"],re);const G=h(e,["mediaResolution"]);G!=null&&m(r,["mediaResolution"],G);const te=h(e,["speechConfig"]);te!=null&&m(r,["speechConfig"],ZI(Ep(te)));const _e=h(e,["audioTimestamp"]);_e!=null&&m(r,["audioTimestamp"],_e);const Ne=h(e,["thinkingConfig"]);return Ne!=null&&m(r,["thinkingConfig"],QI(Ne)),r}function G_(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["contents"]);if(a!=null){let l=Qr(a);Array.isArray(l)&&(l=l.map(c=>wl(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["generationConfig"],e6(t,i,n)),n}function t6(t,e){const n={},r=h(t,["taskType"]);e!==void 0&&r!=null&&m(e,["instances[]","task_type"],r);const a=h(t,["title"]);e!==void 0&&a!=null&&m(e,["instances[]","title"],a);const i=h(t,["outputDimensionality"]);e!==void 0&&i!=null&&m(e,["parameters","outputDimensionality"],i);const l=h(t,["mimeType"]);e!==void 0&&l!=null&&m(e,["instances[]","mimeType"],l);const c=h(t,["autoTruncate"]);return e!==void 0&&c!=null&&m(e,["parameters","autoTruncate"],c),n}function n6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["contents"]);a!=null&&m(n,["instances[]","content"],u2(t,a));const i=h(e,["config"]);return i!=null&&m(n,["config"],t6(i,n)),n}function r6(t,e){const n={},r=h(t,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const a=h(t,["negativePrompt"]);e!==void 0&&a!=null&&m(e,["parameters","negativePrompt"],a);const i=h(t,["numberOfImages"]);e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i);const l=h(t,["aspectRatio"]);e!==void 0&&l!=null&&m(e,["parameters","aspectRatio"],l);const c=h(t,["guidanceScale"]);e!==void 0&&c!=null&&m(e,["parameters","guidanceScale"],c);const d=h(t,["seed"]);e!==void 0&&d!=null&&m(e,["parameters","seed"],d);const f=h(t,["safetyFilterLevel"]);e!==void 0&&f!=null&&m(e,["parameters","safetySetting"],f);const g=h(t,["personGeneration"]);e!==void 0&&g!=null&&m(e,["parameters","personGeneration"],g);const v=h(t,["includeSafetyAttributes"]);e!==void 0&&v!=null&&m(e,["parameters","includeSafetyAttributes"],v);const _=h(t,["includeRaiReason"]);e!==void 0&&_!=null&&m(e,["parameters","includeRaiReason"],_);const T=h(t,["language"]);e!==void 0&&T!=null&&m(e,["parameters","language"],T);const E=h(t,["outputMimeType"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","mimeType"],E);const S=h(t,["outputCompressionQuality"]);e!==void 0&&S!=null&&m(e,["parameters","outputOptions","compressionQuality"],S);const b=h(t,["addWatermark"]);e!==void 0&&b!=null&&m(e,["parameters","addWatermark"],b);const k=h(t,["enhancePrompt"]);return e!==void 0&&k!=null&&m(e,["parameters","enhancePrompt"],k),n}function a6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["config"]);return i!=null&&m(n,["config"],r6(i,n)),n}function Fd(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["gcsUri"],n);const r=h(t,["imageBytes"]);r!=null&&m(e,["bytesBase64Encoded"],ms(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function s6(t){const e={},n=h(t,["maskMode"]);n!=null&&m(e,["maskMode"],n);const r=h(t,["segmentationClasses"]);r!=null&&m(e,["maskClasses"],r);const a=h(t,["maskDilation"]);return a!=null&&m(e,["dilation"],a),e}function i6(t){const e={},n=h(t,["controlType"]);n!=null&&m(e,["controlType"],n);const r=h(t,["enableControlImageComputation"]);return r!=null&&m(e,["computeControl"],r),e}function o6(t){const e={},n=h(t,["styleDescription"]);return n!=null&&m(e,["styleDescription"],n),e}function l6(t){const e={},n=h(t,["subjectType"]);n!=null&&m(e,["subjectType"],n);const r=h(t,["subjectDescription"]);return r!=null&&m(e,["subjectDescription"],r),e}function c6(t){const e={},n=h(t,["referenceImage"]);n!=null&&m(e,["referenceImage"],Fd(n));const r=h(t,["referenceId"]);r!=null&&m(e,["referenceId"],r);const a=h(t,["referenceType"]);a!=null&&m(e,["referenceType"],a);const i=h(t,["maskImageConfig"]);i!=null&&m(e,["maskImageConfig"],s6(i));const l=h(t,["controlImageConfig"]);l!=null&&m(e,["controlImageConfig"],i6(l));const c=h(t,["styleImageConfig"]);c!=null&&m(e,["styleImageConfig"],o6(c));const d=h(t,["subjectImageConfig"]);return d!=null&&m(e,["subjectImageConfig"],l6(d)),e}function u6(t,e){const n={},r=h(t,["outputGcsUri"]);e!==void 0&&r!=null&&m(e,["parameters","storageUri"],r);const a=h(t,["negativePrompt"]);e!==void 0&&a!=null&&m(e,["parameters","negativePrompt"],a);const i=h(t,["numberOfImages"]);e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i);const l=h(t,["aspectRatio"]);e!==void 0&&l!=null&&m(e,["parameters","aspectRatio"],l);const c=h(t,["guidanceScale"]);e!==void 0&&c!=null&&m(e,["parameters","guidanceScale"],c);const d=h(t,["seed"]);e!==void 0&&d!=null&&m(e,["parameters","seed"],d);const f=h(t,["safetyFilterLevel"]);e!==void 0&&f!=null&&m(e,["parameters","safetySetting"],f);const g=h(t,["personGeneration"]);e!==void 0&&g!=null&&m(e,["parameters","personGeneration"],g);const v=h(t,["includeSafetyAttributes"]);e!==void 0&&v!=null&&m(e,["parameters","includeSafetyAttributes"],v);const _=h(t,["includeRaiReason"]);e!==void 0&&_!=null&&m(e,["parameters","includeRaiReason"],_);const T=h(t,["language"]);e!==void 0&&T!=null&&m(e,["parameters","language"],T);const E=h(t,["outputMimeType"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","mimeType"],E);const S=h(t,["outputCompressionQuality"]);e!==void 0&&S!=null&&m(e,["parameters","outputOptions","compressionQuality"],S);const b=h(t,["editMode"]);e!==void 0&&b!=null&&m(e,["parameters","editMode"],b);const k=h(t,["baseSteps"]);return e!==void 0&&k!=null&&m(e,["parameters","editConfig","baseSteps"],k),n}function f6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["referenceImages"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(d=>c6(d))),m(n,["instances[0]","referenceImages"],c)}const l=h(e,["config"]);return l!=null&&m(n,["config"],u6(l,n)),n}function d6(t,e){const n={},r=h(t,["includeRaiReason"]);e!==void 0&&r!=null&&m(e,["parameters","includeRaiReason"],r);const a=h(t,["outputMimeType"]);e!==void 0&&a!=null&&m(e,["parameters","outputOptions","mimeType"],a);const i=h(t,["outputCompressionQuality"]);e!==void 0&&i!=null&&m(e,["parameters","outputOptions","compressionQuality"],i);const l=h(t,["enhanceInputImage"]);e!==void 0&&l!=null&&m(e,["parameters","upscaleConfig","enhanceInputImage"],l);const c=h(t,["imagePreservationFactor"]);e!==void 0&&c!=null&&m(e,["parameters","upscaleConfig","imagePreservationFactor"],c);const d=h(t,["numberOfImages"]);e!==void 0&&d!=null&&m(e,["parameters","sampleCount"],d);const f=h(t,["mode"]);return e!==void 0&&f!=null&&m(e,["parameters","mode"],f),n}function h6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["image"]);a!=null&&m(n,["instances[0]","image"],Fd(a));const i=h(e,["upscaleFactor"]);i!=null&&m(n,["parameters","upscaleConfig","upscaleFactor"],i);const l=h(e,["config"]);return l!=null&&m(n,["config"],d6(l,n)),n}function m6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],$t(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function p6(t,e,n){const r={},a=h(e,["pageSize"]);n!==void 0&&a!=null&&m(n,["_query","pageSize"],a);const i=h(e,["pageToken"]);n!==void 0&&i!=null&&m(n,["_query","pageToken"],i);const l=h(e,["filter"]);n!==void 0&&l!=null&&m(n,["_query","filter"],l);const c=h(e,["queryBase"]);return n!==void 0&&c!=null&&m(n,["_url","models_url"],h2(t,c)),r}function g6(t,e){const n={},r=h(e,["config"]);return r!=null&&m(n,["config"],p6(t,r,n)),n}function x6(t,e){const n={},r=h(t,["displayName"]);e!==void 0&&r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);e!==void 0&&a!=null&&m(e,["description"],a);const i=h(t,["defaultCheckpointId"]);return e!==void 0&&i!=null&&m(e,["defaultCheckpointId"],i),n}function v6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],x6(a,n)),n}function y6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","name"],$t(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],a),n}function _6(t,e){const n={},r=h(t,["systemInstruction"]);e!==void 0&&r!=null&&m(e,["systemInstruction"],wl(ir(r)));const a=h(t,["tools"]);if(e!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>k2(c))),m(e,["tools"],l)}const i=h(t,["generationConfig"]);return e!==void 0&&i!=null&&m(e,["generationConfig"],i),n}function w6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["contents"]);if(a!=null){let l=Qr(a);Array.isArray(l)&&(l=l.map(c=>wl(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["config"],_6(i,n)),n}function T6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["contents"]);if(a!=null){let l=Qr(a);Array.isArray(l)&&(l=l.map(c=>wl(c))),m(n,["contents"],l)}const i=h(e,["config"]);return i!=null&&m(n,["config"],i),n}function E6(t){const e={},n=h(t,["uri"]);n!=null&&m(e,["gcsUri"],n);const r=h(t,["videoBytes"]);r!=null&&m(e,["bytesBase64Encoded"],ms(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function S6(t,e){const n={},r=h(t,["numberOfVideos"]);e!==void 0&&r!=null&&m(e,["parameters","sampleCount"],r);const a=h(t,["outputGcsUri"]);e!==void 0&&a!=null&&m(e,["parameters","storageUri"],a);const i=h(t,["fps"]);e!==void 0&&i!=null&&m(e,["parameters","fps"],i);const l=h(t,["durationSeconds"]);e!==void 0&&l!=null&&m(e,["parameters","durationSeconds"],l);const c=h(t,["seed"]);e!==void 0&&c!=null&&m(e,["parameters","seed"],c);const d=h(t,["aspectRatio"]);e!==void 0&&d!=null&&m(e,["parameters","aspectRatio"],d);const f=h(t,["resolution"]);e!==void 0&&f!=null&&m(e,["parameters","resolution"],f);const g=h(t,["personGeneration"]);e!==void 0&&g!=null&&m(e,["parameters","personGeneration"],g);const v=h(t,["pubsubTopic"]);e!==void 0&&v!=null&&m(e,["parameters","pubsubTopic"],v);const _=h(t,["negativePrompt"]);e!==void 0&&_!=null&&m(e,["parameters","negativePrompt"],_);const T=h(t,["enhancePrompt"]);e!==void 0&&T!=null&&m(e,["parameters","enhancePrompt"],T);const E=h(t,["generateAudio"]);e!==void 0&&E!=null&&m(e,["parameters","generateAudio"],E);const S=h(t,["lastFrame"]);e!==void 0&&S!=null&&m(e,["instances[0]","lastFrame"],Fd(S));const b=h(t,["compressionQuality"]);return e!==void 0&&b!=null&&m(e,["parameters","compressionQuality"],b),n}function b6(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["_url","model"],$t(t,r));const a=h(e,["prompt"]);a!=null&&m(n,["instances[0]","prompt"],a);const i=h(e,["image"]);i!=null&&m(n,["instances[0]","image"],Fd(i));const l=h(e,["video"]);l!=null&&m(n,["instances[0]","video"],E6(l));const c=h(e,["config"]);return c!=null&&m(n,["config"],S6(c,n)),n}function C6(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function A6(t){const e={},n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function k6(t){const e={},n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function N6(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],C6(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],A6(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],k6(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function R6(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>N6(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function D6(t){const e={},n=h(t,["citationSources"]);return n!=null&&m(e,["citations"],n),e}function M6(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function I6(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>M6(a))),m(e,["urlMetadata"],r)}return e}function F6(t){const e={},n=h(t,["content"]);n!=null&&m(e,["content"],R6(n));const r=h(t,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],D6(r));const a=h(t,["tokenCount"]);a!=null&&m(e,["tokenCount"],a);const i=h(t,["finishReason"]);i!=null&&m(e,["finishReason"],i);const l=h(t,["urlContextMetadata"]);l!=null&&m(e,["urlContextMetadata"],I6(l));const c=h(t,["avgLogprobs"]);c!=null&&m(e,["avgLogprobs"],c);const d=h(t,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(t,["index"]);f!=null&&m(e,["index"],f);const g=h(t,["logprobsResult"]);g!=null&&m(e,["logprobsResult"],g);const v=h(t,["safetyRatings"]);return v!=null&&m(e,["safetyRatings"],v),e}function z_(t){const e={},n=h(t,["candidates"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(c=>F6(c))),m(e,["candidates"],l)}const r=h(t,["modelVersion"]);r!=null&&m(e,["modelVersion"],r);const a=h(t,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const i=h(t,["usageMetadata"]);return i!=null&&m(e,["usageMetadata"],i),e}function L6(t){const e={},n=h(t,["values"]);return n!=null&&m(e,["values"],n),e}function O6(){return{}}function P6(t){const e={},n=h(t,["embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>L6(i))),m(e,["embeddings"],a)}return h(t,["metadata"])!=null&&m(e,["metadata"],O6()),e}function U6(t){const e={},n=h(t,["bytesBase64Encoded"]);n!=null&&m(e,["imageBytes"],ms(n));const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function N2(t){const e={},n=h(t,["safetyAttributes","categories"]);n!=null&&m(e,["categories"],n);const r=h(t,["safetyAttributes","scores"]);r!=null&&m(e,["scores"],r);const a=h(t,["contentType"]);return a!=null&&m(e,["contentType"],a),e}function B6(t){const e={},n=h(t,["_self"]);n!=null&&m(e,["image"],U6(n));const r=h(t,["raiFilteredReason"]);r!=null&&m(e,["raiFilteredReason"],r);const a=h(t,["_self"]);return a!=null&&m(e,["safetyAttributes"],N2(a)),e}function j6(t){const e={},n=h(t,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>B6(i))),m(e,["generatedImages"],a)}const r=h(t,["positivePromptSafetyAttributes"]);return r!=null&&m(e,["positivePromptSafetyAttributes"],N2(r)),e}function V6(t){const e={},n=h(t,["baseModel"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["createTime"]);r!=null&&m(e,["createTime"],r);const a=h(t,["updateTime"]);return a!=null&&m(e,["updateTime"],a),e}function Wm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["version"]);i!=null&&m(e,["version"],i);const l=h(t,["_self"]);l!=null&&m(e,["tunedModelInfo"],V6(l));const c=h(t,["inputTokenLimit"]);c!=null&&m(e,["inputTokenLimit"],c);const d=h(t,["outputTokenLimit"]);d!=null&&m(e,["outputTokenLimit"],d);const f=h(t,["supportedGenerationMethods"]);return f!=null&&m(e,["supportedActions"],f),e}function H6(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["_self"]);if(r!=null){let a=m2(r);Array.isArray(a)&&(a=a.map(i=>Wm(i))),m(e,["models"],a)}return e}function $6(){return{}}function G6(t){const e={},n=h(t,["totalTokens"]);n!=null&&m(e,["totalTokens"],n);const r=h(t,["cachedContentTokenCount"]);return r!=null&&m(e,["cachedContentTokenCount"],r),e}function z6(t){const e={},n=h(t,["video","uri"]);n!=null&&m(e,["uri"],n);const r=h(t,["video","encodedVideo"]);r!=null&&m(e,["videoBytes"],ms(r));const a=h(t,["encoding"]);return a!=null&&m(e,["mimeType"],a),e}function q6(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],z6(n)),e}function Y6(t){const e={},n=h(t,["generatedSamples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>q6(l))),m(e,["generatedVideos"],i)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function W6(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);i!=null&&m(e,["error"],i);const l=h(t,["response","generateVideoResponse"]);return l!=null&&m(e,["response"],Y6(l)),e}function J6(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function K6(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["data"]);r!=null&&m(e,["data"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function X6(t){const e={},n=h(t,["displayName"]);n!=null&&m(e,["displayName"],n);const r=h(t,["fileUri"]);r!=null&&m(e,["fileUri"],r);const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function Z6(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],J6(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],K6(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],X6(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function Q6(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>Z6(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function eF(t){const e={},n=h(t,["citations"]);return n!=null&&m(e,["citations"],n),e}function tF(t){const e={},n=h(t,["retrievedUrl"]);n!=null&&m(e,["retrievedUrl"],n);const r=h(t,["urlRetrievalStatus"]);return r!=null&&m(e,["urlRetrievalStatus"],r),e}function nF(t){const e={},n=h(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>tF(a))),m(e,["urlMetadata"],r)}return e}function rF(t){const e={},n=h(t,["content"]);n!=null&&m(e,["content"],Q6(n));const r=h(t,["citationMetadata"]);r!=null&&m(e,["citationMetadata"],eF(r));const a=h(t,["finishMessage"]);a!=null&&m(e,["finishMessage"],a);const i=h(t,["finishReason"]);i!=null&&m(e,["finishReason"],i);const l=h(t,["urlContextMetadata"]);l!=null&&m(e,["urlContextMetadata"],nF(l));const c=h(t,["avgLogprobs"]);c!=null&&m(e,["avgLogprobs"],c);const d=h(t,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(t,["index"]);f!=null&&m(e,["index"],f);const g=h(t,["logprobsResult"]);g!=null&&m(e,["logprobsResult"],g);const v=h(t,["safetyRatings"]);return v!=null&&m(e,["safetyRatings"],v),e}function q_(t){const e={},n=h(t,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>rF(f))),m(e,["candidates"],d)}const r=h(t,["createTime"]);r!=null&&m(e,["createTime"],r);const a=h(t,["responseId"]);a!=null&&m(e,["responseId"],a);const i=h(t,["modelVersion"]);i!=null&&m(e,["modelVersion"],i);const l=h(t,["promptFeedback"]);l!=null&&m(e,["promptFeedback"],l);const c=h(t,["usageMetadata"]);return c!=null&&m(e,["usageMetadata"],c),e}function aF(t){const e={},n=h(t,["truncated"]);n!=null&&m(e,["truncated"],n);const r=h(t,["token_count"]);return r!=null&&m(e,["tokenCount"],r),e}function sF(t){const e={},n=h(t,["values"]);n!=null&&m(e,["values"],n);const r=h(t,["statistics"]);return r!=null&&m(e,["statistics"],aF(r)),e}function iF(t){const e={},n=h(t,["billableCharacterCount"]);return n!=null&&m(e,["billableCharacterCount"],n),e}function oF(t){const e={},n=h(t,["predictions[]","embeddings"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>sF(i))),m(e,["embeddings"],a)}const r=h(t,["metadata"]);return r!=null&&m(e,["metadata"],iF(r)),e}function lF(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["gcsUri"],n);const r=h(t,["bytesBase64Encoded"]);r!=null&&m(e,["imageBytes"],ms(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function R2(t){const e={},n=h(t,["safetyAttributes","categories"]);n!=null&&m(e,["categories"],n);const r=h(t,["safetyAttributes","scores"]);r!=null&&m(e,["scores"],r);const a=h(t,["contentType"]);return a!=null&&m(e,["contentType"],a),e}function bp(t){const e={},n=h(t,["_self"]);n!=null&&m(e,["image"],lF(n));const r=h(t,["raiFilteredReason"]);r!=null&&m(e,["raiFilteredReason"],r);const a=h(t,["_self"]);a!=null&&m(e,["safetyAttributes"],R2(a));const i=h(t,["prompt"]);return i!=null&&m(e,["enhancedPrompt"],i),e}function cF(t){const e={},n=h(t,["predictions"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>bp(i))),m(e,["generatedImages"],a)}const r=h(t,["positivePromptSafetyAttributes"]);return r!=null&&m(e,["positivePromptSafetyAttributes"],R2(r)),e}function uF(t){const e={},n=h(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>bp(a))),m(e,["generatedImages"],r)}return e}function fF(t){const e={},n=h(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>bp(a))),m(e,["generatedImages"],r)}return e}function dF(t){const e={},n=h(t,["endpoint"]);n!=null&&m(e,["name"],n);const r=h(t,["deployedModelId"]);return r!=null&&m(e,["deployedModelId"],r),e}function hF(t){const e={},n=h(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["createTime"]);r!=null&&m(e,["createTime"],r);const a=h(t,["updateTime"]);return a!=null&&m(e,["updateTime"],a),e}function mF(t){const e={},n=h(t,["checkpointId"]);n!=null&&m(e,["checkpointId"],n);const r=h(t,["epoch"]);r!=null&&m(e,["epoch"],r);const a=h(t,["step"]);return a!=null&&m(e,["step"],a),e}function Jm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["displayName"]);r!=null&&m(e,["displayName"],r);const a=h(t,["description"]);a!=null&&m(e,["description"],a);const i=h(t,["versionId"]);i!=null&&m(e,["version"],i);const l=h(t,["deployedModels"]);if(l!=null){let v=l;Array.isArray(v)&&(v=v.map(_=>dF(_))),m(e,["endpoints"],v)}const c=h(t,["labels"]);c!=null&&m(e,["labels"],c);const d=h(t,["_self"]);d!=null&&m(e,["tunedModelInfo"],hF(d));const f=h(t,["defaultCheckpointId"]);f!=null&&m(e,["defaultCheckpointId"],f);const g=h(t,["checkpoints"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(_=>mF(_))),m(e,["checkpoints"],v)}return e}function pF(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["_self"]);if(r!=null){let a=m2(r);Array.isArray(a)&&(a=a.map(i=>Jm(i))),m(e,["models"],a)}return e}function gF(){return{}}function xF(t){const e={},n=h(t,["totalTokens"]);return n!=null&&m(e,["totalTokens"],n),e}function vF(t){const e={},n=h(t,["tokensInfo"]);return n!=null&&m(e,["tokensInfo"],n),e}function yF(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["uri"],n);const r=h(t,["bytesBase64Encoded"]);r!=null&&m(e,["videoBytes"],ms(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function _F(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],yF(n)),e}function wF(t){const e={},n=h(t,["videos"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>_F(l))),m(e,["generatedVideos"],i)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function TF(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);i!=null&&m(e,["error"],i);const l=h(t,["response"]);return l!=null&&m(e,["response"],wF(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const EF="Content-Type",SF="X-Server-Timeout",bF="User-Agent",Km="x-goog-api-client",CF="1.8.0",AF=`google-genai-sdk/${CF}`,kF="v1beta1",NF="v1beta",Y_=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class RF{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const a={};this.clientOptions.vertexai?(a.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:kF,a.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(a.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:NF,a.baseUrl="https://generativelanguage.googleapis.com/"),a.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=a,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(a,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const a=[this.getRequestUrlInternal(n)];return r&&a.push(this.getBaseResourcePath()),e!==""&&a.push(e),new URL(`${a.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[l,c]of Object.entries(e.queryParams))a.searchParams.append(l,String(c));let i={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.unaryApiCall(a,i,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[a,i]of Object.entries(n))typeof i=="object"?r[a]=Object.assign(Object.assign({},r[a]),i):i!==void 0&&(r[a]=i);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),a=this.constructUrl(e.path,n,r);(!a.searchParams.has("alt")||a.searchParams.get("alt")!=="sse")&&a.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.streamApiCall(a,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const a=new AbortController,i=a.signal;n.timeout&&(n==null?void 0:n.timeout)>0&&setTimeout(()=>a.abort(),n.timeout),r&&r.addEventListener("abort",()=>{a.abort()}),e.signal=i}return n&&n.extraBody!==null&&DF(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await W_(a),new Hm(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async a=>(await W_(a),this.processStreamResponse(a))).catch(a=>{throw a instanceof Error?a:new Error(JSON.stringify(a))})}processStreamResponse(e){var n;return nl(this,arguments,function*(){const a=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),i=new TextDecoder("utf-8");if(!a)throw new Error("Response body is empty");try{let l="";for(;;){const{done:c,value:d}=yield en(a.read());if(c){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const f=i.decode(d);try{const v=JSON.parse(f);if("error"in v){const _=JSON.parse(JSON.stringify(v.error)),T=_.status,E=_.code,S=`got status: ${T}. ${JSON.stringify(v)}`;if(E>=400&&E<600)throw new Md({message:S,status:E})}}catch(v){if(v.name==="ApiError")throw v}l+=f;let g=l.match(Y_);for(;g;){const v=g[1];try{const _=new Response(v,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield en(new Hm(_)),l=l.slice(g[0].length),g=l.match(Y_)}catch(_){throw new Error(`exception parsing stream chunk ${v}. ${_}`)}}}}finally{a.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=AF+" "+this.clientOptions.userAgentExtra;return e[bF]=n,e[Km]=n,e[EF]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,a]of Object.entries(e.headers))n.append(r,a);e.timeout&&e.timeout>0&&n.append(SF,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const a={};n!=null&&(a.mimeType=n.mimeType,a.name=n.name,a.displayName=n.displayName),a.name&&!a.name.startsWith("files/")&&(a.name=`files/${a.name}`);const i=this.clientOptions.uploader,l=await i.stat(e);a.sizeBytes=String(l.size);const c=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");a.mimeType=c;const d=await this.fetchUploadUrl(a,n);return i.upload(e,d,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let a={};n!=null&&n.httpOptions?a=n.httpOptions:a={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const i={file:e},l=await this.request({path:qe("upload/v1beta/files",i._url),body:JSON.stringify(i),httpMethod:"POST",httpOptions:a});if(!l||!(l!=null&&l.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const c=(r=l==null?void 0:l.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(c===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return c}}async function W_(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const a=JSON.stringify(r);throw n>=400&&n<600?new Md({message:a,status:n}):new Error(a)}}function DF(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const i=JSON.parse(t.body);if(typeof i=="object"&&i!==null&&!Array.isArray(i))n=i;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(i,l){const c=Object.assign({},i);for(const d in l)if(Object.prototype.hasOwnProperty.call(l,d)){const f=l[d],g=c[d];f&&typeof f=="object"&&!Array.isArray(f)&&g&&typeof g=="object"&&!Array.isArray(g)?c[d]=r(g,f):(g&&f&&typeof g!=typeof f&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof g}, New type: ${typeof f}. Overwriting.`),c[d]=f)}return c}const a=r(n,e);t.body=JSON.stringify(a)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const MF="mcp_used/unknown";function D2(t){for(const e of t)if(Cp(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function M2(t){var e;const n=(e=t[Km])!==null&&e!==void 0?e:"";t[Km]=(n+` ${MF}`).trimStart()}function IF(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(a=>Cp(a)))!==null&&r!==void 0?r:!1}function FF(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(a=>!Cp(a)))!==null&&r!==void 0?r:!1}function Cp(t){return t!==null&&typeof t=="object"&&t instanceof Ap}function LF(t,e=100){return nl(this,arguments,function*(){let r,a=0;for(;a<e;){const i=yield en(t.listTools({cursor:r}));for(const l of i.tools)yield yield en(l),a++;if(!i.nextCursor)break;r=i.nextCursor}})}class Ap{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new Ap(e,n)}async initialize(){var e,n,r,a;if(this.mcpTools.length>0)return;const i={},l=[];for(const g of this.mcpClients)try{for(var c=!0,d=(n=void 0,Uc(LF(g))),f;f=await d.next(),e=f.done,!e;c=!0){a=f.value,c=!1;const v=a;l.push(v);const _=v.name;if(i[_])throw new Error(`Duplicate function name ${_} found in MCP tools. Please ensure function names are unique.`);i[_]=g}}catch(v){n={error:v}}finally{try{!c&&!e&&(r=d.return)&&await r.call(d)}finally{if(n)throw n.error}}this.mcpTools=l,this.functionNameToMcpClient=i}async tool(){return await this.initialize(),kR(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const a=this.functionNameToMcpClient[r.name];let i;this.config.timeout&&(i={timeout:this.config.timeout});const l=await a.callTool({name:r.name,arguments:r.args},void 0,i);n.push({functionResponse:{name:r.name,response:l.isError?{error:l}:l}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function OF(t,e,n){const r=new xR;let a;n.data instanceof Blob?a=JSON.parse(await n.data.text()):a=JSON.parse(n.data);const i=GM(a);Object.assign(r,i),e(r)}class PF{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const a=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion(),l=jF(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),d=`${a}/ws/google.ai.generativelanguage.${i}.GenerativeService.BidiGenerateMusic?key=${c}`;let f=()=>{};const g=new Promise(C=>{f=C}),v=e.callbacks,_=function(){f({})},T=this.apiClient,E={onopen:_,onmessage:C=>{OF(T,v.onmessage,C)},onerror:(n=v==null?void 0:v.onerror)!==null&&n!==void 0?n:function(C){},onclose:(r=v==null?void 0:v.onclose)!==null&&r!==void 0?r:function(C){}},S=this.webSocketFactory.create(d,BF(l),E);S.connect(),await g;const b=$t(this.apiClient,e.model),k=b2({model:b}),A=Ym({setup:k});return S.send(JSON.stringify(A)),new UF(S,this.apiClient)}}class UF{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=aM(e),r=C2(n);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=sM(e),r=Ym(n);this.conn.send(JSON.stringify(r))}sendPlaybackControl(e){const n=Ym({playbackControl:e});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Qo.PLAY)}pause(){this.sendPlaybackControl(Qo.PAUSE)}stop(){this.sendPlaybackControl(Qo.STOP)}resetContext(){this.sendPlaybackControl(Qo.RESET_CONTEXT)}close(){this.conn.close()}}function BF(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function jF(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const VF="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function HF(t,e,n){const r=new gR;let a;n.data instanceof Blob?a=await n.data.text():n.data instanceof ArrayBuffer?a=new TextDecoder().decode(n.data):a=n.data;const i=JSON.parse(a);if(t.isVertexAI()){const l=LM(i);Object.assign(r,l)}else{const l=FM(i);Object.assign(r,l)}e(r)}class $F{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new PF(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,a,i,l,c;const d=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let g;const v=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&D2(e.config.tools)&&M2(v);const _=YF(v);if(this.apiClient.isVertexAI())g=`${d}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(_);else{const P=this.apiClient.getApiKey();let re="BidiGenerateContent",G="key";P!=null&&P.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),re="BidiGenerateContentConstrained",G="access_token"),g=`${d}/ws/google.ai.generativelanguage.${f}.GenerativeService.${re}?${G}=${P}`}let T=()=>{};const E=new Promise(P=>{T=P}),S=e.callbacks,b=function(){var P;(P=S==null?void 0:S.onopen)===null||P===void 0||P.call(S),T({})},k=this.apiClient,A={onopen:b,onmessage:P=>{HF(k,S.onmessage,P)},onerror:(n=S==null?void 0:S.onerror)!==null&&n!==void 0?n:function(P){},onclose:(r=S==null?void 0:S.onclose)!==null&&r!==void 0?r:function(P){}},C=this.webSocketFactory.create(g,qF(_),A);C.connect(),await E;let I=$t(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&I.startsWith("publishers/")){const P=this.apiClient.getProject(),re=this.apiClient.getLocation();I=`projects/${P}/locations/${re}/`+I}let B={};this.apiClient.isVertexAI()&&((a=e.config)===null||a===void 0?void 0:a.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[dd.AUDIO]}:e.config.responseModalities=[dd.AUDIO]),!((i=e.config)===null||i===void 0)&&i.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const j=(c=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],F=[];for(const P of j)if(this.isCallableTool(P)){const re=P;F.push(await re.tool())}else F.push(P);F.length>0&&(e.config.tools=F);const X={model:I,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?B=XD(this.apiClient,X):B=KD(this.apiClient,X),delete B.config,C.send(JSON.stringify(B)),new zF(C,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const GF={turnComplete:!0};class zF{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Qr(n.turns),e.isVertexAI()?r=r.map(a=>wl(a)):r=r.map(a=>Id(a))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const i of r){if(typeof i!="object"||i===null||!("name"in i)||!("response"in i))throw new Error(`Could not parse function response, type '${typeof i}'.`);if(!e.isVertexAI()&&!("id"in i))throw new Error(VF)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},GF),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:rM(e)}:n={realtimeInput:nM(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function qF(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function YF(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const J_=10;function K_(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let a=!1;for(const l of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(nd(l)){a=!0;break}if(!a)return!0;const i=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return i&&(i<0||!Number.isInteger(i))||i==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",i),!0):!1}function nd(t){return"callTool"in t&&typeof t.callTool=="function"}function X_(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class WF extends Yi{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,a,i,l,c;const d=await this.processParamsForMcpUsage(n);if(!IF(n)||K_(n.config))return await this.generateContentInternal(d);if(FF(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let f,g;const v=Qr(d.contents),_=(i=(a=(r=d.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||a===void 0?void 0:a.maximumRemoteCalls)!==null&&i!==void 0?i:J_;let T=0;for(;T<_&&(f=await this.generateContentInternal(d),!(!f.functionCalls||f.functionCalls.length===0));){const E=f.candidates[0].content,S=[];for(const b of(c=(l=n.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(nd(b)){const A=await b.callTool(f.functionCalls);S.push(...A)}T++,g={role:"user",parts:S},d.contents=Qr(d.contents),d.contents.push(E),d.contents.push(g),X_(d.config)&&(v.push(E),v.push(g))}return X_(d.config)&&(f.automaticFunctionCallingHistory=v),f},this.generateContentStream=async n=>{if(K_(n.config)){const r=await this.processParamsForMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var a;let i;const l=[];if(r!=null&&r.generatedImages)for(const d of r.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((a=d==null?void 0:d.safetyAttributes)===null||a===void 0?void 0:a.contentType)==="Positive Prompt"?i=d==null?void 0:d.safetyAttributes:l.push(d);let c;return i?c={generatedImages:l,positivePromptSafetyAttributes:i}:c={generatedImages:l},c}),this.list=async n=>{var r;const l={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((r=l.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new pu(Ui.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const a={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(a)}}async processParamsForMcpUsage(e){var n,r,a;const i=(n=e.config)===null||n===void 0?void 0:n.tools;if(!i)return e;const l=await Promise.all(i.map(async d=>nd(d)?await d.tool():d)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(c.config.tools=l,e.config&&e.config.tools&&D2(e.config.tools)){const d=(a=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&a!==void 0?a:{};let f=Object.assign({},d);Object.keys(f).length===0&&(f=this.apiClient.getDefaultHeaders()),M2(f),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:f})}return c}async initAfcToolsMap(e){var n,r,a;const i=new Map;for(const l of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(nd(l)){const c=l,d=await c.tool();for(const f of(a=d.functionDeclarations)!==null&&a!==void 0?a:[]){if(!f.name)throw new Error("Function declaration name is required.");if(i.has(f.name))throw new Error(`Duplicate tool declaration name: ${f.name}`);i.set(f.name,c)}}return i}async processAfcStream(e){var n,r,a;const i=(a=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&a!==void 0?a:J_;let l=!1,c=0;const d=await this.initAfcToolsMap(e);return function(f,g,v){var _,T;return nl(this,arguments,function*(){for(var E,S,b,k;c<i;){l&&(c++,l=!1);const B=yield en(f.processParamsForMcpUsage(v)),j=yield en(f.generateContentStreamInternal(B)),F=[],X=[];try{for(var A=!0,C=(S=void 0,Uc(j)),I;I=yield en(C.next()),E=I.done,!E;A=!0){k=I.value,A=!1;const P=k;if(yield yield en(P),P.candidates&&(!((_=P.candidates[0])===null||_===void 0)&&_.content)){X.push(P.candidates[0].content);for(const re of(T=P.candidates[0].content.parts)!==null&&T!==void 0?T:[])if(c<i&&re.functionCall){if(!re.functionCall.name)throw new Error("Function call name was not returned by the model.");if(g.has(re.functionCall.name)){const G=yield en(g.get(re.functionCall.name).callTool([re.functionCall]));F.push(...G)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${g.keys()}, mising tool: ${re.functionCall.name}`)}}}}catch(P){S={error:P}}finally{try{!A&&!E&&(b=C.return)&&(yield en(b.call(C)))}finally{if(S)throw S.error}}if(F.length>0){l=!0;const P=new bc;P.candidates=[{content:{role:"user",parts:F}}],yield yield en(P);const re=[];re.push(...X),re.push({role:"user",parts:F});const G=Qr(v.contents).concat(re);v.contents=G}else break}})}(this,d,e)}async generateContentInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=G_(this.apiClient,e);return c=qe("{model}:generateContent",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=q_(g),_=new bc;return Object.assign(_,v),_})}else{const f=$_(this.apiClient,e);return c=qe("{model}:generateContent",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const v=z_(g),_=new bc;return Object.assign(_,v),_})}}async generateContentStreamInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=G_(this.apiClient,e);return c=qe("{model}:streamGenerateContent?alt=sse",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),l.then(function(v){return nl(this,arguments,function*(){var _,T,E,S;try{for(var b=!0,k=Uc(v),A;A=yield en(k.next()),_=A.done,!_;b=!0){S=A.value,b=!1;const I=q_(yield en(S.json())),B=new bc;Object.assign(B,I),yield yield en(B)}}catch(C){T={error:C}}finally{try{!b&&!_&&(E=k.return)&&(yield en(E.call(k)))}finally{if(T)throw T.error}}})})}else{const f=$_(this.apiClient,e);return c=qe("{model}:streamGenerateContent?alt=sse",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),l.then(function(v){return nl(this,arguments,function*(){var _,T,E,S;try{for(var b=!0,k=Uc(v),A;A=yield en(k.next()),_=A.done,!_;b=!0){S=A.value,b=!1;const I=z_(yield en(S.json())),B=new bc;Object.assign(B,I),yield yield en(B)}}catch(C){T={error:C}}finally{try{!b&&!_&&(E=k.return)&&(yield en(E.call(k)))}finally{if(T)throw T.error}}})})}}async embedContent(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=n6(this.apiClient,e);return c=qe("{model}:predict",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=oF(g),_=new T_;return Object.assign(_,v),_})}else{const f=pI(this.apiClient,e);return c=qe("{model}:batchEmbedContents",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const v=P6(g),_=new T_;return Object.assign(_,v),_})}}async generateImagesInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=a6(this.apiClient,e);return c=qe("{model}:predict",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=cF(g),_=new E_;return Object.assign(_,v),_})}else{const f=xI(this.apiClient,e);return c=qe("{model}:predict",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const v=j6(g),_=new E_;return Object.assign(_,v),_})}}async editImageInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=f6(this.apiClient,e);return i=qe("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=uF(d),g=new uR;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=h6(this.apiClient,e);return i=qe("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=fF(d),g=new fR;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=m6(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Jm(g))}else{const f=vI(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Wm(g))}}async listInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=g6(this.apiClient,e);return c=qe("{models_url}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=pF(g),_=new S_;return Object.assign(_,v),_})}else{const f=_I(this.apiClient,e);return c=qe("{models_url}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const v=H6(g),_=new S_;return Object.assign(_,v),_})}}async update(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=v6(this.apiClient,e);return c=qe("{model}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Jm(g))}else{const f=TI(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>Wm(g))}}async delete(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=y6(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(()=>{const g=gF(),v=new b_;return Object.assign(v,g),v})}else{const f=EI(this.apiClient,e);return c=qe("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(()=>{const g=$6(),v=new b_;return Object.assign(v,g),v})}}async countTokens(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=w6(this.apiClient,e);return c=qe("{model}:countTokens",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=xF(g),_=new C_;return Object.assign(_,v),_})}else{const f=bI(this.apiClient,e);return c=qe("{model}:countTokens",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const v=G6(g),_=new C_;return Object.assign(_,v),_})}}async computeTokens(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=T6(this.apiClient,e);return i=qe("{model}:computeTokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>{const f=vF(d),g=new dR;return Object.assign(g,f),g})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=b6(this.apiClient,e);return c=qe("{model}:predictLongRunning",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>TF(g))}else{const f=kI(this.apiClient,e);return c=qe("{model}:predictLongRunning",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>W6(g))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function JF(t){const e={},n=h(t,["operationName"]);n!=null&&m(e,["_url","operationName"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function KF(t){const e={},n=h(t,["operationName"]);n!=null&&m(e,["_url","operationName"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function XF(t){const e={},n=h(t,["operationName"]);n!=null&&m(e,["operationName"],n);const r=h(t,["resourceName"]);r!=null&&m(e,["_url","resourceName"],r);const a=h(t,["config"]);return a!=null&&m(e,["config"],a),e}function ZF(t){const e={},n=h(t,["video","uri"]);n!=null&&m(e,["uri"],n);const r=h(t,["video","encodedVideo"]);r!=null&&m(e,["videoBytes"],ms(r));const a=h(t,["encoding"]);return a!=null&&m(e,["mimeType"],a),e}function QF(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],ZF(n)),e}function e8(t){const e={},n=h(t,["generatedSamples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>QF(l))),m(e,["generatedVideos"],i)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function t8(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);i!=null&&m(e,["error"],i);const l=h(t,["response","generateVideoResponse"]);return l!=null&&m(e,["response"],e8(l)),e}function n8(t){const e={},n=h(t,["gcsUri"]);n!=null&&m(e,["uri"],n);const r=h(t,["bytesBase64Encoded"]);r!=null&&m(e,["videoBytes"],ms(r));const a=h(t,["mimeType"]);return a!=null&&m(e,["mimeType"],a),e}function r8(t){const e={},n=h(t,["_self"]);return n!=null&&m(e,["video"],n8(n)),e}function a8(t){const e={},n=h(t,["videos"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(l=>r8(l))),m(e,["generatedVideos"],i)}const r=h(t,["raiMediaFilteredCount"]);r!=null&&m(e,["raiMediaFilteredCount"],r);const a=h(t,["raiMediaFilteredReasons"]);return a!=null&&m(e,["raiMediaFilteredReasons"],a),e}function Z_(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);i!=null&&m(e,["error"],i);const l=h(t,["response"]);return l!=null&&m(e,["response"],a8(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class s8 extends Yi{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const a=n.name.split("/operations/")[0];let i;return r&&"httpOptions"in r&&(i=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:a,config:{httpOptions:i}})}else return this.getVideosOperationInternal({operationName:n.name,config:r})}async getVideosOperationInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=KF(e);return c=qe("{operationName}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Z_(g))}else{const f=JF(e);return c=qe("{operationName}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>t8(g))}}async fetchPredictVideosOperationInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=XF(e);return i=qe("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>Z_(d))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function i8(t){const e={},n=h(t,["voiceName"]);return n!=null&&m(e,["voiceName"],n),e}function I2(t){const e={},n=h(t,["prebuiltVoiceConfig"]);return n!=null&&m(e,["prebuiltVoiceConfig"],i8(n)),e}function o8(t){const e={},n=h(t,["speaker"]);n!=null&&m(e,["speaker"],n);const r=h(t,["voiceConfig"]);return r!=null&&m(e,["voiceConfig"],I2(r)),e}function l8(t){const e={},n=h(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>o8(a))),m(e,["speakerVoiceConfigs"],r)}return e}function c8(t){const e={},n=h(t,["voiceConfig"]);n!=null&&m(e,["voiceConfig"],I2(n));const r=h(t,["multiSpeakerVoiceConfig"]);r!=null&&m(e,["multiSpeakerVoiceConfig"],l8(r));const a=h(t,["languageCode"]);return a!=null&&m(e,["languageCode"],a),e}function u8(t){const e={},n=h(t,["fps"]);n!=null&&m(e,["fps"],n);const r=h(t,["endOffset"]);r!=null&&m(e,["endOffset"],r);const a=h(t,["startOffset"]);return a!=null&&m(e,["startOffset"],a),e}function f8(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["data"]);n!=null&&m(e,["data"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function d8(t){const e={};if(h(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=h(t,["fileUri"]);n!=null&&m(e,["fileUri"],n);const r=h(t,["mimeType"]);return r!=null&&m(e,["mimeType"],r),e}function h8(t){const e={},n=h(t,["videoMetadata"]);n!=null&&m(e,["videoMetadata"],u8(n));const r=h(t,["thought"]);r!=null&&m(e,["thought"],r);const a=h(t,["inlineData"]);a!=null&&m(e,["inlineData"],f8(a));const i=h(t,["fileData"]);i!=null&&m(e,["fileData"],d8(i));const l=h(t,["thoughtSignature"]);l!=null&&m(e,["thoughtSignature"],l);const c=h(t,["codeExecutionResult"]);c!=null&&m(e,["codeExecutionResult"],c);const d=h(t,["executableCode"]);d!=null&&m(e,["executableCode"],d);const f=h(t,["functionCall"]);f!=null&&m(e,["functionCall"],f);const g=h(t,["functionResponse"]);g!=null&&m(e,["functionResponse"],g);const v=h(t,["text"]);return v!=null&&m(e,["text"],v),e}function m8(t){const e={},n=h(t,["parts"]);if(n!=null){let a=n;Array.isArray(a)&&(a=a.map(i=>h8(i))),m(e,["parts"],a)}const r=h(t,["role"]);return r!=null&&m(e,["role"],r),e}function p8(t){const e={},n=h(t,["behavior"]);n!=null&&m(e,["behavior"],n);const r=h(t,["description"]);r!=null&&m(e,["description"],r);const a=h(t,["name"]);a!=null&&m(e,["name"],a);const i=h(t,["parameters"]);i!=null&&m(e,["parameters"],i);const l=h(t,["parametersJsonSchema"]);l!=null&&m(e,["parametersJsonSchema"],l);const c=h(t,["response"]);c!=null&&m(e,["response"],c);const d=h(t,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function g8(t){const e={},n=h(t,["startTime"]);n!=null&&m(e,["startTime"],n);const r=h(t,["endTime"]);return r!=null&&m(e,["endTime"],r),e}function x8(t){const e={},n=h(t,["timeRangeFilter"]);return n!=null&&m(e,["timeRangeFilter"],g8(n)),e}function v8(t){const e={},n=h(t,["mode"]);n!=null&&m(e,["mode"],n);const r=h(t,["dynamicThreshold"]);return r!=null&&m(e,["dynamicThreshold"],r),e}function y8(t){const e={},n=h(t,["dynamicRetrievalConfig"]);return n!=null&&m(e,["dynamicRetrievalConfig"],v8(n)),e}function _8(){return{}}function w8(t){const e={},n=h(t,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(f=>p8(f))),m(e,["functionDeclarations"],d)}if(h(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=h(t,["googleSearch"]);r!=null&&m(e,["googleSearch"],x8(r));const a=h(t,["googleSearchRetrieval"]);if(a!=null&&m(e,["googleSearchRetrieval"],y8(a)),h(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(h(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");h(t,["urlContext"])!=null&&m(e,["urlContext"],_8());const l=h(t,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const c=h(t,["computerUse"]);return c!=null&&m(e,["computerUse"],c),e}function T8(t){const e={},n=h(t,["handle"]);if(n!=null&&m(e,["handle"],n),h(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Q_(){return{}}function E8(t){const e={},n=h(t,["disabled"]);n!=null&&m(e,["disabled"],n);const r=h(t,["startOfSpeechSensitivity"]);r!=null&&m(e,["startOfSpeechSensitivity"],r);const a=h(t,["endOfSpeechSensitivity"]);a!=null&&m(e,["endOfSpeechSensitivity"],a);const i=h(t,["prefixPaddingMs"]);i!=null&&m(e,["prefixPaddingMs"],i);const l=h(t,["silenceDurationMs"]);return l!=null&&m(e,["silenceDurationMs"],l),e}function S8(t){const e={},n=h(t,["automaticActivityDetection"]);n!=null&&m(e,["automaticActivityDetection"],E8(n));const r=h(t,["activityHandling"]);r!=null&&m(e,["activityHandling"],r);const a=h(t,["turnCoverage"]);return a!=null&&m(e,["turnCoverage"],a),e}function b8(t){const e={},n=h(t,["targetTokens"]);return n!=null&&m(e,["targetTokens"],n),e}function C8(t){const e={},n=h(t,["triggerTokens"]);n!=null&&m(e,["triggerTokens"],n);const r=h(t,["slidingWindow"]);return r!=null&&m(e,["slidingWindow"],b8(r)),e}function A8(t){const e={},n=h(t,["proactiveAudio"]);return n!=null&&m(e,["proactiveAudio"],n),e}function k8(t,e){const n={},r=h(t,["generationConfig"]);e!==void 0&&r!=null&&m(e,["setup","generationConfig"],r);const a=h(t,["responseModalities"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","responseModalities"],a);const i=h(t,["temperature"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig","temperature"],i);const l=h(t,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const c=h(t,["topK"]);e!==void 0&&c!=null&&m(e,["setup","generationConfig","topK"],c);const d=h(t,["maxOutputTokens"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","maxOutputTokens"],d);const f=h(t,["mediaResolution"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","mediaResolution"],f);const g=h(t,["seed"]);e!==void 0&&g!=null&&m(e,["setup","generationConfig","seed"],g);const v=h(t,["speechConfig"]);e!==void 0&&v!=null&&m(e,["setup","generationConfig","speechConfig"],c8(Sp(v)));const _=h(t,["enableAffectiveDialog"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],_);const T=h(t,["systemInstruction"]);e!==void 0&&T!=null&&m(e,["setup","systemInstruction"],m8(ir(T)));const E=h(t,["tools"]);if(e!==void 0&&E!=null){let B=yl(E);Array.isArray(B)&&(B=B.map(j=>w8(vl(j)))),m(e,["setup","tools"],B)}const S=h(t,["sessionResumption"]);e!==void 0&&S!=null&&m(e,["setup","sessionResumption"],T8(S));const b=h(t,["inputAudioTranscription"]);e!==void 0&&b!=null&&m(e,["setup","inputAudioTranscription"],Q_());const k=h(t,["outputAudioTranscription"]);e!==void 0&&k!=null&&m(e,["setup","outputAudioTranscription"],Q_());const A=h(t,["realtimeInputConfig"]);e!==void 0&&A!=null&&m(e,["setup","realtimeInputConfig"],S8(A));const C=h(t,["contextWindowCompression"]);e!==void 0&&C!=null&&m(e,["setup","contextWindowCompression"],C8(C));const I=h(t,["proactivity"]);return e!==void 0&&I!=null&&m(e,["setup","proactivity"],A8(I)),n}function N8(t,e){const n={},r=h(e,["model"]);r!=null&&m(n,["setup","model"],$t(t,r));const a=h(e,["config"]);return a!=null&&m(n,["config"],k8(a,n)),n}function R8(t,e,n){const r={},a=h(e,["expireTime"]);n!==void 0&&a!=null&&m(n,["expireTime"],a);const i=h(e,["newSessionExpireTime"]);n!==void 0&&i!=null&&m(n,["newSessionExpireTime"],i);const l=h(e,["uses"]);n!==void 0&&l!=null&&m(n,["uses"],l);const c=h(e,["liveConnectConstraints"]);n!==void 0&&c!=null&&m(n,["bidiGenerateContentSetup"],N8(t,c));const d=h(e,["lockAdditionalFields"]);return n!==void 0&&d!=null&&m(n,["fieldMask"],d),r}function D8(t,e){const n={},r=h(e,["config"]);return r!=null&&m(n,["config"],R8(t,r,n)),n}function M8(t){const e={},n=h(t,["name"]);return n!=null&&m(e,["name"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function I8(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const a=Object.keys(r).map(i=>`${n}.${i}`);e.push(...a)}else e.push(n)}return e.join(",")}function F8(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const i=r.setup;typeof i=="object"&&i!==null?(t.bidiGenerateContentSetup=i,n=i):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const a=t.fieldMask;if(n){const i=I8(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)i?t.fieldMask=i:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&a!==null&&Array.isArray(a)&&a.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];a.length>0&&(c=a.map(f=>l.includes(f)?`generationConfig.${f}`:f));const d=[];i&&d.push(i),c.length>0&&d.push(...c),d.length>0?t.fieldMask=d.join(","):delete t.fieldMask}else delete t.fieldMask}else a!==null&&Array.isArray(a)&&a.length>0?t.fieldMask=a.join(","):delete t.fieldMask;return t}class L8 extends Yi{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=D8(this.apiClient,e);i=qe("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const d=F8(c,e.config);return a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>M8(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function O8(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","name"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function P8(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const i=h(t,["filter"]);return e!==void 0&&i!=null&&m(e,["_query","filter"],i),n}function U8(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],P8(n,e)),e}function B8(t){const e={},n=h(t,["textInput"]);n!=null&&m(e,["textInput"],n);const r=h(t,["output"]);return r!=null&&m(e,["output"],r),e}function j8(t){const e={};if(h(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=h(t,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>B8(a))),m(e,["examples","examples"],r)}return e}function V8(t,e){const n={};if(h(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=h(t,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&m(e,["displayName"],r),h(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=h(t,["epochCount"]);e!==void 0&&a!=null&&m(e,["tuningTask","hyperparameters","epochCount"],a);const i=h(t,["learningRateMultiplier"]);if(i!=null&&m(n,["tuningTask","hyperparameters","learningRateMultiplier"],i),h(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(h(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=h(t,["batchSize"]);e!==void 0&&l!=null&&m(e,["tuningTask","hyperparameters","batchSize"],l);const c=h(t,["learningRate"]);return e!==void 0&&c!=null&&m(e,["tuningTask","hyperparameters","learningRate"],c),n}function H8(t){const e={},n=h(t,["baseModel"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["trainingDataset"]);r!=null&&m(e,["tuningTask","trainingData"],j8(r));const a=h(t,["config"]);return a!=null&&m(e,["config"],V8(a,e)),e}function $8(t){const e={},n=h(t,["name"]);n!=null&&m(e,["_url","name"],n);const r=h(t,["config"]);return r!=null&&m(e,["config"],r),e}function G8(t,e){const n={},r=h(t,["pageSize"]);e!==void 0&&r!=null&&m(e,["_query","pageSize"],r);const a=h(t,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const i=h(t,["filter"]);return e!==void 0&&i!=null&&m(e,["_query","filter"],i),n}function z8(t){const e={},n=h(t,["config"]);return n!=null&&m(e,["config"],G8(n,e)),e}function q8(t,e){const n={},r=h(t,["gcsUri"]);e!==void 0&&r!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],r);const a=h(t,["vertexDatasetResource"]);if(e!==void 0&&a!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],a),h(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function Y8(t,e){const n={},r=h(t,["gcsUri"]);r!=null&&m(n,["validationDatasetUri"],r);const a=h(t,["vertexDatasetResource"]);return e!==void 0&&a!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],a),n}function W8(t,e){const n={},r=h(t,["validationDataset"]);e!==void 0&&r!=null&&m(e,["supervisedTuningSpec"],Y8(r,n));const a=h(t,["tunedModelDisplayName"]);e!==void 0&&a!=null&&m(e,["tunedModelDisplayName"],a);const i=h(t,["description"]);e!==void 0&&i!=null&&m(e,["description"],i);const l=h(t,["epochCount"]);e!==void 0&&l!=null&&m(e,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=h(t,["learningRateMultiplier"]);e!==void 0&&c!=null&&m(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const d=h(t,["exportLastCheckpointOnly"]);e!==void 0&&d!=null&&m(e,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const f=h(t,["adapterSize"]);if(e!==void 0&&f!=null&&m(e,["supervisedTuningSpec","hyperParameters","adapterSize"],f),h(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(h(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function J8(t){const e={},n=h(t,["baseModel"]);n!=null&&m(e,["baseModel"],n);const r=h(t,["trainingDataset"]);r!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],q8(r,e));const a=h(t,["config"]);return a!=null&&m(e,["config"],W8(a,e)),e}function K8(t){const e={},n=h(t,["name"]);n!=null&&m(e,["model"],n);const r=h(t,["name"]);return r!=null&&m(e,["endpoint"],r),e}function F2(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["state"]);r!=null&&m(e,["state"],f2(r));const a=h(t,["createTime"]);a!=null&&m(e,["createTime"],a);const i=h(t,["tuningTask","startTime"]);i!=null&&m(e,["startTime"],i);const l=h(t,["tuningTask","completeTime"]);l!=null&&m(e,["endTime"],l);const c=h(t,["updateTime"]);c!=null&&m(e,["updateTime"],c);const d=h(t,["description"]);d!=null&&m(e,["description"],d);const f=h(t,["baseModel"]);f!=null&&m(e,["baseModel"],f);const g=h(t,["_self"]);g!=null&&m(e,["tunedModel"],K8(g));const v=h(t,["distillationSpec"]);v!=null&&m(e,["distillationSpec"],v);const _=h(t,["experiment"]);_!=null&&m(e,["experiment"],_);const T=h(t,["labels"]);T!=null&&m(e,["labels"],T);const E=h(t,["pipelineJob"]);E!=null&&m(e,["pipelineJob"],E);const S=h(t,["satisfiesPzi"]);S!=null&&m(e,["satisfiesPzi"],S);const b=h(t,["satisfiesPzs"]);b!=null&&m(e,["satisfiesPzs"],b);const k=h(t,["serviceAccount"]);k!=null&&m(e,["serviceAccount"],k);const A=h(t,["tunedModelDisplayName"]);return A!=null&&m(e,["tunedModelDisplayName"],A),e}function X8(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["tunedModels"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>F2(i))),m(e,["tuningJobs"],a)}return e}function Z8(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["metadata"]);r!=null&&m(e,["metadata"],r);const a=h(t,["done"]);a!=null&&m(e,["done"],a);const i=h(t,["error"]);return i!=null&&m(e,["error"],i),e}function Q8(t){const e={},n=h(t,["checkpointId"]);n!=null&&m(e,["checkpointId"],n);const r=h(t,["epoch"]);r!=null&&m(e,["epoch"],r);const a=h(t,["step"]);a!=null&&m(e,["step"],a);const i=h(t,["endpoint"]);return i!=null&&m(e,["endpoint"],i),e}function eL(t){const e={},n=h(t,["model"]);n!=null&&m(e,["model"],n);const r=h(t,["endpoint"]);r!=null&&m(e,["endpoint"],r);const a=h(t,["checkpoints"]);if(a!=null){let i=a;Array.isArray(i)&&(i=i.map(l=>Q8(l))),m(e,["checkpoints"],i)}return e}function Xm(t){const e={},n=h(t,["name"]);n!=null&&m(e,["name"],n);const r=h(t,["state"]);r!=null&&m(e,["state"],f2(r));const a=h(t,["createTime"]);a!=null&&m(e,["createTime"],a);const i=h(t,["startTime"]);i!=null&&m(e,["startTime"],i);const l=h(t,["endTime"]);l!=null&&m(e,["endTime"],l);const c=h(t,["updateTime"]);c!=null&&m(e,["updateTime"],c);const d=h(t,["error"]);d!=null&&m(e,["error"],d);const f=h(t,["description"]);f!=null&&m(e,["description"],f);const g=h(t,["baseModel"]);g!=null&&m(e,["baseModel"],g);const v=h(t,["tunedModel"]);v!=null&&m(e,["tunedModel"],eL(v));const _=h(t,["supervisedTuningSpec"]);_!=null&&m(e,["supervisedTuningSpec"],_);const T=h(t,["tuningDataStats"]);T!=null&&m(e,["tuningDataStats"],T);const E=h(t,["encryptionSpec"]);E!=null&&m(e,["encryptionSpec"],E);const S=h(t,["partnerModelTuningSpec"]);S!=null&&m(e,["partnerModelTuningSpec"],S);const b=h(t,["distillationSpec"]);b!=null&&m(e,["distillationSpec"],b);const k=h(t,["experiment"]);k!=null&&m(e,["experiment"],k);const A=h(t,["labels"]);A!=null&&m(e,["labels"],A);const C=h(t,["pipelineJob"]);C!=null&&m(e,["pipelineJob"],C);const I=h(t,["satisfiesPzi"]);I!=null&&m(e,["satisfiesPzi"],I);const B=h(t,["satisfiesPzs"]);B!=null&&m(e,["satisfiesPzs"],B);const j=h(t,["serviceAccount"]);j!=null&&m(e,["serviceAccount"],j);const F=h(t,["tunedModelDisplayName"]);return F!=null&&m(e,["tunedModelDisplayName"],F),e}function tL(t){const e={},n=h(t,["nextPageToken"]);n!=null&&m(e,["nextPageToken"],n);const r=h(t,["tuningJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(i=>Xm(i))),m(e,["tuningJobs"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nL extends Yi{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new pu(Ui.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const r=await this.tuneMldevInternal(n);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:Vm.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=$8(e);return c=qe("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>Xm(g))}else{const f=O8(e);return c=qe("{name}",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>F2(g))}}async listInternal(e){var n,r,a,i;let l,c="",d={};if(this.apiClient.isVertexAI()){const f=z8(e);return c=qe("tuningJobs",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),l.then(g=>{const v=tL(g),_=new A_;return Object.assign(_,v),_})}else{const f=U8(e);return c=qe("tunedModels",f._url),d=f._query,delete f.config,delete f._url,delete f._query,l=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(a=e.config)===null||a===void 0?void 0:a.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),l.then(g=>{const v=X8(g),_=new A_;return Object.assign(_,v),_})}}async tuneInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI()){const c=J8(e);return i=qe("tuningJobs",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>Xm(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let a,i="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=H8(e);return i=qe("tunedModels",c._url),l=c._query,delete c.config,delete c._url,delete c._query,a=this.apiClient.request({path:i,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),a.then(d=>Z8(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rL{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const aL=1024*1024*8,sL=3,iL=1e3,oL=2,im="x-goog-upload-status";async function lL(t,e,n){var r,a,i;let l=0,c=0,d=new Hm(new Response),f="upload";for(l=t.size;c<l;){const v=Math.min(aL,l-c),_=t.slice(c,c+v);c+v>=l&&(f+=", finalize");let T=0,E=iL;for(;T<sL&&(d=await n.request({path:"",body:_,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":String(c),"Content-Length":String(v)}}}),!(!((r=d==null?void 0:d.headers)===null||r===void 0)&&r[im]));)T++,await uL(E),E=E*oL;if(c+=v,((a=d==null?void 0:d.headers)===null||a===void 0?void 0:a[im])!=="active")break;if(l<=c)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const g=await(d==null?void 0:d.json());if(((i=d==null?void 0:d.headers)===null||i===void 0?void 0:i[im])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return g.file}async function cL(t){return{size:t.size,type:t.type}}function uL(t){return new Promise(e=>setTimeout(e,t))}class fL{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await lL(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await cL(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dL{create(e,n,r){return new hL(e,n,r)}}class hL{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ew="x-goog-api-key";class mL{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(ew)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(ew,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const pL="gl-node/";class gL{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=cR(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const a=new mL(this.apiKey);this.apiClient=new RF({auth:a,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:pL+"web",uploader:new fL,downloader:new rL}),this.models=new WF(this.apiClient),this.live=new $F(this.apiClient,a,new dL),this.batches=new P3(this.apiClient),this.chats=new V5(this.models,this.apiClient),this.caches=new U5(this.apiClient),this.files=new eD(this.apiClient),this.operations=new s8(this.apiClient),this.authTokens=new L8(this.apiClient),this.tunings=new nL(this.apiClient)}}const va="gemini-2.5-flash-preview-04-17";let Zt=null;const om=t=>{if(!t){Zt=null;return}try{Zt=new gL({apiKey:t})}catch(e){console.error("Failed to initialize Gemini AI:",e),Zt=null}},Wi=t=>{const e=n=>{const{position:r,extendedDetails:a,...i}=n,l={...i};if(a){const{reportDeck:c,attachments:d,subSteps:f,decisions:g,...v}=a,_={...v};c&&c.slides.length>0&&(_.reportDeckExists=!0,_.reportDeckSlideCount=c.slides.length),d&&d.length>0&&(_.attachments=d.map(T=>({id:T.id,name:T.name,type:T.type}))),f&&f.length>0&&(_.subSteps=f.map(T=>{const{position:E,attachments:S,actionItems:b,...k}=T,A={...k};return S&&S.length>0&&(A.attachments=S.map(C=>({id:C.id,name:C.name,type:C.type}))),b&&b.length>0&&(A.actionItems=b.map(C=>{const{report:I,...B}=C,j={...B};if(I){const{attachments:F,...X}=I,P={...X};F&&F.length>0&&(P.attachments=F.map(re=>({id:re.id,name:re.name,type:re.type}))),j.report=P}return j})),A})),l.extendedDetails=_}return l};return Array.isArray(t)?t.map(e):e(t)},Ld=t=>({...t,slides:t.slides.map(e=>{if(e.isLocked)return{id:e.id,isLocked:!0,summary:`Locked Slide: Contains ${e.elements.length} elements. Content is preserved and must not be changed.`,elements:[]};const{elements:n,...r}=e;return{...r,elements:n.map(a=>{var i;if(a.type==="flowchart"&&((i=a.data)!=null&&i.subSteps)){const l=a;return{...l,data:{subStepCount:l.data.subSteps.length,subSteps:`[Sub-step data omitted for brevity, count: ${l.data.subSteps.length}]`}}}return a})}})}),xL=t=>{const e=/"dependencies"\s*:\s*\[([\s\S]*?)\]/g;return t.replace(e,(n,r)=>{const a=r.match(/"[^"]*"/g);return`"dependencies": [${a?a.join(", "):""}]`})},Ua=t=>{let e=t.trim();const n=/^```(?:json)?\s*\n?(.*?)\n?\s*```$/s,r=e.match(n);if(r&&r[1]&&(e=r[1].trim()),e=xL(e),e=e.replace(/"((?:\\.|[^"\\])*)"/g,(a,i)=>`"${i.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")}"`),!r){const a=e.indexOf("{"),i=e.indexOf("[");if(a===-1&&i===-1)throw console.error("No JSON object or array found in the response string.",t),new Error(`AI response did not contain a valid JSON structure. Raw response: ${t.substring(0,500)}...`);const l=a===-1?i:i===-1?a:Math.min(a,i),c=e.lastIndexOf("}"),d=e.lastIndexOf("]"),f=Math.max(c,d);l>-1&&f>l&&(e=e.substring(l,f+1))}try{return JSON.parse(e)}catch(a){throw console.error("Failed to parse JSON response:",a,`
Original text:`,t,`
Processed string:`,e),new Error(`Failed to parse AI response as JSON. Raw response: ${t.substring(0,500)}...`)}},ya=(t,e)=>{console.error(`Error in Gemini API call during ${e}:`,t);let n=`AIとの通信中に不明なエラーが発生しました (${e})。`;if(t instanceof Error){const r=t.message.toLowerCase();r.includes("api key not valid")||r.includes("api key is invalid")?n="APIキーが無効です。キーを確認して再度設定してください。(API key not valid. Please pass a valid API key.)":r.includes("quota")?n="API利用上限に達しました。Google AI Platformのプランと請求情報を確認してください。(You have exceeded your API quota.)":n=`AIとの通信に失敗しました (${e}): ${t.message}`}throw new Error(n)},vL=async(t,e)=>{if(!Zt)throw new Error("AI Service not initialized. Please set an API Key.");const n=`
    You are an expert project planner. Your task is to break down a high-level project goal into a sequence of actionable tasks.
    CONTEXT:
    - Project Goal: "${t}"
    - Target Completion Date: "${e}"
    INSTRUCTIONS:
    1.  Generate a sequence of 3 to 7 high-level, actionable tasks.
    2.  Provide a concise title (max 10 words) and a brief description (1-2 sentences) for each.
    3.  Your response MUST be a single, valid JSON array of objects. Do NOT include any explanations or markdown fences.
    4.  The language of the output should match the language of the input goal.
    5.  Each object MUST have this structure: { "id": "unique_string_id", "title": "Task Title", "description": "Task Description" }
  `;try{const r=await Zt.models.generateContent({model:va,contents:n,config:{responseMimeType:"application/json"}}),a=Ua(r.text);if(!a||!Array.isArray(a)||a.some(i=>!i.id||!i.title||!i.description))throw new Error("AI returned an unexpected format for project tasks.");return a}catch(r){ya(r,"project plan generation")}},yL=async t=>{var n;if(!Zt)throw new Error("AI Service not initialized. Please set an API Key.");const e=`
    You are a project management expert. Analyze the given task and propose a list of concrete next steps to accomplish it.
    CONTEXT:
    - Task Title: "${t.title}"
    - Task Description: "${t.description}"
    - Required Resources: "${((n=t.extendedDetails)==null?void 0:n.resources)||"Not specified"}"
    INSTRUCTIONS:
    1.  Generate a list of 3 to 6 actionable proposals (sub-steps).
    2.  Each proposal must have a concise 'title' and a 'description'.
    3.  Focus on breaking down the main task into logical phases or components.
    4.  Your response MUST be a single, valid JSON array of objects. Do not include any explanations.
    5.  The language must match the input task language.
    6.  The JSON structure for each item must be: { "title": "...", "description": "..." }
  `;try{const r=await Zt.models.generateContent({model:va,contents:e,config:{responseMimeType:"application/json"}}),a=Ua(r.text);if(!a||!Array.isArray(a)||a.some(i=>!i.title||!i.description))throw new Error("AI returned an unexpected format for step proposals.");if(a.length===0)throw new Error("AI did not generate any proposals. The task might be too abstract.");return a}catch(r){ya(r,"step proposal generation")}},_L=async(t,e)=>{if(!Zt)throw new Error("AI Service not initialized. Please set an API Key.");const n=`
        You are a senior project analyst AI. Your task is to intelligently update a list of critical project decisions based on the latest task data. You will merge new findings with an existing list.

        CONTEXT:
        - Full Task Data (JSON, pruned for brevity): ${JSON.stringify(Wi(t))}
        - Existing Decisions List: ${JSON.stringify(e)}
        - Today's Date: ${new Date().toISOString().split("T")[0]}

        INSTRUCTIONS:
        1.  **Analyze Task Data**: Holistically review the 'Full Task Data' to understand the current state, including sub-steps, action items, and notes.
        2.  **Review Existing Decisions**: Go through each item in the 'Existing Decisions List'.
        3.  **Merge and Update**:
            *   **For each existing decision**: Check if the latest task data provides new information.
                *   If an 'undecided' item now has a clear answer in the task data, update its 'status' to 'decided', fill in the 'decision' and 'reasoning', and set the 'date'.
                *   You may also refine the 'question' or 'reasoning' of existing items if the new data provides more clarity.
                *   Keep the original 'id' for all existing items.
            *   **Identify New Decisions**: Look for any *new* critical questions or decision points in the task data that are NOT present in the existing list.
            *   For each new decision you find, create a new decision object.
        4.  **Construct Final List**: Your output MUST be a single JSON array containing the complete, merged list of decisions. This list must include:
            *   All the original decisions, updated as necessary.
            *   All the newly identified decisions.
        5.  **JSON Structure**: Every object in the output array MUST strictly follow this structure. For new items, you MUST set the 'id' field to 'NEW'. For existing items, you MUST preserve their original 'id'.
            {
              "id": "string (original ID or 'NEW' for new items)",
              "question": "The question that needs a decision.",
              "decision": "The final outcome (string, or empty string for 'undecided').",
              "reasoning": "Justification for the decision, or explanation of importance for 'undecided'.",
              "date": "YYYY-MM-DD (string, or empty string for 'undecided').",
              "status": "'decided' or 'undecided'."
            }
        6.  **Language and Format**: The output language must match the input task language. The response must be only the JSON array, without any markdown or explanations.
    `;try{const r=await Zt.models.generateContent({model:va,contents:n,config:{responseMimeType:"application/json"}}),a=Ua(r.text);if(!a||!Array.isArray(a)||a.some(i=>!i.question||!i.status||!i.id))throw new Error("AI returned an unexpected format for decisions. Expected fields: id, question, status.");return a}catch(r){ya(r,"decision generation")}},wL=async(t,e,n)=>{if(!Zt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a presentation designer and project analyst. Your task is to update a project status report slide deck based on new data, while preserving slides that have been manually locked by the user.
      CONTEXT:
      - Overall Project Goal: "${n}"
      - Updated Full Task Data (JSON, pruned for brevity): ${JSON.stringify(Wi(e))}
      - Existing Slide Deck (pruned for brevity): ${JSON.stringify(Ld(t))}

      INSTRUCTIONS:
      1.  Analyze 'existingDeck'. Slides with '"isLocked": true' have been summarized and their 'elements' are empty. You MUST NOT change these slides. Return them exactly as they are in the input (id, isLocked, summary, empty elements array).
      2.  For all other slides (unlocked), REGENERATE their content from scratch based on the 'updatedTaskData'.
      3.  This includes regenerating 'flowchart' slides to reflect the latest sub-step data.
      4.  **ACTION ITEM FOCUS**: When regenerating, pay close attention to the progress and reports within each sub-step's 'actionItems'.
      5.  The final output MUST be a single, valid JSON object representing the complete slide deck, with all slides (locked and regenerated) in their original order.
      6.  Follow the same JSON structure and rules as the initial generation.
    `;try{const a=await Zt.models.generateContent({model:va,contents:r,config:{responseMimeType:"application/json"}}),i=Ua(a.text);if(!i||!Array.isArray(i.slides))throw new Error("AI returned an invalid format for the regenerated slide deck.");return i}catch(a){ya(a,"slide deck regeneration")}},TL=async t=>{if(!Zt)throw new Error("AI Service not initialized. Please set an API Key.");const e=`
        You are an expert presentation designer. The following JSON represents a slide deck.
        Analyze its content and structure. Your task is to improve the layout, wording, and visual hierarchy for maximum clarity and impact.
        You can rephrase text for conciseness, change element positions and sizes, and adjust font properties. Do not change element types or IDs.
        Return the updated slide deck as a valid JSON object with the exact same structure as the input. Do not use markdown.
        CRITICAL: Textbox elements use a "content" field, NOT a "text" field.
        
        Input Deck (pruned for brevity):
        ${JSON.stringify(Ld(t))}
    `;try{const n=await Zt.models.generateContent({model:va,contents:e,config:{responseMimeType:"application/json"}}),r=Ua(n.text);if(!r||!Array.isArray(r.slides))throw new Error("AI returned an invalid format for the optimized slide deck.");return r}catch(n){ya(n,"slide layout optimization")}},EL=async(t,e,n)=>{if(!Zt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a senior project manager AI. Your task is to conduct a holistic health check of the entire project.
      CONTEXT:
      - Overall Project Goal: "${e}"
      - Final Target Date: "${n}"
      - Current Date: "${new Date().toISOString().split("T")[0]}"
      - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Wi(t),null,2)}

      INSTRUCTIONS:
      1.  **Holistic Analysis**: Review ALL provided data. Compare task/sub-step due dates with the current date. Analyze dependencies, blockers, and the completion rate of action items.
      2.  **Determine Overall Status**: Categorize the project's health as 'On Track', 'At Risk', or 'Off Track'.
      3.  **Identify Positives**: List 2-3 key accomplishments or areas that are progressing well.
      4.  **Identify Concerns**: List the most critical risks or issues. For each, explain WHY it's a concern (e.g., "Task 'X' is 2 weeks overdue and blocking 3 other tasks"). Note the related task IDs.
      5.  **Propose Solutions**: For each major concern, provide concrete, actionable suggestions for improvement. (e.g., "Re-allocate resources from Task Y to Task X", "Hold a risk mitigation meeting for Z").
      6.  **Summarize**: Write a concise, executive-level summary of the project's current state.
      7.  **JSON Output**: Your response MUST be a single, valid JSON object following the ProjectHealthReport structure. Do not include markdown or explanations.
      8.  **The output language MUST be Japanese.**

      JSON Structure to follow:
      {
        "overallStatus": "'On Track' | 'At Risk' | 'Off Track'",
        "summary": "string",
        "positivePoints": ["string"],
        "areasOfConcern": [{ "description": "string", "relatedTaskIds": ["string"] }],
        "suggestions": ["string"]
      }
    `;try{const a=await Zt.models.generateContent({model:va,contents:r,config:{responseMimeType:"application/json"}}),i=Ua(a.text);if(!i||!i.overallStatus||!i.summary)throw new Error("AI returned an invalid format for the project health report.");return i}catch(a){ya(a,"project health report generation")}},SL=async(t,e,n)=>{if(!Zt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
        You are a senior project analyst AI. Your task is to create a comprehensive slide deck summarizing the ENTIRE project status.
        CONTEXT:
        - Overall Project Goal: "${e}"
        - Final Target Date: "${n}"
        - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Wi(t),null,2)}
        INSTRUCTIONS:
        1.  Synthesize a comprehensive slide deck (6-10 slides) summarizing the entire project.
        2.  The response MUST be a single, valid JSON object following the SlideDeck structure. Do NOT use markdown.
        3.  The output language MUST be Japanese.
        4.  **CRITICAL SYNTHESIS**:
            - **Title & Overview**: Create a title slide and a project overview slide.
            - **Task Summary & Flowchart**: For each major task in the 'tasks' array, create one or two summary slides. One slide should show a \`flowchart\` of its sub-steps if they exist, following the structure \`{"type": "flowchart", "data": {"subSteps": [...]}}\`. You MUST copy the task's specific \`subSteps\` array from the input JSON into the \`data.subSteps\` field. Another slide can summarize the task's status and outcomes.
            - **Key Project Decisions**: Analyze the 'decisions' data from all tasks. Create a dedicated slide titled "主要なプロジェクト決定事項". List the top 3-5 most important 'decided' items and their outcomes. Separately, list any critical 'undecided' questions that pose a risk to the project timeline or goals.
            - **Key Achievements & Risks**: Create dedicated slides for significant achievements and project-level risks.
            - **Conclusion**: A final slide summarizing the project's outlook and next steps.
        5.  Use the standard JSON format for slides and elements. Remember "content" for textboxes.
    `;try{const a=await Zt.models.generateContent({model:va,contents:r,config:{responseMimeType:"application/json"}}),i=Ua(a.text);if(!i||!Array.isArray(i.slides))throw new Error("AI returned an invalid format for the project slide deck.");return i}catch(a){ya(a,"project report deck generation")}},bL=async(t,e,n,r)=>{if(!Zt)throw new Error("AI Service not initialized. Please set an API Key.");const a=`
      You are a senior project analyst AI. Your task is to update a project-wide status report slide deck based on new data, while preserving slides that have been manually locked by the user.
      CONTEXT:
      - Overall Project Goal: "${n}"
      - Final Target Date: "${r}"
      - Updated Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Wi(e),null,2)}
      - Existing Slide Deck (pruned for brevity): ${JSON.stringify(Ld(t))}

      INSTRUCTIONS:
      1.  Analyze 'existingDeck'. Slides with '"isLocked": true' have been summarized and their 'elements' are empty. You MUST NOT change these slides. Return them exactly as they are in the input (id, isLocked, summary, empty elements array).
      2.  For all other slides (unlocked slides), REGENERATE their content from scratch based on the updated project data.
      3.  This includes regenerating any 'flowchart' elements on unlocked slides to show the latest sub-step data.
      4.  Synthesize information across all tasks to provide a holistic project view in the regenerated slides.
      5.  The final output MUST be a single, valid JSON object for the complete slide deck, in the original slide order.
      6.  The output language MUST be Japanese.
    `;try{const i=await Zt.models.generateContent({model:va,contents:a,config:{responseMimeType:"application/json"}}),l=Ua(i.text);if(!l||!Array.isArray(l.slides))throw new Error("AI returned an invalid format for the regenerated project slide deck.");return l}catch(i){ya(i,"project report deck regeneration")}},CL=t=>{const e=t.match(/^data:(.+);base64,(.*)$/);return e?{mimeType:e[1],data:e[2]}:null},L2=t=>{if(!Zt)throw new Error("AI Service not initialized. Please set an API Key.");const e=[];for(const n of t){if(e.push({text:`
--- START OF SOURCE: ${n.name} ---
`}),n.type==="image"&&typeof n.content=="string"){const r=CL(n.content);r?e.push({inlineData:{mimeType:r.mimeType,data:r.data}}):e.push({text:"[Image data was invalid or in wrong format]"})}else if(n.type==="json"){const r=n.content.slides?Ld(n.content):Wi(n.content);e.push({text:`Type: JSON Data
Content: ${JSON.stringify(r,null,2)}`})}else e.push({text:`Type: Text
Content: ${n.content}`});e.push({text:`
--- END OF SOURCE: ${n.name} ---
`})}return e},O2=async(t,e)=>{if(!Zt)throw new Error("AI Service not initialized. Please set an API Key.");const r=[{text:`
        You are a professional presentation designer AI. Your task is to create a slide deck based on a user's objective and provided source materials.

        **USER OBJECTIVE**: "${e}"

        **CRITICAL INSTRUCTIONS**:
        1.  **Strict JSON Output**: Your entire response MUST be a single, valid JSON object. Do NOT include any text, explanations, or markdown fences (like \`\`\`json\`) outside of the JSON object. Your response should start with \`{\` and end with \`}\`.
        2.  **Schema Adherence**: The JSON object MUST strictly conform to the following TypeScript interfaces for \`SlideDeck\`, \`Slide\`, and \`SlideElement\`.
            \`\`\`typescript
            // The main container for the presentation
            interface SlideDeck {
              slides: Slide[];
              theme?: 'light' | 'dark' | 'business';
            }

            // Represents a single slide in the deck
            interface Slide {
              id: string; // A unique identifier for the slide
              layout: 'title_slide' | 'title_and_content' | 'section_header' | 'two_column' | 'blank';
              elements: SlideElement[];
              isLocked?: boolean; // Must be false for all generated slides
              notes?: string; // Optional speaker notes
            }

            // Union type for all possible elements on a slide
            type SlideElement = TextboxElement | ImageElement | TableElement | ChartElement | FlowchartElement;

            // Base interface for all elements
            interface BaseSlideElement {
              id: string; // A unique identifier for the element
              type: 'textbox' | 'image' | 'table' | 'chart' | 'flowchart';
              position: { x: number; y: number; width: number; height: number; }; // Position in percentages
            }

            // For displaying text
            interface TextboxElement extends BaseSlideElement {
              type: 'textbox';
              content: string; // IMPORTANT: The text content field MUST be named "content".
            }
            
            // For displaying an image from the source materials
            interface ImageElement extends BaseSlideElement {
              type: 'image';
              // You MUST find a relevant image from the source materials and reference its properties here.
              // These IDs must correspond to actual data in the sources provided.
              subStepId: string;
              actionItemId: string; 
              attachmentId: string;
            }

            // For displaying a flowchart of sub-steps
            interface FlowchartElement extends BaseSlideElement {
                type: 'flowchart';
                // You MUST copy the entire 'subSteps' array from the source task data into this field.
                data: {
                    subSteps: any[]; 
                };
            }
            \`\`\`
        3.  **Content Synthesis**:
            *   Analyze ALL provided source materials to create a coherent 4-7 slide presentation that directly addresses the user's objective.
            *   If image sources are provided, you MUST incorporate them into the slides using the 'image' element type.
            *   Do not just copy-paste. Interpret, summarize, and visualize the information effectively.
        4.  **Language**: The output language MUST be Japanese.
        5.  **IDs**: Generate unique string IDs for all 'id' fields in slides and elements.

        **SOURCE MATERIALS FOLLOW**:
    `},...L2(t)];r.push({text:`
Reminder: Create the slide deck now based on the objective and all the sources provided above. The response must be only the JSON object.`});try{const a=await Zt.models.generateContent({model:va,contents:{parts:r},config:{responseMimeType:"application/json"}}),i=Ua(a.text);if(!i||!Array.isArray(i.slides))throw new Error("AI returned an invalid format for the custom slide deck.");return i}catch(a){ya(a,"custom slide deck generation")}},AL=async(t,e)=>{if(!Zt)throw new Error("AI Service not initialized. Please set an API Key.");const r=[{text:`
        You are an expert project analyst. Your task is to write a text-based report based on a specific user objective and a collection of source materials.
        USER OBJECTIVE:
        "${e}"
        INSTRUCTIONS:
        1.  Synthesize the information from ALL provided source materials to create a coherent and insightful report that directly addresses the user's objective.
        2.  Do not simply copy-paste data. Interpret and summarize the information in a clear, professional manner.
        3.  Format the output using Markdown for readability (e.g., use headings, bullet points, bold text).
        4.  If image sources are provided, reference them by name in your report (e.g., "(see image: 'chart.png')"). Do not try to embed them.
        5.  The language of the output should be Japanese.
        6.  Your response MUST be only the text report. Do not include any other explanations.
        SOURCE MATERIALS FOLLOW:
    `},...L2(t)];r.push({text:`
Reminder: Write the report now based on the objective and all the sources provided above. The response must be only the text report.`});try{return(await Zt.models.generateContent({model:va,contents:{parts:r}})).text}catch(a){ya(a,"custom text report generation")}},tw=async(t,e,n)=>{if(!Zt)throw new Error("AI Service not initialized. Please set an API Key.");const r=`
      You are a project management assistant AI. Your task is to convert a project structure into data for a Gantt chart.
      CONTEXT:
      - Project Goal: "${e}"
      - Project Start Date: "${new Date().toISOString().split("T")[0]}"
      - Project Target End Date: "${n}"
      - Full Project Data (JSON, pruned for brevity): ${JSON.stringify(Wi(t),null,2)}

      INSTRUCTIONS:
      1.  Create a flat list of items for the Gantt chart. Include every ProjectTask, every SubStep, and every ActionItem from all tasks.
      2.  For each item, generate a JSON object with this exact structure:
          { "id": "string", "name": "string", "start": "YYYY-MM-DD", "end": "YYYY-MM-DD", "progress": number, "dependencies": ["string"], "type": "'task' | 'substep' | 'actionitem'", "parentId": "string | null" }
      3.  **Date Estimation**:
          - The project must fit between the start and target dates.
          - Use an item's \`dueDate\` as its 'end' date if available for tasks and sub-steps.
          - Estimate 'start' and 'end' dates logically. An item must start after its dependencies end.
          - For 'actionitem', estimate a short duration (e.g., 1-2 days) within the parent sub-step's timeframe.
      4.  **Progress Calculation**:
          - For a 'task': 'Completed' is 100, 'Not Started' is 0. For 'In Progress' or 'Blocked', average the progress of its sub-steps. If no sub-steps, 'In Progress' is 50.
          - For a 'substep': Calculate progress from its \`actionItems\` (% of completed items). If no action items, use its \`status\`: 'Completed' is 100, 'In Progress' is 50, 'Not Started' is 0.
          - For an 'actionitem': 'completed: true' is 100, 'completed: false' is 0.
      5.  **Dependencies & Parent ID**:
          - **Rule**: The 'dependencies' array models the sequential workflow. A dependency can ONLY exist between items of the SAME \`type\` AND with the SAME \`parentId\`.
          - **Tasks**: A task's 'parentId' is ALWAYS null. Use \`nextTaskIds\` to establish dependencies between tasks.
          - **Sub-steps**: A sub-step's 'parentId' MUST BE the ID of its parent ProjectTask. Use \`nextSubStepIds\` to establish dependencies ONLY between sub-steps within the same task.
          - **Action Items**: An action item's 'parentId' MUST BE the ID of its parent SubStep. Create sequential dependencies ONLY between action items within the same sub-step (item 2 depends on item 1, etc.).
          - **CRITICAL**: Do NOT create dependencies across different parents (e.g., from a sub-step in Task A to one in Task B) or across different types (e.g., from a task to a sub-step).
      6.  Your response MUST be a single, valid JSON array of GanttItem objects. Do not use markdown.
    `;try{const a=await Zt.models.generateContent({model:va,contents:r,config:{responseMimeType:"application/json"}}),i=Ua(a.text);if(!i||!Array.isArray(i))throw new Error("AI returned an invalid format for the Gantt chart data.");return i}catch(a){ya(a,"Gantt chart data generation")}},la="プロジェクトの保存・読み込み機能を使用するには、Supabaseの設定が必要です。";class rr{static async getProjects(){if(!at)throw new Error(la);const{data:{user:e}}=await at.auth.getUser();if(!e)throw new Error("ログインが必要です");const{data:n,error:r}=await at.from("projects").select(`
        *,
        project_members!inner(role)
      `).order("updated_at",{ascending:!1});if(r)throw new Error(`プロジェクトの取得に失敗しました: ${r.message}`);return n.map(a=>{var i;return{id:a.id,title:a.title,goal:a.goal,targetDate:a.target_date,tasks:a.tasks_data||[],ganttData:a.gantt_data,createdAt:a.created_at,updatedAt:a.updated_at,lastModifiedBy:a.last_modified_by,version:a.version||1,userRole:((i=a.project_members[0])==null?void 0:i.role)||"viewer"}})}static async getProjectWithMembers(e){var d;if(!at)throw new Error(la);const{data:{user:n}}=await at.auth.getUser();if(!n)throw new Error("ログインが必要です");const{data:r,error:a}=await at.from("projects").select("*, project_members!inner(role)").eq("id",e).single();if(a)throw new Error(`プロジェクト取得エラー: ${a.message}`);const{data:i,error:l}=await at.from("project_members").select("*, profiles (email)").eq("project_id",e).eq("status","accepted");if(l)throw console.error("メンバー取得エラー詳細:",l),new Error(`メンバー情報取得失敗: ${l.message}`);const c=i.map(f=>{var g;return{id:f.id,projectId:f.project_id,userId:f.user_id,role:f.role,invitedBy:f.invited_by,invitedAt:f.invited_at,joinedAt:f.joined_at,status:f.status,userEmail:((g=f.profiles)==null?void 0:g.email)||""}});return{id:r.id,title:r.title,goal:r.goal,targetDate:r.target_date,tasks:r.tasks_data||[],ganttData:r.gantt_data,createdAt:r.created_at,updatedAt:r.updated_at,lastModifiedBy:r.last_modified_by,version:r.version||1,userRole:((d=r.project_members[0])==null?void 0:d.role)||"viewer",members:c}}static async createProject(e,n,r,a=[],i){if(!at)throw new Error(la);const{data:{user:l}}=await at.auth.getUser();if(!l)throw new Error("ログインが必要です");const{data:c,error:d}=await at.from("projects").insert({user_id:l.id,title:e,goal:n,target_date:r,tasks_data:a,gantt_data:i,last_modified_by:l.id,version:1}).select().single();if(d)throw new Error(`プロジェクトの作成に失敗しました: ${d.message}`);return{id:c.id,title:c.title,goal:c.goal,targetDate:c.target_date,tasks:c.tasks_data||[],ganttData:c.gantt_data,createdAt:c.created_at,updatedAt:c.updated_at,lastModifiedBy:c.last_modified_by,version:c.version,userRole:"owner"}}static async updateProject(e,n){var c;if(!at)throw new Error(la);const{data:{user:r}}=await at.auth.getUser();if(!r)throw new Error("ログインが必要です");if(n.expectedVersion!==void 0){const{data:d,error:f}=await at.from("projects").select("version").eq("id",e).single();if(f)throw new Error(`プロジェクトの確認に失敗しました: ${f.message}`);if(d.version!==n.expectedVersion)throw new Error("プロジェクトが他のユーザーによって更新されています。最新の状態を取得してから再度お試しください。")}const a={};n.title!==void 0&&(a.title=n.title),n.goal!==void 0&&(a.goal=n.goal),n.targetDate!==void 0&&(a.target_date=n.targetDate),n.tasks!==void 0&&(a.tasks_data=n.tasks),n.ganttData!==void 0&&(a.gantt_data=n.ganttData);const{data:i,error:l}=await at.from("projects").update(a).eq("id",e).select(`
        *,
        project_members!inner(role)
      `).single();if(l)throw new Error(`プロジェクトの更新に失敗しました: ${l.message}`);return{id:i.id,title:i.title,goal:i.goal,targetDate:i.target_date,tasks:i.tasks_data||[],ganttData:i.gantt_data,createdAt:i.created_at,updatedAt:i.updated_at,lastModifiedBy:i.last_modified_by,version:i.version,userRole:((c=i.project_members[0])==null?void 0:c.role)||"viewer"}}static async deleteProject(e){if(!at)throw new Error(la);const{error:n}=await at.from("projects").delete().eq("id",e);if(n)throw new Error(`プロジェクトの削除に失敗しました: ${n.message}`)}static async getProject(e){var a;if(!at)throw new Error(la);const{data:n,error:r}=await at.from("projects").select(`
        *,
        project_members!inner(role)
      `).eq("id",e).single();if(r)throw new Error(`プロジェクトの取得に失敗しました: ${r.message}`);return{id:n.id,title:n.title,goal:n.goal,targetDate:n.target_date,tasks:n.tasks_data||[],ganttData:n.gantt_data,createdAt:n.created_at,updatedAt:n.updated_at,lastModifiedBy:n.last_modified_by,version:n.version||1,userRole:((a=n.project_members[0])==null?void 0:a.role)||"viewer"}}static async inviteToProject(e,n,r){if(!at)throw new Error(la);const{data:{user:a}}=await at.auth.getUser();if(!a)throw new Error("ログインが必要です");const{data:i,error:l}=await at.from("project_invitations").insert({project_id:e,email:n,role:r,invited_by:a.id}).select().single();if(l)throw new Error(`招待の送信に失敗しました: ${l.message}`);return{id:i.id,projectId:i.project_id,email:i.email,role:i.role,invitedBy:i.invited_by,token:i.token,expiresAt:i.expires_at,createdAt:i.created_at,usedAt:i.used_at}}static async joinProjectByInvitation(e){if(!at)throw new Error(la);const{data:n,error:r}=await at.rpc("join_project_by_invitation",{invitation_token:e});if(r)throw new Error(`プロジェクトへの参加に失敗しました: ${r.message}`);return n}static async getProjectInvitations(e){if(!at)throw new Error(la);const{data:n,error:r}=await at.from("project_invitations").select("*").eq("project_id",e).is("used_at",null).gt("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});if(r)throw new Error(`招待一覧の取得に失敗しました: ${r.message}`);return n.map(a=>({id:a.id,projectId:a.project_id,email:a.email,role:a.role,invitedBy:a.invited_by,token:a.token,expiresAt:a.expires_at,createdAt:a.created_at,usedAt:a.used_at}))}static async updateMemberRole(e,n,r){if(!at)throw new Error(la);const{error:a}=await at.from("project_members").update({role:r}).eq("project_id",e).eq("user_id",n);if(a)throw new Error(`メンバーの役割更新に失敗しました: ${a.message}`)}static async removeMember(e,n){if(!at)throw new Error(la);const{error:r}=await at.from("project_members").delete().eq("project_id",e).eq("user_id",n);if(r)throw new Error(`メンバーの削除に失敗しました: ${r.message}`)}static subscribeToProjectChanges(e,n,r){if(!at)return console.warn("Supabaseが設定されていないため、リアルタイム更新は無効です。"),()=>{};const a=at.channel(`project-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"projects",filter:`id=eq.${e}`},n).on("postgres_changes",{event:"*",schema:"public",table:"project_members",filter:`project_id=eq.${e}`},r).subscribe();return()=>{at.removeChannel(a)}}}const In=({size:t="md",color:e="border-blue-500",text:n})=>{const r={sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16"};return x.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[x.jsx("div",{className:`animate-spin rounded-full border-4 ${e} border-t-transparent ${r[t]}`}),n&&x.jsx("p",{className:"text-slate-600 text-sm",children:n})]})},kp=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-3.75h.008v.008H12v-.008ZM12 15h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5v-.008ZM9.75 18.75h.008v.008H9.75v-.008ZM7.5 18.75h.008v.008H7.5v-.008ZM14.25 15h.008v.008H14.25v-.008ZM16.5 15h.008v.008H16.5v-.008ZM14.25 18.75h.008v.008H14.25v-.008ZM16.5 18.75h.008v.008H16.5v-.008Z"})}),Np=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9 9 0 1 0 0-18 9 9 0 0 0 0 18Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m12 12 4.243 4.243"})]}),kL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})}),NL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"})}),Br=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"})}),P2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"})}),U2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})}),dl=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),Rp=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),xa=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12.56 0c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),gu=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Mi=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})}),Dp=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.354a15.055 15.055 0 0 1-3 0M12.75 4.5v-.75a.75.75 0 0 0-.75-.75h-.75a.75.75 0 0 0-.75.75v.75m0 0A2.25 2.25 0 0 0 9.75 6.75h4.5A2.25 2.25 0 0 0 12.75 4.5M12 18.75h.008v.008H12v-.008Z"})}),Bi=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),RL=({title:t,...e})=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[t&&x.jsx("title",{children:t}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9.75V12m0 0H9.75M12 12h2.25m-2.25 0V9.75M12 12v2.25m0 0H9.75M12 14.25h2.25M12 6.75a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Zm0 0V3m0 3.75h.008v.008H12V6.75Zm-5.25 0H3.75m0 0V3m0 3.75h.008v.008H3.75V6.75Zm10.5 0h2.25m0 0V3m0 3.75h.008v.008H16.5V6.75Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})]}),xu=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75h16.5v16.5H3.75V3.75Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9 12.75 3 3 6-6"})]}),Od=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25-2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"})}),DL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h7.5M8.25 12h7.5m-7.5 5.25h7.5M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})}),Pd=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"})}),Ud=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),ML=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),IL=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113A.375.375 0 0 1 9.75 15.113V8.887c0-.286.307-.466.557-.332l5.603 3.118Z"})]}),FL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),LL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),OL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.125A3.375 3.375 0 005.625 4.5h12.75c1.72 0 3.125 1.119 3.375 2.625M9.75 10.5h4.5m-4.5 3h4.5M11.25 3v1.5m0 15V21m0-16.5a1.5 1.5 0 00-3 0V21a1.5 1.5 0 003 0V3.062A3.375 3.375 0 0112 2.25c.465 0 .91.095 1.312.281M14.25 9a3 3 0 10-6 0 3 3 0 006 0z"})}),B2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),j2=t=>x.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:[x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3v11.25A2.25 2.25 0 006 16.5h12A2.25 2.25 0 0020.25 14.25V3M3.75 21h16.5M16.5 3.75h.008v.008H16.5V3.75zm-3.75 0h.008v.008H12.75V3.75zm-3.75 0h.008v.008H9V3.75zm-3.75 0h.008v.008H5.25V3.75z"}),x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.5h18M9.75 16.5a.75.75 0 01.75-.75h3a.75.75 0 01.75.75v4.5a.75.75 0 01-.75.75h-3a.75.75 0 01-.75-.75v-4.5z"})]}),PL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})}),V2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3"})}),H2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15 15 6-6m0 0-6-6m6 6H3a6 6 0 0 0 0 12h3"})}),Zs=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.122 2.122l7.81-7.81"})}),vu=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125v-1.5c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h-1.5m1.5 0v-1.5m17.25 1.5v-1.5m0 0h1.5m-1.5 0h-17.25m0 0H3.375c-.621 0-1.125-.504-1.125-1.125v-12.75c0-.621.504-1.125 1.125-1.125h17.25c.621 0 1.125.504 1.125 1.125v12.75c0 .621-.504 1.125-1.125 1.125m-17.25 0h-1.5m1.5 0v-1.5m17.25 1.5v-1.5m0 0h1.5m-1.5 0h-17.25m17.25 0v-12.75a1.125 1.125 0 0 0-1.125-1.125H3.375A1.125 1.125 0 0 0 2.25 4.5v12.75c0 .621.504 1.125 1.125 1.125M12 4.5v15m0 0H9m3 0h3"})}),UL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...t,children:x.jsx("path",{fillRule:"evenodd",d:"M10 1a4.5 4.5 0 00-4.5 4.5V9H5a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-.5V5.5A4.5 4.5 0 0010 1zm3 8V5.5a3 3 0 10-6 0V9h6z",clipRule:"evenodd"})}),BL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",...t,children:x.jsx("path",{d:"M10 2a5 5 0 00-5 5v2a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-1V7a5 5 0 00-5-5zm0 2.5a2.5 2.5 0 00-2.5 2.5V9h5V7a2.5 2.5 0 00-2.5-2.5z"})}),Tl=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.572L16.5 21.75l-.398-1.178a3.375 3.375 0 00-2.455-2.456L12.5 17.25l1.178-.398a3.375 3.375 0 002.455-2.456L16.5 13.5l.398 1.178a3.375 3.375 0 002.456 2.456L20.25 17.25l-1.178.398a3.375 3.375 0 00-2.456 2.456z"})}),$2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75c0-.231-.035-.454-.1-.664M6.75 7.5H18v2.25H6.75V7.5zM3 12h3v6.75a2.25 2.25 0 002.25 2.25h9.75a2.25 2.25 0 002.25-2.25V12h3m-3.498 6.75H15"})}),lm=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75v4.5m0-4.5h-4.5m4.5 0L15 9m5.25 11.25v-4.5m0 4.5h-4.5m4.5 0L15 15"})}),cm=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9V4.5M9 9H4.5M9 9 3.75 3.75M9 15v4.5M9 15H4.5M9 15l-5.25 5.25M15 9V4.5M15 9h4.5M15 9l5.25-5.25M15 15v4.5M15 15h4.5M15 15l5.25 5.25"})}),G2=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12"})}),ji=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})}),Zc=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",...t,children:x.jsx("path",{d:"M7.247 4.86l-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"})}),Vi=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",...t,children:x.jsx("path",{d:"M7.247 11.14l-4.796-5.481c-.566-.647-.106-1.659.753-1.659h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"})}),Qc=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25z"})}),md=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"})}),jL=t=>x.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:x.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"})}),VL=({onSubmit:t,isLoading:e,onImportProject:n,onLoadTemplate:r,initialGoal:a="",initialDate:i="",onOpenProjectList:l,onLogout:c,user:d})=>{const[f,g]=U.useState(a),[v,_]=U.useState(i),T=U.useRef(null);cs.useEffect(()=>{g(a)},[a]),cs.useEffect(()=>{_(i)},[i]);const E=new Date().toISOString().split("T")[0],S=I=>{if(I.preventDefault(),!f.trim()||!v){alert("事業目的と目標日付を入力してください。");return}t(f,v)},b=()=>{var I;(I=T.current)==null||I.click()},k=I=>{var j;const B=(j=I.target.files)==null?void 0:j[0];B&&(n(B),I.target.value="")},A=I=>{if(!f.trim()||!v){alert("テンプレートから開始するには、まずプロジェクトの目的と目標の日付を入力してください。");return}r(I,f,v)},C=({template:I,title:B,description:j,disabled:F})=>x.jsxs("button",{type:"button",onClick:()=>A(I),disabled:F,className:"text-left p-4 bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400 text-white rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105",children:[x.jsx("div",{className:"font-semibold text-md",children:B}),x.jsx("div",{className:"text-xs text-purple-200 mt-1",children:j})]});return x.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:[x.jsxs("div",{className:"w-full max-w-2xl mb-4 flex justify-between items-center",children:[x.jsxs("div",{className:"text-white text-sm",children:["ログイン中: ",d==null?void 0:d.email]}),x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsxs("button",{onClick:l,className:"flex items-center gap-2 px-4 py-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",children:[x.jsx(ji,{className:"w-5 h-5"}),"保存済みプロジェクト"]}),x.jsxs("button",{onClick:c,className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:[x.jsx(Qc,{className:"w-5 h-5"}),"ログアウト"]})]})]}),x.jsxs("div",{className:"w-full max-w-2xl bg-white shadow-2xl rounded-xl p-8 md:p-12",children:[x.jsxs("div",{className:"text-center mb-10",children:[x.jsx("h1",{className:"text-4xl font-bold text-slate-800 mb-3",children:"AIプロジェクトプランナー"}),x.jsx("p",{className:"text-slate-600 text-lg",children:"あなたの目標達成をAIがお手伝いします。"})]}),x.jsxs("form",{onSubmit:S,className:"space-y-6",children:[x.jsxs("div",{children:[x.jsxs("label",{htmlFor:"projectGoal",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[x.jsx(Np,{className:"w-5 h-5 mr-2 text-blue-600"}),"プロジェクトの目的 (最終形)"]}),x.jsx("textarea",{id:"projectGoal",value:f,onChange:I=>g(I.target.value),placeholder:"例: 新しいEコマースサイトを立ち上げ、初年度売上1000万円を目指す",rows:3,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-100 placeholder-slate-400"})]}),x.jsxs("div",{children:[x.jsxs("label",{htmlFor:"targetDate",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[x.jsx(kp,{className:"w-5 h-5 mr-2 text-blue-600"}),"目標の日付"]}),x.jsx("input",{type:"date",id:"targetDate",value:v,onChange:I=>_(I.target.value),min:E,className:"w-full px-4 py-3 bg-slate-800 border border-slate-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-100",style:{colorScheme:"dark"}})]}),x.jsx("p",{className:"text-sm text-slate-500 text-center",children:"目的と日付を入力して計画を作成するか、テンプレートまたは既存の計画から開始します。"}),x.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[at&&x.jsx("button",{type:"submit",disabled:e,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105 flex items-center justify-center text-md",children:e?x.jsx(In,{size:"sm",color:"border-white"}):"AIで計画を作成"}),x.jsxs("button",{type:"button",onClick:b,disabled:e,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-150 ease-in-out transform hover:scale-105 flex items-center justify-center text-md",children:[x.jsx(U2,{className:"w-5 h-5 mr-2"}),"計画をインポート (.json)"]}),x.jsx("input",{type:"file",ref:T,onChange:k,accept:".json",className:"hidden","aria-hidden":"true"})]}),x.jsxs("div",{className:"sm:col-span-2 pt-4",children:[x.jsx("p",{className:"text-center text-sm font-semibold text-slate-600 mb-3",children:"または、テンプレートから開始:"}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[x.jsx(C,{template:"process-design",disabled:e,title:"工程設計 (APQP)",description:"新製品の工程をAPQPに基づき計画から量産まで設計します。"}),x.jsx(C,{template:"process-change",disabled:e,title:"工程変更 (ISO/IATF)",description:"既存工程の変更を影響分析、承認、検証を含めて管理します。"}),x.jsx(C,{template:"new-product-eval",disabled:e,title:"新製品の設備評価",description:"顧客要求に基づき、既存設備での実現可能性を評価・報告します。"}),x.jsx(C,{template:"improvement-project",disabled:e,title:"生産性・コスト改善",description:"DMAICフレームワークに基づき、既存プロセスの問題を解決し、改善します。"}),x.jsx(C,{template:"equipment-modification",disabled:e,title:"社内設備改造",description:"社内設備・治具の改造・改善を計画・実行・評価します。"})]})]})]})]}),x.jsx("footer",{className:"mt-12 text-center",children:x.jsx("p",{className:"text-slate-400 text-sm",children:"Powered by Gemini API & Supabase"})})]})},Hf=t=>{switch(t){case Ri.IN_PROGRESS:return{icon:x.jsx(IL,{className:"w-3.5 h-3.5"}),color:"text-blue-700",text:"進行中",bgColor:"bg-blue-100"};case Ri.COMPLETED:return{icon:x.jsx(gu,{className:"w-3.5 h-3.5"}),color:"text-green-700",text:"完了",bgColor:"bg-green-100"};case Ri.BLOCKED:return{icon:x.jsx(FL,{className:"w-3.5 h-3.5"}),color:"text-red-700",text:"停滞中",bgColor:"bg-red-100"};case Ri.NOT_STARTED:default:return{icon:x.jsx(ML,{className:"w-3.5 h-3.5"}),color:"text-slate-600",text:"未着手",bgColor:"bg-slate-100"}}},HL=({task:t,onSelectTask:e,onRemoveTask:n,onUpdateStatus:r,onDragCardStart:a,index:i,cardRef:l,onStartConnection:c,onEndConnection:d,canEdit:f=!0})=>{var F,X,P,re;const[g,v]=U.useState(!1),_=U.useRef(null);U.useEffect(()=>{const G=te=>{_.current&&!_.current.contains(te.target)&&v(!1)};return document.addEventListener("mousedown",G),()=>{document.removeEventListener("mousedown",G)}},[_]);const T=G=>{f&&(r(t.id,G),v(!1))},E=(F=t.extendedDetails)==null?void 0:F.numericalTarget;let S="text-slate-500";E&&(E.status===Im.ACHIEVED?S="text-green-600":E.status===Im.MISSED?S="text-red-600":S="text-yellow-600");const b=Hf(t.status),k=(X=t.extendedDetails)==null?void 0:X.dueDate,A=k?new Date(k+"T00:00:00Z").toLocaleDateString("ja-JP",{month:"short",day:"numeric"}):null,C=t.status===Ri.IN_PROGRESS,I="task-card-in-flow bg-white rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 ease-in-out overflow-hidden flex-shrink-0 w-80 md:w-96 m-1 cursor-grab active:cursor-grabbing",B=C?"border-4 border-blue-500 ring-2 ring-blue-500 ring-offset-1":"border border-transparent",j=G=>{G.stopPropagation(),c(t.id,G)};return x.jsxs("div",{ref:l,id:`taskcard-${t.id}`,draggable:"true",onDragStart:G=>a(G,t.id),onMouseUp:()=>d(t.id),className:`${I} ${B}`,style:{position:"absolute",left:((P=t.position)==null?void 0:P.x)||0,top:((re=t.position)==null?void 0:re.y)||0,touchAction:"none"},children:[x.jsxs("div",{className:"p-5 relative",children:[x.jsx("div",{onMouseDown:j,className:"absolute right-[-6px] top-1/2 -translate-y-1/2 w-4 h-4 bg-blue-500 border-2 border-white rounded-full cursor-crosshair hover:scale-125 transition-transform z-10",title:"ドラッグして接続"}),x.jsxs("div",{className:"flex items-start justify-between mb-2",children:[x.jsxs("div",{className:"flex items-center flex-grow min-w-0 mr-2",children:[x.jsx("span",{className:"bg-blue-600 text-white rounded-full w-7 h-7 flex items-center justify-center font-bold text-xs mr-3 flex-shrink-0",children:i+1}),x.jsx("div",{className:"flex-grow min-w-0",children:x.jsx("div",{className:"text-lg font-bold text-slate-900 break-words","aria-label":`task title for ${t.title}`,children:t.title})})]}),x.jsxs("div",{className:"flex space-x-1 flex-shrink-0 items-center",children:[E&&x.jsx(RL,{className:`w-5 h-5 ${S}`,title:`数値目標: ${E.description} (${E.status})`}),x.jsx("button",{onClick:G=>{G.stopPropagation(),e(t)},className:"text-blue-600 hover:text-blue-800 transition-colors p-1 rounded-full hover:bg-blue-100",title:"詳細・計画編集","aria-label":`詳細・計画編集: ${t.title}`,children:x.jsx(NL,{className:"w-5 h-5"})}),x.jsx("button",{onClick:G=>{G.stopPropagation(),f&&n(t.id)},disabled:!f,className:"text-red-500 hover:text-red-700 transition-colors p-1 rounded-full hover:bg-red-100",title:f?"タスクを削除":"編集権限が必要です","aria-label":`タスクを削除: ${t.title}`,children:x.jsx(xa,{className:"w-5 h-5"})})]})]}),x.jsx("div",{className:"h-20 mb-3",children:x.jsx("p",{className:"text-slate-800 text-sm leading-relaxed line-clamp-4 overflow-hidden h-full",children:t.description})}),x.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 mb-2",children:[x.jsxs("div",{className:"relative",ref:_,children:[x.jsxs("button",{onClick:()=>v(G=>!G),disabled:!f,className:`inline-flex items-center px-2 py-0.5 rounded-full cursor-pointer ${b.bgColor} ${b.color} hover:ring-2 hover:ring-offset-1 hover:ring-blue-400 transition-all`,title:f?"ステータスを変更":"編集権限が必要です",children:[cs.cloneElement(b.icon,{className:`w-3 h-3 mr-1 ${b.color}`}),b.text]}),g&&f&&x.jsx("div",{className:"absolute bottom-full mb-1 w-36 bg-white border border-slate-200 rounded-md shadow-lg z-20 py-1",children:Object.values(Ri).map(G=>x.jsxs("button",{onClick:()=>T(G),className:"w-full text-left px-3 py-1.5 text-sm text-slate-700 hover:bg-slate-100 flex items-center",children:[cs.cloneElement(Hf(G).icon,{className:`w-3.5 h-3.5 mr-2 ${Hf(G).color}`}),Hf(G).text]},G))})]}),A&&x.jsxs("div",{className:"flex items-center text-orange-600",children:[x.jsx(Ud,{className:"w-3.5 h-3.5 mr-1"}),"期日: ",A]})]})]}),x.jsx("button",{onClick:G=>{G.stopPropagation(),e(t)},className:"block w-full text-left bg-slate-100 hover:bg-slate-200 text-blue-700 font-medium py-3 px-5 transition-colors text-xs border-t border-slate-200",children:f?"詳細な計画・レポート・接続 →":"詳細を表示 →"})]})},$L=U.memo(HL),eu=({from:t,to:e,id:n,onDelete:r})=>{const l=t.x,c=e.x,d=(l+c)/2,f=(t.y+e.y)/2,g=`M${l},${t.y} C${l+50},${t.y} ${c-50},${e.y} ${c},${e.y}`;return x.jsxs("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",overflow:"visible"},"aria-hidden":"true",children:[x.jsx("defs",{children:x.jsx("marker",{id:`arrowhead-${n}`,markerWidth:8,markerHeight:8*.7,refX:8,refY:8*.35,orient:"auto",markerUnits:"strokeWidth",children:x.jsx("path",{d:`M0,0 L8,${8*.35} L0,${8*.7} Z`,fill:"#64748b"})})}),x.jsxs("g",{style:{pointerEvents:r?"auto":"none"},children:[x.jsx("path",{d:g,stroke:"#64748b",strokeWidth:2,markerEnd:`url(#arrowhead-${n})`,fill:"none"}),x.jsx("path",{d:g,stroke:"transparent",strokeWidth:"16",fill:"none",className:r?"cursor-pointer group":"",onClick:r}),r&&x.jsxs("g",{transform:`translate(${d}, ${f})`,className:"opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer",onClick:r,children:[x.jsx("circle",{cx:"0",cy:"0",r:"8",fill:"white",stroke:"#ef4444",strokeWidth:"1"}),x.jsx("path",{d:"M -3.5 -3.5 L 3.5 3.5 M -3.5 3.5 L 3.5 -3.5",stroke:"#ef4444",strokeWidth:"1.5",strokeLinecap:"round"})]})]})]})},GL=({tasks:t,onClose:e})=>{const[n,r]=U.useState("all"),[a,i]=U.useState(""),[l,c]=U.useState(null),d=U.useMemo(()=>{const E=[];return t.forEach(S=>{var b,k;(k=(b=S.extendedDetails)==null?void 0:b.subSteps)==null||k.forEach(A=>{var C;(C=A.actionItems)==null||C.forEach(I=>{E.push({actionItem:I,subStep:A,task:S})})})}),E},[t]),f=U.useMemo(()=>d.filter(E=>n==="completed"?E.actionItem.completed:n==="pending"?!E.actionItem.completed:!0).filter(E=>{const S=a.toLowerCase();return E.actionItem.text.toLowerCase().includes(S)||E.subStep.text.toLowerCase().includes(S)||(E.subStep.responsible||"").toLowerCase().includes(S)||E.task.title.toLowerCase().includes(S)}),[d,n,a]),g=U.useMemo(()=>{let E=[...f];return l!==null&&E.sort((S,b)=>{let k="",A="";switch(l.key){case"status":k=S.actionItem.completed,A=b.actionItem.completed;break;case"actionItem":k=S.actionItem.text.toLowerCase(),A=b.actionItem.text.toLowerCase();break;case"responsible":k=(S.subStep.responsible||"").toLowerCase(),A=(b.subStep.responsible||"").toLowerCase();break;case"subStep":k=S.subStep.text.toLowerCase(),A=b.subStep.text.toLowerCase();break;case"task":k=S.task.title.toLowerCase(),A=b.task.title.toLowerCase();break;case"dueDate":k=S.actionItem.dueDate||S.subStep.dueDate||"9999-12-31",A=b.actionItem.dueDate||b.subStep.dueDate||"9999-12-31";break}return k<A?l.direction==="ascending"?-1:1:k>A?l.direction==="ascending"?1:-1:0}),E},[f,l]),v=E=>{let S="ascending";l&&l.key===E&&l.direction==="ascending"&&(S="descending"),c({key:E,direction:S})},_=E=>!l||l.key!==E?x.jsx(Zc,{className:"w-3 h-3 ml-1 opacity-20"}):l.direction==="ascending"?x.jsx(Zc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(Vi,{className:"w-3 h-3 ml-1 text-blue-600"}),T=({sortKey:E,label:S,className:b})=>x.jsx("th",{scope:"col",className:`px-6 py-3 ${b||""}`,children:x.jsxs("button",{onClick:()=>v(E),className:"flex items-center gap-1 hover:text-blue-600 transition-colors",children:[S,_(E)]})});return x.jsxs("div",{className:"fixed inset-0 bg-slate-100 z-[60] flex flex-col",children:[x.jsx("header",{className:"flex-shrink-0 bg-white shadow-md",children:x.jsxs("div",{className:"flex items-center justify-between p-4 border-b w-full max-w-7xl mx-auto",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"全アクションアイテム一覧"}),x.jsxs("button",{onClick:e,className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300",children:[x.jsx(P2,{className:"w-5 h-5"}),"フローに戻る"]})]})}),x.jsxs("main",{className:"flex-grow flex flex-col overflow-hidden p-4 w-full max-w-7xl mx-auto",children:[x.jsx("div",{className:"p-4 flex-shrink-0 bg-white rounded-t-lg border-x border-t",children:x.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[x.jsx("input",{type:"text",placeholder:"検索...",value:a,onChange:E=>i(E.target.value),className:"px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm w-full sm:w-auto flex-grow"}),x.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-slate-100 p-1",children:[x.jsx("button",{onClick:()=>r("all"),className:`px-3 py-1 text-sm rounded-md ${n==="all"?"bg-white shadow":"hover:bg-slate-200"}`,children:"全て"}),x.jsx("button",{onClick:()=>r("pending"),className:`px-3 py-1 text-sm rounded-md ${n==="pending"?"bg-white shadow":"hover:bg-slate-200"}`,children:"未完了"}),x.jsx("button",{onClick:()=>r("completed"),className:`px-3 py-1 text-sm rounded-md ${n==="completed"?"bg-white shadow":"hover:bg-slate-200"}`,children:"完了"})]})]})}),x.jsx("div",{className:"flex-grow overflow-y-auto bg-white rounded-b-lg border",children:x.jsxs("table",{className:"w-full text-sm text-left text-slate-600",children:[x.jsx("thead",{className:"text-xs text-slate-700 uppercase bg-slate-100 sticky top-0 z-10",children:x.jsxs("tr",{children:[x.jsx(T,{sortKey:"status",label:"状態",className:"w-24"}),x.jsx(T,{sortKey:"actionItem",label:"アクションアイテム"}),x.jsx(T,{sortKey:"responsible",label:"担当者"}),x.jsx(T,{sortKey:"subStep",label:"所属サブステップ"}),x.jsx(T,{sortKey:"task",label:"所属タスク"}),x.jsx(T,{sortKey:"dueDate",label:"期日"})]})}),x.jsxs("tbody",{className:"divide-y divide-slate-200",children:[g.map(({actionItem:E,subStep:S,task:b},k)=>x.jsxs("tr",{className:"hover:bg-slate-50",children:[x.jsx("td",{className:"px-6 py-3",children:E.completed?x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[x.jsx(xu,{className:"w-4 h-4 mr-1"}),"完了"]}):x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[x.jsx(Od,{className:"w-4 h-4 mr-1"}),"未完了"]})}),x.jsx("td",{className:"px-6 py-3 font-medium text-slate-900",children:E.text}),x.jsx("td",{className:"px-6 py-3",children:S.responsible||"未設定"}),x.jsx("td",{className:"px-6 py-3",children:S.text}),x.jsx("td",{className:"px-6 py-3",children:b.title}),x.jsx("td",{className:"px-6 py-3",children:E.dueDate||S.dueDate?new Date((E.dueDate||S.dueDate)+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}):"未設定"})]},E.id+k)),g.length===0&&x.jsx("tr",{children:x.jsx("td",{colSpan:6,className:"text-center py-8 text-slate-500",children:"条件に一致するアイテムはありません。"})})]})]})})]})]})},nw={"On Track":{bgColor:"bg-green-100",textColor:"text-green-800",icon:x.jsx(gu,{className:"w-12 h-12 text-green-500"})},"At Risk":{bgColor:"bg-yellow-100",textColor:"text-yellow-800",icon:x.jsx(Mi,{className:"w-12 h-12 text-yellow-500"})},"Off Track":{bgColor:"bg-red-100",textColor:"text-red-800",icon:x.jsx(Mi,{className:"w-12 h-12 text-red-500"})},Unknown:{bgColor:"bg-slate-100",textColor:"text-slate-800",icon:x.jsx(Mi,{className:"w-12 h-12 text-slate-500"})}},zL=({report:t,onClose:e})=>{if(!t)return null;const n=nw[t.overallStatus]||nw.Unknown;return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200 flex-shrink-0",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"AIプロジェクト診断レポート"}),x.jsx("button",{onClick:e,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(Br,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("div",{className:"flex-grow p-6 overflow-y-auto space-y-6",children:[x.jsxs("section",{className:`p-6 rounded-lg flex items-center gap-6 ${n.bgColor}`,children:[x.jsx("div",{className:"flex-shrink-0",children:n.icon}),x.jsxs("div",{children:[x.jsx("h4",{className:`text-2xl font-bold ${n.textColor}`,children:t.overallStatus}),x.jsx("p",{className:`mt-1 text-base ${n.textColor}`,children:t.summary})]})]}),x.jsxs("section",{children:[x.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[x.jsx(gu,{className:"w-5 h-5 mr-2 text-green-500"}),"うまくいっている点"]}),x.jsx("ul",{className:"list-disc list-inside space-y-2 text-slate-600 pl-2",children:t.positivePoints.map((r,a)=>x.jsx("li",{children:r},a))})]}),x.jsxs("section",{children:[x.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[x.jsx(Mi,{className:"w-5 h-5 mr-2 text-yellow-500"}),"懸念事項"]}),x.jsx("div",{className:"space-y-3",children:t.areasOfConcern.map((r,a)=>x.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg",children:[x.jsx("p",{className:"font-semibold text-yellow-800",children:r.description}),r.relatedTaskIds.length>0&&x.jsxs("p",{className:"text-xs text-yellow-700 mt-1",children:["関連タスクID: ",r.relatedTaskIds.join(", ")]})]},a))})]}),x.jsxs("section",{children:[x.jsxs("h5",{className:"text-lg font-semibold text-slate-700 mb-3 flex items-center",children:[x.jsx(Dp,{className:"w-5 h-5 mr-2 text-blue-500"}),"AIからの提案"]}),x.jsx("div",{className:"space-y-3",children:t.suggestions.map((r,a)=>x.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg",children:x.jsx("p",{className:"text-blue-800",children:r})},a))})]})]}),x.jsx("footer",{className:"p-4 bg-slate-50 border-t flex justify-end",children:x.jsx("button",{onClick:e,className:"px-5 py-2 text-sm font-medium text-white bg-slate-600 rounded-md hover:bg-slate-700",children:"閉じる"})})]})})},Ji=({message:t})=>t?x.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-md relative",role:"alert",children:[x.jsx("strong",{className:"font-bold",children:"Error: "}),x.jsx("span",{className:"block sm:inline",children:t})]}):null,qL=({isOpen:t,onClose:e,projectId:n,projectTitle:r,members:a,userRole:i,onMembersUpdate:l})=>{const[c,d]=U.useState(""),[f,g]=U.useState("editor"),[v,_]=U.useState([]),[T,E]=U.useState(!1),[S,b]=U.useState(!1),[k,A]=U.useState(null),C=i==="owner"||i==="editor";U.useEffect(()=>{t&&C&&I()},[t,n,C]);const I=async()=>{b(!0);try{const G=await rr.getProjectInvitations(n);_(G)}catch(G){A(G instanceof Error?G.message:"招待一覧の取得に失敗しました")}finally{b(!1)}},B=async G=>{if(G.preventDefault(),!c.trim()){A("メールアドレスを入力してください");return}if(a.some(te=>te.userEmail===c.trim())){A("このユーザーは既にプロジェクトのメンバーです");return}if(v.some(te=>te.email===c.trim())){A("このメールアドレスには既に招待を送信済みです");return}E(!0),A(null);try{await rr.inviteToProject(n,c.trim(),f),d(""),await I(),l()}catch(te){A(te instanceof Error?te.message:"招待の送信に失敗しました")}finally{E(!1)}},j=async(G,te)=>{if(i==="owner")try{await rr.updateMemberRole(n,G,te),l()}catch(_e){A(_e instanceof Error?_e.message:"役割の更新に失敗しました")}},F=async G=>{if(i==="owner"&&confirm("このメンバーをプロジェクトから削除しますか？"))try{await rr.removeMember(n,G),l()}catch(te){A(te instanceof Error?te.message:"メンバーの削除に失敗しました")}},X=G=>{const te=`${window.location.origin}/invite/${G}`;navigator.clipboard.writeText(te).then(()=>{alert("招待リンクをクリップボードにコピーしました")})},P=G=>{switch(G){case"owner":return"オーナー";case"editor":return"編集者";case"viewer":return"閲覧者";default:return G}},re=G=>{switch(G){case"owner":return"bg-purple-100 text-purple-800";case"editor":return"bg-blue-100 text-blue-800";case"viewer":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"プロジェクトメンバー管理"}),x.jsx("p",{className:"text-sm text-slate-500 mt-1",children:r})]}),x.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:x.jsx(Br,{className:"w-6 h-6"})})]}),x.jsxs("div",{className:"flex-grow p-6 overflow-y-auto space-y-6",children:[k&&x.jsx(Ji,{message:k}),C&&x.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[x.jsxs("h4",{className:"font-semibold text-slate-800 mb-3 flex items-center",children:[x.jsx(jL,{className:"w-5 h-5 mr-2"}),"新しいメンバーを招待"]}),x.jsx("form",{onSubmit:B,className:"space-y-3",children:x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[x.jsx("input",{type:"email",value:c,onChange:G=>d(G.target.value),placeholder:"メールアドレス",className:"px-3 py-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500",disabled:T}),x.jsxs("select",{value:f,onChange:G=>g(G.target.value),className:"px-3 py-2 border border-slate-300 rounded-md focus:ring-blue-500 focus:border-blue-500",disabled:T,children:[x.jsx("option",{value:"editor",children:"編集者"}),x.jsx("option",{value:"viewer",children:"閲覧者"})]}),x.jsxs("button",{type:"submit",disabled:T,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-slate-400",children:[T?x.jsx(In,{size:"sm",color:"border-white"}):x.jsx(Bi,{className:"w-4 h-4"}),"招待"]})]})})]}),x.jsxs("div",{children:[x.jsxs("h4",{className:"font-semibold text-slate-800 mb-3 flex items-center",children:[x.jsx(md,{className:"w-5 h-5 mr-2"}),"現在のメンバー (",a.length,"人)"]}),x.jsx("div",{className:"space-y-2",children:a.map(G=>x.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-slate-200 rounded-lg",children:[x.jsxs("div",{className:"flex items-center space-x-3",children:[x.jsx("div",{className:"w-8 h-8 bg-slate-200 rounded-full flex items-center justify-center",children:x.jsx(md,{className:"w-4 h-4 text-slate-600"})}),x.jsxs("div",{children:[x.jsx("p",{className:"font-medium text-slate-800",children:G.userEmail}),x.jsxs("p",{className:"text-xs text-slate-500",children:["参加日: ",new Date(G.joinedAt||G.invitedAt).toLocaleDateString("ja-JP")]})]})]}),x.jsxs("div",{className:"flex items-center space-x-2",children:[i==="owner"&&G.role!=="owner"?x.jsxs("select",{value:G.role,onChange:te=>j(G.userId,te.target.value),className:"text-xs px-2 py-1 border border-slate-300 rounded",children:[x.jsx("option",{value:"editor",children:"編集者"}),x.jsx("option",{value:"viewer",children:"閲覧者"})]}):x.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${re(G.role)}`,children:P(G.role)}),i==="owner"&&G.role!=="owner"&&x.jsx("button",{onClick:()=>F(G.userId),className:"p-1 text-red-500 hover:text-red-700 rounded",title:"メンバーを削除",children:x.jsx(xa,{className:"w-4 h-4"})})]})]},G.id))})]}),C&&x.jsxs("div",{children:[x.jsxs("h4",{className:"font-semibold text-slate-800 mb-3 flex items-center",children:[x.jsx(Ud,{className:"w-5 h-5 mr-2"}),"保留中の招待"]}),S?x.jsx("div",{className:"flex justify-center py-4",children:x.jsx(In,{size:"md"})}):v.length===0?x.jsx("p",{className:"text-slate-500 text-sm",children:"保留中の招待はありません"}):x.jsx("div",{className:"space-y-2",children:v.map(G=>x.jsxs("div",{className:"flex items-center justify-between p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[x.jsxs("div",{children:[x.jsx("p",{className:"font-medium text-slate-800",children:G.email}),x.jsxs("p",{className:"text-xs text-slate-500",children:[P(G.role)," として招待 • 期限: ",new Date(G.expiresAt).toLocaleDateString("ja-JP")]})]}),x.jsx("button",{onClick:()=>X(G.token),className:"px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700",children:"リンクをコピー"})]},G.id))})]})]}),x.jsx("footer",{className:"p-6 bg-slate-50 border-t flex justify-end",children:x.jsx("button",{onClick:e,className:"px-6 py-2 bg-slate-600 text-white rounded-md hover:bg-slate-700",children:"閉じる"})})]})}):null},rw=t=>{const e=Math.cos(2*Math.PI*t),n=Math.sin(2*Math.PI*t);return[e,n]},YL=({data:t,title:e})=>{const n=t.reduce((l,c)=>l+c.value,0);if(n===0)return x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data to display"});let r=0;const a=["#4a90e2","#50e3c2","#f5a623","#f8e71c","#7ed321","#9013fe"],i=t.map((l,c)=>{const d=l.value/n,[f,g]=rw(r);r+=d;const[v,_]=rw(r),T=d>.5?1:0;return{path:[`M ${f} ${g}`,`A 1 1 0 ${T} 1 ${v} ${_}`,"L 0 0"].join(" "),color:a[c%a.length],label:l.label}});return x.jsxs("div",{className:"w-full h-full flex flex-col bg-white p-2",children:[x.jsx("text",{x:"50%",y:"10",textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",className:"block text-center",children:e}),x.jsxs("div",{className:"flex-grow flex items-center",children:[x.jsx("svg",{viewBox:"-1 -1 2 2",className:"w-2/3 h-full",children:i.map((l,c)=>x.jsx("path",{d:l.path,fill:l.color},c))}),x.jsx("div",{className:"w-1/3 text-[8px] space-y-1",children:i.map((l,c)=>x.jsxs("div",{className:"flex items-center",children:[x.jsx("span",{className:"w-2 h-2 rounded-full mr-1",style:{backgroundColor:l.color}}),x.jsx("span",{className:"truncate",children:l.label})]},c))})]})]})},WL=({data:t,title:e})=>{const n=Math.max(...t.map(f=>f.value),0),r=300,a=150,i={top:20,right:10,bottom:30,left:30},l=r-i.left-i.right,c=a-i.top-i.bottom,d=t.map((f,g)=>{const v=g/(t.length-1)*l,_=c-f.value/n*c;return`${v},${_}`}).join(" ");return x.jsxs("svg",{viewBox:`0 0 ${r} ${a}`,className:"w-full h-full bg-white",children:[x.jsx("text",{x:r/2,y:i.top/2+5,textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",children:e}),x.jsxs("g",{transform:`translate(${i.left}, ${i.top})`,children:[x.jsx("line",{x1:"0",y1:"0",x2:"0",y2:c,stroke:"#ddd",strokeWidth:"0.5"}),x.jsx("line",{x1:"0",y1:c,x2:l,y2:c,stroke:"#ddd",strokeWidth:"0.5"}),x.jsx("polyline",{fill:"none",stroke:"#4a90e2",strokeWidth:"1.5",points:d}),t.map((f,g)=>{const v=g/(t.length-1)*l,_=c-f.value/n*c;return x.jsx("circle",{cx:v,cy:_,r:"2",fill:"#4a90e2"},g)})]})]})},JL=({data:t,title:e})=>{const n=Math.max(...t.map(f=>f.value),0),r=300,a=150,i={top:20,right:10,bottom:30,left:30},l=r-i.left-i.right,c=a-i.top-i.bottom,d=t.length>0?l/t.length*.8:0;return x.jsxs("svg",{viewBox:`0 0 ${r} ${a}`,className:"w-full h-full bg-white",children:[x.jsx("text",{x:r/2,y:i.top/2+5,textAnchor:"middle",fontSize:"10",fontWeight:"bold",fill:"#333",children:e}),x.jsxs("g",{transform:`translate(${i.left}, ${i.top})`,children:[x.jsx("line",{x1:"0",y1:"0",x2:"0",y2:c,stroke:"#999",strokeWidth:"0.5"}),[0,n/2,n].map(f=>x.jsxs("g",{transform:`translate(0, ${c-f/n*c})`,children:[x.jsx("line",{x1:"-3",y1:"0",x2:"0",y2:"0",stroke:"#999",strokeWidth:"0.5"}),x.jsx("text",{x:"-5",y:"3",textAnchor:"end",fontSize:"6",fill:"#666",children:f.toFixed(0)})]},f)),t.map((f,g)=>x.jsxs("g",{transform:`translate(${g*l/t.length+l/t.length*.1}, 0)`,children:[x.jsx("rect",{x:"0",y:c-f.value/n*c,width:d,height:f.value/n*c,fill:"#4a90e2"}),x.jsx("text",{x:d/2,y:c+8,textAnchor:"middle",fontSize:"6",fill:"#666",transform:`rotate(-45, ${d/2}, ${c+8})`,children:f.label})]},f.label))]})]})},KL=({subStep:t,statusColor:e})=>{var n,r;return x.jsx("div",{style:{position:"absolute",left:((n=t.position)==null?void 0:n.x)||0,top:((r=t.position)==null?void 0:r.y)||0,width:192,minHeight:76,padding:"8px",borderRadius:"8px",backgroundColor:"white",borderLeft:`4px solid ${e}`,boxShadow:"0 2px 4px rgba(0,0,0,0.1)",fontSize:"12px",fontFamily:"sans-serif",color:"#333",display:"flex",flexDirection:"column",justifyContent:"center"},children:x.jsx("p",{className:`font-bold break-words ${t.status===dr.COMPLETED?"line-through text-slate-500":""}`,children:t.text})})},XL=({subSteps:t})=>{if(!t||t.length===0)return x.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-100 text-slate-500 text-sm",children:"No sub-steps to display."});const e=l=>{switch(l){case dr.COMPLETED:return"#22c55e";case dr.IN_PROGRESS:return"#3b82f6";default:return"#94a3b8"}},n=192,r=76,a=U.useMemo(()=>{const l=[];return(t||[]).forEach(c=>{var d;if((d=c==null?void 0:c.nextSubStepIds)!=null&&d.length&&c.position){const f={x:c.position.x+n,y:c.position.y+r/2};c.nextSubStepIds.forEach(g=>{const v=t.find(_=>_.id===g);if(v&&v.position){const _={x:v.position.x,y:v.position.y+r/2};l.push({id:`fc-render-${c.id}-${g}`,from:f,to:_,sourceId:c.id,targetId:g})}})}}),l},[t,n,r]),i=U.useMemo(()=>{if(!t||t.length===0)return{minX:0,minY:0,width:400,height:300};let l=0,c=0;return t.forEach(d=>{d.position&&(l=Math.max(l,d.position.x+n),c=Math.max(c,d.position.y+r))}),{minX:0,minY:0,width:l+20,height:c+20}},[t,n,r]);return x.jsx("div",{className:"w-full h-full bg-slate-50 overflow-hidden",style:{fontFamily:"Inter, sans-serif"},children:x.jsxs("svg",{width:"100%",height:"100%",viewBox:`${i.minX} ${i.minY} ${i.width} ${i.height}`,children:[x.jsx("style",{children:`
                    .flowchart-card-container {
                        position: relative;
                        width: 100%;
                        height: 100%;
                        font-family: Inter, sans-serif;
                    }
                    `}),x.jsx("foreignObject",{x:"0",y:"0",width:i.width,height:i.height,children:x.jsx("div",{className:"flowchart-card-container",children:(t||[]).map(l=>x.jsx(KL,{subStep:l,statusColor:e(l.status)},l.id))})}),a.map(l=>x.jsx(eu,{from:l.from,to:l.to,id:l.id},l.id))]})})},ZL=({el:t,onUpdate:e,children:n,isSelected:r,onClick:a})=>x.jsx("div",{onClick:i=>{i.stopPropagation(),a()},style:{position:"absolute",left:`${t.position.x}%`,top:`${t.position.y}%`,width:`${t.position.width}%`,height:`${t.position.height}%`,outline:r?"2px solid #3b82f6":"1px dashed transparent",cursor:"move"},className:"transition-all duration-150 hover:outline-dashed hover:outline-slate-400",children:n}),z2=({tasks:t,initialDeck:e,onSave:n,onClose:r,generateUniqueId:a,projectGoal:i,targetDate:l,reportScope:c})=>{const[d,f]=U.useState(e),[g,v]=U.useState(0),[_,T]=U.useState(null),[E,S]=U.useState(!1),[b,k]=U.useState(null),[A,C]=U.useState(!1),I=U.useRef(null),B=(ae,J)=>{f(D=>({...D,slides:D.slides.map(ee=>ee.id===ae?{...ee,...typeof J=="function"?J(ee):ee}:ee)}))},j=ae=>{const J=d.slides[ae];B(J.id,{isLocked:!J.isLocked})},F=(ae,J,D)=>{B(ae,ee=>({elements:ee.elements.map(M=>M.id===J?{...M,...D}:M)}))},X=async()=>{S(!0),k(null);try{const ae={...d,slides:d.slides.map(ee=>ee.isLocked?ee:{...ee,isLocked:void 0})},J=await TL(ae),D={...J,slides:J.slides.map((ee,M)=>({...ee,isLocked:d.slides[M].isLocked}))};f(D)}catch(ae){k(ae instanceof Error?ae.message:"最適化に失敗しました。")}finally{S(!1)}},P=async()=>{S(!0),k(null);try{let ae;c==="project"?ae=await bL(d,t,i,l):ae=await wL(d,t[0],i),f(ae)}catch(ae){k(ae instanceof Error?ae.message:"レポートの再生成に失敗しました。")}finally{S(!1)}},re=(ae,J)=>{var D,ee,M;for(const Y of t){const K=(ee=(D=Y.extendedDetails)==null?void 0:D.subSteps)==null?void 0:ee.find(W=>W.id===ae);if(K){const W=(M=K==null?void 0:K.actionItems)==null?void 0:M.find(oe=>oe.id===J);if(W)return W}}},G=ae=>{var J,D,ee,M,Y;switch(ae.type){case"textbox":const K=ae;return x.jsx("textarea",{value:K.content,onChange:W=>F(d.slides[g].id,ae.id,{content:W.target.value}),className:"w-full h-full bg-transparent resize-none border-none outline-none p-2",style:{fontSize:K.fontSize,fontWeight:K.fontWeight,textAlign:K.textAlign,color:"#333"}});case"image":{const W=ae,oe=re(W.subStepId,W.actionItemId),ve=(D=(J=oe==null?void 0:oe.report)==null?void 0:J.attachments)==null?void 0:D.find(Te=>Te.id===W.attachmentId);return ve?x.jsx("img",{src:ve.dataUrl,className:"w-full h-full object-contain",alt:ve.name}):x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:"画像が見つかりません"})}case"table":{const W=ae,oe=re(W.subStepId,W.actionItemId),ve=(ee=oe==null?void 0:oe.report)==null?void 0:ee.matrixData;return ve?x.jsx("div",{className:"p-2 overflow-auto h-full",children:x.jsxs("table",{className:"w-full text-[8px] border-collapse bg-white",children:[x.jsx("thead",{children:x.jsx("tr",{className:"bg-slate-200",children:ve.headers.map((Te,De)=>x.jsx("th",{className:"border border-slate-300 p-1 font-semibold",children:Te},De))})}),x.jsx("tbody",{children:ve.rows.map((Te,De)=>x.jsx("tr",{children:Te.map((Se,Be)=>x.jsx("td",{className:"border border-slate-300 p-1",children:Se},`${De}-${Be}`))},De))})]})}):x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:"データなし"})}case"chart":{const W=ae,oe=re(W.subStepId,W.actionItemId),ve=(((Y=(M=oe==null?void 0:oe.report)==null?void 0:M.matrixData)==null?void 0:Y.rows)||[]).map(Te=>({label:Te[0],value:parseFloat(Te[1])||0})).filter(Te=>Te.label&&!isNaN(Te.value));if(ve.length===0)return x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:"チャートデータなし"});switch(W.chartType){case"line":return x.jsx(WL,{data:ve,title:W.title});case"pie":return x.jsx(YL,{data:ve,title:W.title});case"bar":default:return x.jsx(JL,{data:ve,title:W.title})}}case"flowchart":{const W=ae;return W.data&&W.data.subSteps?x.jsx(XL,{subSteps:W.data.subSteps}):x.jsx("div",{className:"bg-slate-200 flex items-center justify-center text-xs text-slate-500",children:"フローチャートのデータが見つかりません。"})}default:return null}},te=()=>window.print(),_e=(ae,J)=>{const D=JSON.stringify(ae,null,2),ee=new Blob([D],{type:"application/json"}),M=URL.createObjectURL(ee),Y=document.createElement("a");Y.href=M,Y.download=J,document.body.appendChild(Y),Y.click(),document.body.removeChild(Y),URL.revokeObjectURL(M)},Ne=ae=>{ae==="pdf"?te():_e(d,"report-deck.json"),C(!1)},Ee=()=>{n(d),r()},se=d.slides[g],ue=c==="project"?`プロジェクト全体レポート: ${i}`:`タスクレポート: ${t[0].title}`;return x.jsxs(x.Fragment,{children:[x.jsx("style",{children:"@media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } .no-print { display: none !important; } .slide-print-page { page-break-after: always; width: 100vw; height: 56.25vw; /* 16:9 aspect ratio */ box-shadow: none !important; border: none; } }"}),x.jsxs("div",{className:"fixed inset-0 bg-slate-900 bg-opacity-80 z-[100] flex flex-col p-4 no-print",onClick:()=>T(null),children:[x.jsxs("header",{className:"flex items-center justify-between pb-4 flex-shrink-0",children:[x.jsx("h2",{className:"text-xl font-bold text-white truncate pr-4",children:ue}),x.jsxs("div",{className:"flex items-center space-x-2",children:[x.jsxs("button",{onClick:P,disabled:E,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-slate-400",children:[x.jsx(Pd,{className:"w-4 h-4"})," ",E?"処理中...":"レポート再生成"]}),x.jsxs("button",{onClick:X,disabled:E,className:"flex items-center gap-2 px-3 py-1.5 text-xs font-semibold text-white bg-purple-600 rounded-md hover:bg-purple-700 disabled:bg-slate-400",children:[x.jsx(Dp,{className:"w-4 h-4"})," ",E?"処理中...":"AIでレイアウト最適化"]}),x.jsxs("div",{className:"relative",ref:I,children:[x.jsx("button",{onClick:()=>C(ae=>!ae),className:"p-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",title:"ダウンロード",children:x.jsx(dl,{className:"w-5 h-5"})}),A&&x.jsxs("div",{className:"absolute right-0 mt-2 w-32 bg-white rounded-md shadow-lg z-10",children:[x.jsx("button",{onClick:()=>Ne("pdf"),className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"PDFとして保存"}),x.jsx("button",{onClick:()=>Ne("json"),className:"block w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-100",children:"JSONとして保存"})]})]}),x.jsxs("button",{onClick:r,className:"p-2 bg-slate-600 text-white rounded-md hover:bg-slate-500",title:"閉じる",children:[" ",x.jsx(Br,{className:"w-5 h-5"})]}),x.jsx("button",{onClick:Ee,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold text-sm",children:"保存して閉じる"})]})]}),b&&x.jsx("div",{className:"text-red-400 text-sm mb-2 bg-red-100 border border-red-400 p-2 rounded-md",children:b}),x.jsxs("div",{className:"flex-grow flex gap-4 min-h-0",children:[x.jsx("aside",{className:"w-40 bg-slate-800 rounded-lg p-2 flex flex-col gap-2 overflow-y-auto",children:d.slides.map((ae,J)=>x.jsxs("div",{onClick:()=>v(J),className:`relative group aspect-video bg-white rounded cursor-pointer transition-all p-1 ${g===J?"ring-4 ring-blue-500":"hover:ring-2 ring-blue-400"}`,children:[x.jsx("div",{className:"absolute top-1 right-1 z-10 opacity-50 group-hover:opacity-100 transition-opacity",children:x.jsx("button",{onClick:D=>{D.stopPropagation(),j(J)},title:ae.isLocked?"スライドのロック解除":"スライドをロック",className:`p-1 rounded-full ${ae.isLocked?"bg-blue-600 text-white":"bg-slate-500 text-white"}`,children:ae.isLocked?x.jsx(UL,{className:"w-3 h-3"}):x.jsx(BL,{className:"w-3 h-3"})})}),x.jsx("div",{className:"w-full h-full transform scale-[0.1] origin-top-left overflow-hidden relative",children:ae.elements.map(D=>x.jsx("div",{style:{position:"absolute",left:`${D.position.x}%`,top:`${D.position.y}%`,width:`${D.position.width}%`,height:`${D.position.height}%`,backgroundColor:"#ccc"}},D.id))}),x.jsx("span",{className:"text-white text-xs block text-center -mt-2",children:J+1})]},ae.id))}),x.jsx("main",{className:"flex-grow flex items-center justify-center",children:se&&x.jsx("div",{className:"aspect-video w-full max-w-[100vh] bg-white shadow-2xl rounded-lg relative overflow-hidden",children:se.elements.map(ae=>x.jsx(ZL,{el:ae,onUpdate:()=>{},isSelected:_===ae.id,onClick:()=>T(ae.id),children:G(ae)},ae.id))})}),x.jsxs("aside",{className:"w-64 bg-slate-800 rounded-lg p-3 text-white overflow-y-auto",children:[x.jsx("h3",{className:"font-bold border-b border-slate-600 pb-2 mb-3",children:"プロパティ"}),x.jsx("p",{className:"text-xs text-slate-400",children:"要素を選択してプロパティを編集します。"})]})]})]}),x.jsx("div",{className:"hidden print:block",children:d.slides.map((ae,J)=>x.jsx("div",{className:"slide-print-page bg-white relative",children:x.jsx("div",{className:"w-full h-full relative",children:ae.elements.map(D=>x.jsx("div",{style:{position:"absolute",left:`${D.position.x}%`,top:`${D.position.y}%`,width:`${D.position.width}%`,height:`${D.position.height}%`},children:G(D)},D.id))})},ae.id))})]})},QL=({onClose:t,onDownloadAndStartNew:e,onStartNewWithoutSaving:n})=>x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsxs("h3",{className:"text-lg font-bold text-slate-800 flex items-center",children:[x.jsx(Mi,{className:"w-6 h-6 mr-2 text-yellow-500"}),"確認"]}),x.jsx("button",{onClick:t,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",title:"閉じる","aria-label":"確認モーダルを閉じる",children:x.jsx(Br,{className:"w-5 h-5"})})]}),x.jsxs("div",{className:"p-6",children:[x.jsx("p",{className:"text-slate-700",children:"新しいプロジェクトを開始します。現在の作業内容は保存されませんが、よろしいですか？"}),x.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"現在のプロジェクトを保存したい場合は、JSON形式でダウンロードできます。"})]}),x.jsxs("footer",{className:"p-4 bg-slate-50 border-t border-slate-200 flex flex-col sm:flex-row justify-end gap-3 rounded-b-xl",children:[x.jsx("button",{type:"button",onClick:t,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"キャンセル"}),x.jsx("button",{type:"button",onClick:n,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-red-700 bg-red-100 border border-transparent rounded-md shadow-sm hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"保存せずに新規作成"}),x.jsxs("button",{type:"submit",onClick:e,className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center justify-center gap-2",children:[x.jsx(dl,{className:"w-4 h-4"}),"ダウンロードして新規作成"]})]})]})});function eO(t,e){if(t.match(/^[a-z]+:\/\//i))return t;if(t.match(/^\/\//))return window.location.protocol+t;if(t.match(/^[a-z]+:/i))return t;const n=document.implementation.createHTMLDocument(),r=n.createElement("base"),a=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(a),e&&(r.href=e),a.href=t,a.href}const tO=(()=>{let t=0;const e=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(t+=1,`u${e()}${t}`)})();function Qs(t){const e=[];for(let n=0,r=t.length;n<r;n++)e.push(t[n]);return e}let Yo=null;function q2(t={}){return Yo||(t.includeStyleProperties?(Yo=t.includeStyleProperties,Yo):(Yo=Qs(window.getComputedStyle(document.documentElement)),Yo))}function pd(t,e){const r=(t.ownerDocument.defaultView||window).getComputedStyle(t).getPropertyValue(e);return r?parseFloat(r.replace("px","")):0}function nO(t){const e=pd(t,"border-left-width"),n=pd(t,"border-right-width");return t.clientWidth+e+n}function rO(t){const e=pd(t,"border-top-width"),n=pd(t,"border-bottom-width");return t.clientHeight+e+n}function Y2(t,e={}){const n=e.width||nO(t),r=e.height||rO(t);return{width:n,height:r}}function aO(){let t,e;try{e=process}catch{}const n=e&&e.env?e.env.devicePixelRatio:null;return n&&(t=parseInt(n,10),Number.isNaN(t)&&(t=1)),t||window.devicePixelRatio||1}const Lr=16384;function sO(t){(t.width>Lr||t.height>Lr)&&(t.width>Lr&&t.height>Lr?t.width>t.height?(t.height*=Lr/t.width,t.width=Lr):(t.width*=Lr/t.height,t.height=Lr):t.width>Lr?(t.height*=Lr/t.width,t.width=Lr):(t.width*=Lr/t.height,t.height=Lr))}function gd(t){return new Promise((e,n)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>e(r))})},r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=t})}async function iO(t){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(t)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function oO(t,e,n){const r="http://www.w3.org/2000/svg",a=document.createElementNS(r,"svg"),i=document.createElementNS(r,"foreignObject");return a.setAttribute("width",`${e}`),a.setAttribute("height",`${n}`),a.setAttribute("viewBox",`0 0 ${e} ${n}`),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("externalResourcesRequired","true"),a.appendChild(i),i.appendChild(t),iO(a)}const Cr=(t,e)=>{if(t instanceof e)return!0;const n=Object.getPrototypeOf(t);return n===null?!1:n.constructor.name===e.name||Cr(n,e)};function lO(t){const e=t.getPropertyValue("content");return`${t.cssText} content: '${e.replace(/'|"/g,"")}';`}function cO(t,e){return q2(e).map(n=>{const r=t.getPropertyValue(n),a=t.getPropertyPriority(n);return`${n}: ${r}${a?" !important":""};`}).join(" ")}function uO(t,e,n,r){const a=`.${t}:${e}`,i=n.cssText?lO(n):cO(n,r);return document.createTextNode(`${a}{${i}}`)}function aw(t,e,n,r){const a=window.getComputedStyle(t,n),i=a.getPropertyValue("content");if(i===""||i==="none")return;const l=tO();try{e.className=`${e.className} ${l}`}catch{return}const c=document.createElement("style");c.appendChild(uO(l,n,a,r)),e.appendChild(c)}function fO(t,e,n){aw(t,e,":before",n),aw(t,e,":after",n)}const sw="application/font-woff",iw="image/jpeg",dO={woff:sw,woff2:sw,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:iw,jpeg:iw,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function hO(t){const e=/\.([^./]*?)$/g.exec(t);return e?e[1]:""}function Mp(t){const e=hO(t).toLowerCase();return dO[e]||""}function mO(t){return t.split(/,/)[1]}function Zm(t){return t.search(/^(data:)/)!==-1}function pO(t,e){return`data:${e};base64,${t}`}async function W2(t,e,n){const r=await fetch(t,e);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const a=await r.blob();return new Promise((i,l)=>{const c=new FileReader;c.onerror=l,c.onloadend=()=>{try{i(n({res:r,result:c.result}))}catch(d){l(d)}},c.readAsDataURL(a)})}const um={};function gO(t,e,n){let r=t.replace(/\?.*/,"");return n&&(r=t),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),e?`[${e}]${r}`:r}async function Ip(t,e,n){const r=gO(t,e,n.includeQueryParams);if(um[r]!=null)return um[r];n.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+new Date().getTime());let a;try{const i=await W2(t,n.fetchRequestInit,({res:l,result:c})=>(e||(e=l.headers.get("Content-Type")||""),mO(c)));a=pO(i,e)}catch(i){a=n.imagePlaceholder||"";let l=`Failed to fetch resource: ${t}`;i&&(l=typeof i=="string"?i:i.message),l&&console.warn(l)}return um[r]=a,a}async function xO(t){const e=t.toDataURL();return e==="data:,"?t.cloneNode(!1):gd(e)}async function vO(t,e){if(t.currentSrc){const i=document.createElement("canvas"),l=i.getContext("2d");i.width=t.clientWidth,i.height=t.clientHeight,l==null||l.drawImage(t,0,0,i.width,i.height);const c=i.toDataURL();return gd(c)}const n=t.poster,r=Mp(n),a=await Ip(n,r,e);return gd(a)}async function yO(t,e){var n;try{if(!((n=t==null?void 0:t.contentDocument)===null||n===void 0)&&n.body)return await Bd(t.contentDocument.body,e,!0)}catch{}return t.cloneNode(!1)}async function _O(t,e){return Cr(t,HTMLCanvasElement)?xO(t):Cr(t,HTMLVideoElement)?vO(t,e):Cr(t,HTMLIFrameElement)?yO(t,e):t.cloneNode(J2(t))}const wO=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SLOT",J2=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SVG";async function TO(t,e,n){var r,a;if(J2(e))return e;let i=[];return wO(t)&&t.assignedNodes?i=Qs(t.assignedNodes()):Cr(t,HTMLIFrameElement)&&(!((r=t.contentDocument)===null||r===void 0)&&r.body)?i=Qs(t.contentDocument.body.childNodes):i=Qs(((a=t.shadowRoot)!==null&&a!==void 0?a:t).childNodes),i.length===0||Cr(t,HTMLVideoElement)||await i.reduce((l,c)=>l.then(()=>Bd(c,n)).then(d=>{d&&e.appendChild(d)}),Promise.resolve()),e}function EO(t,e,n){const r=e.style;if(!r)return;const a=window.getComputedStyle(t);a.cssText?(r.cssText=a.cssText,r.transformOrigin=a.transformOrigin):q2(n).forEach(i=>{let l=a.getPropertyValue(i);i==="font-size"&&l.endsWith("px")&&(l=`${Math.floor(parseFloat(l.substring(0,l.length-2)))-.1}px`),Cr(t,HTMLIFrameElement)&&i==="display"&&l==="inline"&&(l="block"),i==="d"&&e.getAttribute("d")&&(l=`path(${e.getAttribute("d")})`),r.setProperty(i,l,a.getPropertyPriority(i))})}function SO(t,e){Cr(t,HTMLTextAreaElement)&&(e.innerHTML=t.value),Cr(t,HTMLInputElement)&&e.setAttribute("value",t.value)}function bO(t,e){if(Cr(t,HTMLSelectElement)){const n=e,r=Array.from(n.children).find(a=>t.value===a.getAttribute("value"));r&&r.setAttribute("selected","")}}function CO(t,e,n){return Cr(e,Element)&&(EO(t,e,n),fO(t,e,n),SO(t,e),bO(t,e)),e}async function AO(t,e){const n=t.querySelectorAll?t.querySelectorAll("use"):[];if(n.length===0)return t;const r={};for(let i=0;i<n.length;i++){const c=n[i].getAttribute("xlink:href");if(c){const d=t.querySelector(c),f=document.querySelector(c);!d&&f&&!r[c]&&(r[c]=await Bd(f,e,!0))}}const a=Object.values(r);if(a.length){const i="http://www.w3.org/1999/xhtml",l=document.createElementNS(i,"svg");l.setAttribute("xmlns",i),l.style.position="absolute",l.style.width="0",l.style.height="0",l.style.overflow="hidden",l.style.display="none";const c=document.createElementNS(i,"defs");l.appendChild(c);for(let d=0;d<a.length;d++)c.appendChild(a[d]);t.appendChild(l)}return t}async function Bd(t,e,n){return!n&&e.filter&&!e.filter(t)?null:Promise.resolve(t).then(r=>_O(r,e)).then(r=>TO(t,r,e)).then(r=>CO(t,r,e)).then(r=>AO(r,e))}const K2=/url\((['"]?)([^'"]+?)\1\)/g,kO=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,NO=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function RO(t){const e=t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function DO(t){const e=[];return t.replace(K2,(n,r,a)=>(e.push(a),n)),e.filter(n=>!Zm(n))}async function MO(t,e,n,r,a){try{const i=n?eO(e,n):e,l=Mp(e);let c;return a||(c=await Ip(i,l,r)),t.replace(RO(e),`$1${c}$3`)}catch{}return t}function IO(t,{preferredFontFormat:e}){return e?t.replace(NO,n=>{for(;;){const[r,,a]=kO.exec(n)||[];if(!a)return"";if(a===e)return`src: ${r};`}}):t}function X2(t){return t.search(K2)!==-1}async function Z2(t,e,n){if(!X2(t))return t;const r=IO(t,n);return DO(r).reduce((i,l)=>i.then(c=>MO(c,l,e,n)),Promise.resolve(r))}async function Wo(t,e,n){var r;const a=(r=e.style)===null||r===void 0?void 0:r.getPropertyValue(t);if(a){const i=await Z2(a,null,n);return e.style.setProperty(t,i,e.style.getPropertyPriority(t)),!0}return!1}async function FO(t,e){await Wo("background",t,e)||await Wo("background-image",t,e),await Wo("mask",t,e)||await Wo("-webkit-mask",t,e)||await Wo("mask-image",t,e)||await Wo("-webkit-mask-image",t,e)}async function LO(t,e){const n=Cr(t,HTMLImageElement);if(!(n&&!Zm(t.src))&&!(Cr(t,SVGImageElement)&&!Zm(t.href.baseVal)))return;const r=n?t.src:t.href.baseVal,a=await Ip(r,Mp(r),e);await new Promise((i,l)=>{t.onload=i,t.onerror=e.onImageErrorHandler?(...d)=>{try{i(e.onImageErrorHandler(...d))}catch(f){l(f)}}:l;const c=t;c.decode&&(c.decode=i),c.loading==="lazy"&&(c.loading="eager"),n?(t.srcset="",t.src=a):t.href.baseVal=a})}async function OO(t,e){const r=Qs(t.childNodes).map(a=>Q2(a,e));await Promise.all(r).then(()=>t)}async function Q2(t,e){Cr(t,Element)&&(await FO(t,e),await LO(t,e),await OO(t,e))}function PO(t,e){const{style:n}=t;e.backgroundColor&&(n.backgroundColor=e.backgroundColor),e.width&&(n.width=`${e.width}px`),e.height&&(n.height=`${e.height}px`);const r=e.style;return r!=null&&Object.keys(r).forEach(a=>{n[a]=r[a]}),t}const ow={};async function lw(t){let e=ow[t];if(e!=null)return e;const r=await(await fetch(t)).text();return e={url:t,cssText:r},ow[t]=e,e}async function cw(t,e){let n=t.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,i=(n.match(/url\([^)]+\)/g)||[]).map(async l=>{let c=l.replace(r,"$1");return c.startsWith("https://")||(c=new URL(c,t.url).href),W2(c,e.fetchRequestInit,({result:d})=>(n=n.replace(l,`url(${d})`),[l,d]))});return Promise.all(i).then(()=>n)}function uw(t){if(t==null)return[];const e=[],n=/(\/\*[\s\S]*?\*\/)/gi;let r=t.replace(n,"");const a=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const d=a.exec(r);if(d===null)break;e.push(d[0])}r=r.replace(a,"");const i=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,l="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",c=new RegExp(l,"gi");for(;;){let d=i.exec(r);if(d===null){if(d=c.exec(r),d===null)break;i.lastIndex=c.lastIndex}else c.lastIndex=i.lastIndex;e.push(d[0])}return e}async function UO(t,e){const n=[],r=[];return t.forEach(a=>{if("cssRules"in a)try{Qs(a.cssRules||[]).forEach((i,l)=>{if(i.type===CSSRule.IMPORT_RULE){let c=l+1;const d=i.href,f=lw(d).then(g=>cw(g,e)).then(g=>uw(g).forEach(v=>{try{a.insertRule(v,v.startsWith("@import")?c+=1:a.cssRules.length)}catch(_){console.error("Error inserting rule from remote css",{rule:v,error:_})}})).catch(g=>{console.error("Error loading remote css",g.toString())});r.push(f)}})}catch(i){const l=t.find(c=>c.href==null)||document.styleSheets[0];a.href!=null&&r.push(lw(a.href).then(c=>cw(c,e)).then(c=>uw(c).forEach(d=>{l.insertRule(d,l.cssRules.length)})).catch(c=>{console.error("Error loading remote stylesheet",c)})),console.error("Error inlining remote css file",i)}}),Promise.all(r).then(()=>(t.forEach(a=>{if("cssRules"in a)try{Qs(a.cssRules||[]).forEach(i=>{n.push(i)})}catch(i){console.error(`Error while reading CSS rules from ${a.href}`,i)}}),n))}function BO(t){return t.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>X2(e.style.getPropertyValue("src")))}async function jO(t,e){if(t.ownerDocument==null)throw new Error("Provided element is not within a Document");const n=Qs(t.ownerDocument.styleSheets),r=await UO(n,e);return BO(r)}function eE(t){return t.trim().replace(/["']/g,"")}function VO(t){const e=new Set;function n(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(i=>{e.add(eE(i))}),Array.from(r.children).forEach(i=>{i instanceof HTMLElement&&n(i)})}return n(t),e}async function HO(t,e){const n=await jO(t,e),r=VO(t);return(await Promise.all(n.filter(i=>r.has(eE(i.style.fontFamily))).map(i=>{const l=i.parentStyleSheet?i.parentStyleSheet.href:null;return Z2(i.cssText,l,e)}))).join(`
`)}async function $O(t,e){const n=e.fontEmbedCSS!=null?e.fontEmbedCSS:e.skipFonts?null:await HO(t,e);if(n){const r=document.createElement("style"),a=document.createTextNode(n);r.appendChild(a),t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r)}}async function GO(t,e={}){const{width:n,height:r}=Y2(t,e),a=await Bd(t,e,!0);return await $O(a,e),await Q2(a,e),PO(a,e),await oO(a,n,r)}async function zO(t,e={}){const{width:n,height:r}=Y2(t,e),a=await GO(t,e),i=await gd(a),l=document.createElement("canvas"),c=l.getContext("2d"),d=e.pixelRatio||aO(),f=e.canvasWidth||n,g=e.canvasHeight||r;return l.width=f*d,l.height=g*d,e.skipAutoScale||sO(l),l.style.width=`${f}`,l.style.height=`${g}`,e.backgroundColor&&(c.fillStyle=e.backgroundColor,c.fillRect(0,0,l.width,l.height)),c.drawImage(i,0,0,l.width,l.height),l}async function qO(t,e={}){return(await zO(t,e)).toDataURL()}const Nc=40,fw=64,dw=320,hw=["#3B82F6","#F59E0B","#10B981","#EF4444","#6B7280","#6366F1","#EC4899","#8B5CF6"],YO=({data:t,onClose:e,onItemClick:n,onRegenerate:r,isRegenerating:a})=>{const[i,l]=U.useState(!0),[c,d]=U.useState(new Set),[f,g]=U.useState("all"),v=U.useRef(null),[_,T]=U.useState(!1),[E,S]=U.useState("day"),[b,k]=U.useState({start:"",end:""}),C={day:40,week:15,month:5}[E],I=U.useMemo(()=>{const ae=new Map;return t.filter(J=>J.type==="task").forEach((J,D)=>{ae.set(J.id,hw[D%hw.length])}),ae},[t]),B=U.useCallback((ae,J)=>{if(ae.type==="task")return ae.id;let D=ae;for(;D.parentId;){const ee=J.get(D.parentId);if(!ee)return null;if(ee.type==="task")return ee.id;D=ee}return null},[]),j=U.useMemo(()=>new Map(t.map(ae=>[ae.id,ae])),[t]),F=U.useCallback(ae=>{const J=B(ae,j);return J&&I.get(J)||"#9CA3AF"},[j,I,B]);U.useEffect(()=>{const ae=new Set(t.filter(J=>J.type==="task").map(J=>J.id));d(ae)},[t]);const X=ae=>{d(J=>{const D=new Set(J);return D.has(ae)?D.delete(ae):D.add(ae),D})},P=U.useMemo(()=>{const ae=[];return t.filter(D=>D.type==="task").forEach(D=>{ae.push(D),c.has(D.id)&&t.filter(M=>M.type==="substep"&&M.parentId===D.id).forEach(M=>{if(ae.push(M),c.has(M.id)){const Y=t.filter(K=>{if(K.type!=="actionitem"||K.parentId!==M.id)return!1;if(f==="all")return!0;const W=K.progress===100;return f==="completed"?W:f==="pending"?!W:!0});ae.push(...Y)}})}),ae},[t,c,f]),{timelineStart:re,totalDays:G}=U.useMemo(()=>{if(t.length===0)return{timelineStart:new Date,totalDays:30};const ae=t.map(W=>new Date(W.start)).filter(W=>!isNaN(W.getTime())),J=t.map(W=>new Date(W.end)).filter(W=>!isNaN(W.getTime()));let D,ee;ae.length===0||J.length===0?(D=new Date,ee=new Date,ee.setMonth(ee.getMonth()+1)):(D=new Date(Math.min(...ae.map(W=>W.getTime()))),ee=new Date(Math.max(...J.map(W=>W.getTime()))));let M=b.start?new Date(b.start):D,Y=b.end?new Date(b.end):ee;isNaN(M.getTime())&&(M=D),isNaN(Y.getTime())&&(Y=ee),Y<M&&(Y=M),M.setDate(M.getDate()-2),Y.setDate(Y.getDate()+5);const K=(Y.getTime()-M.getTime())/(1e3*3600*24);return{timelineStart:M,totalDays:Math.ceil(K)}},[t,b]),te=U.useMemo(()=>{const ae=ee=>{ee=new Date(Date.UTC(ee.getFullYear(),ee.getMonth(),ee.getDate())),ee.setUTCDate(ee.getUTCDate()+4-(ee.getUTCDay()||7));const M=new Date(Date.UTC(ee.getUTCFullYear(),0,1));return Math.ceil(((ee.getTime()-M.getTime())/864e5+1)/7)},J=[];let D=new Date(re);if(E==="day")for(let ee=0;ee<G;ee++)J.push({secondaryLabel:D.toLocaleDateString("ja-JP",{weekday:"short"}),label:String(D.getDate()),width:C}),D.setDate(D.getDate()+1);else if(E==="week")for(let ee=0;ee<G;ee++)(D.getDay()===1||J.length===0)&&J.push({label:`W${ae(D)}`,secondaryLabel:D.toLocaleDateString("ja-JP",{month:"short"}),width:0}),J[J.length-1].width+=C,D.setDate(D.getDate()+1);else if(E==="month"){let ee=-1;for(let M=0;M<G;M++){const Y=D.getMonth();Y!==ee&&(ee=Y,J.push({label:D.toLocaleDateString("ja-JP",{month:"long",year:"numeric"}),width:0})),J[J.length-1].width+=C,D.setDate(D.getDate()+1)}}return J},[re,G,E,C]),_e=ae=>{const J=new Date(ae);return isNaN(J.getTime())?-1:(J.getTime()-re.getTime())/(1e3*3600*24)},Ne=ae=>{switch(ae){case"substep":return"pl-5";case"actionitem":return"pl-9";default:return"pl-1"}},Ee=ae=>t.some(J=>J.parentId===ae),se=U.useCallback(()=>{if(v.current===null){alert("チャート要素が見つかりません。");return}T(!0),qO(v.current,{cacheBust:!0,backgroundColor:"#ffffff",width:v.current.scrollWidth,height:v.current.scrollHeight}).then(ae=>{const J=document.createElement("a");J.download="gantt-chart.png",J.href=ae,J.click()}).catch(ae=>{console.error("ガントチャートのダウンロードに失敗しました。",ae),alert("画像のダウンロードに失敗しました。コンソールログを確認してください。")}).finally(()=>{T(!1)})},[]),ue=U.useMemo(()=>te.reduce((ae,J)=>ae+J.width,0),[te]);return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 z-[80]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full h-full flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex flex-wrap items-center justify-between p-4 border-b gap-4",children:[x.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"ガントチャート"}),x.jsxs("div",{className:"flex items-center flex-wrap gap-x-6 gap-y-2",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"text-sm font-medium text-slate-600",children:"表示単位:"}),x.jsx("div",{className:"flex items-center rounded-md bg-slate-100 p-1",children:["day","week","month"].map(ae=>x.jsx("button",{onClick:()=>S(ae),className:`px-3 py-1 text-xs capitalize rounded-md ${E===ae?"bg-white shadow-sm font-semibold text-blue-600":""}`,children:ae},ae))})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("span",{className:"text-sm font-medium text-slate-600",children:"表示範囲:"}),x.jsx("input",{type:"date",value:b.start,onChange:ae=>k(J=>({...J,start:ae.target.value})),className:"p-1 border rounded-md text-sm"}),x.jsx("span",{children:"-"}),x.jsx("input",{type:"date",value:b.end,onChange:ae=>k(J=>({...J,end:ae.target.value})),className:"p-1 border rounded-md text-sm"}),x.jsx("button",{onClick:()=>k({start:"",end:""}),className:"text-xs px-2 py-1 bg-slate-200 rounded-md hover:bg-slate-300",children:"リセット"})]}),x.jsxs("button",{onClick:se,disabled:_,className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-green-600 rounded-md hover:bg-green-700 disabled:bg-slate-400",children:[_?x.jsx(In,{size:"sm",color:"border-white"}):x.jsx(dl,{className:"w-4 h-4"}),"PNG"]}),x.jsxs("button",{onClick:e,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold text-slate-700 bg-slate-100 rounded-md hover:bg-slate-200",children:[x.jsx(Br,{className:"w-5 h-5"}),"閉じる"]})]})]}),x.jsxs("div",{className:"flex-shrink-0 p-4 border-b flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-slate-100 p-1",children:[x.jsx("button",{onClick:()=>g("all"),className:`px-3 py-1 text-xs rounded-full ${f==="all"?"bg-white shadow-sm":""}`,children:"すべて"}),x.jsx("button",{onClick:()=>g("pending"),className:`px-3 py-1 text-xs rounded-full ${f==="pending"?"bg-white shadow-sm":""}`,children:"未完了"}),x.jsx("button",{onClick:()=>g("completed"),className:`px-3 py-1 text-xs rounded-full ${f==="completed"?"bg-white shadow-sm":""}`,children:"完了"})]}),x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsxs("button",{onClick:r,disabled:a,className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:bg-slate-400",children:[a?x.jsx(In,{size:"sm",color:"border-white"}):x.jsx(Pd,{className:"w-4 h-4"}),"AIで再生成"]}),x.jsxs("label",{className:"flex items-center text-sm text-slate-600 cursor-pointer",children:[x.jsx("input",{type:"checkbox",checked:i,onChange:()=>l(ae=>!ae),className:"w-4 h-4 mr-2 accent-blue-600"}),"依存関係"]})]})]}),x.jsx("div",{className:"flex-grow overflow-auto relative",children:x.jsxs("div",{ref:v,className:"grid",style:{gridTemplateColumns:`${dw}px 1fr`,width:`${dw+ue}px`},children:[x.jsx("div",{className:"sticky top-0 left-0 z-30 flex items-center p-2 font-semibold text-sm border-b border-r bg-slate-100 text-slate-800",style:{gridColumn:1,gridRow:1,height:fw},children:"タスク / サブステップ"}),x.jsx("div",{className:"sticky top-0 z-20 border-b bg-slate-50",style:{gridColumn:2,gridRow:1,height:fw},children:x.jsx("div",{className:"flex h-full",children:te.map((ae,J)=>x.jsxs("div",{className:"border-r text-center text-[10px] flex flex-col items-center justify-center",style:{width:ae.width},children:[ae.secondaryLabel&&x.jsx("span",{className:"font-semibold text-slate-600",children:ae.secondaryLabel}),x.jsx("div",{className:`font-bold text-slate-800 ${E==="day"?"text-lg":"text-sm"}`,children:ae.label})]},J))})}),x.jsx("div",{className:"pointer-events-none flex",style:{gridColumn:2,gridRow:`2 / span ${P.length}`},children:te.map((ae,J)=>x.jsx("div",{className:"h-full border-r border-slate-200",style:{width:ae.width}},J))}),P.map((ae,J)=>{const D=F(ae),ee=(()=>{const ve=P[J+1];return ve?B(ae,j)!==B(ve,j):!0})(),M=_e(ae.start),Y=Math.max(.2,_e(ae.end)-M+1),K=M*C,W=Y*C,oe={task:{height:"24px"},substep:{height:"20px"},actionitem:{height:"8px"}};return x.jsxs(cs.Fragment,{children:[x.jsxs("div",{className:"sticky left-0 z-10 flex items-center border-r bg-slate-50",style:{gridColumn:1,gridRow:J+2,height:Nc,borderBottom:ee?`2px solid ${D}`:"1px solid #e5e7eb"},children:[x.jsx("div",{className:"w-1 h-full flex-shrink-0",style:{backgroundColor:D}}),x.jsxs("div",{className:`flex items-center w-full ${Ne(ae.type)}`,children:[(ae.type==="task"||ae.type==="substep")&&(Ee(ae.id)?x.jsx(PL,{onClick:()=>X(ae.id),className:`w-4 h-4 mr-1 text-slate-500 cursor-pointer transition-transform ${c.has(ae.id)?"rotate-0":"-rotate-90"}`}):x.jsx("div",{className:"w-4 h-4 mr-1"})),ae.type==="actionitem"&&(ae.progress===100?x.jsx(xu,{className:"w-3.5 h-3.5 text-green-600 mr-2 flex-shrink-0"}):x.jsx(Od,{className:"w-3.5 h-3.5 text-slate-400 mr-2 flex-shrink-0"})),x.jsx("span",{onClick:()=>n==null?void 0:n(ae),className:`truncate text-xs ${ae.type==="task"?"font-semibold text-slate-800":"text-slate-600"} ${n?"cursor-pointer hover:text-blue-600":""}`,title:ae.name,children:ae.name})]})]}),x.jsx("div",{className:"relative",style:{gridColumn:2,gridRow:J+2,borderBottom:ee?`2px solid ${D}`:"1px solid #e5e7eb"},children:M>=0&&x.jsx("div",{title:`${ae.name} (${ae.progress}%)`,onClick:()=>n==null?void 0:n(ae),className:"absolute h-full flex items-center group",style:{left:K,width:W,cursor:n?"pointer":"default"},children:x.jsx("div",{className:"w-full rounded",style:{...oe[ae.type],backgroundColor:D},children:x.jsx("div",{className:"bg-black bg-opacity-30 h-full rounded",style:{width:`${ae.progress}%`}})})})})]},ae.id)}),x.jsx("div",{style:{gridColumn:2,gridRow:`2 / span ${P.length}`,position:"relative",pointerEvents:"none"},children:i&&x.jsx(WO,{items:P,getDaysFromStart:_e,dayWidth:C})})]})})]})})},WO=({items:t,getDaysFromStart:e,dayWidth:n})=>{const r=U.useMemo(()=>{const a=[],i=new Map(t.map((l,c)=>[l.id,c]));return t.forEach((l,c)=>{(l.dependencies||[]).forEach(d=>{const f=i.get(d),g=f!==void 0?t[f]:void 0;if(g&&f!==void 0){const v=e(g.end),_=e(l.start);if(v<0||_<0)return;const T=(v+1)*n,E=f*Nc+Nc/2,S=_*n,b=c*Nc+Nc/2,k=T+20,A=S-20,C=`M ${T} ${E} C ${k} ${E}, ${A} ${b}, ${S} ${b}`;a.push({key:`${d}-${l.id}`,d:C})}})}),a},[t,e,n]);return x.jsxs("svg",{className:"absolute top-0 left-0 w-full h-full pointer-events-none",overflow:"visible",children:[x.jsx("defs",{children:x.jsx("marker",{id:"gantt_arrowhead",markerWidth:"5",markerHeight:"4",refX:"5",refY:"2",orient:"auto",children:x.jsx("polygon",{points:"0 0, 5 2, 0 4",fill:"#4b5563"})})}),r.map(a=>x.jsx("path",{d:a.d,stroke:"#4b5563",strokeWidth:"1",fill:"none",markerEnd:"url(#gantt_arrowhead)"},a.key))]})},JO=({tasks:t,projectGoal:e,targetDate:n,ganttData:r,projectReportDeck:a,onClose:i,onReportGenerated:l,generateUniqueId:c})=>{const[d,f]=U.useState("list"),[g,v]=U.useState(new Set),[_,T]=U.useState(""),[E,S]=U.useState(!1),[b,k]=U.useState(null),[A,C]=U.useState({key:"taskName",direction:"ascending"}),[I,B]=U.useState("slides"),[j,F]=U.useState(null),X=U.useMemo(()=>{const D=[];return r&&D.push({id:"gantt-chart-main",name:"プロジェクト ガントチャート",type:"Gantt Chart",taskName:"プロジェクト全体",subStepName:"",actionItemName:"",source:{name:"プロジェクト ガントチャート",type:"json",content:r}}),a&&D.push({id:"project-report-main",name:"プロジェクトレポート",type:"Project Report",taskName:"プロジェクト全体",subStepName:"",actionItemName:"",source:{name:"プロジェクトレポート",type:"json",content:a}}),t.forEach(ee=>{var M,Y,K,W,oe;(M=ee.extendedDetails)!=null&&M.reportDeck&&D.push({id:`task-report-${ee.id}`,name:`タスクレポート: ${ee.title}`,type:"Task Report",taskName:ee.title,subStepName:"",actionItemName:"",source:{name:`タスクレポート: ${ee.title}`,type:"json",content:ee.extendedDetails.reportDeck}}),(K=(Y=ee.extendedDetails)==null?void 0:Y.attachments)==null||K.forEach(ve=>{D.push({id:ve.id,name:ve.name,type:"Attachment",taskName:ee.title,subStepName:"",actionItemName:"",source:{name:ve.name,type:ve.type.startsWith("image/")?"image":"text",content:ve.dataUrl,dataUrl:ve.dataUrl}})}),(oe=(W=ee.extendedDetails)==null?void 0:W.subSteps)==null||oe.forEach(ve=>{var Te,De;(Te=ve.attachments)==null||Te.forEach(Se=>{D.push({id:Se.id,name:Se.name,type:"Attachment",taskName:ee.title,subStepName:ve.text,actionItemName:"",source:{name:Se.name,type:Se.type.startsWith("image/")?"image":"text",content:Se.dataUrl,dataUrl:Se.dataUrl}})}),(De=ve.actionItems)==null||De.forEach(Se=>{var Be,Z,dt;(Z=(Be=Se.report)==null?void 0:Be.attachments)==null||Z.forEach(Ke=>{D.push({id:Ke.id,name:Ke.name,type:"Attachment",taskName:ee.title,subStepName:ve.text,actionItemName:Se.text,source:{name:Ke.name,type:Ke.type.startsWith("image/")?"image":"text",content:Ke.dataUrl,dataUrl:Ke.dataUrl}})}),(dt=Se.report)!=null&&dt.matrixData&&D.push({id:`matrix-${Se.id}`,name:`データマトリクス: ${Se.text}`,type:"Data Matrix",taskName:ee.title,subStepName:ve.text,actionItemName:Se.text,source:{name:`データマトリクス: ${Se.text}`,type:"json",content:Se.report.matrixData}})})})}),D},[t,r,a]),P=U.useMemo(()=>{let D=[...X];return A!==null&&D.sort((ee,M)=>{const Y=(ee[A.key]||"").toLowerCase(),K=(M[A.key]||"").toLowerCase();return Y<K?A.direction==="ascending"?-1:1:Y>K?A.direction==="ascending"?1:-1:0}),D},[X,A]),re=D=>{let ee="ascending";A&&A.key===D&&A.direction==="ascending"&&(ee="descending"),C({key:D,direction:ee})},G=D=>!A||A.key!==D?x.jsx(Vi,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):A.direction==="ascending"?x.jsx(Zc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(Vi,{className:"w-3 h-3 ml-1 text-blue-600"}),te=D=>{v(ee=>{const M=new Set(ee);return M.has(D)?M.delete(D):M.add(D),M})},_e=()=>{g.size===X.length?v(new Set):v(new Set(X.map(D=>D.id)))},Ne=async()=>{if(g.size===0){k("レポート生成には、少なくとも1つの資料を選択してください。");return}if(!_.trim()){k("レポートの目的をプロンプトに入力してください。");return}S(!0),k(null),F(null);const D=X.filter(ee=>g.has(ee.id)).map(ee=>ee.source);try{if(I==="slides"){const ee=await O2(D,_);l(ee)}else{const ee=await AL(D,_);F(ee)}}catch(ee){k(ee instanceof Error?ee.message:"カスタムレポートの生成に失敗しました。")}finally{S(!1)}},Ee=D=>{switch(D){case"Gantt Chart":return x.jsx(G2,{className:"w-5 h-5 text-amber-600"});case"Project Report":case"Task Report":return x.jsx(j2,{className:"w-5 h-5 text-teal-600"});case"Attachment":return x.jsx(Zs,{className:"w-5 h-5 text-slate-600"});case"Data Matrix":return x.jsx(vu,{className:"w-5 h-5 text-purple-600"});default:return x.jsx(ji,{className:"w-5 h-5 text-slate-500"})}},se=D=>{if(D.dataUrl)return D.dataUrl;if(D.type==="json")try{const ee=JSON.stringify(D.content,null,2),M=new Blob([ee],{type:"application/json"});return URL.createObjectURL(M)}catch{return}},ue=U.useMemo(()=>X.filter(D=>g.has(D.id)),[g,X]),ae=()=>x.jsxs(x.Fragment,{children:[x.jsx("main",{className:"flex-grow p-4 overflow-y-auto",children:x.jsxs("table",{className:"w-full min-w-[1000px] border-collapse text-sm",children:[x.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:x.jsxs("tr",{children:[x.jsx("th",{className:"p-2 border border-slate-300 w-10 text-center",children:x.jsx("input",{type:"checkbox",checked:g.size===X.length&&X.length>0,onChange:_e,className:"w-4 h-4 accent-blue-600"})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>re("name"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:"資料名"}),G("name")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-40",children:x.jsxs("button",{onClick:()=>re("type"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:"種類"}),G("type")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>re("taskName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:"タスク"}),G("taskName")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>re("subStepName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:"サブステップ"}),G("subStepName")]})}),x.jsx("th",{className:"p-0 border border-slate-300 w-1/4",children:x.jsxs("button",{onClick:()=>re("actionItemName"),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50",children:[x.jsx("span",{children:"アクション"}),G("actionItemName")]})})]})}),x.jsx("tbody",{children:P.map(D=>{const ee=se(D.source);return x.jsxs("tr",{className:"bg-white hover:bg-slate-50 transition-colors",children:[x.jsx("td",{className:"border border-slate-300 align-middle text-center p-2",children:x.jsx("input",{type:"checkbox",checked:g.has(D.id),onChange:()=>te(D.id),className:"w-4 h-4 accent-blue-600"})}),x.jsx("td",{className:"border border-slate-300 p-2 font-medium text-slate-800",children:ee?x.jsx("a",{href:ee,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:D.name}):x.jsx("span",{children:D.name})}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600",children:x.jsxs("div",{className:"flex items-center gap-2",children:[Ee(D.type),x.jsx("span",{children:D.type})]})}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:D.taskName}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:D.subStepName}),x.jsx("td",{className:"border border-slate-300 p-2 text-slate-600 truncate",children:D.actionItemName})]},D.id)})})]})}),x.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-between items-center rounded-b-xl",children:[x.jsxs("span",{className:"text-sm text-slate-600",children:[g.size," / ",X.length," 件の資料を選択中"]}),x.jsx("button",{onClick:()=>f("generate"),disabled:g.size===0,className:"px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 disabled:bg-slate-400 disabled:cursor-not-allowed",children:"レポート生成へ"})]})]}),J=()=>x.jsxs(x.Fragment,{children:[x.jsxs("main",{className:"flex-grow p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:[x.jsxs("div",{children:[x.jsxs("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:["選択した資料 (",ue.length,"件)"]}),x.jsx("div",{className:"bg-slate-50 border rounded-lg p-3 max-h-96 overflow-y-auto space-y-2",children:ue.map(D=>x.jsxs("div",{className:"text-sm text-slate-700 flex items-center gap-2",children:[Ee(D.type),x.jsx("span",{className:"truncate",title:D.name,children:D.name})]},D.id))}),x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mt-6 mb-2",children:"レポート形式"}),x.jsxs("div",{className:"flex gap-4",children:[x.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg cursor-pointer flex-1 hover:bg-slate-50",children:[x.jsx("input",{type:"radio",name:"reportFormat",value:"slides",checked:I==="slides",onChange:()=>B("slides"),className:"w-4 h-4 accent-blue-600"}),"スライド形式"]}),x.jsxs("label",{className:"flex items-center gap-2 p-3 border rounded-lg cursor-pointer flex-1 hover:bg-slate-50",children:[x.jsx("input",{type:"radio",name:"reportFormat",value:"text",checked:I==="text",onChange:()=>B("text"),className:"w-4 h-4 accent-blue-600"}),"テキスト形式"]})]})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-2",children:"レポート作成の目的"}),x.jsx("textarea",{value:_,onChange:D=>T(D.target.value),placeholder:"例：これらの資料からプロジェクトの進捗状況をまとめ、経営層向けの報告スライドを作成してください。",rows:6,className:"w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-sm"}),b&&x.jsx("div",{className:"mt-2",children:x.jsx(Ji,{message:b})}),j&&x.jsxs("div",{className:"mt-4 p-4 border rounded-lg bg-slate-50",children:[x.jsx("h5",{className:"font-semibold text-md text-slate-800 mb-2",children:"生成されたテキストレポート"}),x.jsx("pre",{className:"text-sm text-slate-700 bg-white p-3 rounded whitespace-pre-wrap max-h-60 overflow-y-auto",children:j}),x.jsx("button",{onClick:()=>navigator.clipboard.writeText(j),className:"text-xs mt-2 px-2 py-1 bg-slate-200 rounded",children:"クリップボードにコピー"})]})]})]}),x.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-between items-center rounded-b-xl",children:[x.jsxs("button",{onClick:()=>{f("list"),F(null)},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md shadow-sm hover:bg-slate-200",children:[x.jsx(P2,{className:"w-4 h-4"}),"資料選択に戻る"]}),x.jsxs("button",{onClick:Ne,disabled:E,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 disabled:bg-slate-400",children:[E?x.jsx(In,{size:"sm",color:"border-white"}):x.jsx(Tl,{className:"w-5 h-5"}),x.jsx("span",{children:E?"生成中...":"レポートを生成"})]})]})]});return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 sm:p-6 md:p-8 z-[70]",children:x.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full h-full flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[x.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-3",children:[x.jsx(ji,{className:"w-7 h-7 text-blue-600"}),x.jsx("span",{children:"資料センター"})]}),x.jsx("button",{onClick:i,className:"p-1.5 rounded-full hover:bg-slate-100",children:x.jsx(Br,{className:"w-6 h-6 text-slate-500"})})]}),d==="list"?ae():J()]})})},KO=({tasks:t,projectGoal:e,targetDate:n,onSelectTask:r,onUpdateTaskExtendedDetails:a,onUpdateTaskPosition:i,onUpdateTaskStatus:l,onStartNewProject:c,onExportProject:d,onAddTask:f,onRemoveTask:g,onImportSingleTask:v,onAutoLayout:_,onUndo:T,canUndo:E,onRedo:S,canRedo:b,generateUniqueId:k,onUpdateTaskConnections:A,ganttData:C,setGanttData:I,onCustomReportGenerated:B,onClearApiKey:j,onOpenProjectList:F,onLogout:X,currentProjectId:P,onSaveProject:re,projectMembers:G=[],userRole:te="viewer",onMembersUpdate:_e=()=>{}})=>{U.useRef(null);const Ne=U.useRef(null),[Ee,se]=U.useState(new Map),[ue,ae]=U.useState([]),J=U.useRef(null),D=U.useRef({x:0,y:0}),[ee,M]=U.useState(!1),[Y,K]=U.useState(!1),[W,oe]=U.useState(null),[ve,Te]=U.useState(!1),[De,Se]=U.useState(null),[Be,Z]=U.useState(!1),[dt,Ke]=U.useState(null),[xt,nt]=U.useState(!1),[Ie,Bt]=U.useState(null),[an,sn]=U.useState(!1),[un,On]=U.useState(!1),[vt,tn]=U.useState(null),[zn,yn]=U.useState(!1),[Qt,Mt]=U.useState(!1),[it,tt]=U.useState(!1),[St,on]=U.useState(null),[jt,Pn]=U.useState({x:0,y:0}),[Oe,We]=U.useState(!1);U.useEffect(()=>{const R=new Map;t.forEach(V=>{R.set(V.id,Ee.get(V.id)||U.createRef())}),se(R)},[t]);const Ge=U.useCallback(()=>{if(!Ne.current||Ee.size===0){ae([]);return}const R=[];t.forEach(V=>{var O,H;if(V.nextTaskIds&&V.nextTaskIds.length>0){const z=Ee.get(V.id),q=z==null?void 0:z.current;if(!q)return;const fe=((O=V.position)==null?void 0:O.x)||0,ye=((H=V.position)==null?void 0:H.y)||0,le=q.getBoundingClientRect(),he={x:fe+le.width,y:ye+le.height/2};V.nextTaskIds.forEach(pe=>{var Pe,Ve;const Re=t.find(lt=>lt.id===pe);if(!Re)return;const Fe=Ee.get(pe),Ue=Fe==null?void 0:Fe.current;if(!Ue)return;const Me=((Pe=Re.position)==null?void 0:Pe.x)||0,Q=((Ve=Re.position)==null?void 0:Ve.y)||0,we=Ue.getBoundingClientRect(),Ae={x:Me,y:Q+we.height/2};R.push({id:`conn-${V.id}-${pe}`,from:he,to:Ae,sourceId:V.id,targetId:pe})})}}),ae(R)},[t,Ee]);U.useEffect(()=>{const R=setTimeout(Ge,50);return()=>clearTimeout(R)},[Ge,t]),U.useEffect(()=>{window.addEventListener("resize",Ge);const R=new MutationObserver(Ge);return Ne.current&&R.observe(Ne.current,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),()=>{window.removeEventListener("resize",Ge),R.disconnect()}},[Ge]);const Ze=(R,V)=>{var H,z;J.current=V;const O=t.find(q=>q.id===V);if(Ne.current){const q=Ne.current.getBoundingClientRect();D.current.x=R.clientX-q.left-(((H=O==null?void 0:O.position)==null?void 0:H.x)||0),D.current.y=R.clientY-q.top-(((z=O==null?void 0:O.position)==null?void 0:z.y)||0)}R.dataTransfer.effectAllowed="move"},pt=R=>{R.preventDefault(),R.dataTransfer.dropEffect="move"},Zn=R=>{var he;if(R.preventDefault(),!J.current||!Ne.current)return;const V=Ne.current.getBoundingClientRect(),O=(he=Ee.get(J.current))==null?void 0:he.current,H=(O==null?void 0:O.offsetWidth)||380,z=(O==null?void 0:O.offsetHeight)||280;let q=R.clientX-V.left-D.current.x,fe=R.clientY-V.top-D.current.y;const ye=Ne.current.scrollWidth,le=Ne.current.scrollHeight;q=Math.max(0,Math.min(q,ye-H)),fe=Math.max(0,Math.min(fe,le-z)),i(J.current,{x:q,y:fe}),J.current=null,setTimeout(Ge,0)},jr=async()=>{Te(!0),Se(null);try{const R=await EL(t,e,n);oe(R),K(!0)}catch(R){Se(R instanceof Error?R.message:"プロジェクト診断レポートの生成に失敗しました。")}finally{Te(!1)}},ra=async()=>{if(dt){Z(!0);return}nt(!0),Bt(null);try{const R=await SL(t,e,n);Ke(R),Z(!0)}catch(R){Bt(R instanceof Error?R.message:"プロジェクトレポートの生成に失敗しました。")}finally{nt(!1)}},_a=async()=>{if(C){sn(!0);return}On(!0),tn(null);try{const R=await tw(t,e,n);I(R),sn(!0)}catch(R){tn(R instanceof Error?R.message:"ガントチャートのデータ生成に失敗しました。")}finally{On(!1)}},gs=async()=>{On(!0),tn(null);try{const R=await tw(t,e,n);I(R)}catch(R){tn(R instanceof Error?R.message:"ガントチャートのデータ再生成に失敗しました。")}finally{On(!1)}},xs=async()=>{if(P){We(!0);try{await re(),alert("プロジェクトが保存されました！")}catch(R){alert("プロジェクトの保存に失敗しました: "+(R instanceof Error?R.message:"不明なエラー"))}finally{We(!1)}}else{const R=prompt("プロジェクト名を入力してください:",`${e.substring(0,50)}...`);if(!R)return;We(!0);try{const V=await rr.createProject(R,e,n,t,C);alert("プロジェクトが保存されました！"),_e()}catch(V){alert("プロジェクトの保存に失敗しました: "+(V instanceof Error?V.message:"不明なエラー"))}finally{We(!1)}}},Va=(R,V)=>{if(!Ne.current)return;const O=Ne.current.getBoundingClientRect(),H={x:V.clientX-O.left+Ne.current.scrollLeft,y:V.clientY-O.top+Ne.current.scrollTop};on({fromId:R,fromPos:H})},Ha=R=>{if(!St||St.fromId===R){on(null);return}const V=t.find(O=>O.id===St.fromId);if(V){const O=Array.from(new Set([...V.nextTaskIds||[],R]));A(V.id,O)}on(null)},vs=(R,V)=>{const O=t.find(H=>H.id===R);if(O){const H=(O.nextTaskIds||[]).filter(z=>z!==V);A(O.id,H)}},ii=R=>{if(!St||!Ne.current)return;const V=Ne.current.getBoundingClientRect();Pn({x:R.clientX-V.left+Ne.current.scrollLeft,y:R.clientY-V.top+Ne.current.scrollTop})},yr=()=>{St&&on(null)},fn=R=>{const V=R.type==="task"?R.id:R.parentId;if(!V)return;const O=t.find(H=>H.id===V);O&&(sn(!1),r(O))},dn=R=>{B(R),Mt(!1)},Vr=n?new Date(n+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"}):"未設定",yt=te==="owner"||te==="editor",ys=te==="owner"||te==="editor";return Be&&dt?x.jsx(z2,{tasks:t,initialDeck:dt,onSave:R=>Ke(R),onClose:()=>Z(!1),projectGoal:e,targetDate:n,reportScope:"project",generateUniqueId:k}):x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"min-h-screen bg-slate-100 p-4 md:p-6 flex flex-col overflow-hidden",children:[x.jsxs("div",{className:"max-w-full mx-auto w-full",children:[x.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[x.jsxs("button",{onClick:()=>yn(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-slate-600 hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500 transition-transform hover:scale-105",children:[x.jsx(Bi,{className:"w-5 h-5 mr-2"}),"新規プロジェクト"]}),x.jsxs("div",{className:"flex flex-wrap gap-2",children:[at&&x.jsx("button",{onClick:F,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",title:"保存済みプロジェクト",children:x.jsx(ji,{className:"w-5 h-5"})}),at&&x.jsx("button",{onClick:xs,disabled:Oe,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 disabled:bg-slate-400",title:"プロジェクトを保存",children:Oe?x.jsx(In,{size:"sm",color:"border-white"}):x.jsx(dl,{className:"w-5 h-5"})}),x.jsx("button",{onClick:T,disabled:!E,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 disabled:bg-slate-300 disabled:cursor-not-allowed",title:"元に戻す",children:x.jsx(V2,{className:"w-5 h-5"})}),x.jsx("button",{onClick:S,disabled:!b,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400 disabled:bg-slate-300 disabled:cursor-not-allowed",title:"やり直し",children:x.jsx(H2,{className:"w-5 h-5"})}),x.jsx("button",{onClick:j,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-white hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-400",title:"APIキーを変更",children:x.jsx(Qc,{className:"w-5 h-5 text-yellow-600"})}),x.jsx("button",{onClick:X,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700",title:"ログアウト",children:x.jsx(Qc,{className:"w-5 h-5"})}),x.jsxs("button",{onClick:f,disabled:!yt,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700",title:yt?"":"編集権限が必要です",children:[x.jsx(Rp,{className:"w-5 h-5 mr-2"}),"タスク追加"]}),x.jsxs("button",{onClick:d,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700",children:[x.jsx(dl,{className:"w-5 h-5 mr-2"}),"JSONエクスポート"]}),x.jsxs("button",{onClick:_,disabled:!yt,className:"inline-flex items-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",title:"自動整列",title:yt?"自動整列":"編集権限が必要です",children:[x.jsx(Pd,{className:"w-5 h-5 mr-2"}),"整列"]})]})]}),x.jsxs("header",{className:"mb-6 p-6 bg-white rounded-xl shadow-lg",children:[x.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-4",children:[x.jsxs("div",{children:[x.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-3",children:"プロジェクトフロー"}),x.jsxs("div",{className:"space-y-2 text-slate-700",children:[x.jsxs("p",{className:"flex items-start",children:[x.jsx(Np,{className:"w-5 h-5 mr-2 text-blue-600 flex-shrink-0 mt-1"}),x.jsx("strong",{children:"目的:"})," ",x.jsx("span",{className:"break-all",children:e})]}),x.jsxs("p",{className:"flex items-center",children:[x.jsx(kp,{className:"w-5 h-5 mr-2 text-blue-600 flex-shrink-0"}),x.jsx("strong",{children:"目標日:"})," ",Vr]}),P&&x.jsx("p",{className:"text-sm text-green-600",children:"✓ Supabaseに保存済み"}),G.length>1&&x.jsxs("div",{className:"flex items-center text-sm text-slate-600 mt-2",children:[x.jsx(md,{className:"w-4 h-4 mr-1"}),x.jsxs("span",{children:[G.length,"人のメンバー"]}),x.jsx("span",{className:"mx-2",children:"•"}),x.jsxs("span",{children:["あなたの役割: ",te==="owner"?"オーナー":te==="editor"?"編集者":"閲覧者"]})]})]})]}),x.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 flex-shrink-0",children:[at&&ys&&P&&x.jsxs("button",{onClick:()=>tt(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[x.jsx(md,{className:"w-5 h-5 mr-2"}),"メンバー管理"]}),x.jsxs("button",{onClick:()=>M(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[x.jsx($2,{className:"w-5 h-5 mr-2"}),"アクションアイテム一覧"]}),x.jsxs("button",{onClick:()=>Mt(!0),className:"inline-flex items-center justify-center px-4 py-2 border border-slate-300 text-sm font-medium rounded-md shadow-sm text-slate-700 bg-white hover:bg-slate-50",children:[x.jsx(ji,{className:"w-5 h-5 mr-2"}),"資料センター"]}),x.jsxs("button",{onClick:_a,disabled:un,className:"inline-flex items-center justify-center px-4 py-2 border border-amber-300 text-sm font-medium rounded-md shadow-sm text-amber-800 bg-amber-100 hover:bg-amber-200 disabled:bg-slate-400",children:[un?x.jsx(In,{size:"sm"}):x.jsx(G2,{className:"w-5 h-5 mr-2"}),"ガントチャート"]}),x.jsxs("button",{onClick:jr,disabled:ve,title:yt?"":"編集権限が必要です",className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 disabled:bg-slate-400",children:[ve?x.jsx(In,{size:"sm"}):x.jsx(Tl,{className:"w-5 h-5 mr-2"}),"AIプロジェクト診断"]}),x.jsxs("button",{onClick:ra,disabled:xt,title:yt?"":"編集権限が必要です",className:"inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-teal-600 hover:bg-teal-700 disabled:bg-slate-400",children:[xt?x.jsx(In,{size:"sm"}):x.jsx(j2,{className:"w-5 h-5 mr-2"}),"プロジェクトレポート作成"]})]})]}),De&&x.jsx("div",{className:"mt-4",children:x.jsx("p",{className:"text-red-600 text-sm",children:De})}),Ie&&x.jsx("div",{className:"mt-4",children:x.jsx("p",{className:"text-red-600 text-sm",children:Ie})}),vt&&x.jsx("div",{className:"mt-4",children:x.jsx("p",{className:"text-red-600 text-sm",children:vt})})]})]}),x.jsxs("div",{ref:Ne,className:"flex-grow overflow-auto pb-8 relative min-h-[600px] border border-slate-300 rounded-lg bg-slate-50 p-4 shadow-inner",onDragOver:pt,onDrop:Zn,onMouseMove:ii,onMouseUp:yr,children:[x.jsxs("div",{className:"relative w-full h-full min-w-[1200px] min-h-[800px]",children:[t.map((R,V)=>x.jsx($L,{cardRef:Ee.get(R.id),task:R,onSelectTask:r,onRemoveTask:g,onUpdateStatus:l,onDragCardStart:Ze,onStartConnection:Va,onEndConnection:Ha,index:V,canEdit:yt},R.id)),ue.map(R=>x.jsx(eu,{from:R.from,to:R.to,id:R.id,onDelete:()=>vs(R.sourceId,R.targetId)},R.id)),St&&x.jsx(eu,{from:St.fromPos,to:jt,id:"preview-connector"})]}),t.length===0&&x.jsx("div",{className:"text-center py-10 flex-grow flex items-center justify-center",children:x.jsx("p",{className:"text-slate-500 text-lg",children:"タスクがありません。「タスク追加」ボタンで最初のタスクを作成しましょう。"})})]})]}),an&&C&&x.jsx(YO,{data:C,onClose:()=>sn(!1),onItemClick:fn,onRegenerate:gs,isRegenerating:un}),Qt&&x.jsx(JO,{tasks:t,projectGoal:e,targetDate:n,ganttData:C,projectReportDeck:dt,onClose:()=>Mt(!1),onReportGenerated:dn,generateUniqueId:k}),ee&&x.jsx(GL,{tasks:t,onClose:()=>M(!1)}),Y&&x.jsx(zL,{report:W,onClose:()=>K(!1)}),zn&&x.jsx(QL,{onClose:()=>yn(!1),onDownloadAndStartNew:()=>{d(),c()},onStartNewWithoutSaving:c}),it&&P&&x.jsx(qL,{isOpen:it,onClose:()=>tt(!1),projectId:P,projectTitle:e,members:G,userRole:te,onMembersUpdate:_e})]})},XO=({proposals:t,existingSubSteps:e,onConfirm:n,onClose:r})=>{const[a,i]=U.useState(()=>{const d={};return t.forEach((f,g)=>{d[g]={decision:"NEW",targetSubStepId:void 0}}),d}),l=(d,f,g)=>{i(v=>({...v,[d]:{...v[d],[f]:g}}))},c=()=>{const d=[],f=[];Object.entries(a).forEach(([g,v])=>{const _=parseInt(g,10),T=t[_];v.decision==="NEW"?d.push(T):v.decision==="ADD"&&v.targetSubStepId&&f.push({targetSubStepId:v.targetSubStepId,title:T.title})}),n({newSubSteps:d,newActionItems:f})};return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[60]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"AIによる計画提案のレビュー"}),x.jsx("button",{onClick:r,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(Br,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("div",{className:"flex-grow p-5 overflow-y-auto space-y-4",children:[x.jsx("p",{className:"text-sm text-slate-600",children:"AIが以下のステップを提案しました。計画に追加する項目と方法を選択してください。"}),x.jsx("div",{className:"space-y-3",children:t.map((d,f)=>x.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[x.jsx("p",{className:"font-semibold text-slate-800",children:d.title}),x.jsx("p",{className:"text-sm text-slate-600 mb-3",children:d.description}),x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsxs("select",{value:a[f].decision,onChange:g=>l(f,"decision",g.target.value),className:"p-2 border border-slate-300 rounded-md text-sm",children:[x.jsx("option",{value:"NEW",children:"新しいサブステップとして追加"}),e.length>0&&x.jsx("option",{value:"ADD",children:"既存のサブステップに追加"}),x.jsx("option",{value:"IGNORE",children:"無視する"})]}),a[f].decision==="ADD"&&x.jsxs("select",{value:a[f].targetSubStepId||"",onChange:g=>l(f,"targetSubStepId",g.target.value),className:"flex-grow p-2 border border-slate-300 rounded-md text-sm",children:[x.jsx("option",{value:"",disabled:!0,children:"追加先のサブステップを選択..."}),e.map(g=>x.jsx("option",{value:g.id,children:g.text},g.id))]})]})]},f))})]}),x.jsxs("footer",{className:"p-5 bg-slate-100 border-t flex justify-end gap-3",children:[x.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:"キャンセル"}),x.jsx("button",{onClick:c,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:"選択を計画に反映"})]})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var tE=1252,ZO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Fp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Lp=function(t){ZO.indexOf(t)!=-1&&(tE=Fp[0]=t)};function QO(){Lp(1252)}var ma=function(t){Lp(t)};function nE(){ma(1200),QO()}function mw(t){for(var e=[],n=0,r=t.length;n<r;++n)e[n]=t.charCodeAt(n);return e}function eP(t){for(var e=[],n=0;n<t.length>>1;++n)e[n]=String.fromCharCode(t.charCodeAt(2*n)+(t.charCodeAt(2*n+1)<<8));return e.join("")}function rE(t){for(var e=[],n=0;n<t.length>>1;++n)e[n]=String.fromCharCode(t.charCodeAt(2*n+1)+(t.charCodeAt(2*n)<<8));return e.join("")}var Rc=function(t){var e=t.charCodeAt(0),n=t.charCodeAt(1);return e==255&&n==254?eP(t.slice(2)):e==254&&n==255?rE(t.slice(2)):e==65279?t.slice(1):t},$f=function(e){return String.fromCharCode(e)},pw=function(e){return String.fromCharCode(e)},tu,Js="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function gw(t){for(var e="",n=0,r=0,a=0,i=0,l=0,c=0,d=0,f=0;f<t.length;)n=t.charCodeAt(f++),i=n>>2,r=t.charCodeAt(f++),l=(n&3)<<4|r>>4,a=t.charCodeAt(f++),c=(r&15)<<2|a>>6,d=a&63,isNaN(r)?c=d=64:isNaN(a)&&(d=64),e+=Js.charAt(i)+Js.charAt(l)+Js.charAt(c)+Js.charAt(d);return e}function Ur(t){var e="",n=0,r=0,a=0,i=0,l=0,c=0,d=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<t.length;)i=Js.indexOf(t.charAt(f++)),l=Js.indexOf(t.charAt(f++)),n=i<<2|l>>4,e+=String.fromCharCode(n),c=Js.indexOf(t.charAt(f++)),r=(l&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(r)),d=Js.indexOf(t.charAt(f++)),a=(c&3)<<6|d,d!==64&&(e+=String.fromCharCode(a));return e}var Ct=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ki=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,n){return n?new Buffer(e,n):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function ni(t){return Ct?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function xw(t){return Ct?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var ha=function(e){return Ct?Ki(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)&255})};function Xi(t){if(Array.isArray(t))return t.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],n=0;n<t.length;++n)e[n]=String.fromCharCode(t[n]);return e.join("")}function Op(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Op(new Uint8Array(t));for(var e=new Array(t.length),n=0;n<t.length;++n)e[n]=t[n];return e}var Ws=Ct?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Ki(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,n=0;for(e=0;e<t.length;++e)n+=t[e].length;var r=new Uint8Array(n),a=0;for(e=0,n=0;e<t.length;n+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)r.set(t[e],n);else{if(typeof t[e]=="string")throw"wtf";r.set(new Uint8Array(t[e]),n)}return r}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function tP(t){for(var e=[],n=0,r=t.length+250,a=ni(t.length+255),i=0;i<t.length;++i){var l=t.charCodeAt(i);if(l<128)a[n++]=l;else if(l<2048)a[n++]=192|l>>6&31,a[n++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=t.charCodeAt(++i)&1023;a[n++]=240|l>>8&7,a[n++]=128|l>>2&63,a[n++]=128|c>>6&15|(l&3)<<4,a[n++]=128|c&63}else a[n++]=224|l>>12&15,a[n++]=128|l>>6&63,a[n++]=128|l&63;n>r&&(e.push(a.slice(0,n)),n=0,a=ni(65535),r=65530)}return e.push(a.slice(0,n)),Ws(e)}var gr=/\u0000/g,Dc=/[\u0001-\u0006]/g;function rl(t){for(var e="",n=t.length-1;n>=0;)e+=t.charAt(n--);return e}function pa(t,e){var n=""+t;return n.length>=e?n:xn("0",e-n.length)+n}function Pp(t,e){var n=""+t;return n.length>=e?n:xn(" ",e-n.length)+n}function xd(t,e){var n=""+t;return n.length>=e?n:n+xn(" ",e-n.length)}function nP(t,e){var n=""+Math.round(t);return n.length>=e?n:xn("0",e-n.length)+n}function rP(t,e){var n=""+t;return n.length>=e?n:xn("0",e-n.length)+n}var vw=Math.pow(2,32);function Jo(t,e){if(t>vw||t<-vw)return nP(t,e);var n=Math.round(t);return rP(n,e)}function vd(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var yw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],fm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function aP(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var ut={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},_w={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},sP={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function yd(t,e,n){for(var r=t<0?-1:1,a=t*r,i=0,l=1,c=0,d=1,f=0,g=0,v=Math.floor(a);f<e&&(v=Math.floor(a),c=v*l+i,g=v*f+d,!(a-v<5e-8));)a=1/(a-v),i=l,l=c,d=f,f=g;if(g>e&&(f>e?(g=d,c=i):(g=f,c=l)),!n)return[0,r*c,g];var _=Math.floor(r*c/g);return[_,r*c-_*g,g]}function Di(t,e,n){if(t>2958465||t<0)return null;var r=t|0,a=Math.floor(86400*(t-r)),i=0,l=[],c={D:r,T:a,u:86400*(t-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(r+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++r,++c.D)),r===60)l=n?[1317,10,29]:[1900,2,29],i=3;else if(r===0)l=n?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;var d=new Date(1900,0,1);d.setDate(d.getDate()+r-1),l=[d.getFullYear(),d.getMonth()+1,d.getDate()],i=d.getDay(),r<60&&(i=(i+6)%7),n&&(i=fP(d,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=i,c}var aE=new Date(1899,11,31,0,0,0),iP=aE.getTime(),oP=new Date(1900,2,1,0,0,0);function sE(t,e){var n=t.getTime();return e?n-=1461*24*60*60*1e3:t>=oP&&(n+=24*60*60*1e3),(n-(iP+(t.getTimezoneOffset()-aE.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Up(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function lP(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function cP(t){var e=t<0?12:11,n=Up(t.toFixed(12));return n.length<=e||(n=t.toPrecision(10),n.length<=e)?n:t.toExponential(5)}function uP(t){var e=Up(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function nu(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),n;return e>=-4&&e<=-1?n=t.toPrecision(10+e):Math.abs(e)<=9?n=cP(t):e===10?n=t.toFixed(10).substr(0,12):n=uP(t),Up(lP(n.toUpperCase()))}function Hi(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):nu(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ea(14,sE(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function fP(t,e){e[0]-=581;var n=t.getDay();return t<60&&(n=(n+6)%7),n}function dP(t,e,n,r){var a="",i=0,l=0,c=n.y,d,f=0;switch(t){case 98:c=n.y+543;case 121:switch(e.length){case 1:case 2:d=c%100,f=2;break;default:d=c%1e4,f=4;break}break;case 109:switch(e.length){case 1:case 2:d=n.m,f=e.length;break;case 3:return fm[n.m-1][1];case 5:return fm[n.m-1][0];default:return fm[n.m-1][2]}break;case 100:switch(e.length){case 1:case 2:d=n.d,f=e.length;break;case 3:return yw[n.q][0];default:return yw[n.q][1]}break;case 104:switch(e.length){case 1:case 2:d=1+(n.H+11)%12,f=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:d=n.H,f=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:d=n.M,f=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return n.u===0&&(e=="s"||e=="ss")?pa(n.S,e.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,i=Math.round(l*(n.S+n.u)),i>=60*l&&(i=0),e==="s"?i===0?"0":""+i/l:(a=pa(i,2+r),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":d=n.D*24+n.H;break;case"[m]":case"[mm]":d=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":d=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+e}f=e.length===3?1:2;break;case 101:d=c,f=1;break}var g=f>0?pa(d,f):"";return g}function Ks(t){var e=3;if(t.length<=e)return t;for(var n=t.length%e,r=t.substr(0,n);n!=t.length;n+=e)r+=(r.length>0?",":"")+t.substr(n,e);return r}var iE=/%/g;function hP(t,e,n){var r=e.replace(iE,""),a=e.length-r.length;return os(t,r,n*Math.pow(10,2*a))+xn("%",a)}function mP(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return os(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function oE(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+oE(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),n=(e/Math.pow(10,i)).toPrecision(r+1+(a+i)%a),n.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(l-n.length+i):n+="E+"+(l-i);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,f,g){return d+f+g.substr(0,(a+i)%a)+"."+g.substr(i)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var lE=/# (\?+)( ?)\/( ?)(\d+)/;function pP(t,e,n){var r=parseInt(t[4],10),a=Math.round(e*r),i=Math.floor(a/r),l=a-i*r,c=r;return n+(i===0?"":""+i)+" "+(l===0?xn(" ",t[1].length+1+t[4].length):Pp(l,t[1].length)+t[2]+"/"+t[3]+pa(c,t[4].length))}function gP(t,e,n){return n+(e===0?"":""+e)+xn(" ",t[1].length+2+t[4].length)}var cE=/^#*0*\.([0#]+)/,uE=/\).*[0#]/,fE=/\(###\) ###\\?-####/;function hr(t){for(var e="",n,r=0;r!=t.length;++r)switch(n=t.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(n)}return e}function ww(t,e){var n=Math.pow(10,e);return""+Math.round(t*n)/n}function Tw(t,e){var n=t-Math.floor(t),r=Math.pow(10,e);return e<(""+Math.round(n*r)).length?0:Math.round(n*r)}function xP(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function vP(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Xr(t,e,n){if(t.charCodeAt(0)===40&&!e.match(uE)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Xr("n",r,n):"("+Xr("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return mP(t,e,n);if(e.indexOf("%")!==-1)return hP(t,e,n);if(e.indexOf("E")!==-1)return oE(e,n);if(e.charCodeAt(0)===36)return"$"+Xr(t,e.substr(e.charAt(1)==" "?2:1),n);var a,i,l,c,d=Math.abs(n),f=n<0?"-":"";if(e.match(/^00+$/))return f+Jo(d,e.length);if(e.match(/^[#?]+$/))return a=Jo(n,0),a==="0"&&(a=""),a.length>e.length?a:hr(e.substr(0,e.length-a.length))+a;if(i=e.match(lE))return pP(i,d,f);if(e.match(/^#+0+$/))return f+Jo(d,e.length-e.indexOf("0"));if(i=e.match(cE))return a=ww(n,i[1].length).replace(/^([^\.]+)$/,"$1."+hr(i[1])).replace(/\.$/,"."+hr(i[1])).replace(/\.(\d*)$/,function(E,S){return"."+S+xn("0",hr(i[1]).length-S.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return f+ww(d,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return f+Ks(Jo(d,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Xr(t,e,-n):Ks(""+(Math.floor(n)+xP(n,i[1].length)))+"."+pa(Tw(n,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Xr(t,e.replace(/^#,#*,/,""),n);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=rl(Xr(t,e.replace(/[\\-]/g,""),n)),l=0,rl(rl(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return l<a.length?a.charAt(l++):E==="0"?"0":""}));if(e.match(fE))return a=Xr(t,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),c=yd(d,Math.pow(10,l)-1,!1),a=""+f,g=os("n",i[1],c[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+i[2]+"/"+i[3],g=xd(c[2],l),g.length<i[4].length&&(g=hr(i[4].substr(i[4].length-g.length))+g),a+=g,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),c=yd(d,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Pp(c[1],l)+i[2]+"/"+i[3]+xd(c[2],l):xn(" ",2*l+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=Jo(n,0),e.length<=a.length?a:hr(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=e.indexOf(".")-l,_=e.length-a.length-v;return hr(e.substr(0,v)+a+e.substr(e.length-_))}if(i=e.match(/^00,000\.([#0]*0)$/))return l=Tw(n,i[1].length),n<0?"-"+Xr(t,e,-n):Ks(vP(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?pa(0,3-E.length):"")+E})+"."+pa(l,i[1].length);switch(e){case"###,##0.00":return Xr(t,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var T=Ks(Jo(d,0));return T!=="0"?f+T:"";case"###,###.00":return Xr(t,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Xr(t,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function yP(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return os(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function _P(t,e,n){var r=e.replace(iE,""),a=e.length-r.length;return os(t,r,n*Math.pow(10,2*a))+xn("%",a)}function dE(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+dE(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),n=(e/Math.pow(10,i)).toPrecision(r+1+(a+i)%a),!n.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(l-n.length+i):n+="E+"+(l-i),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,f,g){return d+f+g.substr(0,(a+i)%a)+"."+g.substr(i)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Na(t,e,n){if(t.charCodeAt(0)===40&&!e.match(uE)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Na("n",r,n):"("+Na("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return yP(t,e,n);if(e.indexOf("%")!==-1)return _P(t,e,n);if(e.indexOf("E")!==-1)return dE(e,n);if(e.charCodeAt(0)===36)return"$"+Na(t,e.substr(e.charAt(1)==" "?2:1),n);var a,i,l,c,d=Math.abs(n),f=n<0?"-":"";if(e.match(/^00+$/))return f+pa(d,e.length);if(e.match(/^[#?]+$/))return a=""+n,n===0&&(a=""),a.length>e.length?a:hr(e.substr(0,e.length-a.length))+a;if(i=e.match(lE))return gP(i,d,f);if(e.match(/^#+0+$/))return f+pa(d,e.length-e.indexOf("0"));if(i=e.match(cE))return a=(""+n).replace(/^([^\.]+)$/,"$1."+hr(i[1])).replace(/\.$/,"."+hr(i[1])),a=a.replace(/\.(\d*)$/,function(E,S){return"."+S+xn("0",hr(i[1]).length-S.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return f+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return f+Ks(""+d);if(i=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Na(t,e,-n):Ks(""+n)+"."+xn("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Na(t,e.replace(/^#,#*,/,""),n);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=rl(Na(t,e.replace(/[\\-]/g,""),n)),l=0,rl(rl(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return l<a.length?a.charAt(l++):E==="0"?"0":""}));if(e.match(fE))return a=Na(t,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),c=yd(d,Math.pow(10,l)-1,!1),a=""+f,g=os("n",i[1],c[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+i[2]+"/"+i[3],g=xd(c[2],l),g.length<i[4].length&&(g=hr(i[4].substr(i[4].length-g.length))+g),a+=g,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),c=yd(d,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Pp(c[1],l)+i[2]+"/"+i[3]+xd(c[2],l):xn(" ",2*l+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=""+n,e.length<=a.length?a:hr(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=e.indexOf(".")-l,_=e.length-a.length-v;return hr(e.substr(0,v)+a+e.substr(e.length-_))}if(i=e.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Na(t,e,-n):Ks(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?pa(0,3-E.length):"")+E})+"."+pa(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var T=Ks(""+d);return T!=="0"?f+T:"";default:if(e.match(/\.[0#?]*$/))return Na(t,e.slice(0,e.lastIndexOf(".")),n)+hr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function os(t,e,n){return(n|0)===n?Na(t,e,n):Xr(t,e,n)}function wP(t){for(var e=[],n=!1,r=0,a=0;r<t.length;++r)switch(t.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=t.substr(a,r-a),a=r+1}if(e[e.length]=t.substr(a),n===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var hE=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function El(t){for(var e=0,n="",r="";e<t.length;)switch(n=t.charAt(e)){case"G":vd(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(r=n;t.charAt(e++)!=="]"&&e<t.length;)r+=t.charAt(e);if(r.match(hE))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(n=t.charAt(++e))>-1||n=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===n;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function TP(t,e,n,r){for(var a=[],i="",l=0,c="",d="t",f,g,v,_="H";l<t.length;)switch(c=t.charAt(l)){case"G":if(!vd(t,l))throw new Error("unrecognized character "+c+" in "+t);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(v=t.charCodeAt(++l))!==34&&l<t.length;)i+=String.fromCharCode(v);a[a.length]={t:"t",v:i},++l;break;case"\\":var T=t.charAt(++l),E=T==="("||T===")"?T:"t";a[a.length]={t:E,v:T},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(f==null&&(f=Di(e,n,t.charAt(l+1)==="2"),f==null))return"";a[a.length]={t:"X",v:t.substr(l,2)},d=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||f==null&&(f=Di(e,n),f==null))return"";for(i=c;++l<t.length&&t.charAt(l).toLowerCase()===c;)i+=c;c==="m"&&d.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=_),a[a.length]={t:c,v:i},d=c;break;case"A":case"a":case"上":var S={t:c,v:c};if(f==null&&(f=Di(e,n)),t.substr(l,3).toUpperCase()==="A/P"?(f!=null&&(S.v=f.H>=12?"P":"A"),S.t="T",_="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(f!=null&&(S.v=f.H>=12?"PM":"AM"),S.t="T",l+=5,_="h"):t.substr(l,5).toUpperCase()==="上午/下午"?(f!=null&&(S.v=f.H>=12?"下午":"上午"),S.t="T",l+=5,_="h"):(S.t="t",++l),f==null&&S.t==="T")return"";a[a.length]=S,d=c;break;case"[":for(i=c;t.charAt(l++)!=="]"&&l<t.length;)i+=t.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(hE)){if(f==null&&(f=Di(e,n),f==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},d=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",El(t)||(a[a.length]={t:"t",v:i}));break;case".":if(f!=null){for(i=c;++l<t.length&&(c=t.charAt(l))==="0";)i+=c;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++l<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(l))>-1;)i+=c;a[a.length]={t:"n",v:i};break;case"?":for(i=c;t.charAt(++l)===c;)i+=c;a[a.length]={t:c,v:i},d=c;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:r===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)i+=t.charAt(l);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:c,v:c},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);a[a.length]={t:"t",v:c},++l;break}var b=0,k=0,A;for(l=a.length-1,d="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=_,d="h",b<1&&(b=1);break;case"s":(A=a[l].v.match(/\.0+$/))&&(k=Math.max(k,A[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":d=a[l].t;break;case"m":d==="s"&&(a[l].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&a[l].v.match(/[Hh]/)&&(b=1),b<2&&a[l].v.match(/[Mm]/)&&(b=2),b<3&&a[l].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var C="",I;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=dP(a[l].t.charCodeAt(0),a[l].v,f,k),a[l].t="t";break;case"n":case"?":for(I=l+1;a[I]!=null&&((c=a[I].t)==="?"||c==="D"||(c===" "||c==="t")&&a[I+1]!=null&&(a[I+1].t==="?"||a[I+1].t==="t"&&a[I+1].v==="/")||a[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[I].v==="/"||a[I].v===" "&&a[I+1]!=null&&a[I+1].t=="?"));)a[l].v+=a[I].v,a[I]={v:"",t:";"},++I;C+=a[l].v,l=I-1;break;case"G":a[l].t="t",a[l].v=Hi(e,n);break}var B="",j,F;if(C.length>0){C.charCodeAt(0)==40?(j=e<0&&C.charCodeAt(0)===45?-e:e,F=os("n",C,j)):(j=e<0&&r>1?-e:e,F=os("n",C,j),j<0&&a[0]&&a[0].t=="t"&&(F=F.substr(1),a[0].v="-"+a[0].v)),I=F.length-1;var X=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){X=l;break}var P=a.length;if(X===a.length&&F.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(I>=a[l].v.length-1?(I-=a[l].v.length,a[l].v=F.substr(I+1,a[l].v.length)):I<0?a[l].v="":(a[l].v=F.substr(0,I+1),I=-1),a[l].t="t",P=l);I>=0&&P<a.length&&(a[P].v=F.substr(0,I+1)+a[P].v)}else if(X!==a.length&&F.indexOf("E")===-1){for(I=F.indexOf(".")-1,l=X;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(g=a[l].v.indexOf(".")>-1&&l===X?a[l].v.indexOf(".")-1:a[l].v.length-1,B=a[l].v.substr(g+1);g>=0;--g)I>=0&&(a[l].v.charAt(g)==="0"||a[l].v.charAt(g)==="#")&&(B=F.charAt(I--)+B);a[l].v=B,a[l].t="t",P=l}for(I>=0&&P<a.length&&(a[P].v=F.substr(0,I+1)+a[P].v),I=F.indexOf(".")+1,l=X;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==X)){for(g=a[l].v.indexOf(".")>-1&&l===X?a[l].v.indexOf(".")+1:0,B=a[l].v.substr(0,g);g<a[l].v.length;++g)I<F.length&&(B+=F.charAt(I++));a[l].v=B,a[l].t="t",P=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(j=r>1&&e<0&&l>0&&a[l-1].v==="-"?-e:e,a[l].v=os(a[l].t,a[l].v,j),a[l].t="t");var re="";for(l=0;l!==a.length;++l)a[l]!=null&&(re+=a[l].v);return re}var Ew=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Sw(t,e){if(e==null)return!1;var n=parseFloat(e[2]);switch(e[1]){case"=":if(t==n)return!0;break;case">":if(t>n)return!0;break;case"<":if(t<n)return!0;break;case"<>":if(t!=n)return!0;break;case">=":if(t>=n)return!0;break;case"<=":if(t<=n)return!0;break}return!1}function EP(t,e){var n=wP(t),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof e!="number")return[4,n.length===4||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var i=e>0?n[0]:e<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,i];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var l=n[0].match(Ew),c=n[1].match(Ew);return Sw(e,l)?[r,n[0]]:Sw(e,c)?[r,n[1]]:[r,n[l!=null&&c!=null?2:1]]}return[r,i]}function ea(t,e,n){n==null&&(n={});var r="";switch(typeof t){case"string":t=="m/d/yy"&&n.dateNF?r=n.dateNF:r=t;break;case"number":t==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:ut)[t],r==null&&(r=n.table&&n.table[_w[t]]||ut[_w[t]]),r==null&&(r=sP[t]||"General");break}if(vd(r,0))return Hi(e,n);e instanceof Date&&(e=sE(e,n.date1904));var a=EP(r,e);if(vd(a[1]))return Hi(e,n);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return TP(a[1],e,n,a[0])}function Ii(t,e){if(typeof e!="number"){e=+e||-1;for(var n=0;n<392;++n){if(ut[n]==null){e<0&&(e=n);continue}if(ut[n]==t){e=n;break}}e<0&&(e=391)}return ut[e]=t,e}function mE(){ut=aP()}var SP={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},pE=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function bP(t){var e=typeof t=="number"?ut[t]:t;return e=e.replace(pE,"(\\d+)"),new RegExp("^"+e+"$")}function CP(t,e,n){var r=-1,a=-1,i=-1,l=-1,c=-1,d=-1;(e.match(pE)||[]).forEach(function(v,_){var T=parseInt(n[_+1],10);switch(v.toLowerCase().charAt(0)){case"y":r=T;break;case"d":i=T;break;case"h":l=T;break;case"s":d=T;break;case"m":l>=0?c=T:a=T;break}}),d>=0&&c==-1&&a>=0&&(c=a,a=-1);var f=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var g=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return l==-1&&c==-1&&d==-1?f:r==-1&&a==-1&&i==-1?g:f+"T"+g}var AP=function(){var t={};t.version="1.2.0";function e(){for(var F=0,X=new Array(256),P=0;P!=256;++P)F=P,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,X[P]=F;return typeof Int32Array<"u"?new Int32Array(X):X}var n=e();function r(F){var X=0,P=0,re=0,G=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(re=0;re!=256;++re)G[re]=F[re];for(re=0;re!=256;++re)for(P=F[re],X=256+re;X<4096;X+=256)P=G[X]=P>>>8^F[P&255];var te=[];for(re=1;re!=16;++re)te[re-1]=typeof Int32Array<"u"?G.subarray(re*256,re*256+256):G.slice(re*256,re*256+256);return te}var a=r(n),i=a[0],l=a[1],c=a[2],d=a[3],f=a[4],g=a[5],v=a[6],_=a[7],T=a[8],E=a[9],S=a[10],b=a[11],k=a[12],A=a[13],C=a[14];function I(F,X){for(var P=X^-1,re=0,G=F.length;re<G;)P=P>>>8^n[(P^F.charCodeAt(re++))&255];return~P}function B(F,X){for(var P=X^-1,re=F.length-15,G=0;G<re;)P=C[F[G++]^P&255]^A[F[G++]^P>>8&255]^k[F[G++]^P>>16&255]^b[F[G++]^P>>>24]^S[F[G++]]^E[F[G++]]^T[F[G++]]^_[F[G++]]^v[F[G++]]^g[F[G++]]^f[F[G++]]^d[F[G++]]^c[F[G++]]^l[F[G++]]^i[F[G++]]^n[F[G++]];for(re+=15;G<re;)P=P>>>8^n[(P^F[G++])&255];return~P}function j(F,X){for(var P=X^-1,re=0,G=F.length,te=0,_e=0;re<G;)te=F.charCodeAt(re++),te<128?P=P>>>8^n[(P^te)&255]:te<2048?(P=P>>>8^n[(P^(192|te>>6&31))&255],P=P>>>8^n[(P^(128|te&63))&255]):te>=55296&&te<57344?(te=(te&1023)+64,_e=F.charCodeAt(re++)&1023,P=P>>>8^n[(P^(240|te>>8&7))&255],P=P>>>8^n[(P^(128|te>>2&63))&255],P=P>>>8^n[(P^(128|_e>>6&15|(te&3)<<4))&255],P=P>>>8^n[(P^(128|_e&63))&255]):(P=P>>>8^n[(P^(224|te>>12&15))&255],P=P>>>8^n[(P^(128|te>>6&63))&255],P=P>>>8^n[(P^(128|te&63))&255]);return~P}return t.table=n,t.bstr=I,t.buf=B,t.str=j,t}(),Nt=function(){var e={};e.version="1.2.1";function n(R,V){for(var O=R.split("/"),H=V.split("/"),z=0,q=0,fe=Math.min(O.length,H.length);z<fe;++z){if(q=O[z].length-H[z].length)return q;if(O[z]!=H[z])return O[z]<H[z]?-1:1}return O.length-H.length}function r(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:r(R.slice(0,-1));var V=R.lastIndexOf("/");return V===-1?R:R.slice(0,V+1)}function a(R){if(R.charAt(R.length-1)=="/")return a(R.slice(0,-1));var V=R.lastIndexOf("/");return V===-1?R:R.slice(V+1)}function i(R,V){typeof V=="string"&&(V=new Date(V));var O=V.getHours();O=O<<6|V.getMinutes(),O=O<<5|V.getSeconds()>>>1,R.write_shift(2,O);var H=V.getFullYear()-1980;H=H<<4|V.getMonth()+1,H=H<<5|V.getDate(),R.write_shift(2,H)}function l(R){var V=R.read_shift(2)&65535,O=R.read_shift(2)&65535,H=new Date,z=O&31;O>>>=5;var q=O&15;O>>>=4,H.setMilliseconds(0),H.setFullYear(O+1980),H.setMonth(q-1),H.setDate(z);var fe=V&31;V>>>=5;var ye=V&63;return V>>>=6,H.setHours(V),H.setMinutes(ye),H.setSeconds(fe<<1),H}function c(R){Jn(R,0);for(var V={},O=0;R.l<=R.length-4;){var H=R.read_shift(2),z=R.read_shift(2),q=R.l+z,fe={};switch(H){case 21589:O=R.read_shift(1),O&1&&(fe.mtime=R.read_shift(4)),z>5&&(O&2&&(fe.atime=R.read_shift(4)),O&4&&(fe.ctime=R.read_shift(4))),fe.mtime&&(fe.mt=new Date(fe.mtime*1e3));break}R.l=q,V[H]=fe}return V}var d;function f(){return d||(d={})}function g(R,V){if(R[0]==80&&R[1]==75)return Zn(R,V);if((R[0]|32)==109&&(R[1]|32)==105)return ii(R,V);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var O=3,H=512,z=0,q=0,fe=0,ye=0,le=0,he=[],pe=R.slice(0,512);Jn(pe,0);var Re=v(pe);switch(O=Re[0],O){case 3:H=512;break;case 4:H=4096;break;case 0:if(Re[1]==0)return Zn(R,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+O)}H!==512&&(pe=R.slice(0,H),Jn(pe,28));var Fe=R.slice(0,H);_(pe,O);var Ue=pe.read_shift(4,"i");if(O===3&&Ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ue);pe.l+=4,fe=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),ye=pe.read_shift(4,"i"),z=pe.read_shift(4,"i"),le=pe.read_shift(4,"i"),q=pe.read_shift(4,"i");for(var Me=-1,Q=0;Q<109&&(Me=pe.read_shift(4,"i"),!(Me<0));++Q)he[Q]=Me;var we=T(R,H);b(le,q,we,H,he);var Ae=A(we,fe,he,H);Ae[fe].name="!Directory",z>0&&ye!==_e&&(Ae[ye].name="!MiniFAT"),Ae[he[0]].name="!FAT",Ae.fat_addrs=he,Ae.ssz=H;var Pe={},Ve=[],lt=[],It=[];C(fe,Ae,we,Ve,z,Pe,lt,ye),E(lt,It,Ve),Ve.shift();var bt={FileIndex:lt,FullPaths:It};return V&&V.raw&&(bt.raw={header:Fe,sectors:we}),bt}function v(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(Ne,"Header Signature: "),R.l+=16;var V=R.read_shift(2,"u");return[R.read_shift(2,"u"),V]}function _(R,V){var O=9;switch(R.l+=2,O=R.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+O);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+O);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+O)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function T(R,V){for(var O=Math.ceil(R.length/V)-1,H=[],z=1;z<O;++z)H[z-1]=R.slice(z*V,(z+1)*V);return H[O-1]=R.slice(O*V),H}function E(R,V,O){for(var H=0,z=0,q=0,fe=0,ye=0,le=O.length,he=[],pe=[];H<le;++H)he[H]=pe[H]=H,V[H]=O[H];for(;ye<pe.length;++ye)H=pe[ye],z=R[H].L,q=R[H].R,fe=R[H].C,he[H]===H&&(z!==-1&&he[z]!==z&&(he[H]=he[z]),q!==-1&&he[q]!==q&&(he[H]=he[q])),fe!==-1&&(he[fe]=H),z!==-1&&H!=he[H]&&(he[z]=he[H],pe.lastIndexOf(z)<ye&&pe.push(z)),q!==-1&&H!=he[H]&&(he[q]=he[H],pe.lastIndexOf(q)<ye&&pe.push(q));for(H=1;H<le;++H)he[H]===H&&(q!==-1&&he[q]!==q?he[H]=he[q]:z!==-1&&he[z]!==z&&(he[H]=he[z]));for(H=1;H<le;++H)if(R[H].type!==0){if(ye=H,ye!=he[ye])do ye=he[ye],V[H]=V[ye]+"/"+V[H];while(ye!==0&&he[ye]!==-1&&ye!=he[ye]);he[H]=-1}for(V[0]+="/",H=1;H<le;++H)R[H].type!==2&&(V[H]+="/")}function S(R,V,O){for(var H=R.start,z=R.size,q=[],fe=H;O&&z>0&&fe>=0;)q.push(V.slice(fe*te,fe*te+te)),z-=te,fe=Ni(O,fe*4);return q.length===0?Mn(0):Ws(q).slice(0,R.size)}function b(R,V,O,H,z){var q=_e;if(R===_e){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var fe=O[R],ye=(H>>>2)-1;if(!fe)return;for(var le=0;le<ye&&(q=Ni(fe,le*4))!==_e;++le)z.push(q);b(Ni(fe,H-4),V-1,O,H,z)}}function k(R,V,O,H,z){var q=[],fe=[];z||(z=[]);var ye=H-1,le=0,he=0;for(le=V;le>=0;){z[le]=!0,q[q.length]=le,fe.push(R[le]);var pe=O[Math.floor(le*4/H)];if(he=le*4&ye,H<4+he)throw new Error("FAT boundary crossed: "+le+" 4 "+H);if(!R[pe])break;le=Ni(R[pe],he)}return{nodes:q,data:Fw([fe])}}function A(R,V,O,H){var z=R.length,q=[],fe=[],ye=[],le=[],he=H-1,pe=0,Re=0,Fe=0,Ue=0;for(pe=0;pe<z;++pe)if(ye=[],Fe=pe+V,Fe>=z&&(Fe-=z),!fe[Fe]){le=[];var Me=[];for(Re=Fe;Re>=0;){Me[Re]=!0,fe[Re]=!0,ye[ye.length]=Re,le.push(R[Re]);var Q=O[Math.floor(Re*4/H)];if(Ue=Re*4&he,H<4+Ue)throw new Error("FAT boundary crossed: "+Re+" 4 "+H);if(!R[Q]||(Re=Ni(R[Q],Ue),Me[Re]))break}q[Fe]={nodes:ye,data:Fw([le])}}return q}function C(R,V,O,H,z,q,fe,ye){for(var le=0,he=H.length?2:0,pe=V[R].data,Re=0,Fe=0,Ue;Re<pe.length;Re+=128){var Me=pe.slice(Re,Re+128);Jn(Me,64),Fe=Me.read_shift(2),Ue=$p(Me,0,Fe-he),H.push(Ue);var Q={name:Ue,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},we=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);we!==0&&(Q.ct=I(Me,Me.l-8));var Ae=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);Ae!==0&&(Q.mt=I(Me,Me.l-8)),Q.start=Me.read_shift(4,"i"),Q.size=Me.read_shift(4,"i"),Q.size<0&&Q.start<0&&(Q.size=Q.type=0,Q.start=_e,Q.name=""),Q.type===5?(le=Q.start,z>0&&le!==_e&&(V[le].name="!StreamData")):Q.size>=4096?(Q.storage="fat",V[Q.start]===void 0&&(V[Q.start]=k(O,Q.start,V.fat_addrs,V.ssz)),V[Q.start].name=Q.name,Q.content=V[Q.start].data.slice(0,Q.size)):(Q.storage="minifat",Q.size<0?Q.size=0:le!==_e&&Q.start!==_e&&V[le]&&(Q.content=S(Q,V[le].data,(V[ye]||{}).data))),Q.content&&Jn(Q.content,0),q[Ue]=Q,fe.push(Q)}}function I(R,V){return new Date((Or(R,V+4)/1e7*Math.pow(2,32)+Or(R,V)/1e7-11644473600)*1e3)}function B(R,V){return f(),g(d.readFileSync(R),V)}function j(R,V){var O=V&&V.type;switch(O||Ct&&Buffer.isBuffer(R)&&(O="buffer"),O||"base64"){case"file":return B(R,V);case"base64":return g(ha(Ur(R)),V);case"binary":return g(ha(R),V)}return g(R,V)}function F(R,V){var O=V||{},H=O.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=H+"/",R.FileIndex[0]={name:H,type:5}),O.CLSID&&(R.FileIndex[0].clsid=O.CLSID),X(R)}function X(R){var V="Sh33tJ5";if(!Nt.find(R,"/"+V)){var O=Mn(4);O[0]=55,O[1]=O[3]=50,O[2]=54,R.FileIndex.push({name:V,type:2,content:O,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+V),P(R)}}function P(R,V){F(R);for(var O=!1,H=!1,z=R.FullPaths.length-1;z>=0;--z){var q=R.FileIndex[z];switch(q.type){case 0:H?O=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(q.R*q.L*q.C)&&(O=!0),q.R>-1&&q.L>-1&&q.R==q.L&&(O=!0);break;default:O=!0;break}}if(!(!O&&!V)){var fe=new Date(1987,1,19),ye=0,le=Object.create?Object.create(null):{},he=[];for(z=0;z<R.FullPaths.length;++z)le[R.FullPaths[z]]=!0,R.FileIndex[z].type!==0&&he.push([R.FullPaths[z],R.FileIndex[z]]);for(z=0;z<he.length;++z){var pe=r(he[z][0]);H=le[pe],H||(he.push([pe,{name:a(pe).replace("/",""),type:1,clsid:se,ct:fe,mt:fe,content:null}]),le[pe]=!0)}for(he.sort(function(Ue,Me){return n(Ue[0],Me[0])}),R.FullPaths=[],R.FileIndex=[],z=0;z<he.length;++z)R.FullPaths[z]=he[z][0],R.FileIndex[z]=he[z][1];for(z=0;z<he.length;++z){var Re=R.FileIndex[z],Fe=R.FullPaths[z];if(Re.name=a(Fe).replace("/",""),Re.L=Re.R=Re.C=-(Re.color=1),Re.size=Re.content?Re.content.length:0,Re.start=0,Re.clsid=Re.clsid||se,z===0)Re.C=he.length>1?1:-1,Re.size=0,Re.type=5;else if(Fe.slice(-1)=="/"){for(ye=z+1;ye<he.length&&r(R.FullPaths[ye])!=Fe;++ye);for(Re.C=ye>=he.length?-1:ye,ye=z+1;ye<he.length&&r(R.FullPaths[ye])!=r(Fe);++ye);Re.R=ye>=he.length?-1:ye,Re.type=1}else r(R.FullPaths[z+1]||"")==r(Fe)&&(Re.R=z+1),Re.type=2}}}function re(R,V){var O=V||{};if(O.fileType=="mad")return yr(R,O);switch(P(R),O.fileType){case"zip":return ra(R,O)}var H=function(Ue){for(var Me=0,Q=0,we=0;we<Ue.FileIndex.length;++we){var Ae=Ue.FileIndex[we];if(Ae.content){var Pe=Ae.content.length;Pe>0&&(Pe<4096?Me+=Pe+63>>6:Q+=Pe+511>>9)}}for(var Ve=Ue.FullPaths.length+3>>2,lt=Me+7>>3,It=Me+127>>7,bt=lt+Q+Ve+It,Ft=bt+127>>7,hn=Ft<=109?0:Math.ceil((Ft-109)/127);bt+Ft+hn+127>>7>Ft;)hn=++Ft<=109?0:Math.ceil((Ft-109)/127);var Lt=[1,hn,Ft,It,Ve,Q,Me,0];return Ue.FileIndex[0].size=Me<<6,Lt[7]=(Ue.FileIndex[0].start=Lt[0]+Lt[1]+Lt[2]+Lt[3]+Lt[4]+Lt[5])+(Lt[6]+7>>3),Lt}(R),z=Mn(H[7]<<9),q=0,fe=0;{for(q=0;q<8;++q)z.write_shift(1,Ee[q]);for(q=0;q<8;++q)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),q=0;q<3;++q)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,H[2]),z.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:_e),z.write_shift(4,H[3]),z.write_shift(-4,H[1]?H[0]-1:_e),z.write_shift(4,H[1]),q=0;q<109;++q)z.write_shift(-4,q<H[2]?H[1]+q:-1)}if(H[1])for(fe=0;fe<H[1];++fe){for(;q<236+fe*127;++q)z.write_shift(-4,q<H[2]?H[1]+q:-1);z.write_shift(-4,fe===H[1]-1?_e:fe+1)}var ye=function(Ue){for(fe+=Ue;q<fe-1;++q)z.write_shift(-4,q+1);Ue&&(++q,z.write_shift(-4,_e))};for(fe=q=0,fe+=H[1];q<fe;++q)z.write_shift(-4,ue.DIFSECT);for(fe+=H[2];q<fe;++q)z.write_shift(-4,ue.FATSECT);ye(H[3]),ye(H[4]);for(var le=0,he=0,pe=R.FileIndex[0];le<R.FileIndex.length;++le)pe=R.FileIndex[le],pe.content&&(he=pe.content.length,!(he<4096)&&(pe.start=fe,ye(he+511>>9)));for(ye(H[6]+7>>3);z.l&511;)z.write_shift(-4,ue.ENDOFCHAIN);for(fe=q=0,le=0;le<R.FileIndex.length;++le)pe=R.FileIndex[le],pe.content&&(he=pe.content.length,!(!he||he>=4096)&&(pe.start=fe,ye(he+63>>6)));for(;z.l&511;)z.write_shift(-4,ue.ENDOFCHAIN);for(q=0;q<H[4]<<2;++q){var Re=R.FullPaths[q];if(!Re||Re.length===0){for(le=0;le<17;++le)z.write_shift(4,0);for(le=0;le<3;++le)z.write_shift(4,-1);for(le=0;le<12;++le)z.write_shift(4,0);continue}pe=R.FileIndex[q],q===0&&(pe.start=pe.size?pe.start-1:_e);var Fe=q===0&&O.root||pe.name;if(he=2*(Fe.length+1),z.write_shift(64,Fe,"utf16le"),z.write_shift(2,he),z.write_shift(1,pe.type),z.write_shift(1,pe.color),z.write_shift(-4,pe.L),z.write_shift(-4,pe.R),z.write_shift(-4,pe.C),pe.clsid)z.write_shift(16,pe.clsid,"hex");else for(le=0;le<4;++le)z.write_shift(4,0);z.write_shift(4,pe.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,pe.start),z.write_shift(4,pe.size),z.write_shift(4,0)}for(q=1;q<R.FileIndex.length;++q)if(pe=R.FileIndex[q],pe.size>=4096)if(z.l=pe.start+1<<9,Ct&&Buffer.isBuffer(pe.content))pe.content.copy(z,z.l,0,pe.size),z.l+=pe.size+511&-512;else{for(le=0;le<pe.size;++le)z.write_shift(1,pe.content[le]);for(;le&511;++le)z.write_shift(1,0)}for(q=1;q<R.FileIndex.length;++q)if(pe=R.FileIndex[q],pe.size>0&&pe.size<4096)if(Ct&&Buffer.isBuffer(pe.content))pe.content.copy(z,z.l,0,pe.size),z.l+=pe.size+63&-64;else{for(le=0;le<pe.size;++le)z.write_shift(1,pe.content[le]);for(;le&63;++le)z.write_shift(1,0)}if(Ct)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}function G(R,V){var O=R.FullPaths.map(function(le){return le.toUpperCase()}),H=O.map(function(le){var he=le.split("/");return he[he.length-(le.slice(-1)=="/"?2:1)]}),z=!1;V.charCodeAt(0)===47?(z=!0,V=O[0].slice(0,-1)+V):z=V.indexOf("/")!==-1;var q=V.toUpperCase(),fe=z===!0?O.indexOf(q):H.indexOf(q);if(fe!==-1)return R.FileIndex[fe];var ye=!q.match(Dc);for(q=q.replace(gr,""),ye&&(q=q.replace(Dc,"!")),fe=0;fe<O.length;++fe)if((ye?O[fe].replace(Dc,"!"):O[fe]).replace(gr,"")==q||(ye?H[fe].replace(Dc,"!"):H[fe]).replace(gr,"")==q)return R.FileIndex[fe];return null}var te=64,_e=-2,Ne="d0cf11e0a1b11ae1",Ee=[208,207,17,224,161,177,26,225],se="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:_e,FREESECT:-1,HEADER_SIGNATURE:Ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ae(R,V,O){f();var H=re(R,O);d.writeFileSync(V,H)}function J(R){for(var V=new Array(R.length),O=0;O<R.length;++O)V[O]=String.fromCharCode(R[O]);return V.join("")}function D(R,V){var O=re(R,V);switch(V&&V.type||"buffer"){case"file":return f(),d.writeFileSync(V.filename,O),O;case"binary":return typeof O=="string"?O:J(O);case"base64":return gw(typeof O=="string"?O:J(O));case"buffer":if(Ct)return Buffer.isBuffer(O)?O:Ki(O);case"array":return typeof O=="string"?ha(O):O}return O}var ee;function M(R){try{var V=R.InflateRaw,O=new V;if(O._processChunk(new Uint8Array([3,0]),O._finishFlushFlag),O.bytesRead)ee=R;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function Y(R,V){if(!ee)return Ze(R,V);var O=ee.InflateRaw,H=new O,z=H._processChunk(R.slice(R.l),H._finishFlushFlag);return R.l+=H.bytesRead,z}function K(R){return ee?ee.deflateRawSync(R):tt(R)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ve=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Te(R){var V=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(V>>16|V>>8|V)&255}for(var De=typeof Uint8Array<"u",Se=De?new Uint8Array(256):[],Be=0;Be<256;++Be)Se[Be]=Te(Be);function Z(R,V){var O=Se[R&255];return V<=8?O>>>8-V:(O=O<<8|Se[R>>8&255],V<=16?O>>>16-V:(O=O<<8|Se[R>>16&255],O>>>24-V))}function dt(R,V){var O=V&7,H=V>>>3;return(R[H]|(O<=6?0:R[H+1]<<8))>>>O&3}function Ke(R,V){var O=V&7,H=V>>>3;return(R[H]|(O<=5?0:R[H+1]<<8))>>>O&7}function xt(R,V){var O=V&7,H=V>>>3;return(R[H]|(O<=4?0:R[H+1]<<8))>>>O&15}function nt(R,V){var O=V&7,H=V>>>3;return(R[H]|(O<=3?0:R[H+1]<<8))>>>O&31}function Ie(R,V){var O=V&7,H=V>>>3;return(R[H]|(O<=1?0:R[H+1]<<8))>>>O&127}function Bt(R,V,O){var H=V&7,z=V>>>3,q=(1<<O)-1,fe=R[z]>>>H;return O<8-H||(fe|=R[z+1]<<8-H,O<16-H)||(fe|=R[z+2]<<16-H,O<24-H)||(fe|=R[z+3]<<24-H),fe&q}function an(R,V,O){var H=V&7,z=V>>>3;return H<=5?R[z]|=(O&7)<<H:(R[z]|=O<<H&255,R[z+1]=(O&7)>>8-H),V+3}function sn(R,V,O){var H=V&7,z=V>>>3;return O=(O&1)<<H,R[z]|=O,V+1}function un(R,V,O){var H=V&7,z=V>>>3;return O<<=H,R[z]|=O&255,O>>>=8,R[z+1]=O,V+8}function On(R,V,O){var H=V&7,z=V>>>3;return O<<=H,R[z]|=O&255,O>>>=8,R[z+1]=O&255,R[z+2]=O>>>8,V+16}function vt(R,V){var O=R.length,H=2*O>V?2*O:V+5,z=0;if(O>=V)return R;if(Ct){var q=xw(H);if(R.copy)R.copy(q);else for(;z<R.length;++z)q[z]=R[z];return q}else if(De){var fe=new Uint8Array(H);if(fe.set)fe.set(R);else for(;z<O;++z)fe[z]=R[z];return fe}return R.length=H,R}function tn(R){for(var V=new Array(R),O=0;O<R;++O)V[O]=0;return V}function zn(R,V,O){var H=1,z=0,q=0,fe=0,ye=0,le=R.length,he=De?new Uint16Array(32):tn(32);for(q=0;q<32;++q)he[q]=0;for(q=le;q<O;++q)R[q]=0;le=R.length;var pe=De?new Uint16Array(le):tn(le);for(q=0;q<le;++q)he[z=R[q]]++,H<z&&(H=z),pe[q]=0;for(he[0]=0,q=1;q<=H;++q)he[q+16]=ye=ye+he[q-1]<<1;for(q=0;q<le;++q)ye=R[q],ye!=0&&(pe[q]=he[ye+16]++);var Re=0;for(q=0;q<le;++q)if(Re=R[q],Re!=0)for(ye=Z(pe[q],H)>>H-Re,fe=(1<<H+4-Re)-1;fe>=0;--fe)V[ye|fe<<Re]=Re&15|q<<4;return H}var yn=De?new Uint16Array(512):tn(512),Qt=De?new Uint16Array(32):tn(32);if(!De){for(var Mt=0;Mt<512;++Mt)yn[Mt]=0;for(Mt=0;Mt<32;++Mt)Qt[Mt]=0}(function(){for(var R=[],V=0;V<32;V++)R.push(5);zn(R,Qt,32);var O=[];for(V=0;V<=143;V++)O.push(8);for(;V<=255;V++)O.push(9);for(;V<=279;V++)O.push(7);for(;V<=287;V++)O.push(8);zn(O,yn,288)})();var it=function(){for(var V=De?new Uint8Array(32768):[],O=0,H=0;O<ve.length-1;++O)for(;H<ve[O+1];++H)V[H]=O;for(;H<32768;++H)V[H]=29;var z=De?new Uint8Array(259):[];for(O=0,H=0;O<oe.length-1;++O)for(;H<oe[O+1];++H)z[H]=O;function q(ye,le){for(var he=0;he<ye.length;){var pe=Math.min(65535,ye.length-he),Re=he+pe==ye.length;for(le.write_shift(1,+Re),le.write_shift(2,pe),le.write_shift(2,~pe&65535);pe-- >0;)le[le.l++]=ye[he++]}return le.l}function fe(ye,le){for(var he=0,pe=0,Re=De?new Uint16Array(32768):[];pe<ye.length;){var Fe=Math.min(65535,ye.length-pe);if(Fe<10){for(he=an(le,he,+(pe+Fe==ye.length)),he&7&&(he+=8-(he&7)),le.l=he/8|0,le.write_shift(2,Fe),le.write_shift(2,~Fe&65535);Fe-- >0;)le[le.l++]=ye[pe++];he=le.l*8;continue}he=an(le,he,+(pe+Fe==ye.length)+2);for(var Ue=0;Fe-- >0;){var Me=ye[pe];Ue=(Ue<<5^Me)&32767;var Q=-1,we=0;if((Q=Re[Ue])&&(Q|=pe&-32768,Q>pe&&(Q-=32768),Q<pe))for(;ye[Q+we]==ye[pe+we]&&we<250;)++we;if(we>2){Me=z[we],Me<=22?he=un(le,he,Se[Me+1]>>1)-1:(un(le,he,3),he+=5,un(le,he,Se[Me-23]>>5),he+=3);var Ae=Me<8?0:Me-4>>2;Ae>0&&(On(le,he,we-oe[Me]),he+=Ae),Me=V[pe-Q],he=un(le,he,Se[Me]>>3),he-=3;var Pe=Me<4?0:Me-2>>1;Pe>0&&(On(le,he,pe-Q-ve[Me]),he+=Pe);for(var Ve=0;Ve<we;++Ve)Re[Ue]=pe&32767,Ue=(Ue<<5^ye[pe])&32767,++pe;Fe-=we-1}else Me<=143?Me=Me+48:he=sn(le,he,1),he=un(le,he,Se[Me]),Re[Ue]=pe&32767,++pe}he=un(le,he,0)-1}return le.l=(he+7)/8|0,le.l}return function(le,he){return le.length<8?q(le,he):fe(le,he)}}();function tt(R){var V=Mn(50+Math.floor(R.length*1.1)),O=it(R,V);return V.slice(0,O)}var St=De?new Uint16Array(32768):tn(32768),on=De?new Uint16Array(32768):tn(32768),jt=De?new Uint16Array(128):tn(128),Pn=1,Oe=1;function We(R,V){var O=nt(R,V)+257;V+=5;var H=nt(R,V)+1;V+=5;var z=xt(R,V)+4;V+=4;for(var q=0,fe=De?new Uint8Array(19):tn(19),ye=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,he=De?new Uint8Array(8):tn(8),pe=De?new Uint8Array(8):tn(8),Re=fe.length,Fe=0;Fe<z;++Fe)fe[W[Fe]]=q=Ke(R,V),le<q&&(le=q),he[q]++,V+=3;var Ue=0;for(he[0]=0,Fe=1;Fe<=le;++Fe)pe[Fe]=Ue=Ue+he[Fe-1]<<1;for(Fe=0;Fe<Re;++Fe)(Ue=fe[Fe])!=0&&(ye[Fe]=pe[Ue]++);var Me=0;for(Fe=0;Fe<Re;++Fe)if(Me=fe[Fe],Me!=0){Ue=Se[ye[Fe]]>>8-Me;for(var Q=(1<<7-Me)-1;Q>=0;--Q)jt[Ue|Q<<Me]=Me&7|Fe<<3}var we=[];for(le=1;we.length<O+H;)switch(Ue=jt[Ie(R,V)],V+=Ue&7,Ue>>>=3){case 16:for(q=3+dt(R,V),V+=2,Ue=we[we.length-1];q-- >0;)we.push(Ue);break;case 17:for(q=3+Ke(R,V),V+=3;q-- >0;)we.push(0);break;case 18:for(q=11+Ie(R,V),V+=7;q-- >0;)we.push(0);break;default:we.push(Ue),le<Ue&&(le=Ue);break}var Ae=we.slice(0,O),Pe=we.slice(O);for(Fe=O;Fe<286;++Fe)Ae[Fe]=0;for(Fe=H;Fe<30;++Fe)Pe[Fe]=0;return Pn=zn(Ae,St,286),Oe=zn(Pe,on,30),V}function Ge(R,V){if(R[0]==3&&!(R[1]&3))return[ni(V),2];for(var O=0,H=0,z=xw(V||1<<18),q=0,fe=z.length>>>0,ye=0,le=0;(H&1)==0;){if(H=Ke(R,O),O+=3,H>>>1)H>>1==1?(ye=9,le=5):(O=We(R,O),ye=Pn,le=Oe);else{O&7&&(O+=8-(O&7));var he=R[O>>>3]|R[(O>>>3)+1]<<8;if(O+=32,he>0)for(!V&&fe<q+he&&(z=vt(z,q+he),fe=z.length);he-- >0;)z[q++]=R[O>>>3],O+=8;continue}for(;;){!V&&fe<q+32767&&(z=vt(z,q+32767),fe=z.length);var pe=Bt(R,O,ye),Re=H>>>1==1?yn[pe]:St[pe];if(O+=Re&15,Re>>>=4,(Re>>>8&255)===0)z[q++]=Re;else{if(Re==256)break;Re-=257;var Fe=Re<8?0:Re-4>>2;Fe>5&&(Fe=0);var Ue=q+oe[Re];Fe>0&&(Ue+=Bt(R,O,Fe),O+=Fe),pe=Bt(R,O,le),Re=H>>>1==1?Qt[pe]:on[pe],O+=Re&15,Re>>>=4;var Me=Re<4?0:Re-2>>1,Q=ve[Re];for(Me>0&&(Q+=Bt(R,O,Me),O+=Me),!V&&fe<Ue&&(z=vt(z,Ue+100),fe=z.length);q<Ue;)z[q]=z[q-Q],++q}}}return V?[z,O+7>>>3]:[z.slice(0,q),O+7>>>3]}function Ze(R,V){var O=R.slice(R.l||0),H=Ge(O,V);return R.l+=H[1],H[0]}function pt(R,V){if(R)typeof console<"u"&&console.error(V);else throw new Error(V)}function Zn(R,V){var O=R;Jn(O,0);var H=[],z=[],q={FileIndex:H,FullPaths:z};F(q,{root:V.root});for(var fe=O.length-4;(O[fe]!=80||O[fe+1]!=75||O[fe+2]!=5||O[fe+3]!=6)&&fe>=0;)--fe;O.l=fe+4,O.l+=4;var ye=O.read_shift(2);O.l+=6;var le=O.read_shift(4);for(O.l=le,fe=0;fe<ye;++fe){O.l+=20;var he=O.read_shift(4),pe=O.read_shift(4),Re=O.read_shift(2),Fe=O.read_shift(2),Ue=O.read_shift(2);O.l+=8;var Me=O.read_shift(4),Q=c(O.slice(O.l+Re,O.l+Re+Fe));O.l+=Re+Fe+Ue;var we=O.l;O.l=Me+4,jr(O,he,pe,q,Q),O.l=we}return q}function jr(R,V,O,H,z){R.l+=2;var q=R.read_shift(2),fe=R.read_shift(2),ye=l(R);if(q&8257)throw new Error("Unsupported ZIP encryption");for(var le=R.read_shift(4),he=R.read_shift(4),pe=R.read_shift(4),Re=R.read_shift(2),Fe=R.read_shift(2),Ue="",Me=0;Me<Re;++Me)Ue+=String.fromCharCode(R[R.l++]);if(Fe){var Q=c(R.slice(R.l,R.l+Fe));(Q[21589]||{}).mt&&(ye=Q[21589].mt),((z||{})[21589]||{}).mt&&(ye=z[21589].mt)}R.l+=Fe;var we=R.slice(R.l,R.l+he);switch(fe){case 8:we=Y(R,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+fe)}var Ae=!1;q&8&&(le=R.read_shift(4),le==134695760&&(le=R.read_shift(4),Ae=!0),he=R.read_shift(4),pe=R.read_shift(4)),he!=V&&pt(Ae,"Bad compressed size: "+V+" != "+he),pe!=O&&pt(Ae,"Bad uncompressed size: "+O+" != "+pe),dn(H,Ue,we,{unsafe:!0,mt:ye})}function ra(R,V){var O=V||{},H=[],z=[],q=Mn(1),fe=O.compression?8:0,ye=0,le=0,he=0,pe=0,Re=0,Fe=R.FullPaths[0],Ue=Fe,Me=R.FileIndex[0],Q=[],we=0;for(le=1;le<R.FullPaths.length;++le)if(Ue=R.FullPaths[le].slice(Fe.length),Me=R.FileIndex[le],!(!Me.size||!Me.content||Ue=="Sh33tJ5")){var Ae=pe,Pe=Mn(Ue.length);for(he=0;he<Ue.length;++he)Pe.write_shift(1,Ue.charCodeAt(he)&127);Pe=Pe.slice(0,Pe.l),Q[Re]=AP.buf(Me.content,0);var Ve=Me.content;fe==8&&(Ve=K(Ve)),q=Mn(30),q.write_shift(4,67324752),q.write_shift(2,20),q.write_shift(2,ye),q.write_shift(2,fe),Me.mt?i(q,Me.mt):q.write_shift(4,0),q.write_shift(-4,Q[Re]),q.write_shift(4,Ve.length),q.write_shift(4,Me.content.length),q.write_shift(2,Pe.length),q.write_shift(2,0),pe+=q.length,H.push(q),pe+=Pe.length,H.push(Pe),pe+=Ve.length,H.push(Ve),q=Mn(46),q.write_shift(4,33639248),q.write_shift(2,0),q.write_shift(2,20),q.write_shift(2,ye),q.write_shift(2,fe),q.write_shift(4,0),q.write_shift(-4,Q[Re]),q.write_shift(4,Ve.length),q.write_shift(4,Me.content.length),q.write_shift(2,Pe.length),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(4,0),q.write_shift(4,Ae),we+=q.l,z.push(q),we+=Pe.length,z.push(Pe),++Re}return q=Mn(22),q.write_shift(4,101010256),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,Re),q.write_shift(2,Re),q.write_shift(4,we),q.write_shift(4,pe),q.write_shift(2,0),Ws([Ws(H),Ws(z),q])}var _a={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function gs(R,V){if(R.ctype)return R.ctype;var O=R.name||"",H=O.match(/\.([^\.]+)$/);return H&&_a[H[1]]||V&&(H=(O=V).match(/[\.\\]([^\.\\])+$/),H&&_a[H[1]])?_a[H[1]]:"application/octet-stream"}function xs(R){for(var V=gw(R),O=[],H=0;H<V.length;H+=76)O.push(V.slice(H,H+76));return O.join(`\r
`)+`\r
`}function Va(R){var V=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(he){var pe=he.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var O=[],H=V.split(`\r
`),z=0;z<H.length;++z){var q=H[z];if(q.length==0){O.push("");continue}for(var fe=0;fe<q.length;){var ye=76,le=q.slice(fe,fe+ye);le.charAt(ye-1)=="="?ye--:le.charAt(ye-2)=="="?ye-=2:le.charAt(ye-3)=="="&&(ye-=3),le=q.slice(fe,fe+ye),fe+=ye,fe<q.length&&(le+="="),O.push(le)}}return O.join(`\r
`)}function Ha(R){for(var V=[],O=0;O<R.length;++O){for(var H=R[O];O<=R.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+R[++O];V.push(H)}for(var z=0;z<V.length;++z)V[z]=V[z].replace(/[=][0-9A-Fa-f]{2}/g,function(q){return String.fromCharCode(parseInt(q.slice(1),16))});return ha(V.join(`\r
`))}function vs(R,V,O){for(var H="",z="",q="",fe,ye=0;ye<10;++ye){var le=V[ye];if(!le||le.match(/^\s*$/))break;var he=le.match(/^(.*?):\s*([^\s].*)$/);if(he)switch(he[1].toLowerCase()){case"content-location":H=he[2].trim();break;case"content-type":q=he[2].trim();break;case"content-transfer-encoding":z=he[2].trim();break}}switch(++ye,z.toLowerCase()){case"base64":fe=ha(Ur(V.slice(ye).join("")));break;case"quoted-printable":fe=Ha(V.slice(ye));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var pe=dn(R,H.slice(O.length),fe,{unsafe:!0});q&&(pe.ctype=q)}function ii(R,V){if(J(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var O=V&&V.root||"",H=(Ct&&Buffer.isBuffer(R)?R.toString("binary"):J(R)).split(`\r
`),z=0,q="";for(z=0;z<H.length;++z)if(q=H[z],!!/^Content-Location:/i.test(q)&&(q=q.slice(q.indexOf("file")),O||(O=q.slice(0,q.lastIndexOf("/")+1)),q.slice(0,O.length)!=O))for(;O.length>0&&(O=O.slice(0,O.length-1),O=O.slice(0,O.lastIndexOf("/")+1),q.slice(0,O.length)!=O););var fe=(H[1]||"").match(/boundary="(.*?)"/);if(!fe)throw new Error("MAD cannot find boundary");var ye="--"+(fe[1]||""),le=[],he=[],pe={FileIndex:le,FullPaths:he};F(pe);var Re,Fe=0;for(z=0;z<H.length;++z){var Ue=H[z];Ue!==ye&&Ue!==ye+"--"||(Fe++&&vs(pe,H.slice(Re,z),O),Re=z)}return pe}function yr(R,V){var O=V||{},H=O.boundary||"SheetJS";H="------="+H;for(var z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],q=R.FullPaths[0],fe=q,ye=R.FileIndex[0],le=1;le<R.FullPaths.length;++le)if(fe=R.FullPaths[le].slice(q.length),ye=R.FileIndex[le],!(!ye.size||!ye.content||fe=="Sh33tJ5")){fe=fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(we){return"_x"+we.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(we){return"_u"+we.charCodeAt(0).toString(16)+"_"});for(var he=ye.content,pe=Ct&&Buffer.isBuffer(he)?he.toString("binary"):J(he),Re=0,Fe=Math.min(1024,pe.length),Ue=0,Me=0;Me<=Fe;++Me)(Ue=pe.charCodeAt(Me))>=32&&Ue<128&&++Re;var Q=Re>=Fe*4/5;z.push(H),z.push("Content-Location: "+(O.root||"file:///C:/SheetJS/")+fe),z.push("Content-Transfer-Encoding: "+(Q?"quoted-printable":"base64")),z.push("Content-Type: "+gs(ye,fe)),z.push(""),z.push(Q?Va(pe):xs(pe))}return z.push(H+`--\r
`),z.join(`\r
`)}function fn(R){var V={};return F(V,R),V}function dn(R,V,O,H){var z=H&&H.unsafe;z||F(R);var q=!z&&Nt.find(R,V);if(!q){var fe=R.FullPaths[0];V.slice(0,fe.length)==fe?fe=V:(fe.slice(-1)!="/"&&(fe+="/"),fe=(fe+V).replace("//","/")),q={name:a(V),type:2},R.FileIndex.push(q),R.FullPaths.push(fe),z||Nt.utils.cfb_gc(R)}return q.content=O,q.size=O?O.length:0,H&&(H.CLSID&&(q.clsid=H.CLSID),H.mt&&(q.mt=H.mt),H.ct&&(q.ct=H.ct)),q}function Vr(R,V){F(R);var O=Nt.find(R,V);if(O){for(var H=0;H<R.FileIndex.length;++H)if(R.FileIndex[H]==O)return R.FileIndex.splice(H,1),R.FullPaths.splice(H,1),!0}return!1}function yt(R,V,O){F(R);var H=Nt.find(R,V);if(H){for(var z=0;z<R.FileIndex.length;++z)if(R.FileIndex[z]==H)return R.FileIndex[z].name=a(O),R.FullPaths[z]=O,!0}return!1}function ys(R){P(R,!0)}return e.find=G,e.read=j,e.parse=g,e.write=D,e.writeFile=ae,e.utils={cfb_new:fn,cfb_add:dn,cfb_del:Vr,cfb_mov:yt,cfb_gc:ys,ReadShift:Bc,CheckField:PE,prep_blob:Jn,bconcat:Ws,use_zlib:M,_deflateRaw:tt,_inflateRaw:Ze,consts:ue},e}();function kP(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var n=e.read();return e.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+t)}function La(t){for(var e=Object.keys(t),n=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(t,e[r])&&n.push(e[r]);return n}function Bp(t){for(var e=[],n=La(t),r=0;r!==n.length;++r)e[t[n[r]]]=n[r];return e}var _d=new Date(1899,11,30,0,0,0);function vr(t,e){var n=t.getTime(),r=_d.getTime()+(t.getTimezoneOffset()-_d.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var gE=new Date,NP=_d.getTime()+(gE.getTimezoneOffset()-_d.getTimezoneOffset())*6e4,bw=gE.getTimezoneOffset();function jd(t){var e=new Date;return e.setTime(t*24*60*60*1e3+NP),e.getTimezoneOffset()!==bw&&e.setTime(e.getTime()+(e.getTimezoneOffset()-bw)*6e4),e}function RP(t){var e=0,n=0,r=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(n=1,i>3&&(r=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":n*=24;case"H":n*=60;case"M":if(r)n*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=n*parseInt(a[i],10)}return e}var Cw=new Date("2017-02-19T19:06:09.000Z"),xE=isNaN(Cw.getFullYear())?new Date("2/19/17"):Cw,DP=xE.getFullYear()==2017;function Gn(t,e){var n=new Date(t);if(DP)return e>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):e<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(t instanceof Date)return t;if(xE.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return t.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function $i(t,e){if(Ct&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Ic(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Ic(rE(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Ic(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Ic(new TextDecoder("utf-16be").decode(t.slice(2)))}var n={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return n[i]||i})}catch{}for(var r=[],a=0;a!=t.length;++a)r.push(String.fromCharCode(t[a]));return r.join("")}function Kn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=Kn(t[n]));return e}function xn(t,e){for(var n="";n.length<e;)n+=t;return n}function ga(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var n=1,r=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,i){return n=-n,i}),!isNaN(e=Number(r)))?e/n:e}var MP=["january","february","march","april","may","june","july","august","september","october","november","december"];function hl(t){var e=new Date(t),n=new Date(NaN),r=e.getYear(),a=e.getMonth(),i=e.getDate();if(isNaN(i))return n;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&MP.indexOf(l)==-1)return n}else if(l.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||i>1)&&r!=101?e:t.match(/[^-0-9:,\/\\]/)?n:e}var IP=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(n,r,a){if(t||typeof r=="string")return n.split(r);for(var i=n.split(r),l=[i[0]],c=1;c<i.length;++c)l.push(a),l.push(i[c]);return l}}();function vE(t){return t?t.content&&t.type?$i(t.content,!0):t.data?Rc(t.data):t.asNodeBuffer&&Ct?Rc(t.asNodeBuffer().toString("binary")):t.asBinary?Rc(t.asBinary()):t._data&&t._data.getContent?Rc($i(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function yE(t){if(!t)return null;if(t.data)return mw(t.data);if(t.asNodeBuffer&&Ct)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?mw(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function FP(t){return t&&t.name.slice(-4)===".bin"?yE(t):vE(t)}function Zr(t,e){for(var n=t.FullPaths||La(t.files),r=e.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),i=0;i<n.length;++i){var l=n[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||a==l)return t.files?t.files[n[i]]:t.FileIndex[i]}return null}function jp(t,e){var n=Zr(t,e);if(n==null)throw new Error("Cannot find file "+e+" in zip");return n}function Cn(t,e,n){if(!n)return FP(jp(t,e));if(!e)return null;try{return Cn(t,e)}catch{return null}}function Pr(t,e,n){if(!n)return vE(jp(t,e));if(!e)return null;try{return Pr(t,e)}catch{return null}}function LP(t,e,n){return yE(jp(t,e))}function Aw(t){for(var e=t.FullPaths||La(t.files),n=[],r=0;r<e.length;++r)e[r].slice(-1)!="/"&&n.push(e[r].replace(/^Root Entry[\/]/,""));return n.sort()}function OP(t,e,n){if(t.FullPaths){if(typeof n=="string"){var r;return Ct?r=Ki(n):r=tP(n),Nt.utils.cfb_add(t,e,r)}Nt.utils.cfb_add(t,e,n)}else t.file(e,n)}function _E(t,e){switch(e.type){case"base64":return Nt.read(t,{type:"base64"});case"binary":return Nt.read(t,{type:"binary"});case"buffer":case"array":return Nt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Mc(t,e){if(t.charAt(0)=="/")return t.slice(1);var n=e.split("/");e.slice(-1)!="/"&&n.pop();for(var r=t.split("/");r.length!==0;){var a=r.shift();a===".."?n.pop():a!=="."&&n.push(a)}return n.join("/")}var wE=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,PP=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,kw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,UP=/<[^>]*>/g,ur=wE.match(kw)?kw:UP,BP=/<\w*:/,jP=/<(\/?)\w+:/;function et(t,e,n){for(var r={},a=0,i=0;a!==t.length&&!((i=t.charCodeAt(a))===32||i===10||i===13);++a);if(e||(r[0]=t.slice(0,a)),a===t.length)return r;var l=t.match(PP),c=0,d="",f=0,g="",v="",_=1;if(l)for(f=0;f!=l.length;++f){for(v=l[f],i=0;i!=v.length&&v.charCodeAt(i)!==61;++i);for(g=v.slice(0,i).trim();v.charCodeAt(i+1)==32;)++i;for(_=(a=v.charCodeAt(i+1))==34||a==39?1:0,d=v.slice(i+1+_,v.length-_),c=0;c!=g.length&&g.charCodeAt(c)!==58;++c);if(c===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),r[g]=d,r[g.toLowerCase()]=d;else{var T=(c===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(c+1);if(r[T]&&g.slice(c-3,c)=="ext")continue;r[T]=d,r[T.toLowerCase()]=d}}return r}function Ba(t){return t.replace(jP,"<$1")}var TE={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},VP=Bp(TE),Dt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function n(r){var a=r+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(t,function(c,d){return TE[c]||String.fromCharCode(parseInt(d,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,d){return String.fromCharCode(parseInt(d,16))});var l=a.indexOf("]]>");return n(a.slice(0,i))+a.slice(i+9,l)+n(a.slice(l+3))}}(),HP=/[&<>'"]/g,$P=/[\u0000-\u001f]/g;function Vp(t){var e=t+"";return e.replace(HP,function(n){return VP[n]}).replace(/\n/g,"<br/>").replace($P,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}var Nw=function(){var t=/&#(\d+);/g;function e(n,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(t,e)}}();function rn(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function dm(t){for(var e="",n=0,r=0,a=0,i=0,l=0,c=0;n<t.length;){if(r=t.charCodeAt(n++),r<128){e+=String.fromCharCode(r);continue}if(a=t.charCodeAt(n++),r>191&&r<224){l=(r&31)<<6,l|=a&63,e+=String.fromCharCode(l);continue}if(i=t.charCodeAt(n++),r<240){e+=String.fromCharCode((r&15)<<12|(a&63)<<6|i&63);continue}l=t.charCodeAt(n++),c=((r&7)<<18|(a&63)<<12|(i&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function Rw(t){var e=ni(2*t.length),n,r,a=1,i=0,l=0,c;for(r=0;r<t.length;r+=a)a=1,(c=t.charCodeAt(r))<128?n=c:c<224?(n=(c&31)*64+(t.charCodeAt(r+1)&63),a=2):c<240?(n=(c&15)*4096+(t.charCodeAt(r+1)&63)*64+(t.charCodeAt(r+2)&63),a=3):(a=4,n=(c&7)*262144+(t.charCodeAt(r+1)&63)*4096+(t.charCodeAt(r+2)&63)*64+(t.charCodeAt(r+3)&63),n-=65536,l=55296+(n>>>10&1023),n=56320+(n&1023)),l!==0&&(e[i++]=l&255,e[i++]=l>>>8,l=0),e[i++]=n%256,e[i++]=n>>>8;return e.slice(0,i).toString("ucs2")}function Dw(t){return Ki(t,"binary").toString("utf8")}var Gf="foo bar bazâð£",Xt=Ct&&(Dw(Gf)==dm(Gf)&&Dw||Rw(Gf)==dm(Gf)&&Rw)||dm,Ic=Ct?function(t){return Ki(t,"utf8").toString("binary")}:function(t){for(var e=[],n=0,r=0,a=0;n<t.length;)switch(r=t.charCodeAt(n++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=t.charCodeAt(n++)-56320+(r<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},ru=function(){var t={};return function(n,r){var a=n+"|"+(r||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",r||"")}}(),EE=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)r=r.replace(t[a][0],t[a][1]);return r}}(),GP=function(){var t={};return function(n){return t[n]!==void 0?t[n]:t[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}}(),zP=/<\/?(?:vt:)?variant>/g,qP=/<(?:vt:)([^>]*)>([\s\S]*)</;function Mw(t,e){var n=et(t),r=t.match(GP(n.baseType))||[],a=[];if(r.length!=n.size){if(e.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return a}return r.forEach(function(i){var l=i.replace(zP,"").match(qP);l&&a.push({v:Xt(l[2]),t:l[1]})}),a}var YP=/(^\s|\s$|\n)/;function WP(t){return La(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function JP(t,e,n){return"<"+t+(n!=null?WP(n):"")+(e!=null?(e.match(YP)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Hp(t){if(Ct&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Xt(Xi(Op(t)));throw new Error("Bad input format: expected Buffer or string")}var au=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,KP={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},XP=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function ZP(t,e){for(var n=1-2*(t[e+7]>>>7),r=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,i=5;i>=0;--i)a=a*256+t[e+i];return r==2047?a==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}function QP(t,e,n){var r=(e<0||1/e==-1/0?1:0)<<7,a=0,i=0,l=r?-e:e;isFinite(l)?l==0?a=i=0:(a=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(e)?26985:0);for(var c=0;c<=5;++c,i/=256)t[n+c]=i&255;t[n+6]=(a&15)<<4|i&15,t[n+7]=a>>4|r}var Iw=function(t){for(var e=[],n=10240,r=0;r<t[0].length;++r)if(t[0][r])for(var a=0,i=t[0][r].length;a<i;a+=n)e.push.apply(e,t[0][r].slice(a,a+n));return e},Fw=Ct?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Ki(e)})):Iw(t)}:Iw,Lw=function(t,e,n){for(var r=[],a=e;a<n;a+=2)r.push(String.fromCharCode(ss(t,a)));return r.join("").replace(gr,"")},$p=Ct?function(t,e,n){return Buffer.isBuffer(t)?t.toString("utf16le",e,n).replace(gr,""):Lw(t,e,n)}:Lw,Ow=function(t,e,n){for(var r=[],a=e;a<e+n;++a)r.push(("0"+t[a].toString(16)).slice(-2));return r.join("")},SE=Ct?function(t,e,n){return Buffer.isBuffer(t)?t.toString("hex",e,e+n):Ow(t,e,n)}:Ow,Pw=function(t,e,n){for(var r=[],a=e;a<n;a++)r.push(String.fromCharCode(Zo(t,a)));return r.join("")},yu=Ct?function(e,n,r){return Buffer.isBuffer(e)?e.toString("utf8",n,r):Pw(e,n,r)}:Pw,bE=function(t,e){var n=Or(t,e);return n>0?yu(t,e+4,e+4+n-1):""},CE=bE,AE=function(t,e){var n=Or(t,e);return n>0?yu(t,e+4,e+4+n-1):""},kE=AE,NE=function(t,e){var n=2*Or(t,e);return n>0?yu(t,e+4,e+4+n-1):""},RE=NE,DE=function(e,n){var r=Or(e,n);return r>0?$p(e,n+4,n+4+r):""},ME=DE,IE=function(t,e){var n=Or(t,e);return n>0?yu(t,e+4,e+4+n):""},FE=IE,LE=function(t,e){return ZP(t,e)},wd=LE,OE=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ct&&(CE=function(e,n){if(!Buffer.isBuffer(e))return bE(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},kE=function(e,n){if(!Buffer.isBuffer(e))return AE(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},RE=function(e,n){if(!Buffer.isBuffer(e))return NE(e,n);var r=2*e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r-1)},ME=function(e,n){if(!Buffer.isBuffer(e))return DE(e,n);var r=e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r)},FE=function(e,n){if(!Buffer.isBuffer(e))return IE(e,n);var r=e.readUInt32LE(n);return e.toString("utf8",n+4,n+4+r)},wd=function(e,n){return Buffer.isBuffer(e)?e.readDoubleLE(n):LE(e,n)},OE=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Zo=function(t,e){return t[e]},ss=function(t,e){return t[e+1]*256+t[e]},eU=function(t,e){var n=t[e+1]*256+t[e];return n<32768?n:(65535-n+1)*-1},Or=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Ni=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},tU=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Bc(t,e){var n="",r,a,i=[],l,c,d,f;switch(e){case"dbcs":if(f=this.l,Ct&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*t).toString("utf16le");else for(d=0;d<t;++d)n+=String.fromCharCode(ss(this,f)),f+=2;t*=2;break;case"utf8":n=yu(this,this.l,this.l+t);break;case"utf16le":t*=2,n=$p(this,this.l,this.l+t);break;case"wstr":return Bc.call(this,t,"dbcs");case"lpstr-ansi":n=CE(this,this.l),t=4+Or(this,this.l);break;case"lpstr-cp":n=kE(this,this.l),t=4+Or(this,this.l);break;case"lpwstr":n=RE(this,this.l),t=4+2*Or(this,this.l);break;case"lpp4":t=4+Or(this,this.l),n=ME(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Or(this,this.l),n=FE(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,n="";(l=Zo(this,this.l+t++))!==0;)i.push($f(l));n=i.join("");break;case"_wstr":for(t=0,n="";(l=ss(this,this.l+t))!==0;)i.push($f(l)),t+=2;t+=2,n=i.join("");break;case"dbcs-cont":for(n="",f=this.l,d=0;d<t;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Zo(this,f),this.l=f+1,c=Bc.call(this,t-d,l?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push($f(ss(this,f))),f+=2}n=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(n="",f=this.l,d=0;d!=t;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Zo(this,f),this.l=f+1,c=Bc.call(this,t-d,l?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push($f(Zo(this,f))),f+=1}n=i.join("");break;default:switch(t){case 1:return r=Zo(this,this.l),this.l++,r;case 2:return r=(e==="i"?eU:ss)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(t>0?Ni:tU)(this,this.l),this.l+=4,r):(a=Or(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=wd(this,this.l):a=wd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:n=SE(this,this.l,t);break}}return this.l+=t,n}var nU=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24&255},rU=function(t,e,n){t[n]=e&255,t[n+1]=e>>8&255,t[n+2]=e>>16&255,t[n+3]=e>>24&255},aU=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255};function sU(t,e,n){var r=0,a=0;if(n==="dbcs"){for(a=0;a!=e.length;++a)aU(this,e.charCodeAt(a),this.l+2*a);r=2*e.length}else if(n==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;r=e.length}else if(n==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(n==="utf16le"){var i=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var l=e.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,nU(this,e,this.l);break;case 8:if(r=8,n==="f"){QP(this,e,this.l);break}case 16:break;case-4:r=4,rU(this,e,this.l);break}return this.l+=r,this}function PE(t,e){var n=SE(this,this.l,t.length>>1);if(n!==t)throw new Error(e+"Expected "+t+" saw "+n);this.l+=t.length>>1}function Jn(t,e){t.l=e,t.read_shift=Bc,t.chk=PE,t.write_shift=sU}function cr(t,e){t.l+=e}function Mn(t){var e=ni(t);return Jn(e,0),e}function ps(t,e,n){if(t){var r,a,i;Jn(t,t.l||0);for(var l=t.length,c=0,d=0;t.l<l;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var f=Ad[c]||Ad[65535];for(r=t.read_shift(1),i=r&127,a=1;a<4&&r&128;++a)i+=((r=t.read_shift(1))&127)<<7*a;d=t.l+i;var g=f.f&&f.f(t,i,n);if(t.l=d,e(g,f,c))return}}}function Qm(){var t=[],e=Ct?256:2048,n=function(f){var g=Mn(f);return Jn(g,0),g},r=n(e),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&t.push(r),r=null)},i=function(f){return r&&f<r.length-r.l?r:(a(),r=n(Math.max(f+1,e)))},l=function(){return a(),Ws(t)},c=function(f){a(),r=f,r.l==null&&(r.l=r.length),i(e)};return{next:i,push:c,end:l,_bufs:t}}function jc(t,e,n){var r=Kn(t);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Uw(t,e,n){var r=Kn(t);return r.s=jc(r.s,e.s,n),r.e=jc(r.e,e.s,n),r}function Vc(t,e){if(t.cRel&&t.c<0)for(t=Kn(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Kn(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var n=ot(t);return!t.cRel&&t.cRel!=null&&(n=lU(n)),!t.rRel&&t.rRel!=null&&(n=iU(n)),n}function hm(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Fn(t.s.c)+":"+(t.e.cRel?"":"$")+Fn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Xn(t.s.r)+":"+(t.e.rRel?"":"$")+Xn(t.e.r):Vc(t.s,e.biff)+":"+Vc(t.e,e.biff)}function Gp(t){return parseInt(oU(t),10)-1}function Xn(t){return""+(t+1)}function iU(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function oU(t){return t.replace(/\$(\d+)$/,"$1")}function zp(t){for(var e=cU(t),n=0,r=0;r!==e.length;++r)n=26*n+e.charCodeAt(r)-64;return n-1}function Fn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function lU(t){return t.replace(/^([A-Z])/,"$$$1")}function cU(t){return t.replace(/^\$([A-Z])/,"$1")}function uU(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function pr(t){for(var e=0,n=0,r=0;r<t.length;++r){var a=t.charCodeAt(r);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:e-1}}function ot(t){for(var e=t.c+1,n="";e;e=(e-1)/26|0)n=String.fromCharCode((e-1)%26+65)+n;return n+(t.r+1)}function Sl(t){var e=t.indexOf(":");return e==-1?{s:pr(t),e:pr(t)}:{s:pr(t.slice(0,e)),e:pr(t.slice(e+1))}}function Rt(t,e){return typeof e>"u"||typeof e=="number"?Rt(t.s,t.e):(typeof t!="string"&&(t=ot(t)),typeof e!="string"&&(e=ot(e)),t==e?t:t+":"+e)}function vn(t){var e={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,i=t.length;for(n=0;r<i&&!((a=t.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(e.s.c=--n,n=0;r<i&&!((a=t.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(e.s.r=--n,r===i||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,n=0;r!=i&&!((a=t.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(e.e.c=--n,n=0;r!=i&&!((a=t.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return e.e.r=--n,e}function Bw(t,e){var n=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=ea(t.z,n?vr(e):e)}catch{}try{return t.w=ea((t.XF||{}).numFmtId||(n?14:0),n?vr(e):e)}catch{return""+e}}function ds(t,e,n){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&n&&n.dateNF&&(t.z=n.dateNF),t.t=="e"?eo[t.v]||t.v:e==null?Bw(t,t.v):Bw(t,e))}function si(t,e){var n=e&&e.sheet?e.sheet:"Sheet1",r={};return r[n]=t,{SheetNames:[n],Sheets:r}}function UE(t,e,n){var r=n||{},a=t?Array.isArray(t):r.dense,i=t||(a?[]:{}),l=0,c=0;if(i&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var d=typeof r.origin=="string"?pr(r.origin):r.origin;l=d.r,c=d.c}i["!ref"]||(i["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var g=vn(i["!ref"]);f.s.c=g.s.c,f.s.r=g.s.r,f.e.c=Math.max(f.e.c,g.e.c),f.e.r=Math.max(f.e.r,g.e.r),l==-1&&(f.e.r=l=g.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=e[v].length;++_)if(!(typeof e[v][_]>"u")){var T={v:e[v][_]},E=l+v,S=c+_;if(f.s.r>E&&(f.s.r=E),f.s.c>S&&(f.s.c=S),f.e.r<E&&(f.e.r=E),f.e.c<S&&(f.e.c=S),e[v][_]&&typeof e[v][_]=="object"&&!Array.isArray(e[v][_])&&!(e[v][_]instanceof Date))T=e[v][_];else if(Array.isArray(T.v)&&(T.f=e[v][_][1],T.v=T.v[0]),T.v===null)if(T.f)T.t="n";else if(r.nullError)T.t="e",T.v=0;else if(r.sheetStubs)T.t="z";else continue;else typeof T.v=="number"?T.t="n":typeof T.v=="boolean"?T.t="b":T.v instanceof Date?(T.z=r.dateNF||ut[14],r.cellDates?(T.t="d",T.w=ea(T.z,vr(T.v))):(T.t="n",T.v=vr(T.v),T.w=ea(T.z,T.v))):T.t="s";if(a)i[E]||(i[E]=[]),i[E][S]&&i[E][S].z&&(T.z=i[E][S].z),i[E][S]=T;else{var b=ot({c:S,r:E});i[b]&&i[b].z&&(T.z=i[b].z),i[b]=T}}}return f.s.c<1e7&&(i["!ref"]=Rt(f)),i}function bl(t,e){return UE(null,t,e)}function fU(t){return t.read_shift(4,"i")}function lr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function dU(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function qp(t,e){var n=t.l,r=t.read_shift(1),a=lr(t),i=[],l={t:a,h:a};if((r&1)!==0){for(var c=t.read_shift(4),d=0;d!=c;++d)i.push(dU(t));l.r=i}else l.r=[{ich:0,ifnt:0}];return t.l=n+e,l}var hU=qp;function na(t){var e=t.read_shift(4),n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:n}}function Zi(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var mU=lr;function Yp(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var pU=lr,ep=Yp;function Wp(t){var e=t.slice(t.l,t.l+4),n=e[0]&1,r=e[0]&2;t.l+=4;var a=r===0?wd([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Ni(e,0)>>2;return n?a/100:a}function BE(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var Qi=BE;function sr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function gU(t){var e={},n=t.read_shift(1),r=n>>>1,a=t.read_shift(1),i=t.read_shift(2,"i"),l=t.read_shift(1),c=t.read_shift(1),d=t.read_shift(1);switch(t.l++,r){case 0:e.auto=1;break;case 1:e.index=a;var f=Fi[a];f&&(e.rgb=iu(f));break;case 2:e.rgb=iu([l,c,d]);break;case 3:e.theme=a;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function xU(t){var e=t.read_shift(1);t.l++;var n={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return n}function jE(t,e){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=t.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return n[t.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function vU(t){return jE(t,1)}function yU(t){return jE(t,2)}var Jp=2,br=3,zf=11,jw=12,Td=19,qf=64,_U=65,wU=71,TU=4108,EU=4126,$n=80,VE=81,SU=[$n,VE],bU={1:{n:"CodePage",t:Jp},2:{n:"Category",t:$n},3:{n:"PresentationFormat",t:$n},4:{n:"ByteCount",t:br},5:{n:"LineCount",t:br},6:{n:"ParagraphCount",t:br},7:{n:"SlideCount",t:br},8:{n:"NoteCount",t:br},9:{n:"HiddenCount",t:br},10:{n:"MultimediaClipCount",t:br},11:{n:"ScaleCrop",t:zf},12:{n:"HeadingPairs",t:TU},13:{n:"TitlesOfParts",t:EU},14:{n:"Manager",t:$n},15:{n:"Company",t:$n},16:{n:"LinksUpToDate",t:zf},17:{n:"CharacterCount",t:br},19:{n:"SharedDoc",t:zf},22:{n:"HyperlinksChanged",t:zf},23:{n:"AppVersion",t:br,p:"version"},24:{n:"DigSig",t:_U},26:{n:"ContentType",t:$n},27:{n:"ContentStatus",t:$n},28:{n:"Language",t:$n},29:{n:"Version",t:$n},255:{},2147483648:{n:"Locale",t:Td},2147483651:{n:"Behavior",t:Td},1919054434:{}},CU={1:{n:"CodePage",t:Jp},2:{n:"Title",t:$n},3:{n:"Subject",t:$n},4:{n:"Author",t:$n},5:{n:"Keywords",t:$n},6:{n:"Comments",t:$n},7:{n:"Template",t:$n},8:{n:"LastAuthor",t:$n},9:{n:"RevNumber",t:$n},10:{n:"EditTime",t:qf},11:{n:"LastPrinted",t:qf},12:{n:"CreatedDate",t:qf},13:{n:"ModifiedDate",t:qf},14:{n:"PageCount",t:br},15:{n:"WordCount",t:br},16:{n:"CharCount",t:br},17:{n:"Thumbnail",t:wU},18:{n:"Application",t:$n},19:{n:"DocSecurity",t:br},255:{},2147483648:{n:"Locale",t:Td},2147483651:{n:"Behavior",t:Td},1919054434:{}},Vw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},AU=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function kU(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var NU=kU([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Fi=Kn(NU),eo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},HE={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Hw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function RU(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function DU(t){var e=RU();if(!t||!t.match)return e;var n={};if((t.match(ur)||[]).forEach(function(r){var a=et(r);switch(a[0].replace(BP,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[a.Extension]=a.ContentType;break;case"<Override":e[Hw[a.ContentType]]!==void 0&&e[Hw[a.ContentType]].push(a.PartName);break}}),e.xmlns!==KP.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=n,delete e.calcchains,e}var el={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function tp(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Hc(t,e){var n={"!id":{}};if(!t)return n;e.charAt(0)!=="/"&&(e="/"+e);var r={};return(t.match(ur)||[]).forEach(function(a){var i=et(a);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:Mc(i.Target,e);n[c]=l,r[i.Id]=l}}),n["!id"]=r,n}var MU="application/vnd.oasis.opendocument.spreadsheet";function IU(t,e){for(var n=Hp(t),r,a;r=au.exec(n);)switch(r[3]){case"manifest":break;case"file-entry":if(a=et(r[0],!1),a.path=="/"&&a.type!==MU)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw r}}var $c=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],FU=function(){for(var t=new Array($c.length),e=0;e<$c.length;++e){var n=$c[e],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);t[e]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return t}();function $E(t){var e={};t=Xt(t);for(var n=0;n<$c.length;++n){var r=$c[n],a=t.match(FU[n]);a!=null&&a.length>0&&(e[r[1]]=Dt(a[1])),r[2]==="date"&&e[r[1]]&&(e[r[1]]=Gn(e[r[1]]))}return e}var LU=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function GE(t,e,n,r){var a=[];if(typeof t=="string")a=Mw(t,r);else for(var i=0;i<t.length;++i)a=a.concat(t[i].map(function(g){return{v:g}}));var l=typeof e=="string"?Mw(e,r).map(function(g){return g.v}):e,c=0,d=0;if(l.length>0)for(var f=0;f!==a.length;f+=2){switch(d=+a[f+1].v,a[f].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":n.Worksheets=d,n.SheetNames=l.slice(c,c+d);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":n.NamedRanges=d,n.DefinedNames=l.slice(c,c+d);break;case"Charts":case"Diagramme":n.Chartsheets=d,n.ChartNames=l.slice(c,c+d);break}c+=d}}function OU(t,e,n){var r={};return e||(e={}),t=Xt(t),LU.forEach(function(a){var i=(t.match(ru(a[0]))||[])[1];switch(a[2]){case"string":i&&(e[a[1]]=Dt(i));break;case"bool":e[a[1]]=i==="true";break;case"raw":var l=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(r[a[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&GE(r.HeadingPairs,r.TitlesOfParts,e,n),e}var PU=/<[^>]+>[^<]*/g;function UU(t,e){var n={},r="",a=t.match(PU);if(a)for(var i=0;i!=a.length;++i){var l=a[i],c=et(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Dt(c.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var d=l.split(">"),f=d[0].slice(4),g=d[1];switch(f){case"lpstr":case"bstr":case"lpwstr":n[r]=Dt(g);break;case"bool":n[r]=rn(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(g,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(g);break;case"filetime":case"date":n[r]=Gn(g);break;case"cy":case"error":n[r]=Dt(g);break;default:if(f.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,f,d)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return n}var BU={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},mm;function jU(t,e,n){mm||(mm=Bp(BU)),e=mm[e]||e,t[e]=n}function Kp(t){var e=t.read_shift(4),n=t.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function zE(t,e,n){var r=t.l,a=t.read_shift(0,"lpstr-cp");if(n)for(;t.l-r&3;)++t.l;return a}function qE(t,e,n){var r=t.read_shift(0,"lpwstr");return r}function YE(t,e,n){return e===31?qE(t):zE(t,e,n)}function np(t,e,n){return YE(t,e,n===!1?0:4)}function VU(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return YE(t,e,0)}function HU(t){for(var e=t.read_shift(4),n=[],r=0;r!=e;++r){var a=t.l;n[r]=t.read_shift(0,"lpwstr").replace(gr,""),t.l-a&2&&(t.l+=2)}return n}function $U(t){for(var e=t.read_shift(4),n=[],r=0;r!=e;++r)n[r]=t.read_shift(0,"lpstr-cp").replace(gr,"");return n}function GU(t){var e=t.l,n=Ed(t,VE);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var r=Ed(t,br);return[n,r]}function zU(t){for(var e=t.read_shift(4),n=[],r=0;r<e/2;++r)n.push(GU(t));return n}function $w(t,e){for(var n=t.read_shift(4),r={},a=0;a!=n;++a){var i=t.read_shift(4),l=t.read_shift(4);r[i]=t.read_shift(l,e===1200?"utf16le":"utf8").replace(gr,"").replace(Dc,"!"),e===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),r}function WE(t){var e=t.read_shift(4),n=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),n}function qU(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Ed(t,e,n){var r=t.read_shift(2),a,i=n||{};if(t.l+=2,e!==jw&&r!==e&&SU.indexOf(e)===-1&&!((e&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+e+" saw "+r);switch(e===jw?r:e){case 2:return a=t.read_shift(2,"i"),i.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return zE(t,r,4).replace(gr,"");case 31:return qE(t);case 64:return Kp(t);case 65:return WE(t);case 71:return qU(t);case 80:return np(t,r,!i.raw).replace(gr,"");case 81:return VU(t,r).replace(gr,"");case 4108:return zU(t);case 4126:case 4127:return r==4127?HU(t):$U(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}}function Gw(t,e){var n=t.l,r=t.read_shift(4),a=t.read_shift(4),i=[],l=0,c=0,d=-1,f={};for(l=0;l!=a;++l){var g=t.read_shift(4),v=t.read_shift(4);i[l]=[g,v+n]}i.sort(function(A,C){return A[1]-C[1]});var _={};for(l=0;l!=a;++l){if(t.l!==i[l][1]){var T=!0;if(l>0&&e)switch(e[i[l-1][0]].t){case 2:t.l+2===i[l][1]&&(t.l+=2,T=!1);break;case 80:t.l<=i[l][1]&&(t.l=i[l][1],T=!1);break;case 4108:t.l<=i[l][1]&&(t.l=i[l][1],T=!1);break}if((!e||l==0)&&t.l<=i[l][1]&&(T=!1,t.l=i[l][1]),T)throw new Error("Read Error: Expected address "+i[l][1]+" at "+t.l+" :"+l)}if(e){var E=e[i[l][0]];if(_[E.n]=Ed(t,E.t,{raw:!0}),E.p==="version"&&(_[E.n]=String(_[E.n]>>16)+"."+("0000"+String(_[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(_[E.n]){case 0:_[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ma(c=_[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[E.n])}}else if(i[l][0]===1){if(c=_.CodePage=Ed(t,Jp),ma(c),d!==-1){var S=t.l;t.l=i[d][1],f=$w(t,c),t.l=S}}else if(i[l][0]===0){if(c===0){d=l,t.l=i[l+1][1];continue}f=$w(t,c)}else{var b=f[i[l][0]],k;switch(t[t.l]){case 65:t.l+=4,k=WE(t);break;case 30:t.l+=4,k=np(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,k=np(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,k=t.read_shift(4,"i");break;case 19:t.l+=4,k=t.read_shift(4);break;case 5:t.l+=4,k=t.read_shift(8,"f");break;case 11:t.l+=4,k=Tn(t,4);break;case 64:t.l+=4,k=Gn(Kp(t));break;default:throw new Error("unparsed value: "+t[t.l])}_[b]=k}}return t.l=n+r,_}function zw(t,e,n){var r=t.content;if(!r)return{};Jn(r,0);var a,i,l,c,d=0;r.chk("feff","Byte Order: "),r.read_shift(2);var f=r.read_shift(4),g=r.read_shift(16);if(g!==Nt.utils.consts.HEADER_CLSID&&g!==n)throw new Error("Bad PropertySet CLSID "+g);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=r.read_shift(16),c=r.read_shift(4),a===1&&c!==r.l)throw new Error("Length mismatch: "+c+" !== "+r.l);a===2&&(l=r.read_shift(16),d=r.read_shift(4));var v=Gw(r,e),_={SystemIdentifier:f};for(var T in v)_[T]=v[T];if(_.FMTID=i,a===1)return _;if(d-r.l==2&&(r.l+=2),r.l!==d)throw new Error("Length mismatch 2: "+r.l+" !== "+d);var E;try{E=Gw(r,null)}catch{}for(T in E)_[T]=E[T];return _.FMTID=[i,l],_}function $s(t,e){return t.read_shift(e),null}function YU(t,e,n){for(var r=[],a=t.l+e;t.l<a;)r.push(n(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return r}function Tn(t,e){return t.read_shift(e)===1}function An(t){return t.read_shift(2,"u")}function JE(t,e){return YU(t,e,An)}function WU(t){var e=t.read_shift(1),n=t.read_shift(1);return n===1?e:e===1}function _u(t,e,n){var r=t.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var i=t.read_shift(1);i&&(a="dbcs-cont")}else n.biff==12&&(a="wstr");n.biff>=2&&n.biff<=5&&(a="cpstr");var l=r?t.read_shift(r,a):"";return l}function JU(t){var e=t.read_shift(2),n=t.read_shift(1),r=n&4,a=n&8,i=1+(n&1),l=0,c,d={};a&&(l=t.read_shift(2)),r&&(c=t.read_shift(4));var f=i==2?"dbcs-cont":"sbcs-cont",g=e===0?"":t.read_shift(e,f);return a&&(t.l+=4*l),r&&(t.l+=c),d.t=g,a||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function Gi(t,e,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return t.read_shift(e,"cpstr");if(n.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?r=t.read_shift(e,"sbcs-cont"):r=t.read_shift(e,"dbcs-cont"),r}function wu(t,e,n){var r=t.read_shift(n&&n.biff==2?1:2);return r===0?(t.l++,""):Gi(t,r,n)}function to(t,e,n){if(n.biff>5)return wu(t,e,n);var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,n.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function KU(t){var e=t.read_shift(1);t.l++;var n=t.read_shift(2);return t.l+=2,[e,n]}function XU(t){var e=t.read_shift(4),n=t.l,r=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),t.l=n);var a=t.read_shift((r?e-24:e)>>1,"utf16le").replace(gr,"");return r&&(t.l+=24),a}function ZU(t){for(var e=t.read_shift(2),n="";e-- >0;)n+="../";var r=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return n+r.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(i>>1,"utf16le").replace(gr,"");return n+l}function QU(t,e){var n=t.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return XU(t);case"0303000000000000c000000000000046":return ZU(t);default:throw new Error("Unsupported Moniker "+n)}}function Yf(t){var e=t.read_shift(4),n=e>0?t.read_shift(e,"utf16le").replace(gr,""):"";return n}function e7(t,e){var n=t.l+e,r=t.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=t.read_shift(2);t.l+=2;var i,l,c,d,f="",g,v;a&16&&(i=Yf(t,n-t.l)),a&128&&(l=Yf(t,n-t.l)),(a&257)===257&&(c=Yf(t,n-t.l)),(a&257)===1&&(d=QU(t,n-t.l)),a&8&&(f=Yf(t,n-t.l)),a&32&&(g=t.read_shift(16)),a&64&&(v=Kp(t)),t.l=n;var _=l||c||d||"";_&&f&&(_+="#"+f),_||(_="#"+f),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var T={Target:_};return g&&(T.guid=g),v&&(T.time=v),i&&(T.Tooltip=i),T}function KE(t){var e=t.read_shift(1),n=t.read_shift(1),r=t.read_shift(1),a=t.read_shift(1);return[e,n,r,a]}function XE(t,e){var n=KE(t);return n[3]=0,n}function ja(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2);return{r:e,c:n,ixfe:r}}function t7(t){var e=t.read_shift(2),n=t.read_shift(2);return t.l+=8,{type:e,flags:n}}function n7(t,e,n){return e===0?"":to(t,e,n)}function r7(t,e,n){var r=n.biff>8?4:2,a=t.read_shift(r),i=t.read_shift(r,"i"),l=t.read_shift(r,"i");return[a,i,l]}function ZE(t){var e=t.read_shift(2),n=Wp(t);return[e,n]}function a7(t,e,n){t.l+=4,e-=4;var r=t.l+e,a=_u(t,e,n),i=t.read_shift(2);if(r-=t.l,i!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+i);return t.l+=i,a}function Vd(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return{s:{c:r,r:e},e:{c:a,r:n}}}function QE(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(1),a=t.read_shift(1);return{s:{c:r,r:e},e:{c:a,r:n}}}var s7=QE;function eS(t){t.l+=4;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2);return t.l+=12,[n,e,r]}function i7(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function o7(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function tr(t){t.l+=2,t.l+=t.read_shift(2)}var l7={0:tr,4:tr,5:tr,6:tr,7:o7,8:tr,9:tr,10:tr,11:tr,12:tr,13:i7,14:tr,15:tr,16:tr,17:tr,18:tr,19:tr,20:tr,21:eS};function c7(t,e){for(var n=t.l+e,r=[];t.l<n;){var a=t.read_shift(2);t.l-=2;try{r.push(l7[a](t,n-t.l))}catch{return t.l=n,r}}return t.l!=n&&(t.l=n),r}function Wf(t,e){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=t.read_shift(2),e-=2,e>=2&&(n.dt=t.read_shift(2),t.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return t.read_shift(e),n}function u7(t,e){return e===0||t.read_shift(2),1200}function f7(t,e,n){if(n.enc)return t.l+=e,"";var r=t.l,a=to(t,0,n);return t.read_shift(e+r-t.l),a}function d7(t,e,n){var r=n&&n.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function h7(t,e,n){var r=t.read_shift(4),a=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=_u(t,0,n);return l.length===0&&(l="Sheet1"),{pos:r,hs:a,dt:i,name:l}}function m7(t,e){for(var n=t.l+e,r=t.read_shift(4),a=t.read_shift(4),i=[],l=0;l!=a&&t.l<n;++l)i.push(JU(t));return i.Count=r,i.Unique=a,i}function p7(t,e){var n={};return n.dsst=t.read_shift(2),t.l+=e-2,n}function g7(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var n=t.read_shift(2);t.l+=4;var r=t.read_shift(1);return t.l+=3,r&7&&(e.level=r&7),r&32&&(e.hidden=!0),r&64&&(e.hpt=n/20),e}function x7(t){var e=t7(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var n=t.read_shift(4);return n!==0}function v7(t){return t.read_shift(2),t.read_shift(4)}function qw(t,e,n){var r=0;n&&n.biff==2||(r=t.read_shift(2));var a=t.read_shift(2);n&&n.biff==2&&(r=1-(a>>15),a&=32767);var i={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[i,a]}function y7(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),d=t.read_shift(2),f=t.read_shift(2);return{Pos:[e,n],Dim:[r,a],Flags:i,CurTab:l,FirstTab:c,Selected:d,TabRatio:f}}function _7(t,e,n){if(n&&n.biff>=2&&n.biff<5)return{};var r=t.read_shift(2);return{RTL:r&64}}function w7(){}function T7(t,e,n){var r={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return r.name=_u(t,0,n),r}function E7(t){var e=ja(t);return e.isst=t.read_shift(4),e}function S7(t,e,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=t.l+e,a=ja(t);n.biff==2&&t.l++;var i=wu(t,r-t.l,n);return a.val=i,a}function b7(t,e,n){var r=t.read_shift(2),a=to(t,0,n);return[r,a]}var C7=to;function Yw(t,e,n){var r=t.l+e,a=n.biff==8||!n.biff?4:2,i=t.read_shift(a),l=t.read_shift(a),c=t.read_shift(2),d=t.read_shift(2);return t.l=r,{s:{r:i,c},e:{r:l,c:d}}}function A7(t){var e=t.read_shift(2),n=t.read_shift(2),r=ZE(t);return{r:e,c:n,ixfe:r[0],rknum:r[1]}}function k7(t,e){for(var n=t.l+e-2,r=t.read_shift(2),a=t.read_shift(2),i=[];t.l<n;)i.push(ZE(t));if(t.l!==n)throw new Error("MulRK read error");var l=t.read_shift(2);if(i.length!=l-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:l,rkrec:i}}function N7(t,e){for(var n=t.l+e-2,r=t.read_shift(2),a=t.read_shift(2),i=[];t.l<n;)i.push(t.read_shift(2));if(t.l!==n)throw new Error("MulBlank read error");var l=t.read_shift(2);if(i.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:l,ixfe:i}}function R7(t,e,n,r){var a={},i=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(4),d=t.read_shift(2);return a.patternType=AU[c>>26],r.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=d&127,a.icvBack=d>>7&127,a.fsxButton=d>>14&1),a}function D7(t,e,n){var r={};return r.ifnt=t.read_shift(2),r.numFmtId=t.read_shift(2),r.flags=t.read_shift(2),r.fStyle=r.flags>>2&1,e-=6,r.data=R7(t,e,r.fStyle,n),r}function M7(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function Ww(t,e,n){var r=ja(t);(n.biff==2||e==9)&&++t.l;var a=WU(t);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function I7(t,e,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=ja(t),a=sr(t);return r.val=a,r}var Jw=n7;function F7(t,e,n){var r=t.l+e,a=t.read_shift(2),i=t.read_shift(2);if(n.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=Gi(t,i),c=[];r>t.l;)c.push(wu(t));return[i,a,l,c]}function Kw(t,e,n){var r=t.read_shift(2),a,i={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return n.sbcch===14849&&(a=a7(t,e-2,n)),i.body=a||t.read_shift(e-2),typeof a=="string"&&(i.Name=a),i}var L7=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Xw(t,e,n){var r=t.l+e,a=t.read_shift(2),i=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(n&&n.biff==2?1:2),d=0;(!n||n.biff>=5)&&(n.biff!=5&&(t.l+=2),d=t.read_shift(2),n.biff==5&&(t.l+=2),t.l+=4);var f=Gi(t,l,n);a&32&&(f=L7[f.charCodeAt(0)]);var g=r-t.l;n&&n.biff==2&&--g;var v=r==t.l||c===0||!(g>0)?[]:gV(t,g,n,c);return{chKey:i,Name:f,itab:d,rgce:v}}function tS(t,e,n){if(n.biff<8)return O7(t,e,n);for(var r=[],a=t.l+e,i=t.read_shift(n.biff>8?4:2);i--!==0;)r.push(r7(t,n.biff>8?12:6,n));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return r}function O7(t,e,n){t[t.l+1]==3&&t[t.l]++;var r=_u(t,e,n);return r.charCodeAt(0)==3?r.slice(1):r}function P7(t,e,n){if(n.biff<8){t.l+=e;return}var r=t.read_shift(2),a=t.read_shift(2),i=Gi(t,r,n),l=Gi(t,a,n);return[i,l]}function U7(t,e,n){var r=QE(t);t.l++;var a=t.read_shift(1);return e-=8,[xV(t,e,n),a,r]}function Zw(t,e,n){var r=s7(t);switch(n.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[r,mV(t,e,n)]}function B7(t){var e=t.read_shift(4)!==0,n=t.read_shift(4)!==0,r=t.read_shift(4);return[e,n,r]}function j7(t,e,n){if(!(n.biff<8)){var r=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),c=to(t,0,n);return n.biff<8&&t.read_shift(1),[{r,c:a},c,l,i]}}function V7(t,e,n){return j7(t,e,n)}function H7(t,e){for(var n=[],r=t.read_shift(2);r--;)n.push(Vd(t));return n}function $7(t,e,n){if(n&&n.biff<8)return z7(t,e,n);var r=eS(t),a=c7(t,e-22,r[1]);return{cmo:r,ft:a}}var G7={8:function(t,e){var n=t.l+e;t.l+=10;var r=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=n,{fmt:r}}};function z7(t,e,n){t.l+=4;var r=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var l=[];return l.push((G7[r]||cr)(t,e,n)),{cmo:[a,r,i],ft:l}}function q7(t,e,n){var r=t.l,a="";try{t.l+=4;var i=(n.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:l=KU(t,6,n);var c=t.read_shift(2);t.read_shift(2),An(t,2);var d=t.read_shift(2);t.l+=d;for(var f=1;f<t.lens.length-1;++f){if(t.l-r!=t.lens[f])throw new Error("TxO: bad continue record");var g=t[t.l],v=Gi(t,t.lens[f+1]-t.lens[f]-1);if(a+=v,a.length>=(g?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return t.l=r+e,{t:a}}catch{return t.l=r+e,{t:a}}}function Y7(t,e){var n=Vd(t);t.l+=16;var r=e7(t,e-24);return[n,r]}function W7(t,e){t.read_shift(2);var n=Vd(t),r=t.read_shift((e-10)/2,"dbcs-cont");return r=r.replace(gr,""),[n,r]}function J7(t){var e=[0,0],n;return n=t.read_shift(2),e[0]=Vw[n]||n,n=t.read_shift(2),e[1]=Vw[n]||n,e}function K7(t){for(var e=t.read_shift(2),n=[];e-- >0;)n.push(XE(t));return n}function X7(t){for(var e=t.read_shift(2),n=[];e-- >0;)n.push(XE(t));return n}function Z7(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function nS(t,e,n){if(!n.cellStyles)return cr(t,e);var r=n&&n.biff>=12?4:2,a=t.read_shift(r),i=t.read_shift(r),l=t.read_shift(r),c=t.read_shift(r),d=t.read_shift(2);r==2&&(t.l+=2);var f={s:a,e:i,w:l,ixfe:c,flags:d};return(n.biff>=5||!n.biff)&&(f.level=d>>8&7),f}function Q7(t,e){var n={};return e<32||(t.l+=16,n.header=sr(t),n.footer=sr(t),t.l+=2),n}function e9(t,e,n){var r={area:!1};if(n.biff!=5)return t.l+=e,r;var a=t.read_shift(1);return t.l+=3,a&16&&(r.area=!0),r}var t9=ja,n9=JE,r9=wu;function a9(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),a={fmt:e,env:n,len:r,data:t.slice(t.l,t.l+r)};return t.l+=r,a}function s9(t,e,n){n.biffguess&&n.biff==5&&(n.biff=2);var r=ja(t);++t.l;var a=to(t,e-7,n);return r.t="str",r.val=a,r}function i9(t){var e=ja(t);++t.l;var n=sr(t);return e.t="n",e.val=n,e}function o9(t){var e=ja(t);++t.l;var n=t.read_shift(2);return e.t="n",e.val=n,e}function l9(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function c9(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function u9(t,e,n){var r=t.l+e,a=ja(t),i=t.read_shift(2),l=Gi(t,i,n);return t.l=r,a.t="str",a.val=l,a}var f9=[2,3,48,49,131,139,140,245],Qw=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Bp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(c,d){var f=[],g=ni(1);switch(d.type){case"base64":g=ha(Ur(c));break;case"binary":g=ha(c);break;case"buffer":case"array":g=c;break}Jn(g,0);var v=g.read_shift(1),_=!!(v&136),T=!1,E=!1;switch(v){case 2:break;case 3:break;case 48:T=!0,_=!0;break;case 49:T=!0,_=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var S=0,b=521;v==2&&(S=g.read_shift(2)),g.l+=3,v!=2&&(S=g.read_shift(4)),S>1048576&&(S=1e6),v!=2&&(b=g.read_shift(2));var k=g.read_shift(2),A=d.codepage||1252;v!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(A=t[g[g.l]]),g.l+=1,g.l+=2),E&&(g.l+=36);for(var C=[],I={},B=Math.min(g.length,v==2?521:b-10-(T?264:0)),j=E?32:11;g.l<B&&g[g.l]!=13;)switch(I={},I.name=tu.utils.decode(A,g.slice(g.l,g.l+j)).replace(/[\u0000\r\n].*$/g,""),g.l+=j,I.type=String.fromCharCode(g.read_shift(1)),v!=2&&!E&&(I.offset=g.read_shift(4)),I.len=g.read_shift(1),v==2&&(I.offset=g.read_shift(2)),I.dec=g.read_shift(1),I.name.length&&C.push(I),v!=2&&(g.l+=E?13:14),I.type){case"B":(!T||I.len!=8)&&d.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+I.type)}if(g[g.l]!==13&&(g.l=b-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=b;var F=0,X=0;for(f[0]=[],X=0;X!=C.length;++X)f[0][X]=C[X].name;for(;S-- >0;){if(g[g.l]===42){g.l+=k;continue}for(++g.l,f[++F]=[],X=0,X=0;X!=C.length;++X){var P=g.slice(g.l,g.l+C[X].len);g.l+=C[X].len,Jn(P,0);var re=tu.utils.decode(A,P);switch(C[X].type){case"C":re.trim().length&&(f[F][X]=re.replace(/\s+$/,""));break;case"D":re.length===8?f[F][X]=new Date(+re.slice(0,4),+re.slice(4,6)-1,+re.slice(6,8)):f[F][X]=re;break;case"F":f[F][X]=parseFloat(re.trim());break;case"+":case"I":f[F][X]=E?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(re.trim().toUpperCase()){case"Y":case"T":f[F][X]=!0;break;case"N":case"F":f[F][X]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+re+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));f[F][X]="##MEMO##"+(E?parseInt(re.trim(),10):P.read_shift(4));break;case"N":re=re.replace(/\u0000/g,"").trim(),re&&re!="."&&(f[F][X]=+re||0);break;case"@":f[F][X]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":f[F][X]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":f[F][X]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[F][X]=-P.read_shift(-8,"f");break;case"B":if(T&&C[X].len==8){f[F][X]=P.read_shift(8,"f");break}case"G":case"P":P.l+=C[X].len;break;case"0":if(C[X].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[X].type)}}}if(v!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return d&&d.sheetRows&&(f=f.slice(0,d.sheetRows)),d.DBF=C,f}function r(c,d){var f=d||{};f.dateNF||(f.dateNF="yyyymmdd");var g=bl(n(c,f),f);return g["!cols"]=f.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete f.DBF,g}function a(c,d){try{return si(r(c,d),d)}catch(f){if(d&&d.WTF)throw f}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,d){var f=d||{};if(+f.codepage>=0&&ma(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var g=Qm(),v=cp(c,{header:1,raw:!0,cellDates:!0}),_=v[0],T=v.slice(1),E=c["!cols"]||[],S=0,b=0,k=0,A=1;for(S=0;S<_.length;++S){if(((E[S]||{}).DBF||{}).name){_[S]=E[S].DBF.name,++k;continue}if(_[S]!=null){if(++k,typeof _[S]=="number"&&(_[S]=_[S].toString(10)),typeof _[S]!="string")throw new Error("DBF Invalid column name "+_[S]+" |"+typeof _[S]+"|");if(_.indexOf(_[S])!==S){for(b=0;b<1024;++b)if(_.indexOf(_[S]+"_"+b)==-1){_[S]+="_"+b;break}}}}var C=vn(c["!ref"]),I=[],B=[],j=[];for(S=0;S<=C.e.c-C.s.c;++S){var F="",X="",P=0,re=[];for(b=0;b<T.length;++b)T[b][S]!=null&&re.push(T[b][S]);if(re.length==0||_[S]==null){I[S]="?";continue}for(b=0;b<re.length;++b){switch(typeof re[b]){case"number":X="B";break;case"string":X="C";break;case"boolean":X="L";break;case"object":X=re[b]instanceof Date?"D":"C";break;default:X="C"}P=Math.max(P,String(re[b]).length),F=F&&F!=X?"C":X}P>250&&(P=250),X=((E[S]||{}).DBF||{}).type,X=="C"&&E[S].DBF.len>P&&(P=E[S].DBF.len),F=="B"&&X=="N"&&(F="N",j[S]=E[S].DBF.dec,P=E[S].DBF.len),B[S]=F=="C"||X=="N"?P:i[F]||0,A+=B[S],I[S]=F}var G=g.next(32);for(G.write_shift(4,318902576),G.write_shift(4,T.length),G.write_shift(2,296+32*k),G.write_shift(2,A),S=0;S<4;++S)G.write_shift(4,0);for(G.write_shift(4,0|(+e[tE]||3)<<8),S=0,b=0;S<_.length;++S)if(_[S]!=null){var te=g.next(32),_e=(_[S].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);te.write_shift(1,_e,"sbcs"),te.write_shift(1,I[S]=="?"?"C":I[S],"sbcs"),te.write_shift(4,b),te.write_shift(1,B[S]||i[I[S]]||0),te.write_shift(1,j[S]||0),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(1,0),te.write_shift(4,0),te.write_shift(4,0),b+=B[S]||i[I[S]]||0}var Ne=g.next(264);for(Ne.write_shift(4,13),S=0;S<65;++S)Ne.write_shift(4,0);for(S=0;S<T.length;++S){var Ee=g.next(A);for(Ee.write_shift(1,0),b=0;b<_.length;++b)if(_[b]!=null)switch(I[b]){case"L":Ee.write_shift(1,T[S][b]==null?63:T[S][b]?84:70);break;case"B":Ee.write_shift(8,T[S][b]||0,"f");break;case"N":var se="0";for(typeof T[S][b]=="number"&&(se=T[S][b].toFixed(j[b]||0)),k=0;k<B[b]-se.length;++k)Ee.write_shift(1,32);Ee.write_shift(1,se,"sbcs");break;case"D":T[S][b]?(Ee.write_shift(4,("0000"+T[S][b].getFullYear()).slice(-4),"sbcs"),Ee.write_shift(2,("00"+(T[S][b].getMonth()+1)).slice(-2),"sbcs"),Ee.write_shift(2,("00"+T[S][b].getDate()).slice(-2),"sbcs")):Ee.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(T[S][b]!=null?T[S][b]:"").slice(0,B[b]);for(Ee.write_shift(1,ue,"sbcs"),k=0;k<B[b]-ue.length;++k)Ee.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:a,to_sheet:r,from_sheet:l}}(),d9=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+La(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(_,T){var E=t[T];return typeof E=="number"?pw(E):E},r=function(_,T,E){var S=T.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return S==59?_:pw(S)};t["|"]=254;function a(_,T){switch(T.type){case"base64":return i(Ur(_),T);case"binary":return i(_,T);case"buffer":return i(Ct&&Buffer.isBuffer(_)?_.toString("binary"):Xi(_),T);case"array":return i($i(_),T)}throw new Error("Unrecognized type "+T.type)}function i(_,T){var E=_.split(/[\n\r]+/),S=-1,b=-1,k=0,A=0,C=[],I=[],B=null,j={},F=[],X=[],P=[],re=0,G;for(+T.codepage>=0&&ma(+T.codepage);k!==E.length;++k){re=0;var te=E[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,n),_e=te.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),Ne=_e[0],Ee;if(te.length>0)switch(Ne){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":_e[1].charAt(0)=="P"&&I.push(te.slice(3).replace(/;;/g,";"));break;case"C":var se=!1,ue=!1,ae=!1,J=!1,D=-1,ee=-1;for(A=1;A<_e.length;++A)switch(_e[A].charAt(0)){case"A":break;case"X":b=parseInt(_e[A].slice(1))-1,ue=!0;break;case"Y":for(S=parseInt(_e[A].slice(1))-1,ue||(b=0),G=C.length;G<=S;++G)C[G]=[];break;case"K":Ee=_e[A].slice(1),Ee.charAt(0)==='"'?Ee=Ee.slice(1,Ee.length-1):Ee==="TRUE"?Ee=!0:Ee==="FALSE"?Ee=!1:isNaN(ga(Ee))?isNaN(hl(Ee).getDate())||(Ee=Gn(Ee)):(Ee=ga(Ee),B!==null&&El(B)&&(Ee=jd(Ee))),se=!0;break;case"E":J=!0;var M=al(_e[A].slice(1),{r:S,c:b});C[S][b]=[C[S][b],M];break;case"S":ae=!0,C[S][b]=[C[S][b],"S5S"];break;case"G":break;case"R":D=parseInt(_e[A].slice(1))-1;break;case"C":ee=parseInt(_e[A].slice(1))-1;break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+te)}if(se&&(C[S][b]&&C[S][b].length==2?C[S][b][0]=Ee:C[S][b]=Ee,B=null),ae){if(J)throw new Error("SYLK shared formula cannot have own formula");var Y=D>-1&&C[D][ee];if(!Y||!Y[1])throw new Error("SYLK shared formula cannot find base");C[S][b][1]=dS(Y[1],{r:S-D,c:b-ee})}break;case"F":var K=0;for(A=1;A<_e.length;++A)switch(_e[A].charAt(0)){case"X":b=parseInt(_e[A].slice(1))-1,++K;break;case"Y":for(S=parseInt(_e[A].slice(1))-1,G=C.length;G<=S;++G)C[G]=[];break;case"M":re=parseInt(_e[A].slice(1))/20;break;case"F":break;case"G":break;case"P":B=I[parseInt(_e[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=_e[A].slice(1).split(" "),G=parseInt(P[0],10);G<=parseInt(P[1],10);++G)re=parseInt(P[2],10),X[G-1]=re===0?{hidden:!0}:{wch:re},ml(X[G-1]);break;case"C":b=parseInt(_e[A].slice(1))-1,X[b]||(X[b]={});break;case"R":S=parseInt(_e[A].slice(1))-1,F[S]||(F[S]={}),re>0?(F[S].hpt=re,F[S].hpx=ou(re)):re===0&&(F[S].hidden=!0);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+te)}K<1&&(B=null);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+te)}}return F.length>0&&(j["!rows"]=F),X.length>0&&(j["!cols"]=X),T&&T.sheetRows&&(C=C.slice(0,T.sheetRows)),[C,j]}function l(_,T){var E=a(_,T),S=E[0],b=E[1],k=bl(S,T);return La(b).forEach(function(A){k[A]=b[A]}),k}function c(_,T){return si(l(_,T),T)}function d(_,T,E,S){var b="C;Y"+(E+1)+";X"+(S+1)+";K";switch(_.t){case"n":b+=_.v||0,_.f&&!_.F&&(b+=";E"+ZB(_.f,{r:E,c:S}));break;case"b":b+=_.v?"TRUE":"FALSE";break;case"e":b+=_.w||_.v;break;case"d":b+='"'+(_.w||_.v)+'"';break;case"s":b+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function f(_,T){T.forEach(function(E,S){var b="F;W"+(S+1)+" "+(S+1)+" ";E.hidden?b+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=bd(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=Cd(E.wpx)),typeof E.wch=="number"&&(b+=Math.round(E.wch))),b.charAt(b.length-1)!=" "&&_.push(b)})}function g(_,T){T.forEach(function(E,S){var b="F;";E.hidden?b+="M0;":E.hpt?b+="M"+20*E.hpt+";":E.hpx&&(b+="M"+20*cS(E.hpx)+";"),b.length>2&&_.push(b+"R"+(S+1))})}function v(_,T){var E=["ID;PWXL;N;E"],S=[],b=vn(_["!ref"]),k,A=Array.isArray(_),C=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),_["!cols"]&&f(E,_["!cols"]),_["!rows"]&&g(E,_["!rows"]),E.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var I=b.s.r;I<=b.e.r;++I)for(var B=b.s.c;B<=b.e.c;++B){var j=ot({r:I,c:B});k=A?(_[I]||[])[B]:_[j],!(!k||k.v==null&&(!k.f||k.F))&&S.push(d(k,_,I,B))}return E.join(C)+C+S.join(C)+C+"E"+C}return{to_workbook:c,to_sheet:l,from_sheet:v}}(),h9=function(){function t(i,l){switch(l.type){case"base64":return e(Ur(i),l);case"binary":return e(i,l);case"buffer":return e(Ct&&Buffer.isBuffer(i)?i.toString("binary"):Xi(i),l);case"array":return e($i(i),l)}throw new Error("Unrecognized type "+l.type)}function e(i,l){for(var c=i.split(`
`),d=-1,f=-1,g=0,v=[];g!==c.length;++g){if(c[g].trim()==="BOT"){v[++d]=[],f=0;continue}if(!(d<0)){var _=c[g].trim().split(","),T=_[0],E=_[1];++g;for(var S=c[g]||"";(S.match(/["]/g)||[]).length&1&&g<c.length-1;)S+=`
`+c[++g];switch(S=S.trim(),+T){case-1:if(S==="BOT"){v[++d]=[],f=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?v[d][f]=!0:S==="FALSE"?v[d][f]=!1:isNaN(ga(E))?isNaN(hl(E).getDate())?v[d][f]=E:v[d][f]=Gn(E):v[d][f]=ga(E),++f;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),v[d][f++]=S!==""?S:null;break}if(S==="EOD")break}}return l&&l.sheetRows&&(v=v.slice(0,l.sheetRows)),v}function n(i,l){return bl(t(i,l),l)}function r(i,l){return si(n(i,l),l)}var a=function(){var i=function(d,f,g,v,_){d.push(f),d.push(g+","+v),d.push('"'+_.replace(/"/g,'""')+'"')},l=function(d,f,g,v){d.push(f+","+g),d.push(f==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(d){var f=[],g=vn(d["!ref"]),v,_=Array.isArray(d);i(f,"TABLE",0,1,"sheetjs"),i(f,"VECTORS",0,g.e.r-g.s.r+1,""),i(f,"TUPLES",0,g.e.c-g.s.c+1,""),i(f,"DATA",0,0,"");for(var T=g.s.r;T<=g.e.r;++T){l(f,-1,0,"BOT");for(var E=g.s.c;E<=g.e.c;++E){var S=ot({r:T,c:E});if(v=_?(d[T]||[])[E]:d[S],!v){l(f,1,0,"");continue}switch(v.t){case"n":var b=v.w;!b&&v.v!=null&&(b=v.v),b==null?v.f&&!v.F?l(f,1,0,"="+v.f):l(f,1,0,""):l(f,0,b,"V");break;case"b":l(f,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":l(f,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=ea(v.z||ut[14],vr(Gn(v.v)))),l(f,0,v.w,"V");break;default:l(f,1,0,"")}}}l(f,-1,0,"EOD");var k=`\r
`,A=f.join(k);return A}}();return{to_workbook:r,to_sheet:n,from_sheet:a}}(),m9=function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(v,_){for(var T=v.split(`
`),E=-1,S=-1,b=0,k=[];b!==T.length;++b){var A=T[b].trim().split(":");if(A[0]==="cell"){var C=pr(A[1]);if(k.length<=C.r)for(E=k.length;E<=C.r;++E)k[E]||(k[E]=[]);switch(E=C.r,S=C.c,A[2]){case"t":k[E][S]=t(A[3]);break;case"v":k[E][S]=+A[3];break;case"vtf":var I=A[A.length-1];case"vtc":switch(A[3]){case"nl":k[E][S]=!!+A[4];break;default:k[E][S]=+A[4];break}A[2]=="vtf"&&(k[E][S]=[k[E][S],I])}}}return _&&_.sheetRows&&(k=k.slice(0,_.sheetRows)),k}function r(v,_){return bl(n(v,_),_)}function a(v,_){return si(r(v,_),_)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function f(v){if(!v||!v["!ref"])return"";for(var _=[],T=[],E,S="",b=Sl(v["!ref"]),k=Array.isArray(v),A=b.s.r;A<=b.e.r;++A)for(var C=b.s.c;C<=b.e.c;++C)if(S=ot({r:A,c:C}),E=k?(v[A]||[])[C]:v[S],!(!E||E.v==null||E.t==="z")){switch(T=["cell",S,"t"],E.t){case"s":case"str":T.push(e(E.v));break;case"n":E.f?(T[2]="vtf",T[3]="n",T[4]=E.v,T[5]=e(E.f)):(T[2]="v",T[3]=E.v);break;case"b":T[2]="vt"+(E.f?"f":"c"),T[3]="nl",T[4]=E.v?"1":"0",T[5]=e(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var I=vr(Gn(E.v));T[2]="vtc",T[3]="nd",T[4]=""+I,T[5]=E.w||ea(E.z||ut[14],I);break;case"e":continue}_.push(T.join(":"))}return _.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function g(v){return[i,l,c,l,f(v),d].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:g}}(),su=function(){function t(g,v,_,T,E){E.raw?v[_][T]=g:g===""||(g==="TRUE"?v[_][T]=!0:g==="FALSE"?v[_][T]=!1:isNaN(ga(g))?isNaN(hl(g).getDate())?v[_][T]=g:v[_][T]=Gn(g):v[_][T]=ga(g))}function e(g,v){var _=v||{},T=[];if(!g||g.length===0)return T;for(var E=g.split(/[\r\n]/),S=E.length-1;S>=0&&E[S].length===0;)--S;for(var b=10,k=0,A=0;A<=S;++A)k=E[A].indexOf(" "),k==-1?k=E[A].length:k++,b=Math.max(b,k);for(A=0;A<=S;++A){T[A]=[];var C=0;for(t(E[A].slice(0,b).trim(),T,A,C,_),C=1;C<=(E[A].length-b)/10+1;++C)t(E[A].slice(b+(C-1)*10,b+C*10).trim(),T,A,C,_)}return _.sheetRows&&(T=T.slice(0,_.sheetRows)),T}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(g){for(var v={},_=!1,T=0,E=0;T<g.length;++T)(E=g.charCodeAt(T))==34?_=!_:!_&&E in n&&(v[E]=(v[E]||0)+1);E=[];for(T in v)Object.prototype.hasOwnProperty.call(v,T)&&E.push([v[T],T]);if(!E.length){v=r;for(T in v)Object.prototype.hasOwnProperty.call(v,T)&&E.push([v[T],T])}return E.sort(function(S,b){return S[0]-b[0]||r[S[1]]-r[b[1]]}),n[E.pop()[1]]||44}function i(g,v){var _=v||{},T="",E=_.dense?[]:{},S={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(T=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(T=g.charAt(4),g=g.slice(6)):T=a(g.slice(0,1024)):_&&_.FS?T=_.FS:T=a(g.slice(0,1024));var b=0,k=0,A=0,C=0,I=0,B=T.charCodeAt(0),j=!1,F=0,X=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var P=_.dateNF!=null?bP(_.dateNF):null;function re(){var G=g.slice(C,I),te={};if(G.charAt(0)=='"'&&G.charAt(G.length-1)=='"'&&(G=G.slice(1,-1).replace(/""/g,'"')),G.length===0)te.t="z";else if(_.raw)te.t="s",te.v=G;else if(G.trim().length===0)te.t="s",te.v=G;else if(G.charCodeAt(0)==61)G.charCodeAt(1)==34&&G.charCodeAt(G.length-1)==34?(te.t="s",te.v=G.slice(2,-1).replace(/""/g,'"')):ej(G)?(te.t="n",te.f=G.slice(1)):(te.t="s",te.v=G);else if(G=="TRUE")te.t="b",te.v=!0;else if(G=="FALSE")te.t="b",te.v=!1;else if(!isNaN(A=ga(G)))te.t="n",_.cellText!==!1&&(te.w=G),te.v=A;else if(!isNaN(hl(G).getDate())||P&&G.match(P)){te.z=_.dateNF||ut[14];var _e=0;P&&G.match(P)&&(G=CP(G,_.dateNF,G.match(P)||[]),_e=1),_.cellDates?(te.t="d",te.v=Gn(G,_e)):(te.t="n",te.v=vr(Gn(G,_e))),_.cellText!==!1&&(te.w=ea(te.z,te.v instanceof Date?vr(te.v):te.v)),_.cellNF||delete te.z}else te.t="s",te.v=G;if(te.t=="z"||(_.dense?(E[b]||(E[b]=[]),E[b][k]=te):E[ot({c:k,r:b})]=te),C=I+1,X=g.charCodeAt(C),S.e.c<k&&(S.e.c=k),S.e.r<b&&(S.e.r=b),F==B)++k;else if(k=0,++b,_.sheetRows&&_.sheetRows<=b)return!0}e:for(;I<g.length;++I)switch(F=g.charCodeAt(I)){case 34:X===34&&(j=!j);break;case B:case 10:case 13:if(!j&&re())break e;break}return I-C>0&&re(),E["!ref"]=Rt(S),E}function l(g,v){return!(v&&v.PRN)||v.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?i(g,v):bl(e(g,v),v)}function c(g,v){var _="",T=v.type=="string"?[0,0,0,0]:ag(g,v);switch(v.type){case"base64":_=Ur(g);break;case"binary":_=g;break;case"buffer":v.codepage==65001?_=g.toString("utf8"):v.codepage&&typeof tu<"u"||(_=Ct&&Buffer.isBuffer(g)?g.toString("binary"):Xi(g));break;case"array":_=$i(g);break;case"string":_=g;break;default:throw new Error("Unrecognized type "+v.type)}return T[0]==239&&T[1]==187&&T[2]==191?_=Xt(_.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?_=Xt(_):v.type=="binary"&&typeof tu<"u",_.slice(0,19)=="socialcalc:version:"?m9.to_sheet(v.type=="string"?_:Xt(_),v):l(_,v)}function d(g,v){return si(c(g,v),v)}function f(g){for(var v=[],_=vn(g["!ref"]),T,E=Array.isArray(g),S=_.s.r;S<=_.e.r;++S){for(var b=[],k=_.s.c;k<=_.e.c;++k){var A=ot({r:S,c:k});if(T=E?(g[S]||[])[k]:g[A],!T||T.v==null){b.push("          ");continue}for(var C=(T.w||(ds(T),T.w)||"").slice(0,10);C.length<10;)C+=" ";b.push(C+(k===0?" ":""))}v.push(b.join(""))}return v.join(`
`)}return{to_workbook:d,to_sheet:c,from_sheet:f}}();function p9(t,e){var n=e||{},r=!!n.WTF;n.WTF=!0;try{var a=d9.to_workbook(t,n);return n.WTF=r,a}catch(i){if(n.WTF=r,!i.message.match(/SYLK bad record ID/)&&r)throw i;return su.to_workbook(t,e)}}var Gc=function(){function t(M,Y,K){if(M){Jn(M,M.l||0);for(var W=K.Enum||D;M.l<M.length;){var oe=M.read_shift(2),ve=W[oe]||W[65535],Te=M.read_shift(2),De=M.l+Te,Se=ve.f&&ve.f(M,Te,K);if(M.l=De,Y(Se,ve,oe))return}}}function e(M,Y){switch(Y.type){case"base64":return n(ha(Ur(M)),Y);case"binary":return n(ha(M),Y);case"buffer":case"array":return n(M,Y)}throw"Unsupported type "+Y.type}function n(M,Y){if(!M)return M;var K=Y||{},W=K.dense?[]:{},oe="Sheet1",ve="",Te=0,De={},Se=[],Be=[],Z={s:{r:0,c:0},e:{r:0,c:0}},dt=K.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)K.Enum=D,t(M,function(Ie,Bt,an){switch(an){case 0:K.vers=Ie,Ie>=4096&&(K.qpro=!0);break;case 6:Z=Ie;break;case 204:Ie&&(ve=Ie);break;case 222:ve=Ie;break;case 15:case 51:K.qpro||(Ie[1].v=Ie[1].v.slice(1));case 13:case 14:case 16:an==14&&(Ie[2]&112)==112&&(Ie[2]&15)>1&&(Ie[2]&15)<15&&(Ie[1].z=K.dateNF||ut[14],K.cellDates&&(Ie[1].t="d",Ie[1].v=jd(Ie[1].v))),K.qpro&&Ie[3]>Te&&(W["!ref"]=Rt(Z),De[oe]=W,Se.push(oe),W=K.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},Te=Ie[3],oe=ve||"Sheet"+(Te+1),ve="");var sn=K.dense?(W[Ie[0].r]||[])[Ie[0].c]:W[ot(Ie[0])];if(sn){sn.t=Ie[1].t,sn.v=Ie[1].v,Ie[1].z!=null&&(sn.z=Ie[1].z),Ie[1].f!=null&&(sn.f=Ie[1].f);break}K.dense?(W[Ie[0].r]||(W[Ie[0].r]=[]),W[Ie[0].r][Ie[0].c]=Ie[1]):W[ot(Ie[0])]=Ie[1];break}},K);else if(M[2]==26||M[2]==14)K.Enum=ee,M[2]==14&&(K.qpro=!0,M.l=0),t(M,function(Ie,Bt,an){switch(an){case 204:oe=Ie;break;case 22:Ie[1].v=Ie[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ie[3]>Te&&(W["!ref"]=Rt(Z),De[oe]=W,Se.push(oe),W=K.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},Te=Ie[3],oe="Sheet"+(Te+1)),dt>0&&Ie[0].r>=dt)break;K.dense?(W[Ie[0].r]||(W[Ie[0].r]=[]),W[Ie[0].r][Ie[0].c]=Ie[1]):W[ot(Ie[0])]=Ie[1],Z.e.c<Ie[0].c&&(Z.e.c=Ie[0].c),Z.e.r<Ie[0].r&&(Z.e.r=Ie[0].r);break;case 27:Ie[14e3]&&(Be[Ie[14e3][0]]=Ie[14e3][1]);break;case 1537:Be[Ie[0]]=Ie[1],Ie[0]==Te&&(oe=Ie[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(W["!ref"]=Rt(Z),De[ve||oe]=W,Se.push(ve||oe),!Be.length)return{SheetNames:Se,Sheets:De};for(var Ke={},xt=[],nt=0;nt<Be.length;++nt)De[Se[nt]]?(xt.push(Be[nt]||Se[nt]),Ke[Be[nt]]=De[Be[nt]]||De[Se[nt]]):(xt.push(Be[nt]),Ke[Be[nt]]={"!ref":"A1"});return{SheetNames:xt,Sheets:Ke}}function r(M,Y){var K=Y||{};if(+K.codepage>=0&&ma(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var W=Qm(),oe=vn(M["!ref"]),ve=Array.isArray(M),Te=[];ua(W,0,i(1030)),ua(W,6,d(oe));for(var De=Math.min(oe.e.r,8191),Se=oe.s.r;Se<=De;++Se)for(var Be=Xn(Se),Z=oe.s.c;Z<=oe.e.c;++Z){Se===oe.s.r&&(Te[Z]=Fn(Z));var dt=Te[Z]+Be,Ke=ve?(M[Se]||[])[Z]:M[dt];if(!(!Ke||Ke.t=="z"))if(Ke.t=="n")(Ke.v|0)==Ke.v&&Ke.v>=-32768&&Ke.v<=32767?ua(W,13,T(Se,Z,Ke.v)):ua(W,14,S(Se,Z,Ke.v));else{var xt=ds(Ke);ua(W,15,v(Se,Z,xt.slice(0,239)))}}return ua(W,1),W.end()}function a(M,Y){var K=Y||{};if(+K.codepage>=0&&ma(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var W=Qm();ua(W,0,l(M));for(var oe=0,ve=0;oe<M.SheetNames.length;++oe)(M.Sheets[M.SheetNames[oe]]||{})["!ref"]&&ua(W,27,J(M.SheetNames[oe],ve++));var Te=0;for(oe=0;oe<M.SheetNames.length;++oe){var De=M.Sheets[M.SheetNames[oe]];if(!(!De||!De["!ref"])){for(var Se=vn(De["!ref"]),Be=Array.isArray(De),Z=[],dt=Math.min(Se.e.r,8191),Ke=Se.s.r;Ke<=dt;++Ke)for(var xt=Xn(Ke),nt=Se.s.c;nt<=Se.e.c;++nt){Ke===Se.s.r&&(Z[nt]=Fn(nt));var Ie=Z[nt]+xt,Bt=Be?(De[Ke]||[])[nt]:De[Ie];if(!(!Bt||Bt.t=="z"))if(Bt.t=="n")ua(W,23,re(Ke,nt,Te,Bt.v));else{var an=ds(Bt);ua(W,22,F(Ke,nt,Te,an.slice(0,239)))}}++Te}}return ua(W,1),W.end()}function i(M){var Y=Mn(2);return Y.write_shift(2,M),Y}function l(M){var Y=Mn(26);Y.write_shift(2,4096),Y.write_shift(2,4),Y.write_shift(4,0);for(var K=0,W=0,oe=0,ve=0;ve<M.SheetNames.length;++ve){var Te=M.SheetNames[ve],De=M.Sheets[Te];if(!(!De||!De["!ref"])){++oe;var Se=Sl(De["!ref"]);K<Se.e.r&&(K=Se.e.r),W<Se.e.c&&(W=Se.e.c)}}return K>8191&&(K=8191),Y.write_shift(2,K),Y.write_shift(1,oe),Y.write_shift(1,W),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(1,1),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(4,0),Y}function c(M,Y,K){var W={s:{c:0,r:0},e:{c:0,r:0}};return Y==8&&K.qpro?(W.s.c=M.read_shift(1),M.l++,W.s.r=M.read_shift(2),W.e.c=M.read_shift(1),M.l++,W.e.r=M.read_shift(2),W):(W.s.c=M.read_shift(2),W.s.r=M.read_shift(2),Y==12&&K.qpro&&(M.l+=2),W.e.c=M.read_shift(2),W.e.r=M.read_shift(2),Y==12&&K.qpro&&(M.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function d(M){var Y=Mn(8);return Y.write_shift(2,M.s.c),Y.write_shift(2,M.s.r),Y.write_shift(2,M.e.c),Y.write_shift(2,M.e.r),Y}function f(M,Y,K){var W=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(W[0].c=M.read_shift(1),W[3]=M.read_shift(1),W[0].r=M.read_shift(2),M.l+=2):(W[2]=M.read_shift(1),W[0].c=M.read_shift(2),W[0].r=M.read_shift(2)),W}function g(M,Y,K){var W=M.l+Y,oe=f(M,Y,K);if(oe[1].t="s",K.vers==20768){M.l++;var ve=M.read_shift(1);return oe[1].v=M.read_shift(ve,"utf8"),oe}return K.qpro&&M.l++,oe[1].v=M.read_shift(W-M.l,"cstr"),oe}function v(M,Y,K){var W=Mn(7+K.length);W.write_shift(1,255),W.write_shift(2,Y),W.write_shift(2,M),W.write_shift(1,39);for(var oe=0;oe<W.length;++oe){var ve=K.charCodeAt(oe);W.write_shift(1,ve>=128?95:ve)}return W.write_shift(1,0),W}function _(M,Y,K){var W=f(M,Y,K);return W[1].v=M.read_shift(2,"i"),W}function T(M,Y,K){var W=Mn(7);return W.write_shift(1,255),W.write_shift(2,Y),W.write_shift(2,M),W.write_shift(2,K,"i"),W}function E(M,Y,K){var W=f(M,Y,K);return W[1].v=M.read_shift(8,"f"),W}function S(M,Y,K){var W=Mn(13);return W.write_shift(1,255),W.write_shift(2,Y),W.write_shift(2,M),W.write_shift(8,K,"f"),W}function b(M,Y,K){var W=M.l+Y,oe=f(M,Y,K);if(oe[1].v=M.read_shift(8,"f"),K.qpro)M.l=W;else{var ve=M.read_shift(2);I(M.slice(M.l,M.l+ve),oe),M.l+=ve}return oe}function k(M,Y,K){var W=Y&32768;return Y&=-32769,Y=(W?M:0)+(Y>=8192?Y-16384:Y),(W?"":"$")+(K?Fn(Y):Xn(Y))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function I(M,Y){Jn(M,0);for(var K=[],W=0,oe="",ve="",Te="",De="";M.l<M.length;){var Se=M[M.l++];switch(Se){case 0:K.push(M.read_shift(8,"f"));break;case 1:ve=k(Y[0].c,M.read_shift(2),!0),oe=k(Y[0].r,M.read_shift(2),!1),K.push(ve+oe);break;case 2:{var Be=k(Y[0].c,M.read_shift(2),!0),Z=k(Y[0].r,M.read_shift(2),!1);ve=k(Y[0].c,M.read_shift(2),!0),oe=k(Y[0].r,M.read_shift(2),!1),K.push(Be+Z+":"+ve+oe)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(M.read_shift(2));break;case 6:{for(var dt="";Se=M[M.l++];)dt+=String.fromCharCode(Se);K.push('"'+dt.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:De=K.pop(),Te=K.pop(),K.push(["AND","OR"][Se-20]+"("+Te+","+De+")");break;default:if(Se<32&&C[Se])De=K.pop(),Te=K.pop(),K.push(Te+C[Se]+De);else if(A[Se]){if(W=A[Se][1],W==69&&(W=M[M.l++]),W>K.length){console.error("WK1 bad formula parse 0x"+Se.toString(16)+":|"+K.join("|")+"|");return}var Ke=K.slice(-W);K.length-=W,K.push(A[Se][0]+"("+Ke.join(",")+")")}else return Se<=7?console.error("WK1 invalid opcode "+Se.toString(16)):Se<=24?console.error("WK1 unsupported op "+Se.toString(16)):Se<=30?console.error("WK1 invalid opcode "+Se.toString(16)):Se<=115?console.error("WK1 unsupported function opcode "+Se.toString(16)):console.error("WK1 unrecognized opcode "+Se.toString(16))}}K.length==1?Y[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function B(M){var Y=[{c:0,r:0},{t:"n",v:0},0];return Y[0].r=M.read_shift(2),Y[3]=M[M.l++],Y[0].c=M[M.l++],Y}function j(M,Y){var K=B(M);return K[1].t="s",K[1].v=M.read_shift(Y-4,"cstr"),K}function F(M,Y,K,W){var oe=Mn(6+W.length);oe.write_shift(2,M),oe.write_shift(1,K),oe.write_shift(1,Y),oe.write_shift(1,39);for(var ve=0;ve<W.length;++ve){var Te=W.charCodeAt(ve);oe.write_shift(1,Te>=128?95:Te)}return oe.write_shift(1,0),oe}function X(M,Y){var K=B(M);K[1].v=M.read_shift(2);var W=K[1].v>>1;if(K[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return K[1].v=W,K}function P(M,Y){var K=B(M),W=M.read_shift(4),oe=M.read_shift(4),ve=M.read_shift(2);if(ve==65535)return W===0&&oe===3221225472?(K[1].t="e",K[1].v=15):W===0&&oe===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var Te=ve&32768;return ve=(ve&32767)-16446,K[1].v=(1-Te*2)*(oe*Math.pow(2,ve+32)+W*Math.pow(2,ve)),K}function re(M,Y,K,W){var oe=Mn(14);if(oe.write_shift(2,M),oe.write_shift(1,K),oe.write_shift(1,Y),W==0)return oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(2,65535),oe;var ve=0,Te=0,De=0,Se=0;return W<0&&(ve=1,W=-W),Te=Math.log2(W)|0,W/=Math.pow(2,Te-31),Se=W>>>0,(Se&2147483648)==0&&(W/=2,++Te,Se=W>>>0),W-=Se,Se|=2147483648,Se>>>=0,W*=Math.pow(2,32),De=W>>>0,oe.write_shift(4,De),oe.write_shift(4,Se),Te+=16383+(ve?32768:0),oe.write_shift(2,Te),oe}function G(M,Y){var K=P(M);return M.l+=Y-14,K}function te(M,Y){var K=B(M),W=M.read_shift(4);return K[1].v=W>>6,K}function _e(M,Y){var K=B(M),W=M.read_shift(8,"f");return K[1].v=W,K}function Ne(M,Y){var K=_e(M);return M.l+=Y-10,K}function Ee(M,Y){return M[M.l+Y-1]==0?M.read_shift(Y,"cstr"):""}function se(M,Y){var K=M[M.l++];K>Y-1&&(K=Y-1);for(var W="";W.length<K;)W+=String.fromCharCode(M[M.l++]);return W}function ue(M,Y,K){if(!(!K.qpro||Y<21)){var W=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var oe=M.read_shift(Y-21,"cstr");return[W,oe]}}function ae(M,Y){for(var K={},W=M.l+Y;M.l<W;){var oe=M.read_shift(2);if(oe==14e3){for(K[oe]=[0,""],K[oe][0]=M.read_shift(2);M[M.l];)K[oe][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return K}function J(M,Y){var K=Mn(5+M.length);K.write_shift(2,14e3),K.write_shift(2,Y);for(var W=0;W<M.length;++W){var oe=M.charCodeAt(W);K[K.l++]=oe>127?95:oe}return K[K.l++]=0,K}var D={0:{n:"BOF",f:An},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ee},222:{n:"SHEETNAMELP",f:se},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:X},25:{n:"FORMULA19",f:G},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ae},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:te},38:{n:"??"},39:{n:"NUMBER27",f:_e},40:{n:"FORMULA28",f:Ne},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:e}}();function g9(t){var e={},n=t.match(ur),r=0,a=!1;if(n)for(;r!=n.length;++r){var i=et(n[r]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=Fp[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return e}var x9=function(){var t=ru("t"),e=ru("rPr");function n(i){var l=i.match(t);if(!l)return{t:"s",v:""};var c={t:"s",v:Dt(l[1])},d=i.match(e);return d&&(c.s=g9(d[1])),c}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(a).map(n).filter(function(c){return c.v})}}(),v9=function(){var e=/(\r\n|\n)/g;function n(a,i,l){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),a.b&&(i.push("<b>"),l.push("</b>")),a.i&&(i.push("<i>"),l.push("</i>")),a.strike&&(i.push("<s>"),l.push("</s>"));var d=a.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(i.push("<"+d+">"),l.push("</"+d+">")),l.push("</span>"),a}function r(a){var i=[[],a.v,[]];return a.v?(a.s&&n(a.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(r).join("")}}(),y9=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,_9=/<(?:\w+:)?r>/,w9=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Xp(t,e){var n=e?e.cellHTML:!0,r={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Dt(Xt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Xt(t),n&&(r.h=Vp(r.t))):t.match(_9)&&(r.r=Xt(t),r.t=Dt(Xt((t.replace(w9,"").match(y9)||[]).join("").replace(ur,""))),n&&(r.h=v9(x9(r.r)))),r):{t:""}}var T9=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,E9=/<(?:\w+:)?(?:si|sstItem)>/g,S9=/<\/(?:\w+:)?(?:si|sstItem)>/;function b9(t,e){var n=[],r="";if(!t)return n;var a=t.match(T9);if(a){r=a[2].replace(E9,"").split(S9);for(var i=0;i!=r.length;++i){var l=Xp(r[i].trim(),e);l!=null&&(n[n.length]=l)}a=et(a[1]),n.Count=a.count,n.Unique=a.uniqueCount}return n}function C9(t){return[t.read_shift(4),t.read_shift(4)]}function A9(t,e){var n=[],r=!1;return ps(t,function(i,l,c){switch(c){case 159:n.Count=i[0],n.Unique=i[1];break;case 19:n.push(i);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function rS(t){for(var e=[],n=t.split(""),r=0;r<n.length;++r)e[r]=n[r].charCodeAt(0);return e}function ls(t,e){var n={};return n.Major=t.read_shift(2),n.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),n}function k9(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=ls(t,4),e.U=ls(t,4),e.W=ls(t,4),e}function N9(t){for(var e=t.read_shift(4),n=t.l+e-4,r={},a=t.read_shift(4),i=[];a-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(r.name=t.read_shift(0,"lpp4"),r.comps=i,t.l!=n)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+n);return r}function R9(t){var e=[];t.l+=4;for(var n=t.read_shift(4);n-- >0;)e.push(N9(t));return e}function D9(t){var e=[];t.l+=4;for(var n=t.read_shift(4);n-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function M9(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=ls(t,4),e.U=ls(t,4),e.W=ls(t,4),e}function I9(t){var e=M9(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function aS(t,e){var n=t.l+e,r={};r.Flags=t.read_shift(4)&63,t.l+=4,r.AlgID=t.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=t.read_shift(4),r.KeySize=t.read_shift(4),r.ProviderType=t.read_shift(4),t.l+=8,r.CSPName=t.read_shift(n-t.l>>1,"utf16le"),t.l=n,r}function sS(t,e){var n={},r=t.l+e;return t.l+=4,n.Salt=t.slice(t.l,t.l+16),t.l+=16,n.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),n.VerifierHash=t.slice(t.l,r),t.l=r,n}function F9(t){var e=ls(t);switch(e.Minor){case 2:return[e.Minor,L9(t)];case 3:return[e.Minor,O9()];case 4:return[e.Minor,P9(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function L9(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var n=t.read_shift(4),r=aS(t,n),a=sS(t,t.length-t.l);return{t:"Std",h:r,v:a}}function O9(){throw new Error("File is password-protected: ECMA-376 Extensible")}function P9(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var n=t.read_shift(t.length-t.l,"utf8"),r={};return n.replace(ur,function(i){var l=et(i);switch(Ba(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){r[c]=l[c]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function U9(t,e){var n={},r=n.EncryptionVersionInfo=ls(t,4);if(e-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,n.EncryptionHeader=aS(t,a),e-=a,n.EncryptionVerifier=sS(t,e),n}function B9(t){var e={},n=e.EncryptionVersionInfo=ls(t,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function j9(t){var e=0,n,r=rS(t),a=r.length+1,i,l,c,d,f;for(n=ni(a),n[0]=r.length,i=1;i!=a;++i)n[i]=r[i-1];for(i=a-1;i>=0;--i)l=n[i],c=(e&16384)===0?0:1,d=e<<1&32767,f=c|d,e=f^l;return e^52811}var iS=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},a=function(l,c){return r(l^c)},i=function(l){for(var c=e[l.length-1],d=104,f=l.length-1;f>=0;--f)for(var g=l[f],v=0;v!=7;++v)g&64&&(c^=n[d]),g*=2,--d;return c};return function(l){for(var c=rS(l),d=i(c),f=c.length,g=ni(16),v=0;v!=16;++v)g[v]=0;var _,T,E;for((f&1)===1&&(_=d>>8,g[f]=a(t[0],_),--f,_=d&255,T=c[c.length-1],g[f]=a(T,_));f>0;)--f,_=d>>8,g[f]=a(c[f],_),--f,_=d&255,g[f]=a(c[f],_);for(f=15,E=15-c.length;E>0;)_=d>>8,g[f]=a(t[E],_),--f,--E,_=d&255,g[f]=a(c[f],_),--f,--E;return g}}(),V9=function(t,e,n,r,a){a||(a=e),r||(r=iS(t));var i,l;for(i=0;i!=e.length;++i)l=e[i],l^=r[n],l=(l>>5|l<<3)&255,a[i]=l,++n;return[a,n,r]},H9=function(t){var e=0,n=iS(t);return function(r){var a=V9("",r,e,n);return e=a[1],a[0]}};function $9(t,e,n,r){var a={key:An(t),verificationBytes:An(t)};return n.password&&(a.verifier=j9(n.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=H9(n.password)),a}function G9(t,e,n){var r=n||{};return r.Info=t.read_shift(2),t.l-=2,r.Info===1?r.Data=B9(t):r.Data=U9(t,e),r}function z9(t,e,n){var r={Type:n.biff>=8?t.read_shift(2):0};return r.Type?G9(t,e-2,r):$9(t,n.biff>=8?e:e-2,n,r),r}var q9=function(){function t(a,i){switch(i.type){case"base64":return e(Ur(a),i);case"binary":return e(a,i);case"buffer":return e(Ct&&Buffer.isBuffer(a)?a.toString("binary"):Xi(a),i);case"array":return e($i(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){var l=i||{},c=l.dense?[]:{},d=a.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(g,v){Array.isArray(c)&&(c[v]=[]);for(var _=/\\\w+\b/g,T=0,E,S=-1;E=_.exec(g);){switch(E[0]){case"\\cell":var b=g.slice(T,_.lastIndex-E[0].length);if(b[0]==" "&&(b=b.slice(1)),++S,b.length){var k={v:b,t:"s"};Array.isArray(c)?c[v][S]=k:c[ot({r:v,c:S})]=k}break}T=_.lastIndex}S>f.e.c&&(f.e.c=S)}),c["!ref"]=Rt(f),c}function n(a,i){return si(t(a,i),i)}function r(a){for(var i=["{\\rtf1\\ansi"],l=vn(a["!ref"]),c,d=Array.isArray(a),f=l.s.r;f<=l.e.r;++f){i.push("\\trowd\\trautofit1");for(var g=l.s.c;g<=l.e.c;++g)i.push("\\cellx"+(g+1));for(i.push("\\pard\\intbl"),g=l.s.c;g<=l.e.c;++g){var v=ot({r:f,c:g});c=d?(a[f]||[])[g]:a[v],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(ds(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:n,to_sheet:t,from_sheet:r}}();function Y9(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function iu(t){for(var e=0,n=1;e!=3;++e)n=n*256+(t[e]>255?255:t[e]<0?0:t[e]);return n.toString(16).toUpperCase().slice(1)}function W9(t){var e=t[0]/255,n=t[1]/255,r=t[2]/255,a=Math.max(e,n,r),i=Math.min(e,n,r),l=a-i;if(l===0)return[0,0,e];var c=0,d=0,f=a+i;switch(d=l/(f>1?2-f:f),a){case e:c=((n-r)/l+6)%6;break;case n:c=(r-e)/l+2;break;case r:c=(e-n)/l+4;break}return[c/6,d,f/2]}function J9(t){var e=t[0],n=t[1],r=t[2],a=n*2*(r<.5?r:1-r),i=r-a/2,l=[i,i,i],c=6*e,d;if(n!==0)switch(c|0){case 0:case 6:d=a*c,l[0]+=a,l[1]+=d;break;case 1:d=a*(2-c),l[0]+=d,l[1]+=a;break;case 2:d=a*(c-2),l[1]+=a,l[2]+=d;break;case 3:d=a*(4-c),l[1]+=d,l[2]+=a;break;case 4:d=a*(c-4),l[2]+=a,l[0]+=d;break;case 5:d=a*(6-c),l[2]+=d,l[0]+=a;break}for(var f=0;f!=3;++f)l[f]=Math.round(l[f]*255);return l}function Sd(t,e){if(e===0)return t;var n=W9(Y9(t));return e<0?n[2]=n[2]*(1+e):n[2]=1-(1-n[2])*(1-e),iu(J9(n))}var oS=6,K9=15,X9=1,mr=oS;function bd(t){return Math.floor((t+Math.round(128/mr)/256)*mr)}function Cd(t){return Math.floor((t-5)/mr*100+.5)/100}function rp(t){return Math.round((t*mr+5)/mr*256)/256}function pm(t){return rp(Cd(bd(t)))}function Zp(t){var e=Math.abs(t-pm(t)),n=mr;if(e>.005)for(mr=X9;mr<K9;++mr)Math.abs(t-pm(t))<=e&&(e=Math.abs(t-pm(t)),n=mr);mr=n}function ml(t){t.width?(t.wpx=bd(t.width),t.wch=Cd(t.wpx),t.MDW=mr):t.wpx?(t.wch=Cd(t.wpx),t.width=rp(t.wch),t.MDW=mr):typeof t.wch=="number"&&(t.width=rp(t.wch),t.wpx=bd(t.width),t.MDW=mr),t.customWidth&&delete t.customWidth}var Z9=96,lS=Z9;function cS(t){return t*96/lS}function ou(t){return t*lS/96}var Q9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function eB(t,e,n,r){e.Borders=[];var a={},i=!1;(t[0].match(ur)||[]).forEach(function(l){var c=et(l);switch(Ba(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=rn(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=rn(c.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function tB(t,e,n,r){e.Fills=[];var a={},i=!1;(t[0].match(ur)||[]).forEach(function(l){var c=et(l);switch(Ba(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function nB(t,e,n,r){e.Fonts=[];var a={},i=!1;(t[0].match(ur)||[]).forEach(function(l){var c=et(l);switch(Ba(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=Xt(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?rn(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?rn(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?rn(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?rn(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?rn(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?rn(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?rn(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=Fp[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=rn(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var d=Fi[a.color.index];a.color.index==81&&(d=Fi[1]),d||(d=Fi[1]),a.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&n.themeElements&&n.themeElements.clrScheme&&(a.color.rgb=Sd(n.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function rB(t,e,n){e.NumberFmt=[];for(var r=La(ut),a=0;a<r.length;++a)e.NumberFmt[r[a]]=ut[r[a]];var i=t[0].match(ur);if(i)for(a=0;a<i.length;++a){var l=et(i[a]);switch(Ba(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Dt(Xt(l.formatCode)),d=parseInt(l.numFmtId,10);if(e.NumberFmt[d]=c,d>0){if(d>392){for(d=392;d>60&&e.NumberFmt[d]!=null;--d);e.NumberFmt[d]=c}Ii(c,d)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var Jf=["numFmtId","fillId","fontId","borderId","xfId"],Kf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function aB(t,e,n){e.CellXf=[];var r,a=!1;(t[0].match(ur)||[]).forEach(function(i){var l=et(i),c=0;switch(Ba(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],c=0;c<Jf.length;++c)r[Jf[c]]&&(r[Jf[c]]=parseInt(r[Jf[c]],10));for(c=0;c<Kf.length;++c)r[Kf[c]]&&(r[Kf[c]]=rn(r[Kf[c]]));if(e.NumberFmt&&r.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[r.numFmtId]==e.NumberFmt[c]){r.numFmtId=c;break}}e.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};l.vertical&&(d.vertical=l.vertical),l.horizontal&&(d.horizontal=l.horizontal),l.textRotation!=null&&(d.textRotation=l.textRotation),l.indent&&(d.indent=l.indent),l.wrapText&&(d.wrapText=rn(l.wrapText)),r.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var sB=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,d,f){var g={};if(!c)return g;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=c.match(e))&&rB(v,g,f),(v=c.match(a))&&nB(v,g,d,f),(v=c.match(r))&&tB(v,g,d,f),(v=c.match(i))&&eB(v,g,d,f),(v=c.match(n))&&aB(v,g,f),g}}();function iB(t,e){var n=t.read_shift(2),r=lr(t);return[n,r]}function oB(t,e,n){var r={};r.sz=t.read_shift(2)/20;var a=xU(t);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var i=t.read_shift(2);switch(i===700&&(r.bold=1),t.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(r.underline=l);var c=t.read_shift(1);c>0&&(r.family=c);var d=t.read_shift(1);switch(d>0&&(r.charset=d),t.l++,r.color=gU(t),t.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=lr(t),r}var lB=cr;function cB(t,e){var n=t.l+e,r=t.read_shift(2),a=t.read_shift(2);return t.l=n,{ixfe:r,numFmtId:a}}var uB=cr;function fB(t,e,n){var r={};r.NumberFmt=[];for(var a in ut)r.NumberFmt[a]=ut[a];r.CellXf=[],r.Fonts=[];var i=[],l=!1;return ps(t,function(d,f,g){switch(g){case 44:r.NumberFmt[d[0]]=d[1],Ii(d[1],d[0]);break;case 43:r.Fonts.push(d),d.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(d.color.rgb=Sd(e.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&r.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(g),l=!0;break;case 38:i.pop(),l=!1;break;default:if(f.T>0)i.push(g);else if(f.T<0)i.pop();else if(!l||n.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),r}var dB=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function hB(t,e,n){e.themeElements.clrScheme=[];var r={};(t[0].match(ur)||[]).forEach(function(a){var i=et(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=i.val;break;case"<a:sysClr":r.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[dB.indexOf(i[0])]=r,r={}):r.name=i[0].slice(3,i[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function mB(){}function pB(){}var gB=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,xB=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,vB=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function yB(t,e,n){e.themeElements={};var r;[["clrScheme",gB,hB],["fontScheme",xB,mB],["fmtScheme",vB,pB]].forEach(function(a){if(!(r=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,e,n)})}var _B=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function uS(t,e){(!t||t.length===0)&&(t=wB());var n,r={};if(!(n=t.match(_B)))throw new Error("themeElements not found in theme");return yB(n[0],r,e),r.raw=t,r}function wB(t,e){var n=[wE];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function TB(t,e,n){var r=t.l+e,a=t.read_shift(4);if(a!==124226){if(!n.cellStyles){t.l=r;return}var i=t.slice(t.l);t.l=r;var l;try{l=_E(i,{type:"array"})}catch{return}var c=Pr(l,"theme/theme/theme1.xml",!0);if(c)return uS(c,n)}}function EB(t){return t.read_shift(4)}function SB(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=bB(t,4);break;case 2:e.xclrValue=KE(t);break;case 3:e.xclrValue=EB(t);break;case 4:t.l+=4;break}return t.l+=8,e}function bB(t,e){return cr(t,e)}function CB(t,e){return cr(t,e)}function AB(t){var e=t.read_shift(2),n=t.read_shift(2)-4,r=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=SB(t);break;case 6:r[1]=CB(t,n);break;case 14:case 15:r[1]=t.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+n)}return r}function kB(t,e){var n=t.l+e;t.l+=2;var r=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),i=[];a-- >0;)i.push(AB(t,n-t.l));return{ixfe:r,ext:i}}function NB(t,e){e.forEach(function(n){n[0]})}function RB(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:lr(t)}}function DB(t){for(var e=[],n=t.read_shift(4);n-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function MB(t){return t.l+=4,t.read_shift(4)!=0}function IB(t,e,n){var r={Types:[],Cell:[],Value:[]},a=n||{},i=[],l=!1,c=2;return ps(t,function(d,f,g){switch(g){case 335:r.Types.push({name:d.name});break;case 51:d.forEach(function(v){c==1?r.Cell.push({type:r.Types[v[0]-1].name,index:v[1]}):c==0&&r.Value.push({type:r.Types[v[0]-1].name,index:v[1]})});break;case 337:c=d?1:0;break;case 338:c=2;break;case 35:i.push(g),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!f.T){if(!l||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),r}function FB(t,e,n){var r={Types:[],Cell:[],Value:[]};if(!t)return r;var a=!1,i=2,l;return t.replace(ur,function(c){var d=et(c);switch(Ba(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<r.Types.length;++f)r.Types[f].name==d.name&&(l=r.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?r.Cell.push({type:r.Types[d.t-1].name,index:+d.v}):i==0&&r.Value.push({type:r.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+d.i);break;default:if(!a&&n.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return c}),r}function LB(t){var e=[];if(!t)return e;var n=1;return(t.match(ur)||[]).forEach(function(r){var a=et(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?n=a.i:a.i=n,e.push(a);break}}),e}function OB(t){var e={};e.i=t.read_shift(4);var n={};n.r=t.read_shift(4),n.c=t.read_shift(4),e.r=ot(n);var r=t.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}function PB(t,e,n){var r=[];return ps(t,function(i,l,c){switch(c){case 63:r.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function UB(t,e,n,r){if(!t)return t;var a=r||{},i=!1;ps(t,function(c,d,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!d.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function BB(t,e){if(!t)return"??";var n=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][n].Target}function eT(t,e,n,r){var a=Array.isArray(t),i;e.forEach(function(l){var c=pr(l.ref);if(a?(t[c.r]||(t[c.r]=[]),i=t[c.r][c.c]):i=t[l.ref],!i){i={t:"z"},a?t[c.r][c.c]=i:t[l.ref]=i;var d=vn(t["!ref"]||"BDWGO1000001:A1");d.s.r>c.r&&(d.s.r=c.r),d.e.r<c.r&&(d.e.r=c.r),d.s.c>c.c&&(d.s.c=c.c),d.e.c<c.c&&(d.e.c=c.c);var f=Rt(d);f!==t["!ref"]&&(t["!ref"]=f)}i.c||(i.c=[]);var g={a:l.author,t:l.t,r:l.r,T:n};l.h&&(g.h=l.h);for(var v=i.c.length-1;v>=0;--v){if(!n&&i.c[v].T)return;n&&!i.c[v].T&&i.c.splice(v,1)}if(n&&r){for(v=0;v<r.length;++v)if(g.a==r[v].id){g.a=r[v].name||g.a;break}}i.c.push(g)})}function jB(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&n.push(c[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var d=et(c[0]),f={author:d.authorId&&n[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},g=pr(d.ref);if(!(e.sheetRows&&e.sheetRows<=g.r)){var v=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!v&&!!v[1]&&Xp(v[1])||{r:"",t:"",h:""};f.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),f.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(f.h=_.h),r.push(f)}}}}),r}function VB(t,e){var n=[],r=!1,a={},i=0;return t.replace(ur,function(c,d){var f=et(c);switch(Ba(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":a.t!=null&&n.push(a);break;case"<text>":case"<text":i=d+c.length;break;case"</text>":a.t=t.slice(i,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return c}),n}function HB(t,e){var n=[],r=!1;return t.replace(ur,function(i){var l=et(i);switch(Ba(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),n}function $B(t){var e={};e.iauthor=t.read_shift(4);var n=Qi(t);return e.rfx=n.s,e.ref=ot(n.s),t.l+=16,e}var GB=lr;function zB(t,e){var n=[],r=[],a={},i=!1;return ps(t,function(c,d,f){switch(f){case 632:r.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,n.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}var qB="application/vnd.ms-office.vbaProject";function YB(t){var e=Nt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(n,r){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var a=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Nt.utils.cfb_add(e,a,t.FileIndex[r].content)}}),Nt.write(e)}function WB(){return{"!type":"dialog"}}function JB(){return{"!type":"dialog"}}function KB(){return{"!type":"macro"}}function XB(){return{"!type":"macro"}}var al=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function n(r,a,i,l){var c=!1,d=!1;i.length==0?d=!0:i.charAt(0)=="["&&(d=!0,i=i.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var f=i.length>0?parseInt(i,10)|0:0,g=l.length>0?parseInt(l,10)|0:0;return c?g+=e.c:--g,d?f+=e.r:--f,a+(c?"":"$")+Fn(g)+(d?"":"$")+Xn(f)}return function(a,i){return e=i,a.replace(t,n)}}(),fS=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ZB=function(){return function(e,n){return e.replace(fS,function(r,a,i,l,c,d){var f=zp(l)-(i?0:n.c),g=Gp(d)-(c?0:n.r),v=g==0?"":c?g+1:"["+g+"]",_=f==0?"":i?f+1:"["+f+"]";return a+"R"+v+"C"+_})}}();function dS(t,e){return t.replace(fS,function(n,r,a,i,l,c){return r+(a=="$"?a+i:Fn(zp(i)+e.c))+(l=="$"?l+c:Xn(Gp(c)+e.r))})}function QB(t,e,n){var r=Sl(e),a=r.s,i=pr(n),l={r:i.r-a.r,c:i.c-a.c};return dS(t,l)}function ej(t){return t.length!=1}function tT(t){return t.replace(/_xlfn\./g,"")}function bn(t){t.l+=1}function ri(t,e){var n=t.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function hS(t,e,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return mS(t);n.biff==12&&(r=4)}var a=t.read_shift(r),i=t.read_shift(r),l=ri(t),c=ri(t);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function mS(t){var e=ri(t),n=ri(t),r=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function tj(t,e,n){if(n.biff<8)return mS(t);var r=t.read_shift(n.biff==12?4:2),a=t.read_shift(n.biff==12?4:2),i=ri(t),l=ri(t);return{s:{r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function pS(t,e,n){if(n&&n.biff>=2&&n.biff<=5)return nj(t);var r=t.read_shift(n&&n.biff==12?4:2),a=ri(t);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function nj(t){var e=ri(t),n=t.read_shift(1);return{r:e[0],c:n,cRel:e[1],rRel:e[2]}}function rj(t){var e=t.read_shift(2),n=t.read_shift(2);return{r:e,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function aj(t,e,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return sj(t);var a=t.read_shift(r>=12?4:2),i=t.read_shift(2),l=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;a>524287;)a-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:l,rRel:c}}function sj(t){var e=t.read_shift(2),n=t.read_shift(1),r=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),a==1&&n>=128&&(n=n-256),{r:e,c:n,cRel:a,rRel:r}}function ij(t,e,n){var r=(t[t.l++]&96)>>5,a=hS(t,n.biff>=2&&n.biff<=5?6:8,n);return[r,a]}function oj(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),i=8;if(n)switch(n.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var l=hS(t,i,n);return[r,a,l]}function lj(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function cj(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2),i=8;if(n)switch(n.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[r,a]}function uj(t,e,n){var r=(t[t.l++]&96)>>5,a=tj(t,e-1,n);return[r,a]}function fj(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n.biff==2?6:n.biff==12?14:7,[r]}function nT(t){var e=t[t.l+1]&1,n=1;return t.l+=4,[e,n]}function dj(t,e,n){t.l+=2;for(var r=t.read_shift(n&&n.biff==2?1:2),a=[],i=0;i<=r;++i)a.push(t.read_shift(n&&n.biff==2?1:2));return a}function hj(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function mj(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function pj(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function gj(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=n&&n.biff==2?3:4,[r]}function gS(t){var e=t.read_shift(1),n=t.read_shift(1);return[e,n]}function xj(t){return t.read_shift(2),gS(t)}function vj(t){return t.read_shift(2),gS(t)}function yj(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=pS(t,0,n);return[r,a]}function _j(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=aj(t,0,n);return[r,a]}function wj(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);n&&n.biff==5&&(t.l+=12);var i=pS(t,0,n);return[r,a,i]}function Tj(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(n&&n.biff<=3?1:2);return[EV[a],yS[a],r]}function Ej(t,e,n){var r=t[t.l++],a=t.read_shift(1),i=n&&n.biff<=3?[r==88?-1:0,t.read_shift(1)]:Sj(t);return[a,(i[0]===0?yS:TV)[i[1]]]}function Sj(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function bj(t,e,n){t.l+=n&&n.biff==2?3:4}function Cj(t,e,n){if(t.l++,n&&n.biff==12)return[t.read_shift(4,"i"),0];var r=t.read_shift(2),a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function Aj(t){return t.l++,eo[t.read_shift(1)]}function kj(t){return t.l++,t.read_shift(2)}function Nj(t){return t.l++,t.read_shift(1)!==0}function Rj(t){return t.l++,sr(t)}function Dj(t,e,n){return t.l++,_u(t,e-1,n)}function Mj(t,e){var n=[t.read_shift(1)];if(e==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=Tn(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:n[1]=eo[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:n[1]=sr(t);break;case 2:n[1]=to(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function Ij(t,e,n){for(var r=t.read_shift(n.biff==12?4:2),a=[],i=0;i!=r;++i)a.push((n.biff==12?Qi:Vd)(t));return a}function Fj(t,e,n){var r=0,a=0;n.biff==12?(r=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),r=1+t.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--a==0&&(a=256));for(var i=0,l=[];i!=r&&(l[i]=[]);++i)for(var c=0;c!=a;++c)l[i][c]=Mj(t,n.biff);return l}function Lj(t,e,n){var r=t.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,i=t.read_shift(a);switch(n.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[r,0,i]}function Oj(t,e,n){if(n.biff==5)return Pj(t);var r=t.read_shift(1)>>>5&3,a=t.read_shift(2),i=t.read_shift(4);return[r,a,i]}function Pj(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2,"i");t.l+=8;var r=t.read_shift(2);return t.l+=12,[e,n,r]}function Uj(t,e,n){var r=t.read_shift(1)>>>5&3;t.l+=n&&n.biff==2?3:4;var a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function Bj(t,e,n){var r=t.read_shift(1)>>>5&3,a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function jj(t,e,n){var r=t.read_shift(1)>>>5&3;return t.l+=4,n.biff<8&&t.l--,n.biff==12&&(t.l+=2),[r]}function Vj(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2),i=4;if(n)switch(n.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[r,a]}var Hj=cr,$j=cr,Gj=cr;function Tu(t,e,n){return t.l+=2,[rj(t)]}function Qp(t){return t.l+=6,[]}var zj=Tu,qj=Qp,Yj=Qp,Wj=Tu;function xS(t){return t.l+=2,[An(t),t.read_shift(2)&1]}var Jj=Tu,Kj=xS,Xj=Qp,Zj=Tu,Qj=Tu,eV=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function tV(t){t.l+=2;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),a=t.read_shift(2),i=t.read_shift(2),l=eV[n>>2&31];return{ixti:e,coltype:n&3,rt:l,idx:r,c:a,C:i}}function nV(t){return t.l+=2,[t.read_shift(4)]}function rV(t,e,n){return t.l+=5,t.l+=2,t.l+=n.biff==2?1:4,["PTGSHEET"]}function aV(t,e,n){return t.l+=n.biff==2?4:5,["PTGENDSHEET"]}function sV(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function iV(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function oV(t){return t.l+=4,[0,0]}var rT={1:{n:"PtgExp",f:Cj},2:{n:"PtgTbl",f:Gj},3:{n:"PtgAdd",f:bn},4:{n:"PtgSub",f:bn},5:{n:"PtgMul",f:bn},6:{n:"PtgDiv",f:bn},7:{n:"PtgPower",f:bn},8:{n:"PtgConcat",f:bn},9:{n:"PtgLt",f:bn},10:{n:"PtgLe",f:bn},11:{n:"PtgEq",f:bn},12:{n:"PtgGe",f:bn},13:{n:"PtgGt",f:bn},14:{n:"PtgNe",f:bn},15:{n:"PtgIsect",f:bn},16:{n:"PtgUnion",f:bn},17:{n:"PtgRange",f:bn},18:{n:"PtgUplus",f:bn},19:{n:"PtgUminus",f:bn},20:{n:"PtgPercent",f:bn},21:{n:"PtgParen",f:bn},22:{n:"PtgMissArg",f:bn},23:{n:"PtgStr",f:Dj},26:{n:"PtgSheet",f:rV},27:{n:"PtgEndSheet",f:aV},28:{n:"PtgErr",f:Aj},29:{n:"PtgBool",f:Nj},30:{n:"PtgInt",f:kj},31:{n:"PtgNum",f:Rj},32:{n:"PtgArray",f:fj},33:{n:"PtgFunc",f:Tj},34:{n:"PtgFuncVar",f:Ej},35:{n:"PtgName",f:Lj},36:{n:"PtgRef",f:yj},37:{n:"PtgArea",f:ij},38:{n:"PtgMemArea",f:Uj},39:{n:"PtgMemErr",f:Hj},40:{n:"PtgMemNoMem",f:$j},41:{n:"PtgMemFunc",f:Bj},42:{n:"PtgRefErr",f:jj},43:{n:"PtgAreaErr",f:lj},44:{n:"PtgRefN",f:_j},45:{n:"PtgAreaN",f:uj},46:{n:"PtgMemAreaN",f:sV},47:{n:"PtgMemNoMemN",f:iV},57:{n:"PtgNameX",f:Oj},58:{n:"PtgRef3d",f:wj},59:{n:"PtgArea3d",f:oj},60:{n:"PtgRefErr3d",f:Vj},61:{n:"PtgAreaErr3d",f:cj},255:{}},lV={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},cV={1:{n:"PtgElfLel",f:xS},2:{n:"PtgElfRw",f:Zj},3:{n:"PtgElfCol",f:zj},6:{n:"PtgElfRwV",f:Qj},7:{n:"PtgElfColV",f:Wj},10:{n:"PtgElfRadical",f:Jj},11:{n:"PtgElfRadicalS",f:Xj},13:{n:"PtgElfColS",f:qj},15:{n:"PtgElfColSV",f:Yj},16:{n:"PtgElfRadicalLel",f:Kj},25:{n:"PtgList",f:tV},29:{n:"PtgSxName",f:nV},255:{}},uV={0:{n:"PtgAttrNoop",f:oV},1:{n:"PtgAttrSemi",f:gj},2:{n:"PtgAttrIf",f:mj},4:{n:"PtgAttrChoose",f:dj},8:{n:"PtgAttrGoto",f:hj},16:{n:"PtgAttrSum",f:bj},32:{n:"PtgAttrBaxcel",f:nT},33:{n:"PtgAttrBaxcel",f:nT},64:{n:"PtgAttrSpace",f:xj},65:{n:"PtgAttrSpaceSemi",f:vj},128:{n:"PtgAttrIfError",f:pj},255:{}};function Eu(t,e,n,r){if(r.biff<8)return cr(t,e);for(var a=t.l+e,i=[],l=0;l!==n.length;++l)switch(n[l][0]){case"PtgArray":n[l][1]=Fj(t,0,r),i.push(n[l][1]);break;case"PtgMemArea":n[l][2]=Ij(t,n[l][1],r),i.push(n[l][2]);break;case"PtgExp":r&&r.biff==12&&(n[l][1][1]=t.read_shift(4),i.push(n[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[l][0]}return e=a-t.l,e!==0&&i.push(cr(t,e)),i}function Su(t,e,n){for(var r=t.l+e,a,i,l=[];r!=t.l;)e=r-t.l,i=t[t.l],a=rT[i]||rT[lV[i]],(i===24||i===25)&&(a=(i===24?cV:uV)[t[t.l+1]]),!a||!a.f?cr(t,e):l.push([a.n,a.f(t,e,n)]);return l}function fV(t){for(var e=[],n=0;n<t.length;++n){for(var r=t[n],a=[],i=0;i<r.length;++i){var l=r[i];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var dV={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function hV(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function vS(t,e,n){if(!t)return"SH33TJSERR0";if(n.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var r=t.XTI[e];if(n.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(t[r[0]][0]){case 357:return a=r[1]==-1?"#REF":t.SheetNames[r[1]],r[1]==r[2]?a:a+":"+t.SheetNames[r[2]];case 358:return n.SID!=null?t.SheetNames[n.SID]:"SH33TJSSAME"+t[r[0]][0];case 355:default:return"SH33TJSSRC"+t[r[0]][0]}switch(t[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":t.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+t.SheetNames[r[2]];case 14849:return t[r[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[r[0]][0][3]?(a=r[1]==-1?"#REF":t[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+t[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function aT(t,e,n){var r=vS(t,e,n);return r=="#REF"?r:hV(r,n)}function ar(t,e,n,r,a){var i=a&&a.biff||8,l={s:{c:0,r:0}},c=[],d,f,g,v=0,_=0,T,E="";if(!t[0]||!t[0][0])return"";for(var S=-1,b="",k=0,A=t[0].length;k<A;++k){var C=t[0][k];switch(C[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=c.pop(),f=c.pop(),S>=0){switch(t[0][S][1][0]){case 0:b=xn(" ",t[0][S][1][1]);break;case 1:b=xn("\r",t[0][S][1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}f=f+b,S=-1}c.push(f+dV[C[0]]+d);break;case"PtgIsect":d=c.pop(),f=c.pop(),c.push(f+" "+d);break;case"PtgUnion":d=c.pop(),f=c.pop(),c.push(f+","+d);break;case"PtgRange":d=c.pop(),f=c.pop(),c.push(f+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=jc(C[1][1],l,a),c.push(Vc(g,i));break;case"PtgRefN":g=n?jc(C[1][1],n,a):C[1][1],c.push(Vc(g,i));break;case"PtgRef3d":v=C[1][1],g=jc(C[1][2],l,a),E=aT(r,v,a),c.push(E+"!"+Vc(g,i));break;case"PtgFunc":case"PtgFuncVar":var I=C[1][0],B=C[1][1];I||(I=0),I&=127;var j=I==0?[]:c.slice(-I);c.length-=I,B==="User"&&(B=j.shift()),c.push(B+"("+j.join(",")+")");break;case"PtgBool":c.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(C[1]);break;case"PtgNum":c.push(String(C[1]));break;case"PtgStr":c.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(C[1]);break;case"PtgAreaN":T=Uw(C[1][1],n?{s:n}:l,a),c.push(hm(T,a));break;case"PtgArea":T=Uw(C[1][1],l,a),c.push(hm(T,a));break;case"PtgArea3d":v=C[1][1],T=C[1][2],E=aT(r,v,a),c.push(E+"!"+hm(T,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=C[1][2];var F=(r.names||[])[_-1]||(r[0]||[])[_],X=F?F.Name:"SH33TJSNAME"+String(_);X&&X.slice(0,6)=="_xlfn."&&!a.xlfn&&(X=X.slice(6)),c.push(X);break;case"PtgNameX":var P=C[1][1];_=C[1][2];var re;if(a.biff<=5)P<0&&(P=-P),r[P]&&(re=r[P][_]);else{var G="";if(((r[P]||[])[0]||[])[0]==14849||(((r[P]||[])[0]||[])[0]==1025?r[P][_]&&r[P][_].itab>0&&(G=r.SheetNames[r[P][_].itab-1]+"!"):G=r.SheetNames[_-1]+"!"),r[P]&&r[P][_])G+=r[P][_].Name;else if(r[0]&&r[0][_])G+=r[0][_].Name;else{var te=(vS(r,P,a)||"").split(";;");te[_-1]?G=te[_-1]:G+="SH33TJSERRX"}c.push(G);break}re||(re={Name:"SH33TJSERRY"}),c.push(re.Name);break;case"PtgParen":var _e="(",Ne=")";if(S>=0){switch(b="",t[0][S][1][0]){case 2:_e=xn(" ",t[0][S][1][1])+_e;break;case 3:_e=xn("\r",t[0][S][1][1])+_e;break;case 4:Ne=xn(" ",t[0][S][1][1])+Ne;break;case 5:Ne=xn("\r",t[0][S][1][1])+Ne;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}S=-1}c.push(_e+c.pop()+Ne);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":g={c:C[1][1],r:C[1][0]};var Ee={c:n.c,r:n.r};if(r.sharedf[ot(g)]){var se=r.sharedf[ot(g)];c.push(ar(se,l,Ee,r,a))}else{var ue=!1;for(d=0;d!=r.arrayf.length;++d)if(f=r.arrayf[d],!(g.c<f[0].s.c||g.c>f[0].e.c)&&!(g.r<f[0].s.r||g.r>f[0].e.r)){c.push(ar(f[1],l,Ee,r,a)),ue=!0;break}ue||c.push(C[1])}break;case"PtgArray":c.push("{"+fV(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":S=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var ae=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&S>=0&&ae.indexOf(t[0][k][0])==-1){C=t[0][S];var J=!0;switch(C[1][0]){case 4:J=!1;case 0:b=xn(" ",C[1][1]);break;case 5:J=!1;case 1:b=xn("\r",C[1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}c.push((J?b:"")+c.pop()+(J?"":b)),S=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function mV(t,e,n){var r=t.l+e,a=n.biff==2?1:2,i,l=t.read_shift(a);if(l==65535)return[[],cr(t,e-2)];var c=Su(t,l,n);return e!==l+a&&(i=Eu(t,e-l-a,c,n)),t.l=r,[c,i]}function pV(t,e,n){var r=t.l+e,a=n.biff==2?1:2,i,l=t.read_shift(a);if(l==65535)return[[],cr(t,e-2)];var c=Su(t,l,n);return e!==l+a&&(i=Eu(t,e-l-a,c,n)),t.l=r,[c,i]}function gV(t,e,n,r){var a=t.l+e,i=Su(t,r,n),l;return a!==t.l&&(l=Eu(t,a-t.l,i,n)),[i,l]}function xV(t,e,n){var r=t.l+e,a,i=t.read_shift(2),l=Su(t,i,n);return i==65535?[[],cr(t,e-2)]:(e!==i+2&&(a=Eu(t,r-i-2,l,n)),[l,a])}function vV(t){var e;if(ss(t,t.l+6)!==65535)return[sr(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function gm(t,e,n){var r=t.l+e,a=ja(t);n.biff==2&&++t.l;var i=vV(t),l=t.read_shift(1);n.biff!=2&&(t.read_shift(1),n.biff>=5&&t.read_shift(4));var c=pV(t,r-t.l,n);return{cell:a,val:i[0],formula:c,shared:l>>3&1,tt:i[1]}}function Hd(t,e,n){var r=t.read_shift(4),a=Su(t,r,n),i=t.read_shift(4),l=i>0?Eu(t,i,a,n):null;return[a,l]}var yV=Hd,$d=Hd,_V=Hd,wV=Hd,TV={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},yS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},EV={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function sT(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,n){return n.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function xm(t){var e=t.split(":"),n=e[0].split(".")[0];return[n,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var zc={},sl={};function qc(t,e){if(t){var n=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(n=[1,1,1,1,.5,.5]),t.left==null&&(t.left=n[0]),t.right==null&&(t.right=n[1]),t.top==null&&(t.top=n[2]),t.bottom==null&&(t.bottom=n[3]),t.header==null&&(t.header=n[4]),t.footer==null&&(t.footer=n[5])}}function _S(t,e,n,r,a,i){try{r.cellNF&&(t.z=ut[e])}catch(c){if(r.WTF)throw c}if(!(t.t==="z"&&!r.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Gn(t.v)),(!r||r.cellText!==!1)&&t.t!=="z")try{if(ut[e]==null&&Ii(SP[e]||"General",e),t.t==="e")t.w=t.w||eo[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=nu(t.v);else if(t.t==="d"){var l=vr(t.v);(l|0)===l?t.w=l.toString(10):t.w=nu(l)}else{if(t.v===void 0)return"";t.w=Hi(t.v,sl)}else t.t==="d"?t.w=ea(e,vr(t.v),sl):t.w=ea(e,t.v,sl)}catch(c){if(r.WTF)throw c}if(r.cellStyles&&n!=null)try{t.s=i.Fills[n],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Sd(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),r.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Sd(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),r.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(r.WTF&&i.Fills)throw c}}}function SV(t,e){var n=vn(e);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(t["!ref"]=Rt(n))}var bV=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,CV=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,AV=/<(?:\w:)?hyperlink [^>]*>/mg,kV=/"(\w*:\w*)"/,NV=/<(?:\w:)?col\b[^>]*[\/]?>/g,RV=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,DV=/<(?:\w:)?pageMargins[^>]*\/>/g,wS=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,MV=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,IV=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function FV(t,e,n,r,a,i,l){if(!t)return t;r||(r={"!id":{}});var c=e.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",g="",v=t.match(CV);v?(f=t.slice(0,v.index),g=t.slice(v.index+v[0].length)):f=g=t;var _=f.match(wS);_?eg(_[0],c,a,n):(_=f.match(MV))&&LV(_[0],_[1]||"",c,a,n);var T=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(T>0){var E=f.slice(T,T+50).match(kV);E&&SV(c,E[1])}var S=f.match(IV);S&&S[1]&&VV(S[1],a);var b=[];if(e.cellStyles){var k=f.match(NV);k&&UV(b,k)}v&&HV(v[1],c,e,d,i,l);var A=g.match(RV);A&&(c["!autofilter"]=BV(A[0]));var C=[],I=g.match(bV);if(I)for(T=0;T!=I.length;++T)C[T]=vn(I[T].slice(I[T].indexOf('"')+1));var B=g.match(AV);B&&OV(c,B,r);var j=g.match(DV);if(j&&(c["!margins"]=PV(et(j[0]))),!c["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(c["!ref"]=Rt(d)),e.sheetRows>0&&c["!ref"]){var F=vn(c["!ref"]);e.sheetRows<=+F.e.r&&(F.e.r=e.sheetRows-1,F.e.r>d.e.r&&(F.e.r=d.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>d.e.c&&(F.e.c=d.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Rt(F))}return b.length>0&&(c["!cols"]=b),C.length>0&&(c["!merges"]=C),c}function eg(t,e,n,r){var a=et(t);n.Sheets[r]||(n.Sheets[r]={}),a.codeName&&(n.Sheets[r].CodeName=Dt(Xt(a.codeName)))}function LV(t,e,n,r,a){eg(t.slice(0,t.indexOf(">")),n,r,a)}function OV(t,e,n){for(var r=Array.isArray(t),a=0;a!=e.length;++a){var i=et(Xt(e[a]),!0);if(!i.ref)return;var l=((n||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+Dt(i.location))):(i.Target="#"+Dt(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=vn(i.ref),d=c.s.r;d<=c.e.r;++d)for(var f=c.s.c;f<=c.e.c;++f){var g=ot({c:f,r:d});r?(t[d]||(t[d]=[]),t[d][f]||(t[d][f]={t:"z",v:void 0}),t[d][f].l=i):(t[g]||(t[g]={t:"z",v:void 0}),t[g].l=i)}}}function PV(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(n){t[n]&&(e[n]=parseFloat(t[n]))}),e}function UV(t,e){for(var n=!1,r=0;r!=e.length;++r){var a=et(e[r],!0);a.hidden&&(a.hidden=rn(a.hidden));var i=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!n&&a.width&&(n=!0,Zp(a.width)),ml(a);i<=l;)t[i++]=Kn(a)}}function BV(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var jV=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function VV(t,e){e.Views||(e.Views=[{}]),(t.match(jV)||[]).forEach(function(n,r){var a=et(n);e.Views[r]||(e.Views[r]={}),+a.zoomScale&&(e.Views[r].zoom=+a.zoomScale),rn(a.rightToLeft)&&(e.Views[r].RTL=!0)})}var HV=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=ru("v"),l=ru("f");return function(d,f,g,v,_,T){for(var E=0,S="",b=[],k=[],A=0,C=0,I=0,B="",j,F,X=0,P=0,re,G,te=0,_e=0,Ne=Array.isArray(T.CellXf),Ee,se=[],ue=[],ae=Array.isArray(f),J=[],D={},ee=!1,M=!!g.sheetStubs,Y=d.split(e),K=0,W=Y.length;K!=W;++K){S=Y[K].trim();var oe=S.length;if(oe!==0){var ve=0;e:for(E=0;E<oe;++E)switch(S[E]){case">":if(S[E-1]!="/"){++E;break e}if(g&&g.cellStyles){if(F=et(S.slice(ve,E),!0),X=F.r!=null?parseInt(F.r,10):X+1,P=-1,g.sheetRows&&g.sheetRows<X)continue;D={},ee=!1,F.ht&&(ee=!0,D.hpt=parseFloat(F.ht),D.hpx=ou(D.hpt)),F.hidden=="1"&&(ee=!0,D.hidden=!0),F.outlineLevel!=null&&(ee=!0,D.level=+F.outlineLevel),ee&&(J[X-1]=D)}break;case"<":ve=E;break}if(ve>=E)break;if(F=et(S.slice(ve,E),!0),X=F.r!=null?parseInt(F.r,10):X+1,P=-1,!(g.sheetRows&&g.sheetRows<X)){v.s.r>X-1&&(v.s.r=X-1),v.e.r<X-1&&(v.e.r=X-1),g&&g.cellStyles&&(D={},ee=!1,F.ht&&(ee=!0,D.hpt=parseFloat(F.ht),D.hpx=ou(D.hpt)),F.hidden=="1"&&(ee=!0,D.hidden=!0),F.outlineLevel!=null&&(ee=!0,D.level=+F.outlineLevel),ee&&(J[X-1]=D)),b=S.slice(E).split(t);for(var Te=0;Te!=b.length&&b[Te].trim().charAt(0)=="<";++Te);for(b=b.slice(Te),E=0;E!=b.length;++E)if(S=b[E].trim(),S.length!==0){if(k=S.match(n),A=E,C=0,I=0,S="<c "+(S.slice(0,1)=="<"?">":"")+S,k!=null&&k.length===2){for(A=0,B=k[1],C=0;C!=B.length&&!((I=B.charCodeAt(C)-64)<1||I>26);++C)A=26*A+I;--A,P=A}else++P;for(C=0;C!=S.length&&S.charCodeAt(C)!==62;++C);if(++C,F=et(S.slice(0,C),!0),F.r||(F.r=ot({r:X-1,c:P})),B=S.slice(C),j={t:""},(k=B.match(i))!=null&&k[1]!==""&&(j.v=Dt(k[1])),g.cellFormula){if((k=B.match(l))!=null&&k[1]!==""){if(j.f=Dt(Xt(k[1])).replace(/\r\n/g,`
`),g.xlfn||(j.f=tT(j.f)),k[0].indexOf('t="array"')>-1)j.F=(B.match(a)||[])[1],j.F.indexOf(":")>-1&&se.push([vn(j.F),j.F]);else if(k[0].indexOf('t="shared"')>-1){G=et(k[0]);var De=Dt(Xt(k[1]));g.xlfn||(De=tT(De)),ue[parseInt(G.si,10)]=[G,De,F.r]}}else(k=B.match(/<f[^>]*\/>/))&&(G=et(k[0]),ue[G.si]&&(j.f=QB(ue[G.si][1],ue[G.si][2],F.r)));var Se=pr(F.r);for(C=0;C<se.length;++C)Se.r>=se[C][0].s.r&&Se.r<=se[C][0].e.r&&Se.c>=se[C][0].s.c&&Se.c<=se[C][0].e.c&&(j.F=se[C][1])}if(F.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(M)j.t="z";else continue;else j.t=F.t||"n";switch(v.s.c>P&&(v.s.c=P),v.e.c<P&&(v.e.c=P),j.t){case"n":if(j.v==""||j.v==null){if(!M)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!M)continue;j.t="z"}else re=zc[parseInt(j.v,10)],j.v=re.t,j.r=re.r,g.cellHTML&&(j.h=re.h);break;case"str":j.t="s",j.v=j.v!=null?Xt(j.v):"",g.cellHTML&&(j.h=Vp(j.v));break;case"inlineStr":k=B.match(r),j.t="s",k!=null&&(re=Xp(k[1]))?(j.v=re.t,g.cellHTML&&(j.h=re.h)):j.v="";break;case"b":j.v=rn(j.v);break;case"d":g.cellDates?j.v=Gn(j.v,1):(j.v=vr(Gn(j.v,1)),j.t="n");break;case"e":(!g||g.cellText!==!1)&&(j.w=j.v),j.v=HE[j.v];break}if(te=_e=0,Ee=null,Ne&&F.s!==void 0&&(Ee=T.CellXf[F.s],Ee!=null&&(Ee.numFmtId!=null&&(te=Ee.numFmtId),g.cellStyles&&Ee.fillId!=null&&(_e=Ee.fillId))),_S(j,te,_e,g,_,T),g.cellDates&&Ne&&j.t=="n"&&El(ut[te])&&(j.t="d",j.v=jd(j.v)),F.cm&&g.xlmeta){var Be=(g.xlmeta.Cell||[])[+F.cm-1];Be&&Be.type=="XLDAPR"&&(j.D=!0)}if(ae){var Z=pr(F.r);f[Z.r]||(f[Z.r]=[]),f[Z.r][Z.c]=j}else f[F.r]=j}}}}J.length>0&&(f["!rows"]=J)}}();function $V(t,e){var n={},r=t.l+e;n.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=r,i&7&&(n.level=i&7),i&16&&(n.hidden=!0),i&32&&(n.hpt=a/20),n}var GV=Qi;function zV(){}function qV(t,e){var n={},r=t[t.l];return++t.l,n.above=!(r&64),n.left=!(r&128),t.l+=18,n.name=mU(t),n}function YV(t){var e=na(t);return[e]}function WV(t){var e=Zi(t);return[e]}function JV(t){var e=na(t),n=t.read_shift(1);return[e,n,"b"]}function KV(t){var e=Zi(t),n=t.read_shift(1);return[e,n,"b"]}function XV(t){var e=na(t),n=t.read_shift(1);return[e,n,"e"]}function ZV(t){var e=Zi(t),n=t.read_shift(1);return[e,n,"e"]}function QV(t){var e=na(t),n=t.read_shift(4);return[e,n,"s"]}function eH(t){var e=Zi(t),n=t.read_shift(4);return[e,n,"s"]}function tH(t){var e=na(t),n=sr(t);return[e,n,"n"]}function TS(t){var e=Zi(t),n=sr(t);return[e,n,"n"]}function nH(t){var e=na(t),n=Wp(t);return[e,n,"n"]}function rH(t){var e=Zi(t),n=Wp(t);return[e,n,"n"]}function aH(t){var e=na(t),n=qp(t);return[e,n,"is"]}function sH(t){var e=na(t),n=lr(t);return[e,n,"str"]}function iH(t){var e=Zi(t),n=lr(t);return[e,n,"str"]}function oH(t,e,n){var r=t.l+e,a=na(t);a.r=n["!row"];var i=t.read_shift(1),l=[a,i,"b"];if(n.cellFormula){t.l+=2;var c=$d(t,r-t.l,n);l[3]=ar(c,null,a,n.supbooks,n)}else t.l=r;return l}function lH(t,e,n){var r=t.l+e,a=na(t);a.r=n["!row"];var i=t.read_shift(1),l=[a,i,"e"];if(n.cellFormula){t.l+=2;var c=$d(t,r-t.l,n);l[3]=ar(c,null,a,n.supbooks,n)}else t.l=r;return l}function cH(t,e,n){var r=t.l+e,a=na(t);a.r=n["!row"];var i=sr(t),l=[a,i,"n"];if(n.cellFormula){t.l+=2;var c=$d(t,r-t.l,n);l[3]=ar(c,null,a,n.supbooks,n)}else t.l=r;return l}function uH(t,e,n){var r=t.l+e,a=na(t);a.r=n["!row"];var i=lr(t),l=[a,i,"str"];if(n.cellFormula){t.l+=2;var c=$d(t,r-t.l,n);l[3]=ar(c,null,a,n.supbooks,n)}else t.l=r;return l}var fH=Qi;function dH(t,e){var n=t.l+e,r=Qi(t),a=Yp(t),i=lr(t),l=lr(t),c=lr(t);t.l=n;var d={rfx:r,relId:a,loc:i,display:c};return l&&(d.Tooltip=l),d}function hH(){}function mH(t,e,n){var r=t.l+e,a=BE(t),i=t.read_shift(1),l=[a];if(l[2]=i,n.cellFormula){var c=yV(t,r-t.l,n);l[1]=c}else t.l=r;return l}function pH(t,e,n){var r=t.l+e,a=Qi(t),i=[a];if(n.cellFormula){var l=wV(t,r-t.l,n);i[1]=l,t.l=r}else t.l=r;return i}var gH=["left","right","top","bottom","header","footer"];function xH(t){var e={};return gH.forEach(function(n){e[n]=sr(t)}),e}function vH(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function yH(){}function _H(){}function wH(t,e,n,r,a,i,l){if(!t)return t;var c=e||{};r||(r={"!id":{}});var d=c.dense?[]:{},f,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,_=!1,T,E,S,b,k,A,C,I,B,j=[];c.biff=12,c["!row"]=0;var F=0,X=!1,P=[],re={},G=c.supbooks||a.supbooks||[[]];if(G.sharedf=re,G.arrayf=P,G.SheetNames=a.SheetNames||a.Sheets.map(function(ae){return ae.name}),!c.supbooks&&(c.supbooks=G,a.Names))for(var te=0;te<a.Names.length;++te)G[0][te+1]=a.Names[te];var _e=[],Ne=[],Ee=!1;Ad[16]={n:"BrtShortReal",f:TS};var se;if(ps(t,function(J,D,ee){if(!_)switch(ee){case 148:f=J;break;case 0:T=J,c.sheetRows&&c.sheetRows<=T.r&&(_=!0),I=Xn(b=T.r),c["!row"]=T.r,(J.hidden||J.hpt||J.level!=null)&&(J.hpt&&(J.hpx=ou(J.hpt)),Ne[J.r]=J);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:J[2]},J[2]){case"n":E.v=J[1];break;case"s":C=zc[J[1]],E.v=C.t,E.r=C.r;break;case"b":E.v=!!J[1];break;case"e":E.v=J[1],c.cellText!==!1&&(E.w=eo[E.v]);break;case"str":E.t="s",E.v=J[1];break;case"is":E.t="s",E.v=J[1].t;break}if((S=l.CellXf[J[0].iStyleRef])&&_S(E,S.numFmtId,null,c,i,l),k=J[0].c==-1?k+1:J[0].c,c.dense?(d[b]||(d[b]=[]),d[b][k]=E):d[Fn(k)+I]=E,c.cellFormula){for(X=!1,F=0;F<P.length;++F){var M=P[F];T.r>=M[0].s.r&&T.r<=M[0].e.r&&k>=M[0].s.c&&k<=M[0].e.c&&(E.F=Rt(M[0]),X=!0)}!X&&J.length>3&&(E.f=J[3])}if(g.s.r>T.r&&(g.s.r=T.r),g.s.c>k&&(g.s.c=k),g.e.r<T.r&&(g.e.r=T.r),g.e.c<k&&(g.e.c=k),c.cellDates&&S&&E.t=="n"&&El(ut[S.numFmtId])){var Y=Di(E.v);Y&&(E.t="d",E.v=new Date(Y.y,Y.m-1,Y.d,Y.H,Y.M,Y.S,Y.u))}se&&(se.type=="XLDAPR"&&(E.D=!0),se=void 0);break;case 1:case 12:if(!c.sheetStubs||v)break;E={t:"z",v:void 0},k=J[0].c==-1?k+1:J[0].c,c.dense?(d[b]||(d[b]=[]),d[b][k]=E):d[Fn(k)+I]=E,g.s.r>T.r&&(g.s.r=T.r),g.s.c>k&&(g.s.c=k),g.e.r<T.r&&(g.e.r=T.r),g.e.c<k&&(g.e.c=k),se&&(se.type=="XLDAPR"&&(E.D=!0),se=void 0);break;case 176:j.push(J);break;case 49:se=((c.xlmeta||{}).Cell||[])[J-1];break;case 494:var K=r["!id"][J.relId];for(K?(J.Target=K.Target,J.loc&&(J.Target+="#"+J.loc),J.Rel=K):J.relId==""&&(J.Target="#"+J.loc),b=J.rfx.s.r;b<=J.rfx.e.r;++b)for(k=J.rfx.s.c;k<=J.rfx.e.c;++k)c.dense?(d[b]||(d[b]=[]),d[b][k]||(d[b][k]={t:"z",v:void 0}),d[b][k].l=J):(A=ot({c:k,r:b}),d[A]||(d[A]={t:"z",v:void 0}),d[A].l=J);break;case 426:if(!c.cellFormula)break;P.push(J),B=c.dense?d[b][k]:d[Fn(k)+I],B.f=ar(J[1],g,{r:T.r,c:k},G,c),B.F=Rt(J[0]);break;case 427:if(!c.cellFormula)break;re[ot(J[0].s)]=J[1],B=c.dense?d[b][k]:d[Fn(k)+I],B.f=ar(J[1],g,{r:T.r,c:k},G,c);break;case 60:if(!c.cellStyles)break;for(;J.e>=J.s;)_e[J.e--]={width:J.w/256,hidden:!!(J.flags&1),level:J.level},Ee||(Ee=!0,Zp(J.w/256)),ml(_e[J.e+1]);break;case 161:d["!autofilter"]={ref:Rt(J)};break;case 476:d["!margins"]=J;break;case 147:a.Sheets[n]||(a.Sheets[n]={}),J.name&&(a.Sheets[n].CodeName=J.name),(J.above||J.left)&&(d["!outline"]={above:J.above,left:J.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),J.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!D.T){if(!v||c.WTF)throw new Error("Unexpected record 0x"+ee.toString(16))}}},c),delete c.supbooks,delete c["!row"],!d["!ref"]&&(g.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(d["!ref"]=Rt(f||g)),c.sheetRows&&d["!ref"]){var ue=vn(d["!ref"]);c.sheetRows<=+ue.e.r&&(ue.e.r=c.sheetRows-1,ue.e.r>g.e.r&&(ue.e.r=g.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>g.e.c&&(ue.e.c=g.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),d["!fullref"]=d["!ref"],d["!ref"]=Rt(ue))}return j.length>0&&(d["!merges"]=j),_e.length>0&&(d["!cols"]=_e),Ne.length>0&&(d["!rows"]=Ne),d}function TH(t){var e=[],n=t.match(/^<c:numCache>/),r;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=n?+l[2]:l[2])});var a=Dt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){r=i.replace(/<.*?>/g,"")}),[e,a,r]}function EH(t,e,n,r,a,i){var l=i||{"!type":"chart"};if(!t)return i;var c=0,d=0,f="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var _=TH(v);g.s.r=g.s.c=0,g.e.c=c,f=Fn(c),_[0].forEach(function(T,E){l[f+Xn(E)]={t:"n",v:T,z:_[1]},d=E}),g.e.r<d&&(g.e.r=d),++c}),c>0&&(l["!ref"]=Rt(g)),l}function SH(t,e,n,r,a){if(!t)return t;r||(r={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,c=t.match(wS);return c&&eg(c[0],i,a,n),(l=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}function bH(t,e){t.l+=10;var n=lr(t);return{name:n}}function CH(t,e,n,r,a){if(!t)return t;r||(r={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return ps(t,function(d,f,g){switch(g){case 550:i["!rel"]=d;break;case 651:a.Sheets[n]||(a.Sheets[n]={}),d.name&&(a.Sheets[n].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},e),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}var ES=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],AH=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],kH=[],NH=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function iT(t,e){for(var n=0;n!=t.length;++n)for(var r=t[n],a=0;a!=e.length;++a){var i=e[a];if(r[i[0]]==null)r[i[0]]=i[1];else switch(i[2]){case"bool":typeof r[i[0]]=="string"&&(r[i[0]]=rn(r[i[0]]));break;case"int":typeof r[i[0]]=="string"&&(r[i[0]]=parseInt(r[i[0]],10));break}}}function oT(t,e){for(var n=0;n!=e.length;++n){var r=e[n];if(t[r[0]]==null)t[r[0]]=r[1];else switch(r[2]){case"bool":typeof t[r[0]]=="string"&&(t[r[0]]=rn(t[r[0]]));break;case"int":typeof t[r[0]]=="string"&&(t[r[0]]=parseInt(t[r[0]],10));break}}}function SS(t){oT(t.WBProps,ES),oT(t.CalcPr,NH),iT(t.WBView,AH),iT(t.Sheets,kH),sl.date1904=rn(t.WBProps.date1904)}var RH="][*?/\\".split("");function DH(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return RH.forEach(function(r){if(t.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}var MH=/<\w+:workbook/;function IH(t,e){if(!t)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",i={},l=0;if(t.replace(ur,function(d,f){var g=et(d);switch(Ba(g[0])){case"<?xml":break;case"<workbook":d.match(MH)&&(a="xmlns"+d.match(/<(\w+):/)[1]),n.xmlns=g[a];break;case"</workbook>":break;case"<fileVersion":delete g[0],n.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ES.forEach(function(v){if(g[v[0]]!=null)switch(v[2]){case"bool":n.WBProps[v[0]]=rn(g[v[0]]);break;case"int":n.WBProps[v[0]]=parseInt(g[v[0]],10);break;default:n.WBProps[v[0]]=g[v[0]]}}),g.codeName&&(n.WBProps.CodeName=Xt(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],n.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=Dt(Xt(g.name)),delete g[0],n.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":i={},i.Name=Xt(g.name),g.comment&&(i.Comment=g.comment),g.localSheetId&&(i.Sheet=+g.localSheetId),rn(g.hidden||"0")&&(i.Hidden=!0),l=f+d.length;break;case"</definedName>":i.Ref=Dt(Xt(t.slice(l,f))),n.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete g[0],n.CalcPr=g;break;case"<calcPr/>":delete g[0],n.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&e.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return d}),XP.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return SS(n),n}function FH(t,e){var n={};return n.Hidden=t.read_shift(4),n.iTabID=t.read_shift(4),n.strRelID=ep(t),n.name=lr(t),n}function LH(t,e){var n={},r=t.read_shift(4);n.defaultThemeVersion=t.read_shift(4);var a=e>8?lr(t):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function OH(t,e){var n={};return t.read_shift(4),n.ArchID=t.read_shift(4),t.l+=e-8,n}function PH(t,e,n){var r=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),i=pU(t),l=_V(t,0,n),c=Yp(t);t.l=r;var d={Name:i,Ptg:l};return a<268435455&&(d.Sheet=a),c&&(d.Comment=c),d}function UH(t,e){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;e||(e={}),e.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],Ad[16]={n:"BrtFRTArchID$",f:OH},ps(t,function(d,f,g){switch(g){case 156:l.SheetNames.push(d.name),n.Sheets.push(d);break;case 153:n.WBProps=d;break;case 39:d.Sheet!=null&&(e.SID=d.Sheet),d.Ref=ar(d.Ptg,null,null,l,e),delete e.SID,delete d.Ptg,i.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([g,d]):l[0]=[g,d],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(d),l.XTI=l.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(g),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(g),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!f.T){if(!a||e.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},e),SS(n),n.Names=i,n.supbooks=l,n}function BH(t,e,n){return e.slice(-4)===".bin"?UH(t,n):IH(t,n)}function jH(t,e,n,r,a,i,l,c){return e.slice(-4)===".bin"?wH(t,r,n,a,i,l,c):FV(t,r,n,a,i,l,c)}function VH(t,e,n,r,a,i,l,c){return e.slice(-4)===".bin"?CH(t,r,n,a,i):SH(t,r,n,a,i)}function HH(t,e,n,r,a,i,l,c){return e.slice(-4)===".bin"?KB():XB()}function $H(t,e,n,r,a,i,l,c){return e.slice(-4)===".bin"?WB():JB()}function GH(t,e,n,r){return e.slice(-4)===".bin"?fB(t,n,r):sB(t,n,r)}function zH(t,e,n){return uS(t,n)}function qH(t,e,n){return e.slice(-4)===".bin"?A9(t,n):b9(t,n)}function YH(t,e,n){return e.slice(-4)===".bin"?zB(t,n):jB(t,n)}function WH(t,e,n){return e.slice(-4)===".bin"?PB(t):LB(t)}function JH(t,e,n,r){return n.slice(-4)===".bin"?UB(t,e,n,r):void 0}function KH(t,e,n){return e.slice(-4)===".bin"?IB(t,e,n):FB(t,e,n)}var bS=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,CS=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ca(t,e){var n=t.split(/\s+/),r=[];if(r[0]=n[0],n.length===1)return r;var a=t.match(bS),i,l,c,d;if(a)for(d=0;d!=a.length;++d)i=a[d].match(CS),(l=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(l+1),r[c]=i[2].slice(1,i[2].length-1));return r}function XH(t){var e=t.split(/\s+/),n={};if(e.length===1)return n;var r=t.match(bS),a,i,l,c;if(r)for(c=0;c!=r.length;++c)a=r[c].match(CS),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(i+1),n[l]=a[2].slice(1,a[2].length-1));return n}var Yc;function ZH(t,e){var n=Yc[t]||Dt(t);return n==="General"?Hi(e):ea(n,e)}function QH(t,e,n,r){var a=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=rn(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Gn(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}t[Dt(e)]=a}function e$(t,e,n){if(t.t!=="z"){if(!n||n.cellText!==!1)try{t.t==="e"?t.w=t.w||eo[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=nu(t.v):t.w=Hi(t.v):t.w=ZH(e||"General",t.v)}catch(i){if(n.WTF)throw i}try{var r=Yc[e]||e||"General";if(n.cellNF&&(t.z=r),n.cellDates&&t.t=="n"&&El(r)){var a=Di(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(n.WTF)throw i}}}function t$(t,e,n){if(n.cellStyles&&e.Interior){var r=e.Interior;r.Pattern&&(r.patternType=Q9[r.Pattern]||r.Pattern)}t[e.ID]=e}function n$(t,e,n,r,a,i,l,c,d,f){var g="General",v=r.StyleID,_={};f=f||{};var T=[],E=0;for(v===void 0&&c&&(v=c.StyleID),v===void 0&&l&&(v=l.StyleID);i[v]!==void 0&&(i[v].nf&&(g=i[v].nf),i[v].Interior&&T.push(i[v].Interior),!!i[v].Parent);)v=i[v].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=rn(t);break;case"String":r.t="s",r.r=Nw(Dt(t)),r.v=t.indexOf("<")>-1?Dt(e||t).replace(/<.*?>/g,""):r.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),r.v=(Gn(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=Dt(t):r.v<60&&(r.v=r.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+t),r.t||(r.t="n");break;case"Error":r.t="e",r.v=HE[t],f.cellText!==!1&&(r.w=t);break;default:t==""&&e==""?r.t="z":(r.t="s",r.v=Nw(e||t));break}if(e$(r,g,f),f.cellFormula!==!1)if(r.Formula){var S=Dt(r.Formula);S.charCodeAt(0)==61&&(S=S.slice(1)),r.f=al(S,a),delete r.Formula,r.ArrayRange=="RC"?r.F=al("RC:RC",a):r.ArrayRange&&(r.F=al(r.ArrayRange,a),d.push([vn(r.F),r.F]))}else for(E=0;E<d.length;++E)a.r>=d[E][0].s.r&&a.r<=d[E][0].e.r&&a.c>=d[E][0].s.c&&a.c<=d[E][0].e.c&&(r.F=d[E][1]);f.cellStyles&&(T.forEach(function(b){!_.patternType&&b.patternType&&(_.patternType=b.patternType)}),r.s=_),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function r$(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function vm(t,e){var n=e||{};mE();var r=Rc(Hp(t));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(r=Xt(r));var a=r.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=Kn(n);return l.type="string",su.to_workbook(r,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Bt){a.indexOf("<"+Bt)>=0&&(i=!0)}),i)return d$(r,n);Yc={"General Number":"General","General Date":ut[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ut[15],"Short Date":ut[14],"Long Time":ut[19],"Medium Time":ut[18],"Short Time":ut[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ut[2],Standard:ut[4],Percent:ut[10],Scientific:ut[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,d=[],f,g={},v=[],_=n.dense?[]:{},T="",E={},S={},b=ca('<Data ss:Type="String">'),k=0,A=0,C=0,I={s:{r:2e6,c:2e6},e:{r:0,c:0}},B={},j={},F="",X=0,P=[],re={},G={},te=0,_e=[],Ne=[],Ee={},se=[],ue,ae=!1,J=[],D=[],ee={},M=0,Y=0,K={Sheets:[],WBProps:{date1904:!1}},W={};au.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var oe="";c=au.exec(r);)switch(c[3]=(oe=c[3]).toLowerCase()){case"data":if(oe=="data"){if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break}if(d[d.length-1][1])break;c[1]==="/"?n$(r.slice(k,c.index),F,b,d[d.length-1][0]=="comment"?Ee:E,{c:A,r:C},B,se[A],S,J,n):(F="",b=ca(c[0]),k=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(Ne.length>0&&(E.c=Ne),(!n.sheetRows||n.sheetRows>C)&&E.v!==void 0&&(n.dense?(_[C]||(_[C]=[]),_[C][A]=E):_[Fn(A)+Xn(C)]=E),E.HRef&&(E.l={Target:Dt(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(M=A+(parseInt(E.MergeAcross,10)|0),Y=C+(parseInt(E.MergeDown,10)|0),P.push({s:{c:A,r:C},e:{c:M,r:Y}})),!n.sheetStubs)E.MergeAcross?A=M+1:++A;else if(E.MergeAcross||E.MergeDown){for(var ve=A;ve<=M;++ve)for(var Te=C;Te<=Y;++Te)(ve>A||Te>C)&&(n.dense?(_[Te]||(_[Te]=[]),_[Te][ve]={t:"z"}):_[Fn(ve)+Xn(Te)]={t:"z"});A=M+1}else++A;else E=XH(c[0]),E.Index&&(A=+E.Index-1),A<I.s.c&&(I.s.c=A),A>I.e.c&&(I.e.c=A),c[0].slice(-2)==="/>"&&++A,Ne=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(C<I.s.r&&(I.s.r=C),C>I.e.r&&(I.e.r=C),c[0].slice(-2)==="/>"&&(S=ca(c[0]),S.Index&&(C=+S.Index-1)),A=0,++C):(S=ca(c[0]),S.Index&&(C=+S.Index-1),ee={},(S.AutoFitHeight=="0"||S.Height)&&(ee.hpx=parseInt(S.Height,10),ee.hpt=cS(ee.hpx),D[C]=ee),S.Hidden=="1"&&(ee.hidden=!0,D[C]=ee));break;case"worksheet":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));v.push(T),I.s.r<=I.e.r&&I.s.c<=I.e.c&&(_["!ref"]=Rt(I),n.sheetRows&&n.sheetRows<=I.e.r&&(_["!fullref"]=_["!ref"],I.e.r=n.sheetRows-1,_["!ref"]=Rt(I))),P.length&&(_["!merges"]=P),se.length>0&&(_["!cols"]=se),D.length>0&&(_["!rows"]=D),g[T]=_}else I={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=A=0,d.push([c[3],!1]),f=ca(c[0]),T=Dt(f.Name),_=n.dense?[]:{},P=[],J=[],D=[],W={name:T,Hidden:0},K.Sheets.push(W);break;case"table":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else{if(c[0].slice(-2)=="/>")break;d.push([c[3],!1]),se=[],ae=!1}break;case"style":c[1]==="/"?t$(B,j,n):j=ca(c[0]);break;case"numberformat":j.nf=Dt(ca(c[0]).Format||"General"),Yc[j.nf]&&(j.nf=Yc[j.nf]);for(var De=0;De!=392&&ut[De]!=j.nf;++De);if(De==392){for(De=57;De!=392;++De)if(ut[De]==null){Ii(j.nf,De);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(ue=ca(c[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!ae&&ue.wpx>10){ae=!0,mr=oS;for(var Se=0;Se<se.length;++Se)se[Se]&&ml(se[Se])}ae&&ml(ue),se[ue.Index-1||se.length]=ue;for(var Be=0;Be<+ue.Span;++Be)se[se.length]=Kn(ue);break;case"namedrange":if(c[1]==="/")break;K.Names||(K.Names=[]);var Z=et(c[0]),dt={Name:Z.Name,Ref:al(Z.RefersTo.slice(1),{r:0,c:0})};K.Sheets.length>0&&(dt.Sheet=K.Sheets.length-1),K.Names.push(dt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?F+=r.slice(X,c.index):X=c.index+c[0].length;break;case"interior":if(!n.cellStyles)break;j.Interior=ca(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?jU(re,oe,r.slice(te,c.index)):te=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else d.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));r$(Ee),Ne.push(Ee)}else d.push([c[3],!1]),f=ca(c[0]),Ee={a:f.Author};break;case"autofilter":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var Ke=ca(c[0]);_["!autofilter"]={ref:al(Ke.Range).replace(/\$/g,"")},d.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break;case"null":break;default:if(d.length==0&&c[3]=="document"||d.length==0&&c[3]=="uof")return hT(r,n);var xt=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:xt=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:xt=!1}break;case"excelworkbook":switch(c[3]){case"date1904":K.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:xt=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:xt=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(r.slice(te,c.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else te=c.index+c[0].length;break;case"header":_["!margins"]||qc(_["!margins"]={},"xlml"),isNaN(+et(c[0]).Margin)||(_["!margins"].header=+et(c[0]).Margin);break;case"footer":_["!margins"]||qc(_["!margins"]={},"xlml"),isNaN(+et(c[0]).Margin)||(_["!margins"].footer=+et(c[0]).Margin);break;case"pagemargins":var nt=et(c[0]);_["!margins"]||qc(_["!margins"]={},"xlml"),isNaN(+nt.Top)||(_["!margins"].top=+nt.Top),isNaN(+nt.Left)||(_["!margins"].left=+nt.Left),isNaN(+nt.Right)||(_["!margins"].right=+nt.Right),isNaN(+nt.Bottom)||(_["!margins"].bottom=+nt.Bottom);break;case"displayrighttoleft":K.Views||(K.Views=[]),K.Views[0]||(K.Views[0]={}),K.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:xt=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:xt=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:xt=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:xt=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:xt=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:xt=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:xt=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:xt=!1}break;case"smarttags":break;default:xt=!1;break}if(xt||c[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?QH(G,oe,_e,r.slice(te,c.index)):(_e=c,te=c.index+c[0].length);break}if(n.WTF)throw"Unrecognized tag: "+c[3]+"|"+d.join("|")}var Ie={};return!n.bookSheets&&!n.bookProps&&(Ie.Sheets=g),Ie.SheetNames=v,Ie.Workbook=K,Ie.SSF=Kn(ut),Ie.Props=re,Ie.Custprops=G,Ie}function ap(t,e){switch(rg(e=e||{}),e.type||"base64"){case"base64":return vm(Ur(t),e);case"binary":case"buffer":case"file":return vm(t,e);case"array":return vm(Xi(t),e)}}function a$(t){var e={},n=t.content;if(n.l=28,e.AnsiUserType=n.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=vU(n),n.length-n.l<=4)return e;var r=n.read_shift(4);if(r==0||r>40||(n.l-=4,e.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(r=n.read_shift(4),r!==1907505652)||(e.UnicodeClipboardFormat=yU(n),r=n.read_shift(4),r==0||r>40))return e;n.l-=4,e.Reserved2=n.read_shift(0,"lpwstr")}var s$=[60,1084,2066,2165,2175];function i$(t,e,n,r,a){var i=r,l=[],c=n.slice(n.l,n.l+i);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}l.push(c),n.l+=i;for(var d=ss(n,n.l),f=sp[d],g=0;f!=null&&s$.indexOf(d)>-1;)i=ss(n,n.l+2),g=n.l+4,d==2066?g+=4:(d==2165||d==2175)&&(g+=12),c=n.slice(g,n.l+4+i),l.push(c),n.l+=4+i,f=sp[d=ss(n,n.l)];var v=Ws(l);Jn(v,0);var _=0;v.lens=[];for(var T=0;T<l.length;++T)v.lens.push(_),_+=l[T].length;if(v.length<r)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+v.length+" < "+r;return e.f(v,v.length,a)}function Ca(t,e,n){if(t.t!=="z"&&t.XF){var r=0;try{r=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ut[r])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||eo[t.v]:r===0||r=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=nu(t.v):t.w=Hi(t.v):t.w=ea(r,t.v,{date1904:!!n,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&r&&t.t=="n"&&El(ut[r]||String(r))){var a=Di(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Xf(t,e,n){return{v:t,ixfe:e,t:n}}function o$(t,e){var n={opts:{}},r={},a=e.dense?[]:{},i={},l={},c=null,d=[],f="",g={},v,_="",T,E,S,b,k={},A=[],C,I,B=[],j=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},X={},P=function(tt){return tt<8?Fi[tt]:tt<64&&j[tt-8]||Fi[tt]},re=function(tt,St,on){var jt=St.XF.data;if(!(!jt||!jt.patternType||!on||!on.cellStyles)){St.s={},St.s.patternType=jt.patternType;var Pn;(Pn=iu(P(jt.icvFore)))&&(St.s.fgColor={rgb:Pn}),(Pn=iu(P(jt.icvBack)))&&(St.s.bgColor={rgb:Pn})}},G=function(tt,St,on){if(!(ee>1)&&!(on.sheetRows&&tt.r>=on.sheetRows)){if(on.cellStyles&&St.XF&&St.XF.data&&re(tt,St,on),delete St.ixfe,delete St.XF,v=tt,_=ot(tt),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),tt.r<l.s.r&&(l.s.r=tt.r),tt.c<l.s.c&&(l.s.c=tt.c),tt.r+1>l.e.r&&(l.e.r=tt.r+1),tt.c+1>l.e.c&&(l.e.c=tt.c+1),on.cellFormula&&St.f){for(var jt=0;jt<A.length;++jt)if(!(A[jt][0].s.c>tt.c||A[jt][0].s.r>tt.r)&&!(A[jt][0].e.c<tt.c||A[jt][0].e.r<tt.r)){St.F=Rt(A[jt][0]),(A[jt][0].s.c!=tt.c||A[jt][0].s.r!=tt.r)&&delete St.f,St.f&&(St.f=""+ar(A[jt][1],l,tt,J,te));break}}on.dense?(a[tt.r]||(a[tt.r]=[]),a[tt.r][tt.c]=St):a[_]=St}},te={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:A,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(te.password=e.password);var _e,Ne=[],Ee=[],se=[],ue=[],ae=!1,J=[];J.SheetNames=te.snames,J.sharedf=te.sharedf,J.arrayf=te.arrayf,J.names=[],J.XTI=[];var D=0,ee=0,M=0,Y=[],K=[],W;te.codepage=1200,ma(1200);for(var oe=!1;t.l<t.length-1;){var ve=t.l,Te=t.read_shift(2);if(Te===0&&D===10)break;var De=t.l===t.length?0:t.read_shift(2),Se=sp[Te];if(Se&&Se.f){if(e.bookSheets&&D===133&&Te!==133)break;if(D=Te,Se.r===2||Se.r==12){var Be=t.read_shift(2);if(De-=2,!te.enc&&Be!==Te&&((Be&255)<<8|Be>>8)!==Te)throw new Error("rt mismatch: "+Be+"!="+Te);Se.r==12&&(t.l+=10,De-=10)}var Z={};if(Te===10?Z=Se.f(t,De,te):Z=i$(Te,Se,t,De,te),ee==0&&[9,521,1033,2057].indexOf(D)===-1)continue;switch(Te){case 34:n.opts.Date1904=F.WBProps.date1904=Z;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(te.enc||(t.l=0),te.enc=Z,!e.password)throw new Error("File is password-protected");if(Z.valid==null)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case 92:te.lastuser=Z;break;case 66:var dt=Number(Z);switch(dt){case 21010:dt=1200;break;case 32768:dt=1e4;break;case 32769:dt=1252;break}ma(te.codepage=dt),oe=!0;break;case 317:te.rrtabid=Z;break;case 25:te.winlocked=Z;break;case 439:n.opts.RefreshAll=Z;break;case 12:n.opts.CalcCount=Z;break;case 16:n.opts.CalcDelta=Z;break;case 17:n.opts.CalcIter=Z;break;case 13:n.opts.CalcMode=Z;break;case 14:n.opts.CalcPrecision=Z;break;case 95:n.opts.CalcSaveRecalc=Z;break;case 15:te.CalcRefMode=Z;break;case 2211:n.opts.FullCalc=Z;break;case 129:Z.fDialog&&(a["!type"]="dialog"),Z.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),Z.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:B.push(Z);break;case 430:J.push([Z]),J[J.length-1].XTI=[];break;case 35:case 547:J[J.length-1].push(Z);break;case 24:case 536:W={Name:Z.Name,Ref:ar(Z.rgce,l,null,J,te)},Z.itab>0&&(W.Sheet=Z.itab-1),J.names.push(W),J[0]||(J[0]=[],J[0].XTI=[]),J[J.length-1].push(Z),Z.Name=="_xlnm._FilterDatabase"&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&Z.rgce[0][0][0]=="PtgArea3d"&&(K[Z.itab-1]={ref:Rt(Z.rgce[0][0][1][2])});break;case 22:te.ExternCount=Z;break;case 23:J.length==0&&(J[0]=[],J[0].XTI=[]),J[J.length-1].XTI=J[J.length-1].XTI.concat(Z),J.XTI=J.XTI.concat(Z);break;case 2196:if(te.biff<8)break;W!=null&&(W.Comment=Z[1]);break;case 18:a["!protect"]=Z;break;case 19:Z!==0&&te.WTF&&console.error("Password verifier: "+Z);break;case 133:i[Z.pos]=Z,te.snames.push(Z.name);break;case 10:{if(--ee)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=Rt(l),e.sheetRows&&e.sheetRows<=l.e.r){var Ke=l.e.r;l.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Rt(l),l.e.r=Ke}l.e.r++,l.e.c++}Ne.length>0&&(a["!merges"]=Ne),Ee.length>0&&(a["!objects"]=Ee),se.length>0&&(a["!cols"]=se),ue.length>0&&(a["!rows"]=ue),F.Sheets.push(X)}f===""?g=a:r[f]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(te.biff===8&&(te.biff={9:2,521:3,1033:4}[Te]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),te.biffguess=Z.BIFFVer==0,Z.BIFFVer==0&&Z.dt==4096&&(te.biff=5,oe=!0,ma(te.codepage=28591)),te.biff==8&&Z.BIFFVer==0&&Z.dt==16&&(te.biff=2),ee++)break;if(a=e.dense?[]:{},te.biff<8&&!oe&&(oe=!0,ma(te.codepage=e.codepage||1252)),te.biff<5||Z.BIFFVer==0&&Z.dt==4096){f===""&&(f="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var xt={pos:t.l-De,name:f};i[xt.pos]=xt,te.snames.push(f)}else f=(i[ve]||{name:""}).name;Z.dt==32&&(a["!type"]="chart"),Z.dt==64&&(a["!type"]="macro"),Ne=[],Ee=[],te.arrayf=A=[],se=[],ue=[],ae=!1,X={Hidden:(i[ve]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[Z.r]||[])[Z.c]:a[ot({c:Z.c,r:Z.r})])&&++Z.c,C={ixfe:Z.ixfe,XF:B[Z.ixfe]||{},v:Z.val,t:"n"},M>0&&(C.z=Y[C.ixfe>>8&63]),Ca(C,e,n.opts.Date1904),G({c:Z.c,r:Z.r},C,e);break;case 5:case 517:C={ixfe:Z.ixfe,XF:B[Z.ixfe],v:Z.val,t:Z.t},M>0&&(C.z=Y[C.ixfe>>8&63]),Ca(C,e,n.opts.Date1904),G({c:Z.c,r:Z.r},C,e);break;case 638:C={ixfe:Z.ixfe,XF:B[Z.ixfe],v:Z.rknum,t:"n"},M>0&&(C.z=Y[C.ixfe>>8&63]),Ca(C,e,n.opts.Date1904),G({c:Z.c,r:Z.r},C,e);break;case 189:for(var nt=Z.c;nt<=Z.C;++nt){var Ie=Z.rkrec[nt-Z.c][0];C={ixfe:Ie,XF:B[Ie],v:Z.rkrec[nt-Z.c][1],t:"n"},M>0&&(C.z=Y[C.ixfe>>8&63]),Ca(C,e,n.opts.Date1904),G({c:nt,r:Z.r},C,e)}break;case 6:case 518:case 1030:{if(Z.val=="String"){c=Z;break}if(C=Xf(Z.val,Z.cell.ixfe,Z.tt),C.XF=B[C.ixfe],e.cellFormula){var Bt=Z.formula;if(Bt&&Bt[0]&&Bt[0][0]&&Bt[0][0][0]=="PtgExp"){var an=Bt[0][0][1][0],sn=Bt[0][0][1][1],un=ot({r:an,c:sn});k[un]?C.f=""+ar(Z.formula,l,Z.cell,J,te):C.F=((e.dense?(a[an]||[])[sn]:a[un])||{}).F}else C.f=""+ar(Z.formula,l,Z.cell,J,te)}M>0&&(C.z=Y[C.ixfe>>8&63]),Ca(C,e,n.opts.Date1904),G(Z.cell,C,e),c=Z}break;case 7:case 519:if(c)c.val=Z,C=Xf(Z,c.cell.ixfe,"s"),C.XF=B[C.ixfe],e.cellFormula&&(C.f=""+ar(c.formula,l,c.cell,J,te)),M>0&&(C.z=Y[C.ixfe>>8&63]),Ca(C,e,n.opts.Date1904),G(c.cell,C,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{A.push(Z);var On=ot(Z[0].s);if(T=e.dense?(a[Z[0].s.r]||[])[Z[0].s.c]:a[On],e.cellFormula&&T){if(!c||!On||!T)break;T.f=""+ar(Z[1],l,Z[0],J,te),T.F=Rt(Z[0])}}break;case 1212:{if(!e.cellFormula)break;if(_){if(!c)break;k[ot(c.cell)]=Z[0],T=e.dense?(a[c.cell.r]||[])[c.cell.c]:a[ot(c.cell)],(T||{}).f=""+ar(Z[0],l,v,J,te)}}break;case 253:C=Xf(d[Z.isst].t,Z.ixfe,"s"),d[Z.isst].h&&(C.h=d[Z.isst].h),C.XF=B[C.ixfe],M>0&&(C.z=Y[C.ixfe>>8&63]),Ca(C,e,n.opts.Date1904),G({c:Z.c,r:Z.r},C,e);break;case 513:e.sheetStubs&&(C={ixfe:Z.ixfe,XF:B[Z.ixfe],t:"z"},M>0&&(C.z=Y[C.ixfe>>8&63]),Ca(C,e,n.opts.Date1904),G({c:Z.c,r:Z.r},C,e));break;case 190:if(e.sheetStubs)for(var vt=Z.c;vt<=Z.C;++vt){var tn=Z.ixfe[vt-Z.c];C={ixfe:tn,XF:B[tn],t:"z"},M>0&&(C.z=Y[C.ixfe>>8&63]),Ca(C,e,n.opts.Date1904),G({c:vt,r:Z.r},C,e)}break;case 214:case 516:case 4:C=Xf(Z.val,Z.ixfe,"s"),C.XF=B[C.ixfe],M>0&&(C.z=Y[C.ixfe>>8&63]),Ca(C,e,n.opts.Date1904),G({c:Z.c,r:Z.r},C,e);break;case 0:case 512:ee===1&&(l=Z);break;case 252:d=Z;break;case 1054:if(te.biff==4){Y[M++]=Z[1];for(var zn=0;zn<M+163&&ut[zn]!=Z[1];++zn);zn>=163&&Ii(Z[1],M+163)}else Ii(Z[1],Z[0]);break;case 30:{Y[M++]=Z;for(var yn=0;yn<M+163&&ut[yn]!=Z;++yn);yn>=163&&Ii(Z,M+163)}break;case 229:Ne=Ne.concat(Z);break;case 93:Ee[Z.cmo[0]]=te.lastobj=Z;break;case 438:te.lastobj.TxO=Z;break;case 127:te.lastobj.ImData=Z;break;case 440:for(b=Z[0].s.r;b<=Z[0].e.r;++b)for(S=Z[0].s.c;S<=Z[0].e.c;++S)T=e.dense?(a[b]||[])[S]:a[ot({c:S,r:b})],T&&(T.l=Z[1]);break;case 2048:for(b=Z[0].s.r;b<=Z[0].e.r;++b)for(S=Z[0].s.c;S<=Z[0].e.c;++S)T=e.dense?(a[b]||[])[S]:a[ot({c:S,r:b})],T&&T.l&&(T.l.Tooltip=Z[1]);break;case 28:{if(te.biff<=5&&te.biff>=2)break;T=e.dense?(a[Z[0].r]||[])[Z[0].c]:a[ot(Z[0])];var Qt=Ee[Z[2]];T||(e.dense?(a[Z[0].r]||(a[Z[0].r]=[]),T=a[Z[0].r][Z[0].c]={t:"z"}):T=a[ot(Z[0])]={t:"z"},l.e.r=Math.max(l.e.r,Z[0].r),l.s.r=Math.min(l.s.r,Z[0].r),l.e.c=Math.max(l.e.c,Z[0].c),l.s.c=Math.min(l.s.c,Z[0].c)),T.c||(T.c=[]),E={a:Z[1],t:Qt.TxO.t},T.c.push(E)}break;case 2173:NB(B[Z.ixfe],Z.ext);break;case 125:{if(!te.cellStyles)break;for(;Z.e>=Z.s;)se[Z.e--]={width:Z.w/256,level:Z.level||0,hidden:!!(Z.flags&1)},ae||(ae=!0,Zp(Z.w/256)),ml(se[Z.e+1])}break;case 520:{var Mt={};Z.level!=null&&(ue[Z.r]=Mt,Mt.level=Z.level),Z.hidden&&(ue[Z.r]=Mt,Mt.hidden=!0),Z.hpt&&(ue[Z.r]=Mt,Mt.hpt=Z.hpt,Mt.hpx=ou(Z.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||qc(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Te]]=Z;break;case 161:a["!margins"]||qc(a["!margins"]={}),a["!margins"].header=Z.header,a["!margins"].footer=Z.footer;break;case 574:Z.RTL&&(F.Views[0].RTL=!0);break;case 146:j=Z;break;case 2198:_e=Z;break;case 140:I=Z;break;case 442:f?X.CodeName=Z||X.name:F.WBProps.CodeName=Z||"ThisWorkbook";break}}else Se||console.error("Missing Info for XLS Record 0x"+Te.toString(16)),t.l+=De}return n.SheetNames=La(i).sort(function(it,tt){return Number(it)-Number(tt)}).map(function(it){return i[it].name}),e.bookSheets||(n.Sheets=r),!n.SheetNames.length&&g["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=g)):n.Preamble=g,n.Sheets&&K.forEach(function(it,tt){n.Sheets[n.SheetNames[tt]]["!autofilter"]=it}),n.Strings=d,n.SSF=Kn(ut),te.enc&&(n.Encryption=te.enc),_e&&(n.Themes=_e),n.Metadata={},I!==void 0&&(n.Metadata.Country=I),J.names.length>0&&(F.Names=J.names),n.Workbook=F,n}var lT={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function l$(t,e,n){var r=Nt.find(t,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=zw(r,bU,lT.DSI);for(var i in a)e[i]=a[i]}catch(f){if(n.WTF)throw f}var l=Nt.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var c=zw(l,CU,lT.SI);for(var d in c)e[d]==null&&(e[d]=c[d])}catch(f){if(n.WTF)throw f}e.HeadingPairs&&e.TitlesOfParts&&(GE(e.HeadingPairs,e.TitlesOfParts,e,n),delete e.HeadingPairs,delete e.TitlesOfParts)}function AS(t,e){e||(e={}),rg(e),nE(),e.codepage&&Lp(e.codepage);var n,r;if(t.FullPaths){if(Nt.find(t,"/encryption"))throw new Error("File is password-protected");n=Nt.find(t,"!CompObj"),r=Nt.find(t,"/Workbook")||Nt.find(t,"/Book")}else{switch(e.type){case"base64":t=ha(Ur(t));break;case"binary":t=ha(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Jn(t,0),r={content:t}}var a,i;if(n&&a$(n),e.bookProps&&!e.bookSheets)a={};else{var l=Ct?"buffer":"array";if(r&&r.content)a=o$(r.content,e);else if((i=Nt.find(t,"PerfectOffice_MAIN"))&&i.content)a=Gc.to_workbook(i.content,(e.type=l,e));else if((i=Nt.find(t,"NativeContent_MAIN"))&&i.content)a=Gc.to_workbook(i.content,(e.type=l,e));else throw(i=Nt.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Nt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=YB(t))}var c={};return t.FullPaths&&l$(t,c,e),a.Props=a.Custprops=c,e.bookFiles&&(a.cfb=t),a}var Ad={0:{f:$V},1:{f:YV},2:{f:nH},3:{f:XV},4:{f:JV},5:{f:tH},6:{f:sH},7:{f:QV},8:{f:uH},9:{f:cH},10:{f:oH},11:{f:lH},12:{f:WV},13:{f:rH},14:{f:ZV},15:{f:KV},16:{f:TS},17:{f:iH},18:{f:eH},19:{f:qp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:PH},40:{},42:{},43:{f:oB},44:{f:iB},45:{f:lB},46:{f:uB},47:{f:cB},48:{},49:{f:fU},50:{},51:{f:DB},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:nS},62:{f:aH},63:{f:OB},64:{f:yH},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:cr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:vH},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:qV},148:{f:GV,p:16},151:{f:hH},152:{},153:{f:LH},154:{},155:{},156:{f:FH},157:{},158:{},159:{T:1,f:C9},160:{T:-1},161:{T:1,f:Qi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:fH},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:RB},336:{T:-1},337:{f:MB,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ep},357:{},358:{},359:{},360:{T:1},361:{},362:{f:tS},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:mH},427:{f:pH},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:xH},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:zV},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:dH},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ep},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:GB},633:{T:1},634:{T:-1},635:{T:1,f:$B},636:{T:-1},637:{f:hU},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:bH},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:_H},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},sp={6:{f:gm},10:{f:$s},12:{f:An},13:{f:An},14:{f:Tn},15:{f:Tn},16:{f:sr},17:{f:Tn},18:{f:Tn},19:{f:An},20:{f:Jw},21:{f:Jw},23:{f:tS},24:{f:Xw},25:{f:Tn},26:{},27:{},28:{f:V7},29:{},34:{f:Tn},35:{f:Kw},38:{f:sr},39:{f:sr},40:{f:sr},41:{f:sr},42:{f:Tn},43:{f:Tn},47:{f:z9},49:{f:T7},51:{f:An},60:{},61:{f:y7},64:{f:Tn},65:{f:w7},66:{f:An},77:{},80:{},81:{},82:{},85:{f:An},89:{},90:{},91:{},92:{f:f7},93:{f:$7},94:{},95:{f:Tn},96:{},97:{},99:{f:Tn},125:{f:nS},128:{f:M7},129:{f:d7},130:{f:An},131:{f:Tn},132:{f:Tn},133:{f:h7},134:{},140:{f:J7},141:{f:An},144:{},146:{f:X7},151:{},152:{},153:{},154:{},155:{},156:{f:An},157:{},158:{},160:{f:n9},161:{f:Q7},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:k7},190:{f:N7},193:{f:$s},197:{},198:{},199:{},200:{},201:{},202:{f:Tn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:An},220:{},221:{f:Tn},222:{},224:{f:D7},225:{f:u7},226:{f:$s},227:{},229:{f:H7},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:m7},253:{f:E7},255:{f:p7},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:JE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Tn},353:{f:$s},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:F7},431:{f:Tn},432:{},433:{},434:{},437:{},438:{f:q7},439:{f:Tn},440:{f:Y7},441:{},442:{f:wu},443:{},444:{f:An},445:{},446:{},448:{f:$s},449:{f:v7,r:2},450:{f:$s},512:{f:Yw},513:{f:t9},515:{f:I7},516:{f:S7},517:{f:Ww},519:{f:r9},520:{f:g7},523:{},545:{f:Zw},549:{f:qw},566:{},574:{f:_7},638:{f:A7},659:{},1048:{},1054:{f:b7},1084:{},1212:{f:U7},2048:{f:W7},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Wf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:$s},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Z7,r:12},2173:{f:kB,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Tn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:P7,r:12},2197:{},2198:{f:TB,r:12},2199:{},2200:{},2201:{},2202:{f:B7,r:12},2203:{f:$s},2204:{},2205:{},2206:{},2207:{},2211:{f:x7},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:An},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:e9},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:K7},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Yw},1:{},2:{f:o9},3:{f:i9},4:{f:s9},5:{f:Ww},7:{f:l9},8:{},9:{f:Wf},11:{},22:{f:An},30:{f:C7},31:{},32:{},33:{f:Zw},36:{},37:{f:qw},50:{f:c9},62:{},52:{},67:{},68:{f:An},69:{},86:{},126:{},127:{f:a9},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:u9},223:{},234:{},354:{},421:{},518:{f:gm},521:{f:Wf},536:{f:Xw},547:{f:Kw},561:{},579:{},1030:{f:gm},1033:{f:Wf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ua(t,e,n,r){var a=e;if(!isNaN(a)){var i=(n||[]).length||0,l=t.next(4);l.write_shift(2,a),l.write_shift(2,i),i>0&&OE(n)&&t.push(n)}}function cT(t,e){var n=e||{},r=n.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),l=a.index,c=i&&i.index||t.length,d=IP(t.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,g=0,v=0,_=0,T={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(l=0;l<d.length;++l){var S=d[l].trim(),b=S.slice(0,3).toLowerCase();if(b=="<tr"){if(++f,n.sheetRows&&n.sheetRows<=f){--f;break}g=0;continue}if(!(b!="<td"&&b!="<th")){var k=S.split(/<\/t[dh]>/i);for(c=0;c<k.length;++c){var A=k[c].trim();if(A.match(/<t[dh]/i)){for(var C=A,I=0;C.charAt(0)=="<"&&(I=C.indexOf(">"))>-1;)C=C.slice(I+1);for(var B=0;B<E.length;++B){var j=E[B];j.s.c==g&&j.s.r<f&&f<=j.e.r&&(g=j.e.c+1,B=-1)}var F=et(A.slice(0,A.indexOf(">")));_=F.colspan?+F.colspan:1,((v=+F.rowspan)>1||_>1)&&E.push({s:{r:f,c:g},e:{r:f+(v||1)-1,c:g+_-1}});var X=F.t||F["data-t"]||"";if(!C.length){g+=_;continue}if(C=EE(C),T.s.r>f&&(T.s.r=f),T.e.r<f&&(T.e.r=f),T.s.c>g&&(T.s.c=g),T.e.c<g&&(T.e.c=g),!C.length){g+=_;continue}var P={t:"s",v:C};n.raw||!C.trim().length||X=="s"||(C==="TRUE"?P={t:"b",v:!0}:C==="FALSE"?P={t:"b",v:!1}:isNaN(ga(C))?isNaN(hl(C).getDate())||(P={t:"d",v:Gn(C)},n.cellDates||(P={t:"n",v:vr(P.v)}),P.z=n.dateNF||ut[14]):P={t:"n",v:ga(C)}),n.dense?(r[f]||(r[f]=[]),r[f][g]=P):r[ot({r:f,c:g})]=P,g+=_}}}}return r["!ref"]=Rt(T),E.length&&(r["!merges"]=E),r}function c$(t,e,n,r){for(var a=t["!merges"]||[],i=[],l=e.s.c;l<=e.e.c;++l){for(var c=0,d=0,f=0;f<a.length;++f)if(!(a[f].s.r>n||a[f].s.c>l)&&!(a[f].e.r<n||a[f].e.c<l)){if(a[f].s.r<n||a[f].s.c<l){c=-1;break}c=a[f].e.r-a[f].s.r+1,d=a[f].e.c-a[f].s.c+1;break}if(!(c<0)){var g=ot({r:n,c:l}),v=r.dense?(t[n]||[])[l]:t[g],_=v&&v.v!=null&&(v.h||Vp(v.w||(ds(v),v.w)||""))||"",T={};c>1&&(T.rowspan=c),d>1&&(T.colspan=d),r.editable?_='<span contenteditable="true">'+_+"</span>":v&&(T["data-t"]=v&&v.t||"z",v.v!=null&&(T["data-v"]=v.v),v.z!=null&&(T["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+v.l.Target+'">'+_+"</a>")),T.id=(r.id||"sjs")+"-"+g,i.push(JP("td",_,T))}}var E="<tr>";return E+i.join("")+"</tr>"}var u$='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',f$="</body></html>";function d$(t,e){var n=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return si(cT(n[0],e),e);var r=sg();return n.forEach(function(a,i){ig(r,cT(a,e),"Sheet"+(i+1))}),r}function h$(t,e,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function m$(t,e){var n=e||{},r=n.header!=null?n.header:u$,a=n.footer!=null?n.footer:f$,i=[r],l=Sl(t["!ref"]);n.dense=Array.isArray(t),i.push(h$(t,l,n));for(var c=l.s.r;c<=l.e.r;++c)i.push(c$(t,l,c,n));return i.push("</table>"+a),i.join("")}function kS(t,e,n){var r=n||{},a=0,i=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?pr(r.origin):r.origin;a=l.r,i=l.c}var c=e.getElementsByTagName("tr"),d=Math.min(r.sheetRows||1e7,c.length),f={s:{r:0,c:0},e:{r:a,c:i}};if(t["!ref"]){var g=Sl(t["!ref"]);f.s.r=Math.min(f.s.r,g.s.r),f.s.c=Math.min(f.s.c,g.s.c),f.e.r=Math.max(f.e.r,g.e.r),f.e.c=Math.max(f.e.c,g.e.c),a==-1&&(f.e.r=a=g.e.r+1)}var v=[],_=0,T=t["!rows"]||(t["!rows"]=[]),E=0,S=0,b=0,k=0,A=0,C=0;for(t["!cols"]||(t["!cols"]=[]);E<c.length&&S<d;++E){var I=c[E];if(uT(I)){if(r.display)continue;T[S]={hidden:!0}}var B=I.children;for(b=k=0;b<B.length;++b){var j=B[b];if(!(r.display&&uT(j))){var F=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):EE(j.innerHTML),X=j.getAttribute("data-z")||j.getAttribute("z");for(_=0;_<v.length;++_){var P=v[_];P.s.c==k+i&&P.s.r<S+a&&S+a<=P.e.r&&(k=P.e.c+1-i,_=-1)}C=+j.getAttribute("colspan")||1,((A=+j.getAttribute("rowspan")||1)>1||C>1)&&v.push({s:{r:S+a,c:k+i},e:{r:S+a+(A||1)-1,c:k+i+(C||1)-1}});var re={t:"s",v:F},G=j.getAttribute("data-t")||j.getAttribute("t")||"";F!=null&&(F.length==0?re.t=G||"z":r.raw||F.trim().length==0||G=="s"||(F==="TRUE"?re={t:"b",v:!0}:F==="FALSE"?re={t:"b",v:!1}:isNaN(ga(F))?isNaN(hl(F).getDate())||(re={t:"d",v:Gn(F)},r.cellDates||(re={t:"n",v:vr(re.v)}),re.z=r.dateNF||ut[14]):re={t:"n",v:ga(F)})),re.z===void 0&&X!=null&&(re.z=X);var te="",_e=j.getElementsByTagName("A");if(_e&&_e.length)for(var Ne=0;Ne<_e.length&&!(_e[Ne].hasAttribute("href")&&(te=_e[Ne].getAttribute("href"),te.charAt(0)!="#"));++Ne);te&&te.charAt(0)!="#"&&(re.l={Target:te}),r.dense?(t[S+a]||(t[S+a]=[]),t[S+a][k+i]=re):t[ot({c:k+i,r:S+a})]=re,f.e.c<k+i&&(f.e.c=k+i),k+=C}}++S}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),f.e.r=Math.max(f.e.r,S-1+a),t["!ref"]=Rt(f),S>=d&&(t["!fullref"]=Rt((f.e.r=c.length-E+S-1+a,f))),t}function NS(t,e){var n=e||{},r=n.dense?[]:{};return kS(r,t,e)}function p$(t,e){return si(NS(t,e),e)}function uT(t){var e="",n=g$(t);return n&&(e=n(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function g$(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function x$(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=Dt(e.replace(/<[^>]*>/g,""));return[n]}var fT={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function RS(t,e){var n=e||{},r=Hp(t),a=[],i,l,c={name:""},d="",f=0,g,v,_={},T=[],E=n.dense?[]:{},S,b,k={value:""},A="",C=0,I=[],B=-1,j=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},X=0,P={},re=[],G={},te=0,_e=0,Ne=[],Ee=1,se=1,ue=[],ae={Names:[]},J={},D=["",""],ee=[],M={},Y="",K=0,W=!1,oe=!1,ve=0;for(au.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");S=au.exec(r);)switch(S[3]=S[3].replace(/_.*$/,"")){case"table":case"工作表":S[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?E["!ref"]=Rt(F):E["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=F.e.r&&(E["!fullref"]=E["!ref"],F.e.r=n.sheetRows-1,E["!ref"]=Rt(F)),re.length&&(E["!merges"]=re),Ne.length&&(E["!rows"]=Ne),g.name=g.名称||g.name,typeof JSON<"u"&&JSON.stringify(g),T.push(g.name),_[g.name]=E,oe=!1):S[0].charAt(S[0].length-2)!=="/"&&(g=et(S[0],!1),B=j=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,E=n.dense?[]:{},re=[],Ne=[],oe=!0);break;case"table-row-group":S[1]==="/"?--X:++X;break;case"table-row":case"行":if(S[1]==="/"){B+=Ee,Ee=1;break}if(v=et(S[0],!1),v.行号?B=v.行号-1:B==-1&&(B=0),Ee=+v["number-rows-repeated"]||1,Ee<10)for(ve=0;ve<Ee;++ve)X>0&&(Ne[B+ve]={level:X});j=-1;break;case"covered-table-cell":S[1]!=="/"&&++j,n.sheetStubs&&(n.dense?(E[B]||(E[B]=[]),E[B][j]={t:"z"}):E[ot({r:B,c:j})]={t:"z"}),A="",I=[];break;case"table-cell":case"数据":if(S[0].charAt(S[0].length-2)==="/")++j,k=et(S[0],!1),se=parseInt(k["number-columns-repeated"]||"1",10),b={t:"z",v:null},k.formula&&n.cellFormula!=!1&&(b.f=sT(Dt(k.formula))),(k.数据类型||k["value-type"])=="string"&&(b.t="s",b.v=Dt(k["string-value"]||""),n.dense?(E[B]||(E[B]=[]),E[B][j]=b):E[ot({r:B,c:j})]=b),j+=se-1;else if(S[1]!=="/"){++j,A="",C=0,I=[],se=1;var Te=Ee?B+Ee-1:B;if(j>F.e.c&&(F.e.c=j),j<F.s.c&&(F.s.c=j),B<F.s.r&&(F.s.r=B),Te>F.e.r&&(F.e.r=Te),k=et(S[0],!1),ee=[],M={},b={t:k.数据类型||k["value-type"],v:null},n.cellFormula)if(k.formula&&(k.formula=Dt(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(te=parseInt(k["number-matrix-rows-spanned"],10)||0,_e=parseInt(k["number-matrix-columns-spanned"],10)||0,G={s:{r:B,c:j},e:{r:B+te-1,c:j+_e-1}},b.F=Rt(G),ue.push([G,b.F])),k.formula)b.f=sT(k.formula);else for(ve=0;ve<ue.length;++ve)B>=ue[ve][0].s.r&&B<=ue[ve][0].e.r&&j>=ue[ve][0].s.c&&j<=ue[ve][0].e.c&&(b.F=ue[ve][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(te=parseInt(k["number-rows-spanned"],10)||0,_e=parseInt(k["number-columns-spanned"],10)||0,G={s:{r:B,c:j},e:{r:B+te-1,c:j+_e-1}},re.push(G)),k["number-columns-repeated"]&&(se=parseInt(k["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=rn(k["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(k.value);break;case"percentage":b.t="n",b.v=parseFloat(k.value);break;case"currency":b.t="n",b.v=parseFloat(k.value);break;case"date":b.t="d",b.v=Gn(k["date-value"]),n.cellDates||(b.t="n",b.v=vr(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=RP(k["time-value"])/86400,n.cellDates&&(b.t="d",b.v=jd(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(k.数据数值);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",k["string-value"]!=null&&(A=Dt(k["string-value"]),I=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(W=!1,b.t==="s"&&(b.v=A||"",I.length&&(b.R=I),W=C==0),J.Target&&(b.l=J),ee.length>0&&(b.c=ee,ee=[]),A&&n.cellText!==!1&&(b.w=A),W&&(b.t="z",delete b.v),(!W||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=B))for(var De=0;De<Ee;++De){if(se=parseInt(k["number-columns-repeated"]||"1",10),n.dense)for(E[B+De]||(E[B+De]=[]),E[B+De][j]=De==0?b:Kn(b);--se>0;)E[B+De][j+se]=Kn(b);else for(E[ot({r:B+De,c:j})]=b;--se>0;)E[ot({r:B+De,c:j+se})]=Kn(b);F.e.c<=j&&(F.e.c=j)}se=parseInt(k["number-columns-repeated"]||"1",10),j+=se-1,se=0,b={},A="",I=[]}J={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(S[1]==="/"){if((i=a.pop())[0]!==S[3])throw"Bad state: "+i}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!0]);break;case"annotation":if(S[1]==="/"){if((i=a.pop())[0]!==S[3])throw"Bad state: "+i;M.t=A,I.length&&(M.R=I),M.a=Y,ee.push(M)}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);Y="",K=0,A="",C=0,I=[];break;case"creator":S[1]==="/"?Y=r.slice(K,S.index):K=S.index+S[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(S[1]==="/"){if((i=a.pop())[0]!==S[3])throw"Bad state: "+i}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);A="",C=0,I=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(S[1]==="/"){if(P[c.name]=d,(i=a.pop())[0]!==S[3])throw"Bad state: "+i}else S[0].charAt(S[0].length-2)!=="/"&&(d="",c=et(S[0],!1),a.push([S[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=et(S[0],!1),d+=fT[S[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=et(S[0],!1),d+=fT[S[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(S[0].slice(-2)==="/>")break;if(S[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":d+=r.slice(f,S.index);break}else f=S.index+S[0].length;break;case"named-range":l=et(S[0],!1),D=xm(l["cell-range-address"]);var Se={Name:l.name,Ref:D[0]+"!"+D[1]};oe&&(Se.Sheet=T.length),ae.Names.push(Se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(S[1]==="/"&&(!k||!k["string-value"])){var Be=x$(r.slice(C,S.index));A=(A.length>0?A+`
`:"")+Be[0]}else et(S[0],!1),C=S.index+S[0].length;break;case"s":break;case"database-range":if(S[1]==="/")break;try{D=xm(et(S[0])["target-range-address"]),_[D[0]]["!autofilter"]={ref:D[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(S[1]!=="/"){if(J=et(S[0],!1),!J.href)break;J.Target=Dt(J.href),delete J.href,J.Target.charAt(0)=="#"&&J.Target.indexOf(".")>-1?(D=xm(J.Target.slice(1)),J.Target="#"+D[0]+"!"+D[1]):J.Target.match(/^\.\.[\\\/]/)&&(J.Target=J.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(S[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(n.WTF)throw new Error(S)}}var Z={Sheets:_,SheetNames:T,Workbook:ae};return n.bookSheets&&delete Z.Sheets,Z}function dT(t,e){e=e||{},Zr(t,"META-INF/manifest.xml")&&IU(Cn(t,"META-INF/manifest.xml"),e);var n=Pr(t,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=RS(Xt(n),e);return Zr(t,"meta.xml")&&(r.Props=$E(Cn(t,"meta.xml"))),r}function hT(t,e){return RS(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function tg(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ip(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Xt(Xi(t))}function op(t){var e=t.reduce(function(a,i){return a+i.length},0),n=new Uint8Array(e),r=0;return t.forEach(function(a){n.set(a,r),r+=a.length}),n}function mT(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function v$(t,e){for(var n=(t[e+15]&127)<<7|t[e+14]>>1,r=t[e+14]&1,a=e+13;a>=e;--a)r=r*256+t[a];return(t[e+15]&128?-r:r)*Math.pow(10,n-6176)}function lu(t,e){var n=e?e[0]:0,r=t[n]&127;e:if(t[n++]>=128&&(r|=(t[n]&127)<<7,t[n++]<128||(r|=(t[n]&127)<<14,t[n++]<128)||(r|=(t[n]&127)<<21,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,28),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,35),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,42),++n,t[n++]<128)))break e;return e&&(e[0]=n),r}function Ln(t){var e=0,n=t[e]&127;e:if(t[e++]>=128){if(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128))break e;n|=(t[e]&127)<<28}return n}function or(t){for(var e=[],n=[0];n[0]<t.length;){var r=n[0],a=lu(t,n),i=a&7;a=Math.floor(a/8);var l=0,c;if(a==0)break;switch(i){case 0:{for(var d=n[0];t[n[0]++]>=128;);c=t.slice(d,n[0])}break;case 5:l=4,c=t.slice(n[0],n[0]+l),n[0]+=l;break;case 1:l=8,c=t.slice(n[0],n[0]+l),n[0]+=l;break;case 2:l=lu(t,n),c=t.slice(n[0],n[0]+l),n[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(r))}var f={data:c,type:i};e[a]==null?e[a]=[f]:e[a].push(f)}return e}function ng(t,e){return(t==null?void 0:t.map(function(n){return e(n.data)}))||[]}function y$(t){for(var e,n=[],r=[0];r[0]<t.length;){var a=lu(t,r),i=or(t.slice(r[0],r[0]+a));r[0]+=a;var l={id:Ln(i[1][0].data),messages:[]};i[2].forEach(function(c){var d=or(c.data),f=Ln(d[3][0].data);l.messages.push({meta:d,data:t.slice(r[0],r[0]+f)}),r[0]+=f}),(e=i[3])!=null&&e[0]&&(l.merge=Ln(i[3][0].data)>>>0>0),n.push(l)}return n}function _$(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var n=[0],r=lu(e,n),a=[];n[0]<e.length;){var i=e[n[0]]&3;if(i==0){var l=e[n[0]++]>>2;if(l<60)++l;else{var c=l-59;l=e[n[0]],c>1&&(l|=e[n[0]+1]<<8),c>2&&(l|=e[n[0]+2]<<16),c>3&&(l|=e[n[0]+3]<<24),l>>>=0,l++,n[0]+=c}a.push(e.slice(n[0],n[0]+l)),n[0]+=l;continue}else{var d=0,f=0;if(i==1?(f=(e[n[0]]>>2&7)+4,d=(e[n[0]++]&224)<<3,d|=e[n[0]++]):(f=(e[n[0]++]>>2)+1,i==2?(d=e[n[0]]|e[n[0]+1]<<8,n[0]+=2):(d=(e[n[0]]|e[n[0]+1]<<8|e[n[0]+2]<<16|e[n[0]+3]<<24)>>>0,n[0]+=4)),a=[op(a)],d==0)throw new Error("Invalid offset 0");if(d>a[0].length)throw new Error("Invalid offset beyond length");if(f>=d)for(a.push(a[0].slice(-d)),f-=d;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-d,-d+f))}}var g=op(a);if(g.length!=r)throw new Error("Unexpected length: ".concat(g.length," != ").concat(r));return g}function w$(t){for(var e=[],n=0;n<t.length;){var r=t[n++],a=t[n]|t[n+1]<<8|t[n+2]<<16;n+=3,e.push(_$(r,t.slice(n,n+a))),n+=a}if(n!==t.length)throw new Error("data is not a valid framed stream!");return op(e)}function T$(t,e,n,r){var a=tg(t),i=a.getUint32(4,!0),l=(r>1?12:8)+mT(i&(r>1?3470:398))*4,c=-1,d=-1,f=NaN,g=new Date(2001,0,1);i&512&&(c=a.getUint32(l,!0),l+=4),l+=mT(i&(r>1?12288:4096))*4,i&16&&(d=a.getUint32(l,!0),l+=4),i&32&&(f=a.getFloat64(l,!0),l+=8),i&64&&(g.setTime(g.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var v;switch(t[2]){case 0:break;case 2:v={t:"n",v:f};break;case 3:v={t:"s",v:e[d]};break;case 5:v={t:"d",v:g};break;case 6:v={t:"b",v:f>0};break;case 7:v={t:"n",v:f/86400};break;case 8:v={t:"e",v:0};break;case 9:if(c>-1)v={t:"s",v:n[c]};else if(d>-1)v={t:"s",v:e[d]};else if(!isNaN(f))v={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return v}function E$(t,e,n){var r=tg(t),a=r.getUint32(8,!0),i=12,l=-1,c=-1,d=NaN,f=NaN,g=new Date(2001,0,1);a&1&&(d=v$(t,i),i+=16),a&2&&(f=r.getFloat64(i,!0),i+=8),a&4&&(g.setTime(g.getTime()+r.getFloat64(i,!0)*1e3),i+=8),a&8&&(c=r.getUint32(i,!0),i+=4),a&16&&(l=r.getUint32(i,!0),i+=4);var v;switch(t[1]){case 0:break;case 2:v={t:"n",v:d};break;case 3:v={t:"s",v:e[c]};break;case 5:v={t:"d",v:g};break;case 6:v={t:"b",v:f>0};break;case 7:v={t:"n",v:f/86400};break;case 8:v={t:"e",v:0};break;case 9:if(l>-1)v={t:"s",v:n[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:v={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return v}function S$(t,e,n){switch(t[0]){case 0:case 1:case 2:case 3:return T$(t,e,n,t[0]);case 5:return E$(t,e,n);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function ei(t){var e=or(t);return lu(e[1][0].data)}function pT(t,e){var n=or(e.data),r=Ln(n[1][0].data),a=n[3],i=[];return(a||[]).forEach(function(l){var c=or(l.data),d=Ln(c[1][0].data)>>>0;switch(r){case 1:i[d]=ip(c[3][0].data);break;case 8:{var f=t[ei(c[9][0].data)][0],g=or(f.data),v=t[ei(g[1][0].data)][0],_=Ln(v.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var T=or(v.data);i[d]=T[3].map(function(E){return ip(E.data)}).join("")}break}}),i}function b$(t,e){var n,r,a,i,l,c,d,f,g,v,_,T,E,S,b=or(t),k=Ln(b[1][0].data)>>>0,A=Ln(b[2][0].data)>>>0,C=((r=(n=b[8])==null?void 0:n[0])==null?void 0:r.data)&&Ln(b[8][0].data)>0||!1,I,B;if((i=(a=b[7])==null?void 0:a[0])!=null&&i.data&&e!=0)I=(c=(l=b[7])==null?void 0:l[0])==null?void 0:c.data,B=(f=(d=b[6])==null?void 0:d[0])==null?void 0:f.data;else if((v=(g=b[4])==null?void 0:g[0])!=null&&v.data&&e!=1)I=(T=(_=b[4])==null?void 0:_[0])==null?void 0:T.data,B=(S=(E=b[3])==null?void 0:E[0])==null?void 0:S.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var j=C?4:1,F=tg(I),X=[],P=0;P<I.length/2;++P){var re=F.getUint16(P*2,!0);re<65535&&X.push([P,re])}if(X.length!=A)throw"Expected ".concat(A," cells, found ").concat(X.length);var G=[];for(P=0;P<X.length-1;++P)G[X[P][0]]=B.subarray(X[P][1]*j,X[P+1][1]*j);return X.length>=1&&(G[X[X.length-1][0]]=B.subarray(X[X.length-1][1]*j)),{R:k,cells:G}}function C$(t,e){var n,r=or(e.data),a=(n=r==null?void 0:r[7])!=null&&n[0]?Ln(r[7][0].data)>>>0>0?1:0:-1,i=ng(r[5],function(l){return b$(l,a)});return{nrows:Ln(r[4][0].data)>>>0,data:i.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(d,f){if(l[c.R][f])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(f));l[c.R][f]=d}),l},[])}}function A$(t,e,n){var r,a=or(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Ln(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Ln(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));n["!ref"]=Rt(i);var l=or(a[4][0].data),c=pT(t,t[ei(l[4][0].data)][0]),d=(r=l[17])!=null&&r[0]?pT(t,t[ei(l[17][0].data)][0]):[],f=or(l[3][0].data),g=0;f[1].forEach(function(v){var _=or(v.data),T=t[ei(_[2][0].data)][0],E=Ln(T.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var S=C$(t,T);S.data.forEach(function(b,k){b.forEach(function(A,C){var I=ot({r:g+k,c:C}),B=S$(A,c,d);B&&(n[I]=B)})}),g+=S.nrows})}function k$(t,e){var n=or(e.data),r={"!ref":"A1"},a=t[ei(n[2][0].data)],i=Ln(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return A$(t,a[0],r),r}function N$(t,e){var n,r=or(e.data),a={name:(n=r[1])!=null&&n[0]?ip(r[1][0].data):"",sheets:[]},i=ng(r[2],ei);return i.forEach(function(l){t[l].forEach(function(c){var d=Ln(c.meta[1][0].data);d==6e3&&a.sheets.push(k$(t,c))})}),a}function R$(t,e){var n=sg(),r=or(e.data),a=ng(r[1],ei);if(a.forEach(function(i){t[i].forEach(function(l){var c=Ln(l.meta[1][0].data);if(c==2){var d=N$(t,l);d.sheets.forEach(function(f,g){ig(n,f,g==0?d.name:d.name+"_"+g,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function ym(t){var e,n,r,a,i={},l=[];if(t.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var f;try{f=w$(d.content)}catch(v){return console.log("?? "+d.content.length+" "+(v.message||v))}var g;try{g=y$(f)}catch(v){return console.log("## "+(v.message||v))}g.forEach(function(v){i[v.id]=v.messages,l.push(v.id)})}}),!l.length)throw new Error("File has no messages");var c=((a=(r=(n=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:n.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&Ln(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||l.forEach(function(d){i[d].forEach(function(f){var g=Ln(f.meta[1][0].data)>>>0;if(g==1)if(!c)c=f;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return R$(i,c)}function D$(t){return function(n){for(var r=0;r!=t.length;++r){var a=t[r];n[a[0]]===void 0&&(n[a[0]]=a[1]),a[2]==="n"&&(n[a[0]]=Number(n[a[0]]))}}}function rg(t){D$([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function M$(t){return el.WS.indexOf(t)>-1?"sheet":t==el.CS?"chart":t==el.DS?"dialog":t==el.MS?"macro":t&&t.length?t:"sheet"}function I$(t,e){if(!t)return 0;try{t=e.map(function(r){return r.id||(r.id=r.strRelID),[r.name,t["!id"][r.id].Target,M$(t["!id"][r.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function F$(t,e,n,r,a,i,l,c,d,f,g,v){try{i[r]=Hc(Pr(t,n,!0),e);var _=Cn(t,e),T;switch(c){case"sheet":T=jH(_,e,a,d,i[r],f,g,v);break;case"chart":if(T=VH(_,e,a,d,i[r],f,g,v),!T||!T["!drawel"])break;var E=Mc(T["!drawel"].Target,e),S=tp(E),b=BB(Pr(t,E,!0),Hc(Pr(t,S,!0),E)),k=Mc(b,E),A=tp(k);T=EH(Pr(t,k,!0),k,d,Hc(Pr(t,A,!0),k),f,T);break;case"macro":T=HH(_,e,a,d,i[r],f,g,v);break;case"dialog":T=$H(_,e,a,d,i[r],f,g,v);break;default:throw new Error("Unrecognized sheet type "+c)}l[r]=T;var C=[];i&&i[r]&&La(i[r]).forEach(function(I){var B="";if(i[r][I].Type==el.CMNT){B=Mc(i[r][I].Target,e);var j=YH(Cn(t,B,!0),B,d);if(!j||!j.length)return;eT(T,j,!1)}i[r][I].Type==el.TCMNT&&(B=Mc(i[r][I].Target,e),C=C.concat(VB(Cn(t,B,!0),d)))}),C&&C.length&&eT(T,C,!0,d.people||[])}catch(I){if(d.WTF)throw I}}function Kr(t){return t.charAt(0)=="/"?t.slice(1):t}function L$(t,e){if(mE(),e=e||{},rg(e),Zr(t,"META-INF/manifest.xml")||Zr(t,"objectdata.xml"))return dT(t,e);if(Zr(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ym<"u"){if(t.FileIndex)return ym(t);var n=Nt.utils.cfb_new();return Aw(t).forEach(function(Ne){OP(n,Ne,LP(t,Ne))}),ym(n)}throw new Error("Unsupported NUMBERS file")}if(!Zr(t,"[Content_Types].xml"))throw Zr(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Zr(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=Aw(t),a=DU(Pr(t,"[Content_Types].xml")),i=!1,l,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",Cn(t,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!Cn(t,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var d={},f={};if(!e.bookSheets&&!e.bookProps){if(zc=[],a.sst)try{zc=qH(Cn(t,Kr(a.sst)),a.sst,e)}catch(Ne){if(e.WTF)throw Ne}e.cellStyles&&a.themes.length&&(d=zH(Pr(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(f=GH(Cn(t,Kr(a.style)),a.style,d,e))}a.links.map(function(Ne){try{var Ee=Hc(Pr(t,tp(Kr(Ne))),Ne);return JH(Cn(t,Kr(Ne)),Ee,Ne,e)}catch{}});var g=BH(Cn(t,Kr(a.workbooks[0])),a.workbooks[0],e),v={},_="";a.coreprops.length&&(_=Cn(t,Kr(a.coreprops[0]),!0),_&&(v=$E(_)),a.extprops.length!==0&&(_=Cn(t,Kr(a.extprops[0]),!0),_&&OU(_,v,e)));var T={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(_=Pr(t,Kr(a.custprops[0]),!0),_&&(T=UU(_,e)));var E={};if((e.bookSheets||e.bookProps)&&(g.Sheets?l=g.Sheets.map(function(Ee){return Ee.name}):v.Worksheets&&v.SheetNames.length>0&&(l=v.SheetNames),e.bookProps&&(E.Props=v,E.Custprops=T),e.bookSheets&&typeof l<"u"&&(E.SheetNames=l),e.bookSheets?E.SheetNames:e.bookProps))return E;l={};var S={};e.bookDeps&&a.calcchain&&(S=WH(Cn(t,Kr(a.calcchain)),a.calcchain));var b=0,k={},A,C;{var I=g.Sheets;v.Worksheets=I.length,v.SheetNames=[];for(var B=0;B!=I.length;++B)v.SheetNames[B]=I[B].name}var j=i?"bin":"xml",F=a.workbooks[0].lastIndexOf("/"),X=(a.workbooks[0].slice(0,F+1)+"_rels/"+a.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");Zr(t,X)||(X="xl/_rels/workbook."+j+".rels");var P=Hc(Pr(t,X,!0),X.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=KH(Cn(t,Kr(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=HB(Cn(t,Kr(a.people[0])),e)),P&&(P=I$(P,g.Sheets));var re=Cn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=v.Worksheets;++b){var G="sheet";if(P&&P[b]?(A="xl/"+P[b][1].replace(/[\/]?xl\//,""),Zr(t,A)||(A=P[b][1]),Zr(t,A)||(A=X.replace(/_rels\/.*$/,"")+P[b][1]),G=P[b][2]):(A="xl/worksheets/sheet"+(b+1-re)+"."+j,A=A.replace(/sheet0\./,"sheet.")),C=A.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(b!=e.sheets)continue e;break;case"string":if(v.SheetNames[b].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var te=!1,_e=0;_e!=e.sheets.length;++_e)typeof e.sheets[_e]=="number"&&e.sheets[_e]==b&&(te=1),typeof e.sheets[_e]=="string"&&e.sheets[_e].toLowerCase()==v.SheetNames[b].toLowerCase()&&(te=1);if(!te)continue e}}F$(t,A,C,v.SheetNames[b],b,k,l,G,e,g,d,f)}return E={Directory:a,Workbook:g,Props:v,Custprops:T,Deps:S,Sheets:l,SheetNames:v.SheetNames,Strings:zc,Styles:f,Themes:d,SSF:Kn(ut)},e&&e.bookFiles&&(t.files?(E.keys=r,E.files=t.files):(E.keys=[],E.files={},t.FullPaths.forEach(function(Ne,Ee){Ne=Ne.replace(/^Root Entry[\/]/,""),E.keys.push(Ne),E.files[Ne]=t.FileIndex[Ee]}))),e&&e.bookVBA&&(a.vba.length>0?E.vbaraw=Cn(t,Kr(a.vba[0]),!0):a.defaults&&a.defaults.bin===qB&&(E.vbaraw=Cn(t,"xl/vbaProject.bin",!0))),E}function O$(t,e){var n=e||{},r="Workbook",a=Nt.find(t,r);try{if(r="/!DataSpaces/Version",a=Nt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(k9(a.content),r="/!DataSpaces/DataSpaceMap",a=Nt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var i=R9(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Nt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=D9(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Nt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);I9(a.content)}catch{}if(r="/EncryptionInfo",a=Nt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=F9(a.content);if(r="/EncryptedPackage",a=Nt.find(t,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,n.password||"",n);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,n.password||"",n);throw new Error("File is password-protected")}function ag(t,e){var n="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":n=Ur(t.slice(0,12));break;case"binary":n=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function P$(t,e){return Nt.find(t,"EncryptedPackage")?O$(t,e):AS(t,e)}function U$(t,e){var n,r=t,a=e||{};return a.type||(a.type=Ct&&Buffer.isBuffer(t)?"buffer":"base64"),n=_E(r,a),L$(n,a)}function DS(t,e){var n=0;e:for(;n<t.length;)switch(t.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return ap(t.slice(n),e);default:break e}return su.to_workbook(t,e)}function B$(t,e){var n="",r=ag(t,e);switch(e.type){case"base64":n=Ur(t);break;case"binary":n=t;break;case"buffer":n=t.toString("binary");break;case"array":n=$i(t);break;default:throw new Error("Unrecognized type "+e.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(n=Xt(n)),e.type="binary",DS(n,e)}function j$(t,e){var n=t;return e.type=="base64"&&(n=Ur(n)),n=tu.utils.decode(1200,n.slice(2),"str"),e.type="binary",DS(n,e)}function V$(t){return t.match(/[^\x00-\x7F]/)?Ic(t):t}function _m(t,e,n,r){return r?(n.type="string",su.to_workbook(t,n)):su.to_workbook(e,n)}function lp(t,e){nE();var n=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return lp(new Uint8Array(t),(n=Kn(n),n.type="array",n));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!n.type&&(n.type=typeof Deno<"u"?"buffer":"array");var r=t,a=[0,0,0,0],i=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),sl={},n.dateNF&&(sl.dateNF=n.dateNF),n.type||(n.type=Ct&&Buffer.isBuffer(t)?"buffer":"base64"),n.type=="file"&&(n.type=Ct?"buffer":"binary",r=kP(t),typeof Uint8Array<"u"&&!Ct&&(n.type="array")),n.type=="string"&&(i=!0,n.type="binary",n.codepage=65001,r=V$(t)),n.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return n=Kn(n),n.type="array",lp(Op(r),n)}switch((a=ag(r,n))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return P$(Nt.read(r,n),n);break;case 9:if(a[1]<=8)return AS(r,n);break;case 60:return ap(r,n);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return p9(r,n);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return h9.to_workbook(r,n);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?U$(r,n):_m(t,r,n,i);case 239:return a[3]===60?ap(r,n):_m(t,r,n,i);case 255:if(a[1]===254)return j$(r,n);if(a[1]===0&&a[2]===2&&a[3]===0)return Gc.to_workbook(r,n);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Gc.to_workbook(r,n);break;case 3:case 131:case 139:case 140:return Qw.to_workbook(r,n);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return q9.to_workbook(r,n);break;case 10:case 13:case 32:return B$(r,n);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return f9.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Qw.to_workbook(r,n):_m(t,r,n,i)}function H$(t,e,n,r,a,i,l,c){var d=Xn(n),f=c.defval,g=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),v=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:n,enumerable:!1})}catch{_.__rowNum__=n}else _.__rowNum__=n;if(!l||t[n])for(var T=e.s.c;T<=e.e.c;++T){var E=l?t[n][T]:t[r[T]+d];if(E===void 0||E.t===void 0){if(f===void 0)continue;i[T]!=null&&(_[i[T]]=f);continue}var S=E.v;switch(E.t){case"z":if(S==null)break;continue;case"e":S=S==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(i[T]!=null){if(S==null)if(E.t=="e"&&S===null)_[i[T]]=null;else if(f!==void 0)_[i[T]]=f;else if(g&&S===null)_[i[T]]=null;else continue;else _[i[T]]=g&&(E.t!=="n"||E.t==="n"&&c.rawNumbers!==!1)?S:ds(E,S,c);S!=null&&(v=!1)}}return{row:_,isempty:v}}function cp(t,e){if(t==null||t["!ref"]==null)return[];var n={t:"n",v:0},r=0,a=1,i=[],l=0,c="",d={s:{r:0,c:0},e:{r:0,c:0}},f=e||{},g=f.range!=null?f.range:t["!ref"];switch(f.header===1?r=1:f.header==="A"?r=2:Array.isArray(f.header)?r=3:f.header==null&&(r=0),typeof g){case"string":d=vn(g);break;case"number":d=vn(t["!ref"]),d.s.r=g;break;default:d=g}r>0&&(a=0);var v=Xn(d.s.r),_=[],T=[],E=0,S=0,b=Array.isArray(t),k=d.s.r,A=0,C={};b&&!t[k]&&(t[k]=[]);var I=f.skipHidden&&t["!cols"]||[],B=f.skipHidden&&t["!rows"]||[];for(A=d.s.c;A<=d.e.c;++A)if(!(I[A]||{}).hidden)switch(_[A]=Fn(A),n=b?t[k][A]:t[_[A]+v],r){case 1:i[A]=A-d.s.c;break;case 2:i[A]=_[A];break;case 3:i[A]=f.header[A-d.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),c=l=ds(n,null,f),S=C[l]||0,!S)C[l]=1;else{do c=l+"_"+S++;while(C[c]);C[l]=S,C[c]=1}i[A]=c}for(k=d.s.r+a;k<=d.e.r;++k)if(!(B[k]||{}).hidden){var j=H$(t,d,k,_,r,i,b,f);(j.isempty===!1||(r===1?f.blankrows!==!1:f.blankrows))&&(T[E++]=j.row)}return T.length=E,T}var gT=/"/g;function $$(t,e,n,r,a,i,l,c){for(var d=!0,f=[],g="",v=Xn(n),_=e.s.c;_<=e.e.c;++_)if(r[_]){var T=c.dense?(t[n]||[])[_]:t[r[_]+v];if(T==null)g="";else if(T.v!=null){d=!1,g=""+(c.rawNumbers&&T.t=="n"?T.v:ds(T,null,c));for(var E=0,S=0;E!==g.length;++E)if((S=g.charCodeAt(E))===a||S===i||S===34||c.forceQuotes){g='"'+g.replace(gT,'""')+'"';break}g=="ID"&&(g='"ID"')}else T.f!=null&&!T.F?(d=!1,g="="+T.f,g.indexOf(",")>=0&&(g='"'+g.replace(gT,'""')+'"')):g="";f.push(g)}return c.blankrows===!1&&d?null:f.join(l)}function MS(t,e){var n=[],r=e??{};if(t==null||t["!ref"]==null)return"";var a=vn(t["!ref"]),i=r.FS!==void 0?r.FS:",",l=i.charCodeAt(0),c=r.RS!==void 0?r.RS:`
`,d=c.charCodeAt(0),f=new RegExp((i=="|"?"\\|":i)+"+$"),g="",v=[];r.dense=Array.isArray(t);for(var _=r.skipHidden&&t["!cols"]||[],T=r.skipHidden&&t["!rows"]||[],E=a.s.c;E<=a.e.c;++E)(_[E]||{}).hidden||(v[E]=Fn(E));for(var S=0,b=a.s.r;b<=a.e.r;++b)(T[b]||{}).hidden||(g=$$(t,a,b,v,l,d,i,r),g!=null&&(r.strip&&(g=g.replace(f,"")),(g||r.blankrows!==!1)&&n.push((S++?c:"")+g)));return delete r.dense,n.join("")}function G$(t,e){e||(e={}),e.FS="	",e.RS=`
`;var n=MS(t,e);return n}function z$(t){var e="",n,r="";if(t==null||t["!ref"]==null)return[];var a=vn(t["!ref"]),i="",l=[],c,d=[],f=Array.isArray(t);for(c=a.s.c;c<=a.e.c;++c)l[c]=Fn(c);for(var g=a.s.r;g<=a.e.r;++g)for(i=Xn(g),c=a.s.c;c<=a.e.c;++c)if(e=l[c]+i,n=f?(t[g]||[])[c]:t[e],r="",n!==void 0){if(n.F!=null){if(e=n.F,!n.f)continue;r=n.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}d[d.length]=e+"="+r}return d}function IS(t,e,n){var r=n||{},a=+!r.skipHeader,i=t||{},l=0,c=0;if(i&&r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var d=typeof r.origin=="string"?pr(r.origin):r.origin;l=d.r,c=d.c}var f,g={s:{c:0,r:0},e:{c,r:l+e.length-1+a}};if(i["!ref"]){var v=vn(i["!ref"]);g.e.c=Math.max(g.e.c,v.e.c),g.e.r=Math.max(g.e.r,v.e.r),l==-1&&(l=v.e.r+1,g.e.r=l+e.length-1+a)}else l==-1&&(l=0,g.e.r=e.length-1+a);var _=r.header||[],T=0;e.forEach(function(S,b){La(S).forEach(function(k){(T=_.indexOf(k))==-1&&(_[T=_.length]=k);var A=S[k],C="z",I="",B=ot({c:c+T,r:l+b+a});f=cu(i,B),A&&typeof A=="object"&&!(A instanceof Date)?i[B]=A:(typeof A=="number"?C="n":typeof A=="boolean"?C="b":typeof A=="string"?C="s":A instanceof Date?(C="d",r.cellDates||(C="n",A=vr(A)),I=r.dateNF||ut[14]):A===null&&r.nullError&&(C="e",A=0),f?(f.t=C,f.v=A,delete f.w,delete f.R,I&&(f.z=I)):i[B]=f={t:C,v:A},I&&(f.z=I))})}),g.e.c=Math.max(g.e.c,c+_.length-1);var E=Xn(l);if(a)for(T=0;T<_.length;++T)i[Fn(T+c)+E]={t:"s",v:_[T]};return i["!ref"]=Rt(g),i}function q$(t,e){return IS(null,t,e)}function cu(t,e,n){if(typeof e=="string"){if(Array.isArray(t)){var r=pr(e);return t[r.r]||(t[r.r]=[]),t[r.r][r.c]||(t[r.r][r.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?cu(t,ot(e)):cu(t,ot({r:e,c:n||0}))}function Y$(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var n=t.SheetNames.indexOf(e);if(n>-1)return n;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function sg(){return{SheetNames:[],Sheets:{}}}function ig(t,e,n,r){var a=1;if(!n)for(;a<=65535&&t.SheetNames.indexOf(n="Sheet"+a)!=-1;++a,n=void 0);if(!n||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&t.SheetNames.indexOf(n)>=0){var i=n.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var l=i&&i[1]||n;for(++a;a<=65535&&t.SheetNames.indexOf(n=l+a)!=-1;++a);}if(DH(n),t.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return t.SheetNames.push(n),t.Sheets[n]=e,n}function W$(t,e,n){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var r=Y$(t,e);switch(t.Workbook.Sheets[r]||(t.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}t.Workbook.Sheets[r].Hidden=n}function J$(t,e){return t.z=e,t}function FS(t,e,n){return e?(t.l={Target:e},n&&(t.l.Tooltip=n)):delete t.l,t}function K$(t,e,n){return FS(t,"#"+e,n)}function X$(t,e,n){t.c||(t.c=[]),t.c.push({t:e,a:n||"SheetJS"})}function Z$(t,e,n,r){for(var a=typeof e!="string"?e:vn(e),i=typeof e=="string"?e:Rt(e),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var d=cu(t,l,c);d.t="n",d.F=i,delete d.v,l==a.s.r&&c==a.s.c&&(d.f=n,r&&(d.D=!0))}return t}var Q$={encode_col:Fn,encode_row:Xn,encode_cell:ot,encode_range:Rt,decode_col:zp,decode_row:Gp,split_cell:uU,decode_cell:pr,decode_range:Sl,format_cell:ds,sheet_add_aoa:UE,sheet_add_json:IS,sheet_add_dom:kS,aoa_to_sheet:bl,json_to_sheet:q$,table_to_sheet:NS,table_to_book:p$,sheet_to_csv:MS,sheet_to_txt:G$,sheet_to_json:cp,sheet_to_html:m$,sheet_to_formulae:z$,sheet_to_row_object_array:cp,sheet_get_cell:cu,book_new:sg,book_append_sheet:ig,book_set_sheet_visibility:W$,cell_set_number_format:J$,cell_set_hyperlink:FS,cell_set_internal_link:K$,cell_add_comment:X$,sheet_set_array_formula:Z$,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const LS=({matrixData:t,onUpdate:e})=>{const n=(d,f)=>e({...t,headers:t.headers.map((g,v)=>v===d?f:g)}),r=(d,f,g)=>e({...t,rows:t.rows.map((v,_)=>_===d?v.map((T,E)=>E===f?g:T):v)}),a=()=>e({...t,rows:[...t.rows,Array(t.headers.length).fill("")]}),i=d=>e({...t,rows:t.rows.filter((f,g)=>g!==d)}),l=()=>{const d=`列 ${t.headers.length+1}`;e({headers:[...t.headers,d],rows:t.rows.map(f=>[...f,""])})},c=d=>{t.headers.length<=1||e({headers:t.headers.filter((f,g)=>g!==d),rows:t.rows.map(f=>f.filter((g,v)=>v!==d))})};return x.jsxs("div",{className:"overflow-x-auto p-1 bg-slate-50 rounded-md border",children:[x.jsxs("table",{className:"w-full text-xs border-collapse",children:[x.jsx("thead",{children:x.jsxs("tr",{className:"bg-slate-200",children:[t.headers.map((d,f)=>x.jsx("th",{className:"border border-slate-300 p-0 font-semibold text-slate-700",children:x.jsxs("div",{className:"flex items-center justify-between gap-1 px-1",children:[x.jsx("input",{type:"text",value:d,onChange:g=>n(f,g.target.value),className:"w-full bg-transparent outline-none text-center font-semibold text-slate-800"}),x.jsx("button",{onClick:()=>c(f),className:"text-red-500 hover:text-red-700 opacity-30 hover:opacity-100",title:"列を削除",children:x.jsx(xa,{className:"w-3 h-3"})})]})},f)),x.jsx("th",{className:"border border-slate-300 p-1 w-10"})]})}),x.jsx("tbody",{children:t.rows.map((d,f)=>x.jsxs("tr",{children:[d.map((g,v)=>x.jsx("td",{className:"border border-slate-300 p-0",children:x.jsx("input",{type:"text",value:g,onChange:_=>r(f,v,_.target.value),className:"w-full bg-white text-slate-900 outline-none p-1 focus:bg-blue-50"})},v)),x.jsx("td",{className:"border border-slate-300 p-1 text-center",children:x.jsx("button",{onClick:()=>i(f),className:"text-red-500 hover:text-red-700",title:"行を削除",children:x.jsx(xa,{className:"w-3 h-3"})})})]},f))})]}),x.jsxs("div",{className:"flex gap-2 mt-2",children:[x.jsxs("button",{onClick:a,className:"text-xs px-2 py-1 bg-slate-200 hover:bg-slate-300 rounded flex items-center gap-1",children:[x.jsx(Bi,{className:"w-3 h-3"}),"行を追加"]}),x.jsxs("button",{onClick:l,className:"text-xs px-2 py-1 bg-slate-200 hover:bg-slate-300 rounded flex items-center gap-1",children:[x.jsx(Bi,{className:"w-3 h-3"}),"列を追加"]})]})]})},xT=t=>{const e=Math.cos(2*Math.PI*t),n=Math.sin(2*Math.PI*t);return[e,n]},eG=({data:t,title:e})=>{const n=t.reduce((l,c)=>l+c.value,0);if(n===0)return x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data for chart"});let r=0;const a=["#4A90E2","#50E3C2","#F5A623","#F8E71C","#7ED321","#9013FE","#BD10E0","#4A4A4A"],i=t.map((l,c)=>{const d=l.value/n,[f,g]=xT(r);r+=d;const[v,_]=xT(r),T=d>.5?1:0;return{path:`M ${f} ${g} A 1 1 0 ${T} 1 ${v} ${_} L 0 0`,color:a[c%a.length],label:l.label,value:l.value}});return x.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-white p-2 border rounded-md",children:[x.jsx("h5",{className:"font-bold text-sm mb-2",children:e}),x.jsx("svg",{viewBox:"-1.2 -1.2 2.4 2.4",className:"w-32 h-32 mb-2",children:i.map((l,c)=>x.jsx("path",{d:l.path,fill:l.color},c))}),x.jsx("div",{className:"text-[10px] space-y-0.5 w-full",children:i.map((l,c)=>x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center",children:[x.jsx("span",{className:"w-2 h-2 rounded-full mr-1.5",style:{backgroundColor:l.color}}),x.jsx("span",{children:l.label})]}),x.jsxs("span",{children:[l.value," (",(l.value/n*100).toFixed(1),"%)"]})]},c))})]})},tG=({data:t,title:e})=>{if(t.length<2)return x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"Need at least 2 data points for a line chart."});const n=Math.max(...t.map(r=>r.value),0);return x.jsxs("div",{className:"w-full h-full bg-white p-2 border rounded-md",children:[x.jsx("h5",{className:"text-center font-bold text-sm mb-2",children:e}),x.jsxs("svg",{viewBox:"0 0 100 50",className:"w-full h-40",children:[[0,.25,.5,.75,1].map(r=>x.jsx("line",{x1:"0",y1:50-r*45,x2:"100",y2:50-r*45,stroke:"#f0f0f0",strokeWidth:"0.5"},r)),x.jsx("polyline",{fill:"none",stroke:"#4a90e2",strokeWidth:"1",points:t.map((r,a)=>`${a/(t.length-1)*100},${50-r.value/n*45}`).join(" ")}),t.map((r,a)=>x.jsx("circle",{cx:`${a/(t.length-1)*100}`,cy:`${50-r.value/n*45}`,r:"1.5",fill:"#4a90e2"},a))]})]})},nG=({data:t,title:e})=>{const n=Math.max(...t.map(r=>r.value),0);return n===0?x.jsx("div",{className:"flex items-center justify-center h-full text-xs text-slate-500",children:"No data for chart"}):x.jsxs("div",{className:"w-full h-full bg-white p-2 border rounded-md",children:[x.jsx("h5",{className:"text-center font-bold text-sm mb-2",children:e}),x.jsx("div",{className:"space-y-1",children:t.map(r=>x.jsxs("div",{className:"flex items-center text-xs",children:[x.jsx("div",{className:"w-24 truncate pr-2 text-right text-slate-600",children:r.label}),x.jsx("div",{className:"flex-grow bg-slate-200 rounded-full h-4",children:x.jsx("div",{className:"bg-blue-500 h-4 rounded-full text-white text-right pr-1",style:{width:`${r.value/n*100}%`},children:x.jsx("span",{className:"text-[10px]",children:r.value})})})]},r.label))})]})},rG=({actionItem:t,onSave:e,onClose:n,generateUniqueId:r})=>{var k;const[a,i]=U.useState(t.report||{notes:"",attachments:[],matrixData:null}),[l,c]=U.useState("bar"),d=U.useRef(null),f=U.useRef(null),g=A=>{i(C=>({...C,...A}))},v=()=>{e({...t,report:a})},_=A=>{var F;const C=(F=A.target.files)==null?void 0:F[0];if(!C)return;const I=5,B=I*1024*1024;if(C.size>B){alert(`ファイルサイズが大きすぎます。${I}MB未満のファイルを選択してください。`),A.target&&(A.target.value="");return}const j=new FileReader;j.onload=X=>{var P;if(typeof((P=X.target)==null?void 0:P.result)=="string"){const re={id:r("attach"),name:C.name,type:C.type,dataUrl:X.target.result};g({attachments:[...a.attachments||[],re]})}else alert("ファイルの読み込みに失敗しました。")},j.onerror=()=>{alert("ファイルの読み込み中にエラーが発生しました。")},j.readAsDataURL(C),A.target&&(A.target.value="")},T=A=>{var C;g({attachments:(C=a.attachments)==null?void 0:C.filter(I=>I.id!==A)})},E=A=>{var B;const C=(B=A.target.files)==null?void 0:B[0];if(!C)return;const I=new FileReader;I.onload=j=>{var F;try{const X=(F=j.target)==null?void 0:F.result,P=lp(X,{type:"array"}),re=P.SheetNames[0],G=P.Sheets[re],te=Q$.sheet_to_json(G,{header:1});if(!Array.isArray(te)||te.length===0){alert("Excelファイルが空か、有効なデータが含まれていません。"),A.target&&(A.target.value="");return}const _e=te[0];if(!Array.isArray(_e)){alert("Excelファイルのヘッダー行が読み取れませんでした。"),A.target&&(A.target.value="");return}const Ne=_e.map(String),Ee=te.slice(1),se=[];for(const ue of Ee)if(Array.isArray(ue)){const ae=Array(Ne.length).fill("");for(let J=0;J<Ne.length;J++)ae[J]=ue[J]!==null&&ue[J]!==void 0?String(ue[J]):"";se.push(ae)}g({matrixData:{headers:Ne,rows:se}})}catch(X){console.error("Error parsing Excel file:",X),alert(`Excelファイルの解析中にエラーが発生しました: ${X instanceof Error?X.message:"Unknown error"}`)}finally{A.target&&(A.target.value="")}},I.readAsArrayBuffer(C)},S=(((k=a.matrixData)==null?void 0:k.rows)||[]).map(A=>({label:A[0],value:parseFloat(A[1])||0})).filter(A=>A.label&&!isNaN(A.value)),b=()=>{if(!a.matrixData||S.length===0)return null;switch(l){case"line":return x.jsx(tG,{data:S,title:"データチャート"});case"pie":return x.jsx(eG,{data:S,title:"データチャート"});case"bar":default:return x.jsx(nG,{data:S,title:"データチャート"})}};return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[70]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"実施レポート"}),x.jsx("p",{className:"text-sm text-slate-500",children:t.text})]}),x.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(Br,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("div",{className:"flex-grow p-5 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-6",children:[x.jsxs("div",{className:"space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"text-sm font-semibold text-slate-700",children:"実施内容・メモ"}),x.jsx("textarea",{value:a.notes,onChange:A=>g({notes:A.target.value}),className:"w-full mt-1 p-2 border rounded-md h-32 bg-slate-50 focus:bg-white text-slate-800",placeholder:"実施した内容、結果、考察などを記録..."})]}),x.jsxs("div",{children:[x.jsxs("h4",{className:"text-sm font-semibold text-slate-700 flex justify-between items-center mb-2",children:["添付ファイル",x.jsx("button",{onClick:()=>{var A;return(A=d.current)==null?void 0:A.click()},className:"p-1 hover:bg-slate-200 rounded-full",children:x.jsx(Zs,{className:"w-5 h-5"})}),x.jsx("input",{type:"file",ref:d,onChange:_,className:"hidden",multiple:!1})]}),x.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 max-h-48 overflow-y-auto border p-2 rounded-md bg-slate-50",children:(a.attachments||[]).map(A=>x.jsxs("div",{className:"relative group border rounded-md overflow-hidden bg-white shadow-sm h-24",children:[x.jsx("a",{href:A.dataUrl,download:A.name,className:"block w-full h-full","aria-label":`Download ${A.name}`,children:A.type.startsWith("image/")?x.jsx("img",{src:A.dataUrl,alt:A.name,className:"w-full h-full object-cover"}):x.jsx("div",{className:"w-full h-full bg-slate-100 flex flex-col items-center justify-center p-2 hover:bg-slate-200",children:x.jsx(Zs,{className:"w-8 h-8 text-slate-500"})})}),x.jsx("div",{className:"absolute bottom-0 w-full bg-black bg-opacity-60 p-1 pointer-events-none",children:x.jsx("p",{className:"text-white text-[10px] truncate",title:A.name,children:A.name})}),x.jsx("button",{onClick:()=>T(A.id),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:x.jsx(xa,{className:"w-3 h-3"})})]},A.id))})]})]}),x.jsxs("div",{className:"space-y-4",children:[x.jsxs("h4",{className:"text-sm font-semibold text-slate-700 flex justify-between items-center",children:["データ・マトリクス",x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("button",{onClick:()=>{var A;return(A=f.current)==null?void 0:A.click()},className:"p-1 hover:bg-slate-200 rounded-full",title:"Excelからインポート",children:x.jsx(U2,{className:"w-5 h-5 text-green-600"})}),x.jsx("input",{type:"file",ref:f,onChange:E,className:"hidden",accept:".xlsx, .xls, .csv"}),a.matrixData&&S.length>0&&x.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-slate-200 p-0.5",children:[x.jsx("button",{onClick:()=>c("bar"),className:`px-2 py-0.5 rounded-full text-xs ${l==="bar"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Bar"}),x.jsx("button",{onClick:()=>c("line"),className:`px-2 py-0.5 rounded-full text-xs ${l==="line"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Line"}),x.jsx("button",{onClick:()=>c("pie"),className:`px-2 py-0.5 rounded-full text-xs ${l==="pie"?"bg-white shadow-sm text-blue-600":"text-slate-600"}`,children:"Pie"})]}),x.jsx("button",{onClick:()=>g({matrixData:a.matrixData?null:{headers:["項目","値"],rows:[["",""]]}}),className:"p-1 hover:bg-slate-200 rounded-full",title:a.matrixData?"マトリクスを削除":"マトリクスを追加",children:a.matrixData?x.jsx(xa,{className:"w-5 h-5 text-red-500"}):x.jsx(vu,{className:"w-5 h-5"})})]})]}),a.matrixData?x.jsx(LS,{matrixData:a.matrixData,onUpdate:A=>g({matrixData:A})}):null,x.jsx("div",{className:"mt-4",children:b()})]})]}),x.jsxs("footer",{className:"p-5 bg-slate-100 border-t flex justify-end gap-3",children:[x.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:"キャンセル"}),x.jsx("button",{onClick:v,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:"保存して閉じる"})]})]})})},wm=({value:t,onChange:e,placeholder:n})=>x.jsx("textarea",{value:t,onChange:r=>e(r.target.value),placeholder:n,rows:3,className:"w-full h-full text-sm bg-transparent outline-none p-2 rounded-sm focus:ring-1 focus:ring-blue-500 focus:bg-blue-50 resize-none text-slate-800 placeholder-slate-400"}),aG=({isOpen:t,onClose:e,onSave:n,task:r,generateUniqueId:a})=>{var F;const[i,l]=U.useState([]),[c,d]=U.useState(!1),[f,g]=U.useState(null),[v,_]=U.useState({key:"status",direction:"ascending"});U.useEffect(()=>{var X;t&&l(((X=r.extendedDetails)==null?void 0:X.decisions)||[])},[t,(F=r.extendedDetails)==null?void 0:F.decisions]);const T=U.useMemo(()=>{let X=[...i];return v!==null&&X.sort((P,re)=>{let G="",te="";switch(v.key){case"status":G=P.status==="undecided"?0:1,te=re.status==="undecided"?0:1;break;case"date":G=P.date||"9999-12-31",te=re.date||"9999-12-31";break;default:G=(P[v.key]||"").toLowerCase(),te=(re[v.key]||"").toLowerCase()}return G<te?v.direction==="ascending"?-1:1:G>te?v.direction==="ascending"?1:-1:0}),X},[i,v]),E=X=>{let P="ascending";v&&v.key===X&&v.direction==="ascending"&&(P="descending"),_({key:X,direction:P})},S=X=>!v||v.key!==X?x.jsx(Vi,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):v.direction==="ascending"?x.jsx(Zc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(Vi,{className:"w-3 h-3 ml-1 text-blue-600"}),b=({sortKey:X,label:P,className:re})=>x.jsx("th",{className:`p-0 border border-slate-300 ${re||""}`,children:x.jsxs("button",{onClick:()=>E(X),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50 transition-colors",children:[x.jsx("span",{children:P}),S(X)]})}),k=async()=>{d(!0),g(null);try{const P=(await _L(r,i)).map(re=>re.id==="NEW"?{...re,id:a("dec_ai")}:re);l(P)}catch(X){g(X instanceof Error?X.message:"決定事項の抽出に失敗しました。")}finally{d(!1)}},A=(X,P)=>{l(re=>re.map(G=>G.id===X?{...G,...P}:G))},C=(X,P)=>{const re=i.find(te=>te.id===X);if(!re)return;const G={status:P};P==="decided"&&!re.date?G.date=new Date().toISOString().split("T")[0]:P==="undecided"&&(G.date=void 0),A(X,G)},I=X=>{l(P=>P.filter(re=>re.id!==X))},B=()=>{const X={id:a("dec_manual"),question:"",status:"undecided"};l(P=>[X,...P])},j=()=>{n(i)};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex flex-col p-4 sm:p-6 md:p-8 z-[50]",children:x.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full h-full flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"決定事項の管理"}),x.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[x.jsxs("button",{onClick:k,disabled:c,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-white bg-cyan-600 rounded-md hover:bg-cyan-700 disabled:bg-slate-400",children:[c?x.jsx(In,{size:"sm",color:"border-white"}):x.jsx(Tl,{className:"w-5 h-5"}),x.jsx("span",{children:"AIでリストを更新"})]}),x.jsxs("button",{onClick:B,disabled:c,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-semibold text-slate-700 bg-slate-200 rounded-md hover:bg-slate-300 disabled:bg-slate-400",children:[x.jsx(Rp,{className:"w-5 h-5"}),x.jsx("span",{children:"手動で追加"})]}),x.jsx("button",{onClick:e,className:"p-1.5 rounded-full hover:bg-slate-100",children:x.jsx(Br,{className:"w-6 h-6 text-slate-500"})})]})]}),f&&x.jsx("div",{className:"p-4",children:x.jsx(Ji,{message:f})}),x.jsx("main",{className:"flex-grow p-4 overflow-auto",children:x.jsxs("table",{className:"w-full min-w-[1000px] border-collapse text-sm",children:[x.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:x.jsxs("tr",{children:[x.jsx(b,{sortKey:"status",label:"ステータス",className:"w-32"}),x.jsx(b,{sortKey:"question",label:"決定すべき項目 (Question)",className:"w-[25%]"}),x.jsx(b,{sortKey:"decision",label:"決定した内容 (Decision)",className:"w-[25%]"}),x.jsx(b,{sortKey:"reasoning",label:"理由/重要性",className:"w-[25%]"}),x.jsx(b,{sortKey:"date",label:"日付",className:"w-36"}),x.jsx("th",{className:"p-2 border border-slate-300 w-16",children:"アクション"})]})}),x.jsxs("tbody",{children:[T.map(X=>x.jsxs("tr",{className:"bg-white hover:bg-slate-50 transition-colors",children:[x.jsx("td",{className:"border border-slate-300 align-top p-2",children:x.jsxs("select",{value:X.status,onChange:P=>C(X.id,P.target.value),className:`w-full p-2 rounded-md font-semibold text-xs border ${X.status==="decided"?"bg-green-100 text-green-800 border-green-200":"bg-yellow-100 text-yellow-800 border-yellow-200"}`,children:[x.jsx("option",{value:"undecided",children:"未決定"}),x.jsx("option",{value:"decided",children:"決定済み"})]})}),x.jsx("td",{className:"border border-slate-300",children:x.jsx(wm,{value:X.question||"",onChange:P=>A(X.id,{question:P}),placeholder:"例：どのクラウドプロバイダーを利用するか？"})}),x.jsx("td",{className:"border border-slate-300",children:x.jsx(wm,{value:X.decision||"",onChange:P=>A(X.id,{decision:P}),placeholder:"決定内容..."})}),x.jsx("td",{className:"border border-slate-300",children:x.jsx(wm,{value:X.reasoning||"",onChange:P=>A(X.id,{reasoning:P}),placeholder:"理由や背景..."})}),x.jsx("td",{className:"border border-slate-300 align-top p-2",children:x.jsx("input",{type:"date",value:X.date||"",onChange:P=>A(X.id,{date:P.target.value}),className:"w-full bg-transparent border-b border-dotted border-slate-400 outline-none p-1 text-xs text-slate-600 focus:border-solid focus:border-blue-500 disabled:border-none disabled:bg-slate-100",disabled:X.status==="undecided"})}),x.jsx("td",{className:"border border-slate-300 text-center align-middle",children:x.jsx("button",{onClick:()=>I(X.id),className:"text-red-400 hover:text-red-700 p-1 rounded-full hover:bg-red-100 transition-colors",title:"この項目を削除",children:x.jsx(xa,{className:"w-5 h-5"})})})]},X.id)),i.length===0&&x.jsx("tr",{children:x.jsx("td",{colSpan:6,className:"text-center py-12 text-slate-500 bg-white border border-slate-300",children:"決定事項はありません。「手動で追加」するか、「AIでリストを更新」してください。"})})]})]})}),x.jsxs("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-end gap-3 rounded-b-xl",children:[x.jsx("button",{onClick:e,className:"px-5 py-2 text-sm font-medium text-slate-700 bg-slate-100 border border-slate-300 rounded-md shadow-sm hover:bg-slate-200",children:"キャンセル"}),x.jsx("button",{onClick:j,className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:"変更を保存"})]})]})}):null},vT=({items:t,taskName:e,onClose:n})=>{var g;const[r,a]=U.useState(null),i=U.useMemo(()=>new Set(t.map(v=>v.subStep.id)).size<=1,[t]),l=U.useMemo(()=>{let v=[...t];return r!==null&&v.sort((_,T)=>{let E="",S="";switch(r.key){case"status":E=_.actionItem.completed,S=T.actionItem.completed;break;case"dueDate":E=_.actionItem.dueDate||"9999-12-31",S=T.actionItem.dueDate||"9999-12-31";break;case"completedDate":E=_.actionItem.completedDate||"9999-12-31",S=T.actionItem.completedDate||"9999-12-31";break;case"text":E=(_.actionItem.text||"").toLowerCase(),S=(T.actionItem.text||"").toLowerCase();break;case"subStep":E=(_.subStep.text||"").toLowerCase(),S=(T.subStep.text||"").toLowerCase();break;case"responsible":E=(_.actionItem.responsible||"").toLowerCase(),S=(T.actionItem.responsible||"").toLowerCase();break}return E<S?r.direction==="ascending"?-1:1:E>S?r.direction==="ascending"?1:-1:0}),v},[t,r]),c=v=>{let _="ascending";r&&r.key===v&&r.direction==="ascending"&&(_="descending"),a({key:v,direction:_})},d=v=>!r||r.key!==v?x.jsx(Vi,{className:"w-3 h-3 ml-1 opacity-30 group-hover:opacity-100"}):r.direction==="ascending"?x.jsx(Zc,{className:"w-3 h-3 ml-1 text-blue-600"}):x.jsx(Vi,{className:"w-3 h-3 ml-1 text-blue-600"}),f=({sortKey:v,label:_,className:T})=>x.jsx("th",{scope:"col",className:`p-0 ${T||""}`,children:x.jsxs("button",{onClick:()=>c(v),className:"w-full h-full flex items-center justify-between group font-semibold text-slate-700 p-2 hover:bg-slate-200/50 transition-colors",children:[x.jsx("span",{children:_}),d(v)]})});return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[80]",children:x.jsxs("div",{className:"bg-slate-100 rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-4 border-b border-slate-200 bg-white rounded-t-xl",children:[x.jsxs("div",{children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"アクションアイテム一覧"}),x.jsx("p",{className:"text-sm text-slate-500",children:i?`タスク: ${e} / サブステップ: ${((g=t[0])==null?void 0:g.subStep.text)||""}`:`タスク: ${e}`})]}),x.jsx("button",{onClick:n,className:"p-1.5 rounded-full hover:bg-slate-100",children:x.jsx(Br,{className:"w-6 h-6 text-slate-500"})})]}),x.jsx("main",{className:"flex-grow p-4 overflow-auto",children:x.jsxs("table",{className:"w-full border-collapse text-sm",children:[x.jsx("thead",{className:"sticky top-0 bg-slate-200 z-10",children:x.jsxs("tr",{children:[x.jsx(f,{sortKey:"status",label:"状態",className:"w-28 border border-slate-300"}),x.jsx(f,{sortKey:"text",label:"アクションアイテム",className:"w-2/5 border border-slate-300"}),!i&&x.jsx(f,{sortKey:"subStep",label:"所属サブステップ",className:"w-1/5 border border-slate-300"}),x.jsx(f,{sortKey:"responsible",label:"担当者",className:"w-40 border border-slate-300"}),x.jsx(f,{sortKey:"dueDate",label:"期日",className:"w-40 border border-slate-300"}),x.jsx(f,{sortKey:"completedDate",label:"完了日",className:"w-40 border border-slate-300"})]})}),x.jsxs("tbody",{className:"bg-white",children:[l.map(({actionItem:v,subStep:_})=>{var T;return x.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[x.jsx("td",{className:"p-2 border border-slate-300 align-top text-center",children:v.completed?x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[x.jsx(xu,{className:"w-4 h-4 mr-1"}),"完了"]}):x.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:[x.jsx(Od,{className:"w-4 h-4 mr-1"}),"未完了"]})}),x.jsxs("td",{className:"p-2 border border-slate-300 align-top font-medium text-slate-800",children:[v.text,v.report&&Array.isArray(v.report.attachments)&&v.report.attachments.length>0&&x.jsx("div",{className:"mt-2 pt-2 border-t border-slate-200 space-y-1",children:v.report.attachments.map(E=>x.jsxs("a",{href:E.dataUrl,target:"_blank",rel:"noopener noreferrer",download:E.name,className:"flex items-center gap-1.5 text-xs text-blue-600 hover:underline",children:[x.jsx(Zs,{className:"w-3.5 h-3.5"}),x.jsx("span",{children:E.name})]},E.id))}),((T=v.report)==null?void 0:T.notes)&&x.jsx("p",{className:"text-xs text-slate-500 mt-1 pt-1 border-t border-slate-200 whitespace-pre-wrap",children:v.report.notes})]}),!i&&x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:_.text}),x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:v.responsible||""}),x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:v.dueDate||""}),x.jsx("td",{className:"p-2 border border-slate-300 align-top",children:v.completedDate||""})]},v.id)}),t.length===0&&x.jsx("tr",{children:x.jsx("td",{colSpan:i?5:6,className:"text-center py-10 text-slate-500",children:"アクションアイテムはありません。"})})]})]})}),x.jsx("footer",{className:"flex-shrink-0 p-4 bg-white border-t flex justify-end gap-3 rounded-b-xl",children:x.jsx("button",{onClick:n,className:"px-5 py-2 text-sm font-medium text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700",children:"閉じる"})})]})})},sG=({task:t,isOpen:e,onClose:n,onReportGenerated:r})=>{const[a,i]=U.useState(""),[l,c]=U.useState(new Set),[d,f]=U.useState(!1),[g,v]=U.useState(null),_=U.useMemo(()=>{var C,I,B,j;const A=[];return A.push({id:`task-data-${t.id}`,name:`基本タスク情報: ${t.title}`,type:"Task Data",source:{name:`タスクデータ: ${t.title}`,type:"json",content:t}}),(I=(C=t.extendedDetails)==null?void 0:C.attachments)==null||I.forEach(F=>{A.push({id:F.id,name:`添付: ${F.name}`,type:"Attachment",source:{name:F.name,type:F.type.startsWith("image/")?"image":"text",content:F.dataUrl}})}),(j=(B=t.extendedDetails)==null?void 0:B.subSteps)==null||j.forEach(F=>{var X;(X=F.actionItems)==null||X.forEach(P=>{var re,G,te;(re=P.report)!=null&&re.matrixData&&A.push({id:`matrix-${P.id}`,name:`データ: ${P.text} (${F.text})`,type:"Data Matrix",source:{name:`データマトリクス: ${P.text}`,type:"json",content:P.report.matrixData}}),(te=(G=P.report)==null?void 0:G.attachments)==null||te.forEach(_e=>{A.push({id:_e.id,name:`添付: ${_e.name} (${P.text})`,type:"Attachment",source:{name:_e.name,type:_e.type.startsWith("image/")?"image":"text",content:_e.dataUrl}})})})}),A},[t]),T=U.useMemo(()=>_.find(A=>A.type==="Task Data"),[_]),E=U.useMemo(()=>_.filter(A=>A.type!=="Task Data"),[_]);U.useEffect(()=>{if(e){const A=new Set;T&&A.add(T.id),c(A)}},[e,T]);const S=A=>{const C=_.find(I=>I.id===A);(C==null?void 0:C.type)!=="Task Data"&&c(I=>{const B=new Set(I);return B.has(A)?B.delete(A):B.add(A),B})},b=async()=>{if(!a.trim()){v("レポート作成の目的を入力してください。");return}if(l.size===0){v("少なくとも1つの資料を選択してください。");return}f(!0),v(null);try{const A=_.filter(I=>l.has(I.id)).map(I=>I.source),C=await O2(A,a);r(C)}catch(A){v(A instanceof Error?A.message:"レポートの生成中にエラーが発生しました。")}finally{f(!1)}};if(!e)return null;const k=A=>{switch(A){case"Task Data":return x.jsx(ji,{className:"w-5 h-5 text-blue-600"});case"Attachment":return x.jsx(Zs,{className:"w-5 h-5 text-slate-600"});case"Data Matrix":return x.jsx(vu,{className:"w-5 h-5 text-purple-600"});default:return x.jsx(ji,{className:"w-5 h-5 text-slate-500"})}};return x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[80]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between p-5 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"カスタムレポート作成"}),x.jsx("button",{onClick:n,className:"p-1 rounded-full hover:bg-slate-100",children:x.jsx(Br,{className:"w-6 h-6 text-slate-500"})})]}),x.jsxs("main",{className:"flex-grow p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-8",children:[x.jsxs("div",{children:[x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-3",children:"1. 資料の選択"}),x.jsxs("div",{className:"mb-4",children:[x.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:"常に使用される情報:"}),x.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-md bg-slate-200",children:[x.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"w-4 h-4 accent-blue-600"}),T&&k(T.type),x.jsx("span",{className:"text-sm text-slate-800 font-medium truncate",title:T==null?void 0:T.name,children:T==null?void 0:T.name})]})]}),E.length>0&&x.jsxs(x.Fragment,{children:[x.jsx("p",{className:"text-xs text-slate-600 font-semibold mb-1",children:"追加の資料 (任意):"}),x.jsx("div",{className:"bg-slate-50 border rounded-lg p-3 max-h-80 overflow-y-auto space-y-2",children:E.map(A=>x.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-slate-100 cursor-pointer",children:[x.jsx("input",{type:"checkbox",checked:l.has(A.id),onChange:()=>S(A.id),className:"w-4 h-4 accent-blue-600"}),k(A.type),x.jsx("span",{className:"text-sm text-slate-700 truncate",title:A.name,children:A.name})]},A.id))})]})]}),x.jsxs("div",{children:[x.jsx("h4",{className:"font-semibold text-lg text-slate-800 mb-3",children:"2. レポート作成の指示"}),x.jsx("textarea",{value:a,onChange:A=>i(A.target.value),placeholder:"例：選択した資料を基に、プロジェクトの技術的な課題とそれに対する解決策をまとめたスライドを作成してください。",rows:8,className:"w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition text-sm"}),g&&x.jsx("div",{className:"mt-2",children:x.jsx(Ji,{message:g})})]})]}),x.jsxs("footer",{className:"flex-shrink-0 p-5 bg-slate-100 border-t flex justify-end items-center gap-4",children:[x.jsx("button",{onClick:n,className:"px-5 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-md shadow-sm hover:bg-slate-50",children:"キャンセル"}),x.jsxs("button",{onClick:b,disabled:d,className:"flex items-center gap-2 px-6 py-2 text-sm font-medium text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 disabled:bg-slate-400",children:[d?x.jsx(In,{size:"sm",color:"border-white"}):x.jsx(Tl,{className:"w-5 h-5"}),x.jsx("span",{children:d?"生成中...":"レポートを生成"})]})]})]})})},Aa=({label:t,name:e,value:n,onChange:r,type:a="text",placeholder:i,rows:l,disabled:c=!1,icon:d,required:f=!1})=>x.jsxs("div",{className:"mb-4",children:[x.jsxs("label",{htmlFor:e,className:"block text-sm font-medium text-slate-700 mb-1 flex items-center",children:[d&&x.jsx("span",{className:"mr-1.5 text-slate-500 w-4 h-4",children:d}),t,f&&x.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),a==="textarea"?x.jsx("textarea",{id:e,name:e,value:n,onChange:r,rows:l||3,placeholder:i,disabled:c,className:"w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm text-slate-900 bg-white placeholder-slate-400 disabled:bg-slate-100"}):x.jsx("input",{type:a,id:e,name:e,value:n,onChange:r,placeholder:i,disabled:c,className:"w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm text-slate-900 bg-white placeholder-slate-400 disabled:bg-slate-100"})]}),iG=cs.memo(({subStep:t,onRemove:e,onDragStart:n,onClick:r,cardRef:a,isSelected:i,onStartConnection:l,onEndConnection:c})=>{var g,v;const d=_=>{switch(_){case dr.COMPLETED:return"border-l-4 border-green-500";case dr.IN_PROGRESS:return"border-l-4 border-blue-500";default:return"border-l-4 border-slate-300"}},f=_=>{_.stopPropagation(),l(t.id,_)};return x.jsxs("div",{ref:a,draggable:!0,onDragStart:_=>n(_,t.id),onClick:r,onMouseUp:_=>{_.stopPropagation(),c(t.id)},className:`substep-card absolute p-2.5 rounded-lg shadow-sm cursor-grab active:cursor-grabbing bg-white border w-56 h-auto min-h-[100px] text-xs flex flex-col hover:shadow-md transition-all duration-200 ${i?"ring-2 ring-blue-500 shadow-lg":"border-slate-300"} ${d(t.status)}`,style:{left:((g=t.position)==null?void 0:g.x)||0,top:((v=t.position)==null?void 0:v.y)||0,touchAction:"none"},children:[x.jsxs("div",{children:[x.jsxs("div",{className:"flex justify-between items-start text-slate-400 mb-1",children:[x.jsxs("span",{className:"font-mono text-[10px] select-none",children:["ID: ...",t.id.slice(-4)]}),x.jsx("button",{onClick:_=>{_.stopPropagation(),e()},className:"text-red-400 hover:text-red-600 p-0.5",title:"サブステップ削除",children:x.jsx(xa,{className:"w-3.5 h-3.5"})})]}),x.jsx("p",{className:`mb-1 break-words font-semibold text-slate-800 ${t.status===dr.COMPLETED?"line-through text-slate-500":""}`,children:t.text||"クリックして編集"})]}),x.jsx("div",{className:"flex-grow my-1 border-t pt-1 min-h-0",children:x.jsx("div",{className:"text-[10px] text-slate-600 space-y-1 h-full max-h-20 overflow-y-auto pr-1",children:(t.actionItems||[]).length>0?(t.actionItems||[]).map(_=>x.jsxs("div",{className:`flex justify-between items-center ${_.completed?"text-slate-400 line-through":""}`,children:[x.jsx("span",{className:"truncate pr-1",title:_.text,children:_.text}),_.dueDate&&x.jsx("span",{className:"flex-shrink-0 text-slate-500",children:new Date(_.dueDate+"T00:00:00Z").toLocaleDateString("ja-JP",{month:"numeric",day:"numeric"})})]},_.id)):x.jsx("div",{className:"text-center text-slate-400 pt-2",children:"アクションなし"})})}),x.jsx("div",{className:"mt-auto",children:t.dueDate&&x.jsxs("div",{className:"text-[11px] text-orange-600 font-medium flex items-center justify-end",children:[x.jsx(Ud,{className:"w-3 h-3 mr-1"}),"期日: ",new Date(t.dueDate+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"2-digit",month:"numeric",day:"numeric"})]})}),x.jsx("div",{onMouseDown:f,className:"absolute right-[-5px] top-1/2 -translate-y-1/2 w-3 h-3 bg-blue-500 rounded-full cursor-crosshair hover:scale-125 transition-transform",title:"ドラッグして接続"})]})}),oG=cs.memo(({items:t,onToggle:e,onAdd:n,onUpdate:r,onRemove:a,onOpenReport:i,onOpenTable:l})=>x.jsxs("div",{className:"space-y-2 mt-2",children:[x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsx("h6",{className:"text-sm font-semibold text-slate-600",children:"アクションアイテム"}),x.jsx("button",{onClick:l,className:"p-1 rounded-full hover:bg-slate-200",title:"表形式で表示",children:x.jsx(vu,{className:"w-5 h-5 text-slate-500"})})]}),x.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto pr-2",children:t.map(c=>x.jsxs("div",{className:"group bg-slate-50 p-2 rounded-md transition-all border border-transparent hover:border-slate-200",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("button",{onClick:()=>e(c.id),className:"flex-shrink-0",children:c.completed?x.jsx(xu,{className:"w-5 h-5 text-green-600"}):x.jsx(Od,{className:"w-5 h-5 text-slate-400"})}),x.jsx("div",{className:"flex-grow",onDoubleClick:()=>i(c),children:x.jsx("input",{type:"text",value:c.text,onChange:d=>r(c.id,{text:d.target.value}),placeholder:"アクションアイテム名",className:`w-full text-sm bg-transparent outline-none p-1 rounded-sm focus:ring-1 focus:ring-blue-500 focus:bg-white ${c.completed?"line-through text-slate-500":"text-slate-800"}`})}),x.jsx("button",{onClick:()=>a(c.id),className:"ml-2 text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",children:x.jsx(xa,{className:"w-4 h-4"})})]}),x.jsxs("div",{className:"pl-7 pt-1.5 flex justify-end items-center gap-4 text-xs text-slate-500",children:[c.completed&&c.completedDate?x.jsxs("span",{className:"text-xs text-green-600 font-medium flex items-center mr-auto",children:[x.jsx(gu,{className:"w-4 h-4 mr-1"}),"完了日: ",new Date(c.completedDate+"T00:00:00Z").toLocaleDateString("ja-JP")]}):x.jsx("div",{className:"mr-auto"}),x.jsxs("div",{className:"flex items-center",children:[x.jsx("label",{htmlFor:`responsible-${c.id}`,className:"mr-1 flex items-center",title:"担当者",children:x.jsx(B2,{className:"w-4 h-4"})}),x.jsx("input",{type:"text",id:`responsible-${c.id}`,value:c.responsible||"",onChange:d=>r(c.id,{responsible:d.target.value}),className:"bg-transparent border-b border-dotted border-slate-400 outline-none p-0.5 w-24 focus:border-solid focus:border-blue-500 disabled:border-none disabled:text-slate-400",placeholder:"担当者",disabled:c.completed})]}),x.jsxs("div",{className:"flex items-center",children:[x.jsx("label",{htmlFor:`due-date-${c.id}`,className:"mr-1",children:"期日:"}),x.jsx("input",{type:"date",id:`due-date-${c.id}`,value:c.dueDate||"",onChange:d=>r(c.id,{dueDate:d.target.value}),className:"bg-transparent border-b border-dotted border-slate-400 outline-none p-0.5 w-28 focus:border-solid focus:border-blue-500 disabled:border-none disabled:text-slate-400",style:{colorScheme:"light"},title:"期日",disabled:c.completed})]})]})]},c.id))}),x.jsxs("button",{onClick:n,className:"mt-1 text-xs text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:[x.jsx(Rp,{className:"w-4 h-4"}),"アイテムを追加"]})]})),lG=({task:t,onClose:e,onUpdateTaskCoreInfo:n,onUpdateExtendedDetails:r,generateUniqueId:a,projectGoal:i,targetDate:l})=>{var R,V,O,H,z,q,fe,ye,le,he,pe,Re,Fe,Ue,Me;if(!t)return null;const[c,d]=U.useState(t),[f,g]=U.useState(t),[v,_]=U.useState("none"),[T,E]=U.useState(!1),[S,b]=U.useState(!1),[k,A]=U.useState(!1),[C,I]=U.useState(!1),[B,j]=U.useState(!1),[F,X]=U.useState(null),[P,re]=U.useState(!1),[G,te]=U.useState(!1),[_e,Ne]=U.useState([]),[Ee,se]=U.useState([]),[ue,ae]=U.useState(!1),[J,D]=U.useState(null),[ee,M]=U.useState([]),Y=U.useRef(null),[K,W]=U.useState(new Map),oe=U.useRef(null),ve=U.useRef({x:0,y:0}),[Te,De]=U.useState(null),Se=U.useRef(null),Be=U.useRef(null),[Z,dt]=U.useState(null),[Ke,xt]=U.useState({x:0,y:0}),[nt,Ie]=U.useState([]),Bt=U.useMemo(()=>JSON.stringify(f)!==JSON.stringify(c),[f,c]),an=U.useMemo(()=>{var we;const Q=((we=c.extendedDetails)==null?void 0:we.decisions)||[];return{decided:Q.filter(Ae=>Ae.status==="decided").length,undecided:Q.filter(Ae=>Ae.status==="undecided").length}},[(R=c.extendedDetails)==null?void 0:R.decisions]);U.useEffect(()=>{d(t),g(t),Ne([]),se([])},[t]),U.useEffect(()=>{var we;const Q=new Map;(((we=c.extendedDetails)==null?void 0:we.subSteps)||[]).forEach(Ae=>{Ae&&Ae.id&&Q.set(Ae.id,K.get(Ae.id)||cs.createRef())}),W(Q)},[(V=c.extendedDetails)==null?void 0:V.subSteps]);const sn=U.useCallback(()=>{var we;if(!Y.current){Ie([]);return}const Q=[];(((we=c.extendedDetails)==null?void 0:we.subSteps)||[]).forEach(Ae=>{var Pe,Ve;if((Pe=Ae==null?void 0:Ae.nextSubStepIds)!=null&&Pe.length){const lt=(Ve=K.get(Ae.id))==null?void 0:Ve.current;if(lt&&Ae.position){const It={x:Ae.position.x+lt.offsetWidth,y:Ae.position.y+lt.offsetHeight/2};Ae.nextSubStepIds.forEach(bt=>{var Lt,Hr;const Ft=(Lt=c.extendedDetails)==null?void 0:Lt.subSteps.find(mn=>mn.id===bt),hn=(Hr=K.get(bt))==null?void 0:Hr.current;if(Ft&&hn&&Ft.position){const mn={x:Ft.position.x,y:Ft.position.y+hn.offsetHeight/2};Q.push({id:`subconn-${Ae.id}-${bt}`,from:It,to:mn,sourceId:Ae.id,targetId:bt})}})}}}),Ie(Q)},[(O=c.extendedDetails)==null?void 0:O.subSteps,K]);U.useEffect(()=>{const Q=setTimeout(sn,100);return()=>clearTimeout(Q)},[sn]);const un=U.useCallback(Q=>{d(we=>(Ne(Ae=>[...Ae,we]),se([]),Q(we)))},[]),On=Q=>{un(we=>({...we,...typeof Q=="function"?Q(we):Q}))},vt=Q=>{On(we=>({extendedDetails:{...we.extendedDetails,...typeof Q=="function"?Q(we.extendedDetails):Q}}))},tn=()=>{if(_e.length===0)return;const Q=_e[_e.length-1];Ne(we=>we.slice(0,-1)),se(we=>[c,...we]),d(Q)},zn=()=>{if(Ee.length===0)return;const Q=Ee[0];se(we=>we.slice(1)),Ne(we=>[...we,c]),d(Q)},yn=async()=>{ae(!0),D(null);try{const Q=await yL(c);M(Q),b(!0)}catch(Q){D(Q instanceof Error?Q.message:"計画の提案生成に失敗しました。")}finally{ae(!1)}},Qt=Q=>{vt(we=>{const Ae=we.subSteps||[],Pe=Ae.length,Ve=Q.newSubSteps.map((It,bt)=>({id:a("sub_ai"),text:It.title,notes:It.description,status:dr.NOT_STARTED,actionItems:[],attachments:[],position:{x:10+(Pe+bt)%4*210,y:Math.floor((Pe+bt)/4)*90+10}}));return{subSteps:[...Ae.map(It=>{const bt=Q.newActionItems.filter(hn=>hn.targetSubStepId===It.id);if(bt.length===0)return It;const Ft=bt.map(hn=>({id:a("action_ai"),text:hn.title,completed:!1}));return{...It,actionItems:[...It.actionItems||[],...Ft]}}),...Ve]}}),b(!1)},Mt=()=>{var Ae,Pe;const Q=((Pe=(Ae=c.extendedDetails)==null?void 0:Ae.subSteps)==null?void 0:Pe.length)||0,we={id:a("sub_new"),text:"新しいステップ",status:dr.NOT_STARTED,actionItems:[],attachments:[],position:{x:10+Q%4*210,y:Math.floor(Q/4)*90+10}};vt(Ve=>({subSteps:[...Ve.subSteps||[],we]})),De(we.id)},it=U.useCallback((Q,we)=>{vt(Ae=>({subSteps:(Ae.subSteps||[]).map(Pe=>Pe.id===Q?{...Pe,...typeof we=="function"?we(Pe):we}:Pe)}))},[vt]),tt=U.useCallback(Q=>{De(we=>we===Q?null:we),vt(we=>({subSteps:(we.subSteps||[]).filter(Ae=>Ae.id!==Q).map(Ae=>{var Pe;return{...Ae,nextSubStepIds:(Pe=Ae.nextSubStepIds)==null?void 0:Pe.filter(Ve=>Ve!==Q)}})}))},[vt]),St=()=>{var oi;const Q=(oi=c.extendedDetails)==null?void 0:oi.subSteps,we=Y.current;if(!Q||Q.length===0||!we)return;const Ae=new Map;Q.forEach(Gt=>{var Nn;const _t=(Nn=K.get(Gt.id))==null?void 0:Nn.current;Ae.set(Gt.id,{width:(_t==null?void 0:_t.offsetWidth)||224,height:(_t==null?void 0:_t.offsetHeight)||100})});const Pe=new Map,Ve=new Map;Q.forEach(Gt=>{Pe.set(Gt.id,[]),Ve.set(Gt.id,0)}),Q.forEach(Gt=>{(Gt.nextSubStepIds||[]).forEach(_t=>{Pe.has(_t)&&(Pe.get(Gt.id).push(_t),Ve.set(_t,Ve.get(_t)+1))})});const lt=Q.filter(Gt=>Ve.get(Gt.id)===0).map(Gt=>Gt.id),It=[];let bt=0;for(;lt.length>0;){const Gt=lt.length,_t=[];for(let Nn=0;Nn<Gt;Nn++){const li=lt.shift();_t.push(li),bt++,(Pe.get(li)||[]).forEach(aa=>{Ve.set(aa,Ve.get(aa)-1),Ve.get(aa)===0&&lt.push(aa)})}It.push(_t)}if(bt<Q.length){const Gt=new Set(It.flat()),_t=Q.filter(Nn=>!Gt.has(Nn.id)).map(Nn=>Nn.id);_t.length>0&&It.push(_t)}const Ft=we.clientWidth,hn=60,Lt=20,Hr=new Map;let mn=10,Cl=10,no=0;It.forEach(Gt=>{const Nn=Math.max(...Gt.map(Ar=>Ae.get(Ar).width))+hn;let li=Gt.reduce((Ar,bu)=>Ar+Ae.get(bu).height+Lt,0)-(Gt.length>0?Lt:0);mn>10&&mn+Nn>Ft&&(mn=10,Cl+=no+Lt*2,no=0);let aa=0;Gt.forEach(Ar=>{Hr.set(Ar,{x:mn,y:Cl+aa}),aa+=Ae.get(Ar).height+Lt}),mn+=Nn,no=Math.max(no,li)});let _s=0,ro=0;Hr.forEach((Gt,_t)=>{const Nn=Ae.get(_t);_s=Math.max(_s,Gt.x+Nn.width),ro=Math.max(ro,Gt.y+Nn.height)}),vt(Gt=>({subSteps:(Gt.subSteps||[]).map(_t=>({..._t,position:Hr.get(_t.id)||_t.position})),subStepCanvasSize:{width:_s+20,height:ro+20}}))},on=(Q,we)=>{oe.current=we;const Ae=Q.currentTarget.getBoundingClientRect();ve.current={x:Q.clientX-Ae.left,y:Q.clientY-Ae.top},Q.dataTransfer.effectAllowed="move"},jt=Q=>{Q.preventDefault(),Q.dataTransfer.dropEffect="move"},Pn=Q=>{var Ft;if(Q.preventDefault(),!oe.current||!Y.current)return;const we=Y.current.getBoundingClientRect(),Ae=(Ft=K.get(oe.current))==null?void 0:Ft.current;if(!Ae)return;const Pe=Ae.offsetWidth,Ve=Ae.offsetHeight;let lt=Q.clientX-we.left-ve.current.x+Y.current.scrollLeft,It=Q.clientY-we.top-ve.current.y+Y.current.scrollTop;const bt=Y.current.querySelector(".substep-inner-canvas");bt&&(lt=Math.max(0,Math.min(lt,bt.scrollWidth-Pe)),It=Math.max(0,Math.min(It,bt.scrollHeight-Ve))),it(oe.current,{position:{x:lt,y:It}}),oe.current=null},Oe=Q=>{X(Q),A(!0)},We=(Q,we)=>{var It;const Ae=(It=Q.target.files)==null?void 0:It[0];if(!Ae)return;const Pe=5,Ve=Pe*1024*1024;if(Ae.size>Ve){alert(`ファイルサイズが大きすぎます。${Pe}MB未満のファイルを選択してください。`),Q.target&&(Q.target.value="");return}const lt=new FileReader;lt.onload=bt=>{var Ft;if(typeof((Ft=bt.target)==null?void 0:Ft.result)=="string"){const hn={id:a("attach"),name:Ae.name,type:Ae.type,dataUrl:bt.target.result};we==="task"?vt(Lt=>({attachments:[...Lt.attachments||[],hn]})):we==="substep"&&Te&&it(Te,Lt=>({attachments:[...Lt.attachments||[],hn]}))}else alert("ファイルの読み込みに失敗しました。")},lt.onerror=()=>{alert("ファイルの読み込み中にエラーが発生しました。")},lt.readAsDataURL(Ae),Q.target&&(Q.target.value="")},Ge=(Q,we)=>{we==="task"?vt(Ae=>{var Pe;return{attachments:(Pe=Ae.attachments)==null?void 0:Pe.filter(Ve=>Ve.id!==Q)}}):we==="substep"&&Te&&it(Te,Ae=>{var Pe;return{attachments:(Pe=Ae.attachments)==null?void 0:Pe.filter(Ve=>Ve.id!==Q)}})},Ze=(Q,we)=>{if(!Y.current)return;const Ae=Y.current.getBoundingClientRect(),Pe={x:we.clientX-Ae.left+Y.current.scrollLeft,y:we.clientY-Ae.top+Y.current.scrollTop};dt({fromId:Q,fromPos:Pe})},pt=Q=>{if(!Z)return;const{fromId:we}=Z;if(we===Q){dt(null);return}it(we,Ae=>({...Ae,nextSubStepIds:Array.from(new Set([...Ae.nextSubStepIds||[],Q]))})),dt(null)},Zn=(Q,we)=>{it(Q,Ae=>{var Pe;return{...Ae,nextSubStepIds:(Pe=Ae.nextSubStepIds)==null?void 0:Pe.filter(Ve=>Ve!==we)}})},jr=Q=>{if(!Z||!Y.current)return;const we=Y.current.getBoundingClientRect();xt({x:Q.clientX-we.left+Y.current.scrollLeft,y:Q.clientY-we.top+Y.current.scrollTop})},ra=()=>{Z&&dt(null)},_a=(Q,we)=>{it(Q,Ae=>{var Pe;return{actionItems:(Pe=Ae.actionItems)==null?void 0:Pe.map(Ve=>Ve.id===we.id?we:Ve)}}),A(!1),X(null)},gs=(Q,we,Ae)=>{it(Q,Pe=>{var Ve;return{actionItems:(Ve=Pe.actionItems)==null?void 0:Ve.map(lt=>lt.id===we?{...lt,...Ae}:lt)}})},xs=(Q,we)=>{vt(Ae=>({subSteps:(Ae.subSteps||[]).map(Ve=>{var hn;if(Ve.id!==Q)return Ve;const lt=(hn=Ve.actionItems)==null?void 0:hn.map(Lt=>{if(Lt.id!==we)return Lt;const Hr=!Lt.completed;return{...Lt,completed:Hr,completedDate:Hr?new Date().toISOString().split("T")[0]:void 0}}),It=lt==null?void 0:lt.every(Lt=>Lt.completed),bt=lt==null?void 0:lt.some(Lt=>Lt.completed);let Ft=Ve.status;return lt&&lt.length>0?It?Ft=dr.COMPLETED:bt?Ft=dr.IN_PROGRESS:Ft=dr.NOT_STARTED:Ft=dr.NOT_STARTED,{...Ve,actionItems:lt,status:Ft}})}))},Va=Q=>{it(Q,we=>({actionItems:[...we.actionItems||[],{id:a("action"),text:"新しいアクション",completed:!1}]}))},Ha=(Q,we)=>{it(Q,Ae=>{var Pe;return{actionItems:(Pe=Ae.actionItems)==null?void 0:Pe.filter(Ve=>Ve.id!==we)}})},vs=()=>{n(c.id,{title:c.title,description:c.description,status:c.status}),r(c.id,c.extendedDetails),e()},ii=Q=>{vt({reportDeck:Q})},yr=()=>{j(!0)},fn=Q=>{vt({reportDeck:Q}),j(!1),E(!0)},dn=()=>{if(!Bt){e();return}window.confirm(`変更が保存されていません。現在の変更を破棄してよろしいですか？

・「OK」で変更を破棄して戻る
・「キャンセル」で編集を続ける（手動で保存できます）`)&&e()},Vr=Q=>{vt({decisions:Q}),I(!1)},yt=((z=(H=c.extendedDetails)==null?void 0:H.subSteps)==null?void 0:z.find(Q=>Q.id===Te))||null,ys=(Q,we)=>x.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 mt-1 max-h-40 overflow-y-auto p-2 border rounded-md bg-slate-50",children:!Q||Q.length===0?x.jsx("p",{className:"col-span-full text-center text-xs text-slate-400 py-2",children:"添付ファイルはありません"}):Q.map(Ae=>x.jsxs("div",{className:"relative group border rounded-md overflow-hidden bg-white shadow-sm h-20",children:[x.jsx("a",{href:Ae.dataUrl,download:Ae.name,className:"block w-full h-full","aria-label":`Download ${Ae.name}`,children:Ae.type.startsWith("image/")?x.jsx("img",{src:Ae.dataUrl,alt:Ae.name,className:"w-full h-full object-cover"}):x.jsx("div",{className:"w-full h-full bg-slate-100 flex flex-col items-center justify-center p-1 hover:bg-slate-200",children:x.jsx(Zs,{className:"w-8 h-8 text-slate-500"})})}),x.jsx("div",{className:"absolute bottom-0 w-full bg-black bg-opacity-60 p-1 pointer-events-none",children:x.jsx("p",{className:"text-white text-[10px] truncate",title:Ae.name,children:Ae.name})}),x.jsx("button",{onClick:()=>we(Ae.id),className:"absolute top-1 right-1 bg-black bg-opacity-70 text-white rounded-full p-0.5 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:x.jsx(xa,{className:"w-3 h-3"})})]},Ae.id))});return T&&((q=c.extendedDetails)!=null&&q.reportDeck)?x.jsx(z2,{tasks:[c],initialDeck:c.extendedDetails.reportDeck,onSave:ii,onClose:()=>E(!1),generateUniqueId:a,projectGoal:i,targetDate:l,reportScope:"task"}):S?x.jsx(XO,{proposals:ee,existingSubSteps:((fe=c.extendedDetails)==null?void 0:fe.subSteps)||[],onConfirm:Qt,onClose:()=>b(!1)}):k&&F&&yt?x.jsx(rG,{actionItem:F,onSave:Q=>_a(yt.id,Q),onClose:()=>A(!1),generateUniqueId:a}):x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"min-h-screen bg-slate-100 flex flex-col",children:[x.jsx("header",{className:"flex-shrink-0 bg-white shadow-md z-10 sticky top-0",children:x.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-5 w-full max-w-screen-2xl mx-auto",children:[x.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-slate-800 truncate pr-2",children:[c.title," - 詳細計画"]}),x.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[x.jsx("button",{onClick:dn,className:"px-3 sm:px-5 py-2 bg-slate-200 text-slate-700 text-sm font-medium rounded-md hover:bg-slate-300",children:"フローに戻る"}),x.jsx("button",{onClick:vs,className:"px-3 sm:px-5 py-2 bg-blue-600 text-white text-sm font-semibold rounded-md hover:bg-blue-700",children:"計画の変更を保存"}),x.jsx("button",{onClick:yr,className:"px-3 sm:px-5 py-2 bg-purple-600 text-white text-sm font-semibold rounded-md hover:bg-purple-700",children:"レポート作成"})]})]})}),x.jsx("main",{className:"flex-grow p-4 sm:p-6 overflow-hidden w-full max-w-screen-2xl mx-auto",children:x.jsxs("div",{className:"flex gap-6 h-full",children:[x.jsxs("section",{className:`flex flex-col space-y-4 bg-white p-4 rounded-lg shadow-sm border transition-all duration-300 ease-in-out
                  ${v==="info"?"flex-1":v==="none"?"w-[360px] min-w-[360px]":"w-0 p-0 m-0 border-0 overflow-hidden opacity-0"}`,children:[x.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[x.jsxs("h4",{className:"text-lg font-semibold text-slate-700 flex items-center",children:[x.jsx(kL,{className:"w-5 h-5 mr-2 text-purple-600"}),"タスク情報"]}),x.jsx("button",{onClick:()=>_(v==="info"?"none":"info"),className:"p-1 text-slate-500 hover:text-blue-600",title:v==="info"?"元に戻す":"最大化",children:v==="info"?x.jsx(cm,{className:"w-5 h-5"}):x.jsx(lm,{className:"w-5 h-5"})})]}),x.jsxs("div",{className:"flex-grow overflow-y-auto pr-2",children:[x.jsx(Aa,{label:"タスクタイトル",name:"title",value:c.title,onChange:Q=>On({title:Q.target.value}),required:!0}),x.jsx(Aa,{label:"タスク説明",name:"description",value:c.description,onChange:Q=>On({description:Q.target.value}),type:"textarea",rows:3,required:!0}),x.jsx(Aa,{icon:x.jsx(B2,{}),label:"担当者/チーム",name:"responsible",value:c.extendedDetails.responsible,onChange:Q=>vt({responsible:Q.target.value})}),x.jsx(Aa,{icon:x.jsx(Ud,{}),label:"このタスクの期日",name:"dueDate",type:"date",value:c.extendedDetails.dueDate||"",onChange:Q=>vt({dueDate:Q.target.value})}),x.jsxs("div",{children:[x.jsx(Aa,{icon:x.jsx(OL,{}),label:"必要なリソース",name:"resources",value:c.extendedDetails.resources,onChange:Q=>vt({resources:Q.target.value}),type:"textarea"}),(ye=c.extendedDetails)!=null&&ye.resourceMatrix?x.jsx("div",{className:"mt-2",children:x.jsx(LS,{matrixData:c.extendedDetails.resourceMatrix,onUpdate:Q=>vt({resourceMatrix:Q})})}):x.jsxs("button",{onClick:()=>vt({resourceMatrix:{headers:["購入品","価格"],rows:[["",""]]}}),className:"mt-1 text-xs text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1",children:[x.jsx(vu,{className:"w-4 h-4"}),"マトリクスを追加"]})]}),x.jsx(Aa,{icon:x.jsx(LL,{}),label:"備考・詳細メモ",name:"notes",value:c.extendedDetails.notes,onChange:Q=>vt({notes:Q.target.value}),type:"textarea",rows:4}),x.jsx("div",{className:"pt-4 border-t mt-4",children:x.jsxs("button",{onClick:()=>I(!0),className:"w-full text-left p-3 bg-cyan-50 hover:bg-cyan-100 rounded-lg text-cyan-800 font-semibold flex justify-between items-center",children:[x.jsxs("span",{className:"flex items-center gap-2",children:[x.jsx($2,{className:"w-5 h-5 text-cyan-600"}),"決定事項の管理"]}),x.jsxs("div",{className:"flex gap-2 text-xs",children:[x.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-green-200 text-green-800",children:["済: ",an.decided]}),x.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-yellow-200 text-yellow-800",children:["未: ",an.undecided]})]})]})}),x.jsxs("div",{className:"pt-4",children:[x.jsxs("label",{className:"flex items-center justify-between text-sm font-medium text-slate-700 mb-1",children:["タスク全体の添付資料",x.jsx("button",{onClick:()=>{var Q;return(Q=Se.current)==null?void 0:Q.click()},className:"p-1 hover:bg-slate-100 rounded-full",title:"添付ファイルを追加",children:x.jsx(Zs,{className:"w-4 h-4 text-slate-600"})})]}),ys((le=c.extendedDetails)==null?void 0:le.attachments,Q=>Ge(Q,"task")),x.jsx("input",{type:"file",ref:Se,onChange:Q=>We(Q,"task"),className:"hidden"})]}),x.jsxs("div",{className:"pt-4",children:[x.jsxs("h4",{className:"text-lg font-semibold text-slate-700 mb-3 border-b pb-2 flex items-center",children:[x.jsx(Dp,{className:"w-5 h-5 mr-2 text-yellow-500"}),"AIによる自動計画"]}),x.jsx("button",{onClick:yn,disabled:ue,className:"w-full px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md shadow-sm hover:bg-indigo-700 disabled:bg-slate-400",children:ue?x.jsx(In,{size:"sm"}):"AIでサブステップを自動計画"}),J&&x.jsx("div",{className:"mt-2",children:x.jsx(Ji,{message:J})})]})]})]}),x.jsxs("section",{className:`flex flex-col space-y-4 min-w-0 transition-all duration-300 ease-in-out
                  ${v==="canvas"||v==="none"?"flex-1":"hidden"}`,children:[x.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[x.jsxs("h4",{className:"text-lg font-semibold text-slate-700 flex items-center",children:[x.jsx(DL,{className:"w-5 h-5 mr-2 text-blue-600"}),"サブステップ計画"]}),x.jsxs("div",{className:"flex gap-2 items-center",children:[x.jsx("button",{onClick:tn,disabled:_e.length===0,className:"text-xs px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",title:"元に戻す",children:x.jsx(V2,{className:"w-3 h-3"})}),x.jsx("button",{onClick:zn,disabled:Ee.length===0,className:"text-xs px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",title:"やり直し",children:x.jsx(H2,{className:"w-3 h-3"})}),x.jsxs("button",{onClick:Mt,className:"text-xs px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center gap-1",children:[x.jsx(Bi,{className:"w-3 h-3"}),"追加"]}),x.jsxs("button",{onClick:St,className:"text-xs px-2 py-1 bg-slate-200 text-slate-700 rounded-md hover:bg-slate-300 flex items-center gap-1",title:"自動整列",children:[x.jsx(Pd,{className:"w-3 h-3"}),"整列"]}),x.jsx("button",{onClick:()=>_(v==="canvas"?"none":"canvas"),className:"p-1 text-slate-500 hover:text-blue-600",title:v==="canvas"?"元に戻す":"最大化",children:v==="canvas"?x.jsx(cm,{className:"w-5 h-5"}):x.jsx(lm,{className:"w-5 h-5"})})]})]}),x.jsx("div",{ref:Y,onMouseMove:jr,onMouseUp:ra,onDragOver:jt,onDrop:Pn,className:`substep-canvas relative border rounded-md bg-white p-2 overflow-auto shadow-inner ${v==="canvas"?"":"flex-grow"}`,children:x.jsxs("div",{className:"substep-inner-canvas relative",style:{width:`${((pe=(he=c.extendedDetails)==null?void 0:he.subStepCanvasSize)==null?void 0:pe.width)||1200}px`,height:`${((Fe=(Re=c.extendedDetails)==null?void 0:Re.subStepCanvasSize)==null?void 0:Fe.height)||800}px`},children:[(((Ue=c.extendedDetails)==null?void 0:Ue.subSteps)||[]).map(Q=>Q?x.jsx(iG,{subStep:Q,cardRef:K.get(Q.id),isSelected:Te===Q.id,onClick:()=>De(Q.id),onRemove:()=>tt(Q.id),onDragStart:on,onStartConnection:Ze,onEndConnection:pt},Q.id):null),nt.map(Q=>x.jsx(eu,{from:Q.from,to:Q.to,id:Q.id,onDelete:()=>Zn(Q.sourceId,Q.targetId)},Q.id)),Z&&x.jsx(eu,{from:Z.fromPos,to:Ke,id:"preview-connector"})]})})]}),x.jsxs("section",{className:`flex flex-col space-y-4 bg-white p-4 rounded-lg shadow-sm border transition-all duration-300 ease-in-out
                  ${v==="details"?"flex-1":v==="none"?"w-[360px] min-w-[360px]":"hidden"}`,children:[x.jsx("div",{className:"mb-0",children:x.jsx("button",{onClick:()=>te(!0),className:"w-full text-left p-3 bg-indigo-50 hover:bg-indigo-100 rounded-lg text-indigo-800 font-semibold flex justify-between items-center",children:x.jsxs("span",{className:"flex items-center gap-2",children:[x.jsx(xu,{className:"w-5 h-5 text-indigo-600"}),"このタスクのアクションアイテム一覧"]})})}),x.jsxs("div",{className:"flex items-center justify-between border-b pb-2",children:[x.jsx("h5",{className:"text-lg font-semibold text-slate-800",children:"サブステップ詳細"}),x.jsx("button",{onClick:()=>_(v==="details"?"none":"details"),disabled:!yt,className:"p-1 text-slate-500 hover:text-blue-600 disabled:text-slate-300 disabled:cursor-not-allowed",title:v==="details"?"元に戻す":"最大化",children:v==="details"?x.jsx(cm,{className:"w-5 h-5"}):x.jsx(lm,{className:"w-5 h-5"})})]}),x.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:yt?x.jsxs("div",{className:"space-y-4",children:[x.jsx(Aa,{label:"テキスト",name:"text",value:yt.text,onChange:Q=>it(yt.id,{text:Q.target.value}),type:"textarea"}),x.jsx(Aa,{label:"担当者",name:"responsible",value:yt.responsible||"",onChange:Q=>it(yt.id,{responsible:Q.target.value})}),x.jsx(Aa,{label:"期日",name:"dueDate",type:"date",value:yt.dueDate||"",onChange:Q=>it(yt.id,{dueDate:Q.target.value})}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"ステータス"}),x.jsx("select",{value:yt.status||dr.NOT_STARTED,onChange:Q=>it(yt.id,{status:Q.target.value}),className:"w-full p-2 border rounded-md text-sm bg-white text-slate-900",children:Object.values(dr).map(Q=>x.jsx("option",{value:Q,children:Q},Q))})]}),x.jsx(Aa,{label:"メモ",name:"notes",value:yt.notes||"",onChange:Q=>it(yt.id,{notes:Q.target.value}),type:"textarea"}),x.jsx(oG,{items:yt.actionItems||[],onToggle:Q=>xs(yt.id,Q),onAdd:()=>Va(yt.id),onUpdate:(Q,we)=>gs(yt.id,Q,we),onRemove:Q=>Ha(yt.id,Q),onOpenReport:Oe,onOpenTable:()=>re(!0)}),x.jsxs("div",{children:[x.jsxs("label",{className:"flex items-center justify-between text-sm font-medium text-slate-700 mb-1",children:["このサブステップの添付資料",x.jsx("button",{onClick:()=>{var Q;return(Q=Be.current)==null?void 0:Q.click()},className:"p-1 hover:bg-slate-100 rounded-full",title:"添付ファイルを追加",children:x.jsx(Zs,{className:"w-4 h-4 text-slate-600"})})]}),ys(yt.attachments,Q=>Ge(Q,"substep")),x.jsx("input",{type:"file",ref:Be,onChange:Q=>We(Q,"substep"),className:"hidden"})]})]}):x.jsx("div",{className:"flex items-center justify-center h-full text-center text-slate-500 text-sm",children:x.jsxs("p",{children:["左のフローチャートから",x.jsx("br",{}),"サブステップを選択して詳細を編集します。"]})})})]})]})})]}),C&&x.jsx(aG,{task:c,isOpen:C,onClose:()=>I(!1),onSave:Vr,generateUniqueId:a}),G&&x.jsx(vT,{items:(((Me=c.extendedDetails)==null?void 0:Me.subSteps)||[]).flatMap(Q=>(Q.actionItems||[]).map(we=>({actionItem:we,subStep:Q}))),taskName:c.title,onClose:()=>te(!1)}),P&&yt&&x.jsx(vT,{items:(yt.actionItems||[]).map(Q=>({actionItem:Q,subStep:yt})),taskName:c.title,onClose:()=>re(!1)}),B&&x.jsx(sG,{task:c,isOpen:B,onClose:()=>j(!1),onReportGenerated:fn})]})},cG=({onSetApiKey:t,error:e,isLoading:n})=>{const[r,a]=U.useState(""),i=l=>{l.preventDefault(),t(r)};return x.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:[x.jsxs("div",{className:"w-full max-w-md bg-white shadow-2xl rounded-xl p-8",children:[x.jsxs("div",{className:"text-center mb-8",children:[x.jsx(Tl,{className:"w-12 h-12 mx-auto text-blue-600 mb-4"}),x.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"AI Project Planner"}),x.jsx("p",{className:"text-slate-600 mt-2",children:"始めるには、Google Gemini APIキーを入力してください。"})]}),x.jsxs("form",{onSubmit:i,className:"space-y-6",children:[x.jsxs("div",{children:[x.jsxs("label",{htmlFor:"apiKey",className:"block text-sm font-semibold text-slate-700 mb-2 flex items-center",children:[x.jsx(Qc,{className:"w-5 h-5 mr-2 text-slate-500"}),"Gemini API Key"]}),x.jsx("input",{id:"apiKey",type:"password",value:r,onChange:l=>a(l.target.value),placeholder:"APIキーをここに貼り付け",className:"w-full px-4 py-3 bg-slate-100 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition duration-150 ease-in-out text-base text-slate-800 placeholder-slate-400"})]}),e&&x.jsx("p",{className:"text-sm text-red-600 bg-red-100 p-3 rounded-md",children:e}),x.jsx("button",{type:"submit",disabled:n||!r,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out flex items-center justify-center",children:n?x.jsx(In,{size:"sm"}):"保存して開始"})]}),x.jsxs("div",{className:"text-center mt-6",children:[x.jsx("a",{href:"https://aistudio.google.com/app/apikey",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"APIキーの取得はこちら"}),x.jsx("p",{className:"text-xs text-slate-400 mt-2",children:"APIキーはセッション中のみブラウザに保存されます。"})]})]}),x.jsx("footer",{className:"mt-8 text-center",children:x.jsx("p",{className:"text-slate-400 text-sm",children:"Powered by Gemini API"})})]})},OS=({isOpen:t,onClose:e,onSuccess:n})=>{const[r,a]=U.useState(!0),[i,l]=U.useState(""),[c,d]=U.useState(""),[f,g]=U.useState(!1),[v,_]=U.useState(null),T=async E=>{E.preventDefault(),g(!0),_(null);try{if(r){const{error:S}=await at.auth.signInWithPassword({email:i,password:c});if(S)throw S}else{const{error:S}=await at.auth.signUp({email:i,password:c});if(S)throw S}n()}catch(S){_(S instanceof Error?S.message:"認証に失敗しました")}finally{g(!1)}};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[x.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[x.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center",children:[x.jsx(Qc,{className:"w-6 h-6 mr-2 text-blue-600"}),r?"ログイン":"アカウント作成"]}),x.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:x.jsx(Br,{className:"w-5 h-5"})})]}),x.jsxs("form",{onSubmit:T,className:"p-6 space-y-4",children:[x.jsxs("div",{children:[x.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-1",children:"メールアドレス"}),x.jsx("input",{type:"email",id:"email",value:i,onChange:E=>l(E.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-1",children:"パスワード"}),x.jsx("input",{type:"password",id:"password",value:c,onChange:E=>d(E.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0,minLength:6})]}),v&&x.jsx("div",{className:"text-sm text-red-600 bg-red-100 p-3 rounded-md",children:v}),x.jsx("button",{type:"submit",disabled:f,className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-slate-400 text-white font-semibold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out flex items-center justify-center",children:f?x.jsx(In,{size:"sm",color:"border-white"}):r?"ログイン":"アカウント作成"}),x.jsx("div",{className:"text-center",children:x.jsx("button",{type:"button",onClick:()=>a(!r),className:"text-sm text-blue-600 hover:underline",children:r?"アカウントをお持ちでない方はこちら":"すでにアカウントをお持ちの方はこちら"})})]})]})}):null},uG=({isOpen:t,onClose:e,onSelectProject:n,onCreateNew:r})=>{const[a,i]=U.useState([]),[l,c]=U.useState(!1),[d,f]=U.useState(null),g=async()=>{c(!0),f(null);try{const T=await rr.getProjects();i(T)}catch(T){f(T instanceof Error?T.message:"プロジェクトの読み込みに失敗しました")}finally{c(!1)}};U.useEffect(()=>{t&&g()},[t]);const v=async(T,E)=>{if(E.stopPropagation(),!!confirm("このプロジェクトを削除しますか？この操作は取り消せません。"))try{await rr.deleteProject(T),await g()}catch(S){f(S instanceof Error?S.message:"プロジェクトの削除に失敗しました")}},_=T=>{const E={projectGoal:T.goal,targetDate:T.targetDate,tasks:T.tasks,ganttData:T.ganttData},S=JSON.stringify(E,null,2),b=new Blob([S],{type:"application/json"}),k=URL.createObjectURL(b),A=document.createElement("a");A.href=k,A.download=`${T.title}.json`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(k)};return t?x.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[x.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[x.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"プロジェクト一覧"}),x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[x.jsx(Bi,{className:"w-5 h-5"}),"新規作成"]}),x.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-700 transition-colors p-1 rounded-full hover:bg-slate-100",children:x.jsx(Br,{className:"w-6 h-6"})})]})]}),x.jsxs("div",{className:"flex-grow p-6 overflow-y-auto",children:[d&&x.jsx(Ji,{message:d}),l?x.jsx("div",{className:"flex items-center justify-center py-12",children:x.jsx(In,{size:"lg",text:"プロジェクトを読み込み中..."})}):a.length===0?x.jsxs("div",{className:"text-center py-12",children:[x.jsx("p",{className:"text-slate-500 text-lg mb-4",children:"プロジェクトがありません"}),x.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 mx-auto",children:[x.jsx(Bi,{className:"w-5 h-5"}),"最初のプロジェクトを作成"]})]}):x.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(T=>x.jsxs("div",{onClick:()=>n(T),className:"bg-slate-50 rounded-lg p-4 cursor-pointer hover:bg-slate-100 transition-colors border border-slate-200 hover:border-blue-300",children:[x.jsxs("div",{className:"flex items-start justify-between mb-3",children:[x.jsx("h4",{className:"font-semibold text-slate-800 truncate flex-grow",children:T.title}),x.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[x.jsx("button",{onClick:E=>{E.stopPropagation(),_(T)},className:"p-1 text-slate-500 hover:text-blue-600 rounded",title:"JSONでダウンロード",children:x.jsx(dl,{className:"w-4 h-4"})}),x.jsx("button",{onClick:E=>v(T.id,E),className:"p-1 text-slate-500 hover:text-red-600 rounded",title:"削除",children:x.jsx(xa,{className:"w-4 h-4"})})]})]}),x.jsxs("div",{className:"space-y-2 text-sm text-slate-600",children:[x.jsxs("p",{className:"flex items-start",children:[x.jsx(Np,{className:"w-4 h-4 mr-2 text-blue-600 flex-shrink-0 mt-0.5"}),x.jsx("span",{className:"line-clamp-2",children:T.goal})]}),x.jsxs("p",{className:"flex items-center",children:[x.jsx(kp,{className:"w-4 h-4 mr-2 text-blue-600 flex-shrink-0"}),new Date(T.targetDate+"T00:00:00Z").toLocaleDateString("ja-JP",{year:"numeric",month:"long",day:"numeric"})]}),x.jsxs("p",{className:"text-xs text-slate-500",children:["タスク数: ",T.tasks.length," | 更新: ",new Date(T.updatedAt).toLocaleDateString("ja-JP")]})]})]},T.id))})]})]})}):null},fG={"process-design":{goal:"APQP（Advanced Product Quality Planning）に基づく新製品の工程設計を完了し、量産開始準備を整える",tasks:[{id:"apqp-1",title:"計画・プログラム定義（Phase 1）",description:"顧客要求の理解、設計目標の設定、初期品質計画の策定"},{id:"apqp-2",title:"製品設計・開発（Phase 2）",description:"DFMEA実施、設計検証、製品仕様の確定"},{id:"apqp-3",title:"工程設計・開発（Phase 3）",description:"PFMEA実施、工程フロー作成、制御計画策定"},{id:"apqp-4",title:"製品・工程検証（Phase 4）",description:"試作評価、工程能力確認、量産試作実施"},{id:"apqp-5",title:"立上げ・評価・是正処置（Phase 5）",description:"量産開始、初期品質監視、継続的改善"}]},"process-change":{goal:"ISO/IATF 16949に準拠した工程変更管理を実施し、品質リスクを最小化して変更を完了する",tasks:[{id:"change-1",title:"変更要求・影響分析",description:"変更内容の詳細分析、リスクアセスメント、関連部門への影響評価"},{id:"change-2",title:"変更計画・承認",description:"変更実施計画の策定、必要な承認取得、リソース確保"},{id:"change-3",title:"変更実施・検証",description:"工程変更の実施、検証試験、品質確認"},{id:"change-4",title:"効果確認・標準化",description:"変更効果の測定、標準書更新、関係者への展開"}]},"new-product-eval":{goal:"顧客からの新製品要求に対し、既存設備での製造可能性を評価し、実現可能性報告書を提出する",tasks:[{id:"eval-1",title:"顧客要求分析",description:"製品仕様、品質要求、数量・納期要求の詳細分析"},{id:"eval-2",title:"設備能力評価",description:"既存設備の能力確認、必要な改造・追加設備の検討"},{id:"eval-3",title:"製造可能性検証",description:"試作・テスト実施、品質確認、コスト試算"},{id:"eval-4",title:"実現可能性報告",description:"評価結果まとめ、リスク・課題整理、顧客への提案書作成"}]},"improvement-project":{goal:"DMAICアプローチを用いて生産性向上とコスト削減を実現し、目標効果を達成する",tasks:[{id:"dmaic-d",title:"Define（定義）",description:"問題の明確化、目標設定、プロジェクトスコープの定義"},{id:"dmaic-m",title:"Measure（測定）",description:"現状把握、データ収集、ベースライン設定"},{id:"dmaic-a",title:"Analyze（分析）",description:"根本原因分析、要因特定、改善機会の抽出"},{id:"dmaic-i",title:"Improve（改善）",description:"改善案実施、効果検証、最適化"},{id:"dmaic-c",title:"Control（管理）",description:"標準化、監視体制構築、継続的改善"}]},"equipment-modification":{goal:"社内設備・治具の改造により生産効率向上を図り、投資対効果を最大化する",tasks:[{id:"equip-1",title:"現状分析・要求定義",description:"現設備の課題分析、改造要求の明確化、目標設定"},{id:"equip-2",title:"改造設計・計画",description:"改造設計、部品調達計画、作業スケジュール策定"},{id:"equip-3",title:"改造実施・テスト",description:"設備停止、改造作業実施、機能確認テスト"},{id:"equip-4",title:"効果検証・標準化",description:"改造効果測定、作業標準更新、横展開検討"}]}},dG=t=>{const[e,n]=U.useState([t]),[r,a]=U.useState(0),i=U.useCallback(g=>{n(v=>{const _=v.slice(0,r+1);return _.push(g),_.slice(-50)}),a(v=>Math.min(v+1,49))},[r]),l=U.useCallback(()=>r>0?(a(g=>g-1),e[r-1]):null,[r,e]),c=U.useCallback(()=>r<e.length-1?(a(g=>g+1),e[r+1]):null,[r,e]),d=r>0,f=r<e.length-1;return{addToHistory:i,undo:l,redo:c,canUndo:d,canRedo:f}},hG=()=>{const[t,e]=U.useState(null),[n,r]=U.useState(!0),[a,i]=U.useState(!1),[l,c]=U.useState(null),[d,f]=U.useState([]),[g,v]=U.useState(!1),[_,T]=U.useState(!1),[E,S]=U.useState(ka.INPUT_FORM),[b,k]=U.useState(""),[A,C]=U.useState(""),[I,B]=U.useState(""),[j,F]=U.useState([]),[X,P]=U.useState(null),[re,G]=U.useState(null),[te,_e]=U.useState(null),[Ne,Ee]=U.useState(!1),[se,ue]=U.useState(null),[ae,J]=U.useState(""),[D,ee]=U.useState(!1),{addToHistory:M,undo:Y,redo:K,canUndo:W,canRedo:oe}=dG({tasks:j,projectGoal:b,targetDate:I}),ve=450,Te=350;U.useEffect(()=>{if((async()=>{if(!at){e(null),r(!1);return}const{data:{session:Ge}}=await at.auth.getSession();e((Ge==null?void 0:Ge.user)??null),r(!1)})(),!at)return;const{data:{subscription:We}}=at.auth.onAuthStateChange((Ge,Ze)=>{e((Ze==null?void 0:Ze.user)??null),Ge==="SIGNED_OUT"&&(c(null),f([]),F([]),k(""),B(""),S(ka.INPUT_FORM))});return()=>We.unsubscribe()},[]),U.useEffect(()=>{const Oe=sessionStorage.getItem("gemini_api_key");Oe&&(J(Oe),ee(!0),om(Oe))},[]),U.useEffect(()=>l!=null&&l.id?rr.subscribeToProjectChanges(l.id,We=>{if(We.eventType==="UPDATE"){const Ge=We.new;F(Ge.tasks_data||[]),k(Ge.goal),B(Ge.target_date),G(Ge.gantt_data)}},()=>{De()}):void 0,[l==null?void 0:l.id]);const De=U.useCallback(async()=>{if(l!=null&&l.id)try{const Oe=await rr.getProjectWithMembers(l.id);f(Oe.members||[])}catch(Oe){console.error("Failed to load project members:",Oe)}},[l==null?void 0:l.id]);U.useEffect(()=>{De()},[De]);const Se=U.useCallback((Oe="item")=>`${Oe}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,[]),Be=U.useCallback(Oe=>{F(We=>{const Ge=typeof Oe=="function"?Oe(We):Oe;return M({tasks:Ge,projectGoal:b,targetDate:I}),Ge})},[M,b,I]),Z=U.useCallback(Oe=>{J(Oe),ee(!0),sessionStorage.setItem("gemini_api_key",Oe),om(Oe),ue(null)},[]),dt=U.useCallback(()=>{J(""),ee(!1),sessionStorage.removeItem("gemini_api_key"),om("")},[]),Ke=U.useCallback(()=>{i(!1)},[]),xt=U.useCallback(async()=>{await at.auth.signOut()},[]),nt=U.useCallback(async(Oe,We)=>{if(!D){ue("APIキーが設定されていません。");return}Ee(!0),ue(null);try{const Ze=(await vL(Oe,We)).map((pt,Zn)=>({...pt,position:{x:50+Zn%3*ve,y:50+Math.floor(Zn/3)*Te}}));k(Oe),B(We),Be(Ze),S(ka.PROJECT_FLOW),M({tasks:Ze,projectGoal:Oe,targetDate:We})}catch(Ge){ue(Ge instanceof Error?Ge.message:"プロジェクト計画の生成に失敗しました。")}finally{Ee(!1)}},[D,Be,M,ve,Te]),Ie=U.useCallback((Oe,We,Ge)=>{const pt=fG[Oe].tasks.map((Zn,jr)=>({...Zn,position:{x:50+jr%3*ve,y:50+Math.floor(jr/3)*Te}}));k(We),B(Ge),Be(pt),S(ka.PROJECT_FLOW),M({tasks:pt,projectGoal:We,targetDate:Ge})},[Be,M,ve,Te]),Bt=U.useCallback(Oe=>{P(Oe)},[]),an=U.useCallback(async(Oe,We)=>{const Ge=j.map(Ze=>Ze.id===Oe?{...Ze,extendedDetails:We}:Ze);if(Be(Ge),l!=null&&l.id&&(l.userRole==="owner"||l.userRole==="editor"))try{await rr.updateProject(l.id,{tasks:Ge,expectedVersion:l.version})}catch(Ze){console.error("Failed to auto-save project:",Ze)}},[j,Be,l]),sn=U.useCallback(async(Oe,We)=>{const Ge=j.map(Ze=>Ze.id===Oe?{...Ze,position:We}:Ze);if(Be(Ge),l!=null&&l.id&&(l.userRole==="owner"||l.userRole==="editor"))try{await rr.updateProject(l.id,{tasks:Ge,expectedVersion:l.version})}catch(Ze){console.error("Failed to auto-save project:",Ze)}},[j,Be,l]),un=U.useCallback(async(Oe,We)=>{const Ge=j.map(Ze=>Ze.id===Oe?{...Ze,status:We}:Ze);if(Be(Ge),l!=null&&l.id&&(l.userRole==="owner"||l.userRole==="editor"))try{await rr.updateProject(l.id,{tasks:Ge,expectedVersion:l.version})}catch(Ze){console.error("Failed to auto-save project:",Ze)}},[j,Be,l]),On=U.useCallback(async(Oe,We)=>{const Ge=j.map(Ze=>Ze.id===Oe?{...Ze,nextTaskIds:We}:Ze);if(Be(Ge),l!=null&&l.id&&(l.userRole==="owner"||l.userRole==="editor"))try{await rr.updateProject(l.id,{tasks:Ge,expectedVersion:l.version})}catch(Ze){console.error("Failed to auto-save project:",Ze)}},[j,Be,l]),vt=U.useCallback(()=>{c(null),f([]),F([]),k(""),B(""),G(null),_e(null),S(ka.INPUT_FORM)},[]),tn=U.useCallback(()=>{const We=JSON.stringify({projectGoal:b,targetDate:I,tasks:j,ganttData:re},null,2),Ge=new Blob([We],{type:"application/json"}),Ze=URL.createObjectURL(Ge),pt=document.createElement("a");pt.href=Ze,pt.download=`project-${Date.now()}.json`,document.body.appendChild(pt),pt.click(),document.body.removeChild(pt),URL.revokeObjectURL(Ze)},[b,I,j,re]),zn=U.useCallback(Oe=>{const We=new FileReader;We.onload=Ge=>{var Ze;try{const pt=JSON.parse((Ze=Ge.target)==null?void 0:Ze.result);pt.projectGoal&&pt.targetDate&&Array.isArray(pt.tasks)?(k(pt.projectGoal),B(pt.targetDate),Be(pt.tasks),G(pt.ganttData||null),S(ka.PROJECT_FLOW),M({tasks:pt.tasks,projectGoal:pt.projectGoal,targetDate:pt.targetDate})):ue("無効なプロジェクトファイル形式です。")}catch{ue("ファイルの読み込みに失敗しました。")}},We.readAsText(Oe)},[Be,M]),yn=U.useCallback(()=>{const Oe={id:Se("task"),title:"新しいタスク",description:"タスクの説明を入力してください",position:{x:50+j.length%3*ve,y:50+Math.floor(j.length/3)*Te}};Be([...j,Oe])},[j,Se,Be,ve,Te]),Qt=U.useCallback(Oe=>{if(confirm("このタスクを削除しますか？")){const We=j.filter(Ge=>Ge.id!==Oe);Be(We)}},[j,Be]),Mt=U.useCallback(Oe=>{const We=new FileReader;We.onload=Ge=>{var Ze;try{const pt=JSON.parse((Ze=Ge.target)==null?void 0:Ze.result);if(pt.task&&pt.task.id&&pt.task.title){const Zn={...pt.task,id:Se("imported_task"),position:{x:50+j.length%3*ve,y:50+Math.floor(j.length/3)*Te}};Be([...j,Zn])}else ue("無効なタスクファイル形式です。")}catch{ue("タスクファイルの読み込みに失敗しました。")}},We.readAsText(Oe)},[j,Se,Be,ve,Te]),it=U.useCallback(()=>{const Oe=j.map((We,Ge)=>({...We,position:{x:50+Ge%3*ve,y:50+Math.floor(Ge/3)*Te}}));Be(Oe)},[j,Be,ve,Te]),tt=U.useCallback(()=>{const Oe=Y();Oe&&(F(Oe.tasks),k(Oe.projectGoal),B(Oe.targetDate))},[Y]),St=U.useCallback(()=>{const Oe=K();Oe&&(F(Oe.tasks),k(Oe.projectGoal),B(Oe.targetDate))},[K]),on=U.useCallback(Oe=>{_e(Oe)},[]),jt=U.useCallback(async Oe=>{v(!0);try{const We=await rr.getProjectWithMembers(Oe.id);c(Oe),f(We.members||[]),k(Oe.goal),B(Oe.targetDate),F(Oe.tasks),G(Oe.ganttData||null),S(ka.PROJECT_FLOW),T(!1)}catch(We){ue(We instanceof Error?We.message:"プロジェクトの読み込みに失敗しました")}finally{v(!1)}},[]),Pn=U.useCallback(async()=>{if(!t)throw new Error("ログインが必要です");if(l!=null&&l.id){const Oe=await rr.updateProject(l.id,{goal:b,targetDate:I,tasks:j,ganttData:re,description:A,expectedVersion:l.version});c(Oe)}else throw new Error("新規プロジェクトの保存はProjectFlowDisplayで処理されます")},[t,l,b,I,j,re]);return n?x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700",children:x.jsx(In,{size:"lg",text:"認証情報を確認中..."})}):t?D?g?x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-100",children:x.jsx(In,{size:"lg",text:"プロジェクトを読み込み中..."})}):x.jsxs(x.Fragment,{children:[E===ka.INPUT_FORM&&x.jsx(VL,{onSubmit:nt,isLoading:Ne,onImportProject:zn,onLoadTemplate:Ie,initialGoal:b,initialDate:I,onOpenProjectList:()=>T(!0),onLogout:xt,user:t}),E===ka.PROJECT_FLOW&&x.jsx(KO,{tasks:j,projectGoal:b,targetDate:I,onSelectTask:Bt,onUpdateTaskExtendedDetails:an,onUpdateTaskPosition:sn,onUpdateTaskStatus:un,onStartNewProject:vt,onExportProject:tn,onAddTask:yn,onRemoveTask:Qt,onImportSingleTask:Mt,onAutoLayout:it,onUndo:tt,canUndo:W,onRedo:St,canRedo:oe,generateUniqueId:Se,onUpdateTaskConnections:On,ganttData:re,setGanttData:G,onCustomReportGenerated:on,onClearApiKey:dt,onOpenProjectList:()=>T(!0),onLogout:xt,currentProjectId:(l==null?void 0:l.id)||null,onSaveProject:Pn,projectMembers:d,userRole:(l==null?void 0:l.userRole)||"viewer",onMembersUpdate:De}),X&&x.jsx(lG,{task:X,onClose:()=>P(null),onUpdateTask:an,generateUniqueId:Se,projectGoal:b,targetDate:I,canEdit:!l||l.userRole==="owner"||l.userRole==="editor"}),_&&x.jsx(uG,{isOpen:_,onClose:()=>T(!1),onSelectProject:jt,onCreateNew:vt}),se&&x.jsxs("div",{className:"fixed bottom-4 right-4 z-50",children:[x.jsx(Ji,{message:se}),x.jsx("button",{onClick:()=>ue(null),className:"mt-2 text-sm text-blue-600 hover:underline",children:"閉じる"})]})]}):x.jsx(cG,{onSetApiKey:Z,error:se,isLoading:Ne}):x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-md w-full text-center",children:[x.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-4",children:"AI Project Planner"}),x.jsx("p",{className:"text-slate-600 mb-6",children:"プロジェクト管理を始めるには、ログインまたはアカウントを作成してください。"}),x.jsx("button",{onClick:()=>i(!0),className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700",children:"ログイン / アカウント作成"})]})}),x.jsx(OS,{isOpen:a,onClose:()=>i(!1),onSuccess:Ke})]})},mG=()=>{var _;const{token:t}=NA(),e=kT(),[n,r]=U.useState(null),[a,i]=U.useState(!1),[l,c]=U.useState(null),[d,f]=U.useState(!1);U.useEffect(()=>{at.auth.getSession().then(({data:{session:E}})=>{r((E==null?void 0:E.user)??null),E!=null&&E.user&&t&&g()});const{data:{subscription:T}}=at.auth.onAuthStateChange((E,S)=>{r((S==null?void 0:S.user)??null),S!=null&&S.user&&t&&!l&&g()});return()=>T.unsubscribe()},[t]);const g=async()=>{if(!t){c({success:!1,error:"無効な招待リンクです"});return}i(!0);try{const T=await rr.joinProjectByInvitation(t);c(T),T.success&&T.project&&setTimeout(()=>{e("/")},3e3)}catch(T){c({success:!1,error:T instanceof Error?T.message:"プロジェクトへの参加に失敗しました"})}finally{i(!1)}},v=()=>{f(!1)};return t?n?a?x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-md w-full text-center",children:[x.jsx(In,{size:"lg"}),x.jsx("h1",{className:"text-2xl font-bold text-slate-800 mt-4 mb-2",children:"プロジェクトに参加中..."}),x.jsx("p",{className:"text-slate-600",children:"しばらくお待ちください。"})]})}):l?x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:x.jsx("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-md w-full text-center",children:l.success?x.jsxs(x.Fragment,{children:[x.jsx(gu,{className:"w-16 h-16 mx-auto text-green-500 mb-4"}),x.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:"参加完了！"}),x.jsxs("p",{className:"text-slate-600 mb-2",children:["プロジェクト「",(_=l.project)==null?void 0:_.title,"」に参加しました。"]}),x.jsx("p",{className:"text-sm text-slate-500 mb-6",children:"3秒後に自動的にプロジェクトページに移動します..."}),x.jsx("button",{onClick:()=>e("/"),className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700",children:"今すぐプロジェクトを見る"})]}):x.jsxs(x.Fragment,{children:[x.jsx(Mi,{className:"w-16 h-16 mx-auto text-red-500 mb-4"}),x.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:"参加に失敗"}),x.jsx("p",{className:"text-slate-600 mb-6",children:l.error}),x.jsx("button",{onClick:()=>e("/"),className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700",children:"ホームに戻る"})]})})}):null:x.jsxs(x.Fragment,{children:[x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-md w-full text-center",children:[x.jsx(Tl,{className:"w-16 h-16 mx-auto text-blue-500 mb-4"}),x.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:"プロジェクトへの招待"}),x.jsx("p",{className:"text-slate-600 mb-6",children:"プロジェクトに参加するには、まずログインまたはアカウントを作成してください。"}),x.jsx("button",{onClick:()=>f(!0),className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700",children:"ログイン / アカウント作成"})]})}),x.jsx(OS,{isOpen:d,onClose:()=>f(!1),onSuccess:v})]}):x.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-700 p-4",children:x.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-md w-full text-center",children:[x.jsx(Mi,{className:"w-16 h-16 mx-auto text-red-500 mb-4"}),x.jsx("h1",{className:"text-2xl font-bold text-slate-800 mb-2",children:"無効な招待リンク"}),x.jsx("p",{className:"text-slate-600 mb-6",children:"招待リンクが正しくありません。"}),x.jsx("button",{onClick:()=>e("/"),className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700",children:"ホームに戻る"})]})})},PS=document.getElementById("root");if(!PS)throw new Error("Could not find root element to mount to");const pG=ZC.createRoot(PS);pG.render(x.jsx(cs.StrictMode,{children:x.jsx(mk,{children:x.jsxs(GA,{children:[x.jsx(Em,{path:"/",element:x.jsx(hG,{})}),x.jsx(Em,{path:"/invite/:token",element:x.jsx(mG,{})})]})})}));
